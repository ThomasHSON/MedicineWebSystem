(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();function af(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var bc={exports:{}},Do={},Nc={exports:{}},Pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xs=Symbol.for("react.element"),cf=Symbol.for("react.portal"),uf=Symbol.for("react.fragment"),df=Symbol.for("react.strict_mode"),ff=Symbol.for("react.profiler"),pf=Symbol.for("react.provider"),mf=Symbol.for("react.context"),hf=Symbol.for("react.forward_ref"),gf=Symbol.for("react.suspense"),xf=Symbol.for("react.memo"),yf=Symbol.for("react.lazy"),ci=Symbol.iterator;function vf(e){return e===null||typeof e!="object"?null:(e=ci&&e[ci]||e["@@iterator"],typeof e=="function"?e:null)}var jc={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Sc=Object.assign,Cc={};function _r(e,t,n){this.props=e,this.context=t,this.refs=Cc,this.updater=n||jc}_r.prototype.isReactComponent={};_r.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_r.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function kc(){}kc.prototype=_r.prototype;function fa(e,t,n){this.props=e,this.context=t,this.refs=Cc,this.updater=n||jc}var pa=fa.prototype=new kc;pa.constructor=fa;Sc(pa,_r.prototype);pa.isPureReactComponent=!0;var ui=Array.isArray,Dc=Object.prototype.hasOwnProperty,ma={current:null},_c={key:!0,ref:!0,__self:!0,__source:!0};function Mc(e,t,n){var s,o={},l=null,a=null;if(t!=null)for(s in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(l=""+t.key),t)Dc.call(t,s)&&!_c.hasOwnProperty(s)&&(o[s]=t[s]);var i=arguments.length-2;if(i===1)o.children=n;else if(1<i){for(var c=Array(i),h=0;h<i;h++)c[h]=arguments[h+2];o.children=c}if(e&&e.defaultProps)for(s in i=e.defaultProps,i)o[s]===void 0&&(o[s]=i[s]);return{$$typeof:xs,type:e,key:l,ref:a,props:o,_owner:ma.current}}function wf(e,t){return{$$typeof:xs,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ha(e){return typeof e=="object"&&e!==null&&e.$$typeof===xs}function bf(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var di=/\/+/g;function Wo(e,t){return typeof e=="object"&&e!==null&&e.key!=null?bf(""+e.key):t.toString(36)}function Gs(e,t,n,s,o){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(l){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case xs:case cf:a=!0}}if(a)return a=e,o=o(a),e=s===""?"."+Wo(a,0):s,ui(o)?(n="",e!=null&&(n=e.replace(di,"$&/")+"/"),Gs(o,t,n,"",function(h){return h})):o!=null&&(ha(o)&&(o=wf(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(di,"$&/")+"/")+e)),t.push(o)),1;if(a=0,s=s===""?".":s+":",ui(e))for(var i=0;i<e.length;i++){l=e[i];var c=s+Wo(l,i);a+=Gs(l,t,n,c,o)}else if(c=vf(e),typeof c=="function")for(e=c.call(e),i=0;!(l=e.next()).done;)l=l.value,c=s+Wo(l,i++),a+=Gs(l,t,n,c,o);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ss(e,t,n){if(e==null)return e;var s=[],o=0;return Gs(e,s,"","",function(l){return t.call(n,l,o++)}),s}function Nf(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ft={current:null},Fs={transition:null},jf={ReactCurrentDispatcher:ft,ReactCurrentBatchConfig:Fs,ReactCurrentOwner:ma};function Ec(){throw Error("act(...) is not supported in production builds of React.")}Pe.Children={map:Ss,forEach:function(e,t,n){Ss(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ss(e,function(){t++}),t},toArray:function(e){return Ss(e,function(t){return t})||[]},only:function(e){if(!ha(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Pe.Component=_r;Pe.Fragment=uf;Pe.Profiler=ff;Pe.PureComponent=fa;Pe.StrictMode=df;Pe.Suspense=gf;Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jf;Pe.act=Ec;Pe.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=Sc({},e.props),o=e.key,l=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,a=ma.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(c in t)Dc.call(t,c)&&!_c.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&i!==void 0?i[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){i=Array(c);for(var h=0;h<c;h++)i[h]=arguments[h+2];s.children=i}return{$$typeof:xs,type:e.type,key:o,ref:l,props:s,_owner:a}};Pe.createContext=function(e){return e={$$typeof:mf,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:pf,_context:e},e.Consumer=e};Pe.createElement=Mc;Pe.createFactory=function(e){var t=Mc.bind(null,e);return t.type=e,t};Pe.createRef=function(){return{current:null}};Pe.forwardRef=function(e){return{$$typeof:hf,render:e}};Pe.isValidElement=ha;Pe.lazy=function(e){return{$$typeof:yf,_payload:{_status:-1,_result:e},_init:Nf}};Pe.memo=function(e,t){return{$$typeof:xf,type:e,compare:t===void 0?null:t}};Pe.startTransition=function(e){var t=Fs.transition;Fs.transition={};try{e()}finally{Fs.transition=t}};Pe.unstable_act=Ec;Pe.useCallback=function(e,t){return ft.current.useCallback(e,t)};Pe.useContext=function(e){return ft.current.useContext(e)};Pe.useDebugValue=function(){};Pe.useDeferredValue=function(e){return ft.current.useDeferredValue(e)};Pe.useEffect=function(e,t){return ft.current.useEffect(e,t)};Pe.useId=function(){return ft.current.useId()};Pe.useImperativeHandle=function(e,t,n){return ft.current.useImperativeHandle(e,t,n)};Pe.useInsertionEffect=function(e,t){return ft.current.useInsertionEffect(e,t)};Pe.useLayoutEffect=function(e,t){return ft.current.useLayoutEffect(e,t)};Pe.useMemo=function(e,t){return ft.current.useMemo(e,t)};Pe.useReducer=function(e,t,n){return ft.current.useReducer(e,t,n)};Pe.useRef=function(e){return ft.current.useRef(e)};Pe.useState=function(e){return ft.current.useState(e)};Pe.useSyncExternalStore=function(e,t,n){return ft.current.useSyncExternalStore(e,t,n)};Pe.useTransition=function(){return ft.current.useTransition()};Pe.version="18.3.1";Nc.exports=Pe;var m=Nc.exports;const to=af(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sf=m,Cf=Symbol.for("react.element"),kf=Symbol.for("react.fragment"),Df=Object.prototype.hasOwnProperty,_f=Sf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mf={key:!0,ref:!0,__self:!0,__source:!0};function Ic(e,t,n){var s,o={},l=null,a=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(a=t.ref);for(s in t)Df.call(t,s)&&!Mf.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)o[s]===void 0&&(o[s]=t[s]);return{$$typeof:Cf,type:e,key:l,ref:a,props:o,_owner:_f.current}}Do.Fragment=kf;Do.jsx=Ic;Do.jsxs=Ic;bc.exports=Do;var r=bc.exports,Pc={exports:{}},_t={},Rc={exports:{}},Tc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(C,X){var fe=C.length;C.push(X);e:for(;0<fe;){var Z=fe-1>>>1,le=C[Z];if(0<o(le,X))C[Z]=X,C[fe]=le,fe=Z;else break e}}function n(C){return C.length===0?null:C[0]}function s(C){if(C.length===0)return null;var X=C[0],fe=C.pop();if(fe!==X){C[0]=fe;e:for(var Z=0,le=C.length,Ne=le>>>1;Z<Ne;){var ae=2*(Z+1)-1,we=C[ae],U=ae+1,ie=C[U];if(0>o(we,fe))U<le&&0>o(ie,we)?(C[Z]=ie,C[U]=fe,Z=U):(C[Z]=we,C[ae]=fe,Z=ae);else if(U<le&&0>o(ie,fe))C[Z]=ie,C[U]=fe,Z=U;else break e}}return X}function o(C,X){var fe=C.sortIndex-X.sortIndex;return fe!==0?fe:C.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var a=Date,i=a.now();e.unstable_now=function(){return a.now()-i}}var c=[],h=[],d=1,g=null,p=3,b=!1,w=!1,D=!1,N=typeof setTimeout=="function"?setTimeout:null,u=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(C){for(var X=n(h);X!==null;){if(X.callback===null)s(h);else if(X.startTime<=C)s(h),X.sortIndex=X.expirationTime,t(c,X);else break;X=n(h)}}function S(C){if(D=!1,x(C),!w)if(n(c)!==null)w=!0,y($);else{var X=n(h);X!==null&&T(S,X.startTime-C)}}function $(C,X){w=!1,D&&(D=!1,u(k),k=-1),b=!0;var fe=p;try{for(x(X),g=n(c);g!==null&&(!(g.expirationTime>X)||C&&!q());){var Z=g.callback;if(typeof Z=="function"){g.callback=null,p=g.priorityLevel;var le=Z(g.expirationTime<=X);X=e.unstable_now(),typeof le=="function"?g.callback=le:g===n(c)&&s(c),x(X)}else s(c);g=n(c)}if(g!==null)var Ne=!0;else{var ae=n(h);ae!==null&&T(S,ae.startTime-X),Ne=!1}return Ne}finally{g=null,p=fe,b=!1}}var M=!1,A=null,k=-1,F=5,E=-1;function q(){return!(e.unstable_now()-E<F)}function V(){if(A!==null){var C=e.unstable_now();E=C;var X=!0;try{X=A(!0,C)}finally{X?P():(M=!1,A=null)}}else M=!1}var P;if(typeof f=="function")P=function(){f(V)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,ne=O.port2;O.port1.onmessage=V,P=function(){ne.postMessage(null)}}else P=function(){N(V,0)};function y(C){A=C,M||(M=!0,P())}function T(C,X){k=N(function(){C(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(C){C.callback=null},e.unstable_continueExecution=function(){w||b||(w=!0,y($))},e.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<C?Math.floor(1e3/C):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(C){switch(p){case 1:case 2:case 3:var X=3;break;default:X=p}var fe=p;p=X;try{return C()}finally{p=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(C,X){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var fe=p;p=C;try{return X()}finally{p=fe}},e.unstable_scheduleCallback=function(C,X,fe){var Z=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Z+fe:Z):fe=Z,C){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=fe+le,C={id:d++,callback:X,priorityLevel:C,startTime:fe,expirationTime:le,sortIndex:-1},fe>Z?(C.sortIndex=fe,t(h,C),n(c)===null&&C===n(h)&&(D?(u(k),k=-1):D=!0,T(S,fe-Z))):(C.sortIndex=le,t(c,C),w||b||(w=!0,y($))),C},e.unstable_shouldYield=q,e.unstable_wrapCallback=function(C){var X=p;return function(){var fe=p;p=X;try{return C.apply(this,arguments)}finally{p=fe}}}})(Tc);Rc.exports=Tc;var Ef=Rc.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var If=m,Dt=Ef;function se(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ac=new Set,es={};function qn(e,t){wr(e,t),wr(e+"Capture",t)}function wr(e,t){for(es[e]=t,e=0;e<t.length;e++)Ac.add(t[e])}var cn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vl=Object.prototype.hasOwnProperty,Pf=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fi={},pi={};function Rf(e){return vl.call(pi,e)?!0:vl.call(fi,e)?!1:Pf.test(e)?pi[e]=!0:(fi[e]=!0,!1)}function Tf(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Af(e,t,n,s){if(t===null||typeof t>"u"||Tf(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function pt(e,t,n,s,o,l,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=a}var ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ot[e]=new pt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ot[t]=new pt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ot[e]=new pt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ot[e]=new pt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ot[e]=new pt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ot[e]=new pt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ot[e]=new pt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ot[e]=new pt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ot[e]=new pt(e,5,!1,e.toLowerCase(),null,!1,!1)});var ga=/[\-:]([a-z])/g;function xa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ga,xa);ot[t]=new pt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ga,xa);ot[t]=new pt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ga,xa);ot[t]=new pt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ot[e]=new pt(e,1,!1,e.toLowerCase(),null,!1,!1)});ot.xlinkHref=new pt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ot[e]=new pt(e,1,!1,e.toLowerCase(),null,!0,!0)});function ya(e,t,n,s){var o=ot.hasOwnProperty(t)?ot[t]:null;(o!==null?o.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Af(t,n,o,s)&&(n=null),s||o===null?Rf(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,s=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var pn=If.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cs=Symbol.for("react.element"),nr=Symbol.for("react.portal"),rr=Symbol.for("react.fragment"),va=Symbol.for("react.strict_mode"),wl=Symbol.for("react.profiler"),Oc=Symbol.for("react.provider"),$c=Symbol.for("react.context"),wa=Symbol.for("react.forward_ref"),bl=Symbol.for("react.suspense"),Nl=Symbol.for("react.suspense_list"),ba=Symbol.for("react.memo"),gn=Symbol.for("react.lazy"),Lc=Symbol.for("react.offscreen"),mi=Symbol.iterator;function Rr(e){return e===null||typeof e!="object"?null:(e=mi&&e[mi]||e["@@iterator"],typeof e=="function"?e:null)}var He=Object.assign,qo;function zr(e){if(qo===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);qo=t&&t[1]||""}return`
`+qo+e}var Yo=!1;function Xo(e,t){if(!e||Yo)return"";Yo=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var s=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){s=h}e.call(t.prototype)}else{try{throw Error()}catch(h){s=h}e()}}catch(h){if(h&&s&&typeof h.stack=="string"){for(var o=h.stack.split(`
`),l=s.stack.split(`
`),a=o.length-1,i=l.length-1;1<=a&&0<=i&&o[a]!==l[i];)i--;for(;1<=a&&0<=i;a--,i--)if(o[a]!==l[i]){if(a!==1||i!==1)do if(a--,i--,0>i||o[a]!==l[i]){var c=`
`+o[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=i);break}}}finally{Yo=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?zr(e):""}function Of(e){switch(e.tag){case 5:return zr(e.type);case 16:return zr("Lazy");case 13:return zr("Suspense");case 19:return zr("SuspenseList");case 0:case 2:case 15:return e=Xo(e.type,!1),e;case 11:return e=Xo(e.type.render,!1),e;case 1:return e=Xo(e.type,!0),e;default:return""}}function jl(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case rr:return"Fragment";case nr:return"Portal";case wl:return"Profiler";case va:return"StrictMode";case bl:return"Suspense";case Nl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case $c:return(e.displayName||"Context")+".Consumer";case Oc:return(e._context.displayName||"Context")+".Provider";case wa:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ba:return t=e.displayName||null,t!==null?t:jl(e.type)||"Memo";case gn:t=e._payload,e=e._init;try{return jl(e(t))}catch{}}return null}function $f(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jl(t);case 8:return t===va?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function En(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Uc(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Lf(e){var t=Uc(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(a){s=""+a,l.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ks(e){e._valueTracker||(e._valueTracker=Lf(e))}function Bc(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Uc(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function no(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Sl(e,t){var n=t.checked;return He({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function hi(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=En(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function zc(e,t){t=t.checked,t!=null&&ya(e,"checked",t,!1)}function Cl(e,t){zc(e,t);var n=En(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?kl(e,t.type,n):t.hasOwnProperty("defaultValue")&&kl(e,t.type,En(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function gi(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function kl(e,t,n){(t!=="number"||no(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Gr=Array.isArray;function mr(e,t,n,s){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&s&&(e[n].defaultSelected=!0)}else{for(n=""+En(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function Dl(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(se(91));return He({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function xi(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(se(92));if(Gr(n)){if(1<n.length)throw Error(se(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:En(n)}}function Gc(e,t){var n=En(t.value),s=En(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function yi(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Fc(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _l(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Fc(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ds,Hc=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ds=Ds||document.createElement("div"),Ds.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ds.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ts(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Vr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Uf=["Webkit","ms","Moz","O"];Object.keys(Vr).forEach(function(e){Uf.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Vr[t]=Vr[e]})});function Vc(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Vr.hasOwnProperty(e)&&Vr[e]?(""+t).trim():t+"px"}function Wc(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,o=Vc(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,o):e[n]=o}}var Bf=He({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ml(e,t){if(t){if(Bf[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(se(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(se(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(se(61))}if(t.style!=null&&typeof t.style!="object")throw Error(se(62))}}function El(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Il=null;function Na(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pl=null,hr=null,gr=null;function vi(e){if(e=ws(e)){if(typeof Pl!="function")throw Error(se(280));var t=e.stateNode;t&&(t=Po(t),Pl(e.stateNode,e.type,t))}}function qc(e){hr?gr?gr.push(e):gr=[e]:hr=e}function Yc(){if(hr){var e=hr,t=gr;if(gr=hr=null,vi(e),t)for(e=0;e<t.length;e++)vi(t[e])}}function Xc(e,t){return e(t)}function Qc(){}var Qo=!1;function Kc(e,t,n){if(Qo)return e(t,n);Qo=!0;try{return Xc(e,t,n)}finally{Qo=!1,(hr!==null||gr!==null)&&(Qc(),Yc())}}function ns(e,t){var n=e.stateNode;if(n===null)return null;var s=Po(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(se(231,t,typeof n));return n}var Rl=!1;if(cn)try{var Tr={};Object.defineProperty(Tr,"passive",{get:function(){Rl=!0}}),window.addEventListener("test",Tr,Tr),window.removeEventListener("test",Tr,Tr)}catch{Rl=!1}function zf(e,t,n,s,o,l,a,i,c){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(d){this.onError(d)}}var Wr=!1,ro=null,so=!1,Tl=null,Gf={onError:function(e){Wr=!0,ro=e}};function Ff(e,t,n,s,o,l,a,i,c){Wr=!1,ro=null,zf.apply(Gf,arguments)}function Hf(e,t,n,s,o,l,a,i,c){if(Ff.apply(this,arguments),Wr){if(Wr){var h=ro;Wr=!1,ro=null}else throw Error(se(198));so||(so=!0,Tl=h)}}function Yn(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Jc(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function wi(e){if(Yn(e)!==e)throw Error(se(188))}function Vf(e){var t=e.alternate;if(!t){if(t=Yn(e),t===null)throw Error(se(188));return t!==e?null:e}for(var n=e,s=t;;){var o=n.return;if(o===null)break;var l=o.alternate;if(l===null){if(s=o.return,s!==null){n=s;continue}break}if(o.child===l.child){for(l=o.child;l;){if(l===n)return wi(o),e;if(l===s)return wi(o),t;l=l.sibling}throw Error(se(188))}if(n.return!==s.return)n=o,s=l;else{for(var a=!1,i=o.child;i;){if(i===n){a=!0,n=o,s=l;break}if(i===s){a=!0,s=o,n=l;break}i=i.sibling}if(!a){for(i=l.child;i;){if(i===n){a=!0,n=l,s=o;break}if(i===s){a=!0,s=l,n=o;break}i=i.sibling}if(!a)throw Error(se(189))}}if(n.alternate!==s)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?e:t}function Zc(e){return e=Vf(e),e!==null?eu(e):null}function eu(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=eu(e);if(t!==null)return t;e=e.sibling}return null}var tu=Dt.unstable_scheduleCallback,bi=Dt.unstable_cancelCallback,Wf=Dt.unstable_shouldYield,qf=Dt.unstable_requestPaint,Ye=Dt.unstable_now,Yf=Dt.unstable_getCurrentPriorityLevel,ja=Dt.unstable_ImmediatePriority,nu=Dt.unstable_UserBlockingPriority,oo=Dt.unstable_NormalPriority,Xf=Dt.unstable_LowPriority,ru=Dt.unstable_IdlePriority,_o=null,Jt=null;function Qf(e){if(Jt&&typeof Jt.onCommitFiberRoot=="function")try{Jt.onCommitFiberRoot(_o,e,void 0,(e.current.flags&128)===128)}catch{}}var Ht=Math.clz32?Math.clz32:Zf,Kf=Math.log,Jf=Math.LN2;function Zf(e){return e>>>=0,e===0?32:31-(Kf(e)/Jf|0)|0}var _s=64,Ms=4194304;function Fr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function lo(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,o=e.suspendedLanes,l=e.pingedLanes,a=n&268435455;if(a!==0){var i=a&~o;i!==0?s=Fr(i):(l&=a,l!==0&&(s=Fr(l)))}else a=n&~o,a!==0?s=Fr(a):l!==0&&(s=Fr(l));if(s===0)return 0;if(t!==0&&t!==s&&!(t&o)&&(o=s&-s,l=t&-t,o>=l||o===16&&(l&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-Ht(t),o=1<<n,s|=e[n],t&=~o;return s}function ep(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tp(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,l=e.pendingLanes;0<l;){var a=31-Ht(l),i=1<<a,c=o[a];c===-1?(!(i&n)||i&s)&&(o[a]=ep(i,t)):c<=t&&(e.expiredLanes|=i),l&=~i}}function Al(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function su(){var e=_s;return _s<<=1,!(_s&4194240)&&(_s=64),e}function Ko(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ys(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ht(t),e[t]=n}function np(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-Ht(n),l=1<<o;t[o]=0,s[o]=-1,e[o]=-1,n&=~l}}function Sa(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-Ht(n),o=1<<s;o&t|e[s]&t&&(e[s]|=t),n&=~o}}var Ae=0;function ou(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var lu,Ca,au,iu,cu,Ol=!1,Es=[],Nn=null,jn=null,Sn=null,rs=new Map,ss=new Map,yn=[],rp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ni(e,t){switch(e){case"focusin":case"focusout":Nn=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Sn=null;break;case"pointerover":case"pointerout":rs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ss.delete(t.pointerId)}}function Ar(e,t,n,s,o,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:l,targetContainers:[o]},t!==null&&(t=ws(t),t!==null&&Ca(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function sp(e,t,n,s,o){switch(t){case"focusin":return Nn=Ar(Nn,e,t,n,s,o),!0;case"dragenter":return jn=Ar(jn,e,t,n,s,o),!0;case"mouseover":return Sn=Ar(Sn,e,t,n,s,o),!0;case"pointerover":var l=o.pointerId;return rs.set(l,Ar(rs.get(l)||null,e,t,n,s,o)),!0;case"gotpointercapture":return l=o.pointerId,ss.set(l,Ar(ss.get(l)||null,e,t,n,s,o)),!0}return!1}function uu(e){var t=$n(e.target);if(t!==null){var n=Yn(t);if(n!==null){if(t=n.tag,t===13){if(t=Jc(n),t!==null){e.blockedOn=t,cu(e.priority,function(){au(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Hs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=$l(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Il=s,n.target.dispatchEvent(s),Il=null}else return t=ws(n),t!==null&&Ca(t),e.blockedOn=n,!1;t.shift()}return!0}function ji(e,t,n){Hs(e)&&n.delete(t)}function op(){Ol=!1,Nn!==null&&Hs(Nn)&&(Nn=null),jn!==null&&Hs(jn)&&(jn=null),Sn!==null&&Hs(Sn)&&(Sn=null),rs.forEach(ji),ss.forEach(ji)}function Or(e,t){e.blockedOn===t&&(e.blockedOn=null,Ol||(Ol=!0,Dt.unstable_scheduleCallback(Dt.unstable_NormalPriority,op)))}function os(e){function t(o){return Or(o,e)}if(0<Es.length){Or(Es[0],e);for(var n=1;n<Es.length;n++){var s=Es[n];s.blockedOn===e&&(s.blockedOn=null)}}for(Nn!==null&&Or(Nn,e),jn!==null&&Or(jn,e),Sn!==null&&Or(Sn,e),rs.forEach(t),ss.forEach(t),n=0;n<yn.length;n++)s=yn[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<yn.length&&(n=yn[0],n.blockedOn===null);)uu(n),n.blockedOn===null&&yn.shift()}var xr=pn.ReactCurrentBatchConfig,ao=!0;function lp(e,t,n,s){var o=Ae,l=xr.transition;xr.transition=null;try{Ae=1,ka(e,t,n,s)}finally{Ae=o,xr.transition=l}}function ap(e,t,n,s){var o=Ae,l=xr.transition;xr.transition=null;try{Ae=4,ka(e,t,n,s)}finally{Ae=o,xr.transition=l}}function ka(e,t,n,s){if(ao){var o=$l(e,t,n,s);if(o===null)al(e,t,s,io,n),Ni(e,s);else if(sp(o,e,t,n,s))s.stopPropagation();else if(Ni(e,s),t&4&&-1<rp.indexOf(e)){for(;o!==null;){var l=ws(o);if(l!==null&&lu(l),l=$l(e,t,n,s),l===null&&al(e,t,s,io,n),l===o)break;o=l}o!==null&&s.stopPropagation()}else al(e,t,s,null,n)}}var io=null;function $l(e,t,n,s){if(io=null,e=Na(s),e=$n(e),e!==null)if(t=Yn(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Jc(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return io=e,null}function du(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Yf()){case ja:return 1;case nu:return 4;case oo:case Xf:return 16;case ru:return 536870912;default:return 16}default:return 16}}var wn=null,Da=null,Vs=null;function fu(){if(Vs)return Vs;var e,t=Da,n=t.length,s,o="value"in wn?wn.value:wn.textContent,l=o.length;for(e=0;e<n&&t[e]===o[e];e++);var a=n-e;for(s=1;s<=a&&t[n-s]===o[l-s];s++);return Vs=o.slice(e,1<s?1-s:void 0)}function Ws(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Is(){return!0}function Si(){return!1}function Mt(e){function t(n,s,o,l,a){this._reactName=n,this._targetInst=o,this.type=s,this.nativeEvent=l,this.target=a,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],this[i]=n?n(l):l[i]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Is:Si,this.isPropagationStopped=Si,this}return He(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Is)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Is)},persist:function(){},isPersistent:Is}),t}var Mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_a=Mt(Mr),vs=He({},Mr,{view:0,detail:0}),ip=Mt(vs),Jo,Zo,$r,Mo=He({},vs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ma,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$r&&($r&&e.type==="mousemove"?(Jo=e.screenX-$r.screenX,Zo=e.screenY-$r.screenY):Zo=Jo=0,$r=e),Jo)},movementY:function(e){return"movementY"in e?e.movementY:Zo}}),Ci=Mt(Mo),cp=He({},Mo,{dataTransfer:0}),up=Mt(cp),dp=He({},vs,{relatedTarget:0}),el=Mt(dp),fp=He({},Mr,{animationName:0,elapsedTime:0,pseudoElement:0}),pp=Mt(fp),mp=He({},Mr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),hp=Mt(mp),gp=He({},Mr,{data:0}),ki=Mt(gp),xp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=vp[e])?!!t[e]:!1}function Ma(){return wp}var bp=He({},vs,{key:function(e){if(e.key){var t=xp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ws(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?yp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ma,charCode:function(e){return e.type==="keypress"?Ws(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ws(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Np=Mt(bp),jp=He({},Mo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Di=Mt(jp),Sp=He({},vs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ma}),Cp=Mt(Sp),kp=He({},Mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dp=Mt(kp),_p=He({},Mo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mp=Mt(_p),Ep=[9,13,27,32],Ea=cn&&"CompositionEvent"in window,qr=null;cn&&"documentMode"in document&&(qr=document.documentMode);var Ip=cn&&"TextEvent"in window&&!qr,pu=cn&&(!Ea||qr&&8<qr&&11>=qr),_i=" ",Mi=!1;function mu(e,t){switch(e){case"keyup":return Ep.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var sr=!1;function Pp(e,t){switch(e){case"compositionend":return hu(t);case"keypress":return t.which!==32?null:(Mi=!0,_i);case"textInput":return e=t.data,e===_i&&Mi?null:e;default:return null}}function Rp(e,t){if(sr)return e==="compositionend"||!Ea&&mu(e,t)?(e=fu(),Vs=Da=wn=null,sr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pu&&t.locale!=="ko"?null:t.data;default:return null}}var Tp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ei(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Tp[e.type]:t==="textarea"}function gu(e,t,n,s){qc(s),t=co(t,"onChange"),0<t.length&&(n=new _a("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Yr=null,ls=null;function Ap(e){Du(e,0)}function Eo(e){var t=ar(e);if(Bc(t))return e}function Op(e,t){if(e==="change")return t}var xu=!1;if(cn){var tl;if(cn){var nl="oninput"in document;if(!nl){var Ii=document.createElement("div");Ii.setAttribute("oninput","return;"),nl=typeof Ii.oninput=="function"}tl=nl}else tl=!1;xu=tl&&(!document.documentMode||9<document.documentMode)}function Pi(){Yr&&(Yr.detachEvent("onpropertychange",yu),ls=Yr=null)}function yu(e){if(e.propertyName==="value"&&Eo(ls)){var t=[];gu(t,ls,e,Na(e)),Kc(Ap,t)}}function $p(e,t,n){e==="focusin"?(Pi(),Yr=t,ls=n,Yr.attachEvent("onpropertychange",yu)):e==="focusout"&&Pi()}function Lp(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Eo(ls)}function Up(e,t){if(e==="click")return Eo(t)}function Bp(e,t){if(e==="input"||e==="change")return Eo(t)}function zp(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Wt=typeof Object.is=="function"?Object.is:zp;function as(e,t){if(Wt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var o=n[s];if(!vl.call(t,o)||!Wt(e[o],t[o]))return!1}return!0}function Ri(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ti(e,t){var n=Ri(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ri(n)}}function vu(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?vu(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function wu(){for(var e=window,t=no();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=no(e.document)}return t}function Ia(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Gp(e){var t=wu(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&vu(n.ownerDocument.documentElement,n)){if(s!==null&&Ia(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,l=Math.min(s.start,o);s=s.end===void 0?l:Math.min(s.end,o),!e.extend&&l>s&&(o=s,s=l,l=o),o=Ti(n,l);var a=Ti(n,s);o&&a&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),l>s?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Fp=cn&&"documentMode"in document&&11>=document.documentMode,or=null,Ll=null,Xr=null,Ul=!1;function Ai(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ul||or==null||or!==no(s)||(s=or,"selectionStart"in s&&Ia(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Xr&&as(Xr,s)||(Xr=s,s=co(Ll,"onSelect"),0<s.length&&(t=new _a("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=or)))}function Ps(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var lr={animationend:Ps("Animation","AnimationEnd"),animationiteration:Ps("Animation","AnimationIteration"),animationstart:Ps("Animation","AnimationStart"),transitionend:Ps("Transition","TransitionEnd")},rl={},bu={};cn&&(bu=document.createElement("div").style,"AnimationEvent"in window||(delete lr.animationend.animation,delete lr.animationiteration.animation,delete lr.animationstart.animation),"TransitionEvent"in window||delete lr.transitionend.transition);function Io(e){if(rl[e])return rl[e];if(!lr[e])return e;var t=lr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in bu)return rl[e]=t[n];return e}var Nu=Io("animationend"),ju=Io("animationiteration"),Su=Io("animationstart"),Cu=Io("transitionend"),ku=new Map,Oi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pn(e,t){ku.set(e,t),qn(t,[e])}for(var sl=0;sl<Oi.length;sl++){var ol=Oi[sl],Hp=ol.toLowerCase(),Vp=ol[0].toUpperCase()+ol.slice(1);Pn(Hp,"on"+Vp)}Pn(Nu,"onAnimationEnd");Pn(ju,"onAnimationIteration");Pn(Su,"onAnimationStart");Pn("dblclick","onDoubleClick");Pn("focusin","onFocus");Pn("focusout","onBlur");Pn(Cu,"onTransitionEnd");wr("onMouseEnter",["mouseout","mouseover"]);wr("onMouseLeave",["mouseout","mouseover"]);wr("onPointerEnter",["pointerout","pointerover"]);wr("onPointerLeave",["pointerout","pointerover"]);qn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qn("onBeforeInput",["compositionend","keypress","textInput","paste"]);qn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wp=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hr));function $i(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,Hf(s,t,void 0,e),e.currentTarget=null}function Du(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],o=s.event;s=s.listeners;e:{var l=void 0;if(t)for(var a=s.length-1;0<=a;a--){var i=s[a],c=i.instance,h=i.currentTarget;if(i=i.listener,c!==l&&o.isPropagationStopped())break e;$i(o,i,h),l=c}else for(a=0;a<s.length;a++){if(i=s[a],c=i.instance,h=i.currentTarget,i=i.listener,c!==l&&o.isPropagationStopped())break e;$i(o,i,h),l=c}}}if(so)throw e=Tl,so=!1,Tl=null,e}function Le(e,t){var n=t[Hl];n===void 0&&(n=t[Hl]=new Set);var s=e+"__bubble";n.has(s)||(_u(t,e,2,!1),n.add(s))}function ll(e,t,n){var s=0;t&&(s|=4),_u(n,e,s,t)}var Rs="_reactListening"+Math.random().toString(36).slice(2);function is(e){if(!e[Rs]){e[Rs]=!0,Ac.forEach(function(n){n!=="selectionchange"&&(Wp.has(n)||ll(n,!1,e),ll(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Rs]||(t[Rs]=!0,ll("selectionchange",!1,t))}}function _u(e,t,n,s){switch(du(t)){case 1:var o=lp;break;case 4:o=ap;break;default:o=ka}n=o.bind(null,t,n,e),o=void 0,!Rl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function al(e,t,n,s,o){var l=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var i=s.stateNode.containerInfo;if(i===o||i.nodeType===8&&i.parentNode===o)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===o||c.nodeType===8&&c.parentNode===o))return;a=a.return}for(;i!==null;){if(a=$n(i),a===null)return;if(c=a.tag,c===5||c===6){s=l=a;continue e}i=i.parentNode}}s=s.return}Kc(function(){var h=l,d=Na(n),g=[];e:{var p=ku.get(e);if(p!==void 0){var b=_a,w=e;switch(e){case"keypress":if(Ws(n)===0)break e;case"keydown":case"keyup":b=Np;break;case"focusin":w="focus",b=el;break;case"focusout":w="blur",b=el;break;case"beforeblur":case"afterblur":b=el;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=Ci;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=up;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=Cp;break;case Nu:case ju:case Su:b=pp;break;case Cu:b=Dp;break;case"scroll":b=ip;break;case"wheel":b=Mp;break;case"copy":case"cut":case"paste":b=hp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=Di}var D=(t&4)!==0,N=!D&&e==="scroll",u=D?p!==null?p+"Capture":null:p;D=[];for(var f=h,x;f!==null;){x=f;var S=x.stateNode;if(x.tag===5&&S!==null&&(x=S,u!==null&&(S=ns(f,u),S!=null&&D.push(cs(f,S,x)))),N)break;f=f.return}0<D.length&&(p=new b(p,w,null,n,d),g.push({event:p,listeners:D}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",b=e==="mouseout"||e==="pointerout",p&&n!==Il&&(w=n.relatedTarget||n.fromElement)&&($n(w)||w[un]))break e;if((b||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,b?(w=n.relatedTarget||n.toElement,b=h,w=w?$n(w):null,w!==null&&(N=Yn(w),w!==N||w.tag!==5&&w.tag!==6)&&(w=null)):(b=null,w=h),b!==w)){if(D=Ci,S="onMouseLeave",u="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(D=Di,S="onPointerLeave",u="onPointerEnter",f="pointer"),N=b==null?p:ar(b),x=w==null?p:ar(w),p=new D(S,f+"leave",b,n,d),p.target=N,p.relatedTarget=x,S=null,$n(d)===h&&(D=new D(u,f+"enter",w,n,d),D.target=x,D.relatedTarget=N,S=D),N=S,b&&w)t:{for(D=b,u=w,f=0,x=D;x;x=tr(x))f++;for(x=0,S=u;S;S=tr(S))x++;for(;0<f-x;)D=tr(D),f--;for(;0<x-f;)u=tr(u),x--;for(;f--;){if(D===u||u!==null&&D===u.alternate)break t;D=tr(D),u=tr(u)}D=null}else D=null;b!==null&&Li(g,p,b,D,!1),w!==null&&N!==null&&Li(g,N,w,D,!0)}}e:{if(p=h?ar(h):window,b=p.nodeName&&p.nodeName.toLowerCase(),b==="select"||b==="input"&&p.type==="file")var $=Op;else if(Ei(p))if(xu)$=Bp;else{$=Lp;var M=$p}else(b=p.nodeName)&&b.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&($=Up);if($&&($=$(e,h))){gu(g,$,n,d);break e}M&&M(e,p,h),e==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&kl(p,"number",p.value)}switch(M=h?ar(h):window,e){case"focusin":(Ei(M)||M.contentEditable==="true")&&(or=M,Ll=h,Xr=null);break;case"focusout":Xr=Ll=or=null;break;case"mousedown":Ul=!0;break;case"contextmenu":case"mouseup":case"dragend":Ul=!1,Ai(g,n,d);break;case"selectionchange":if(Fp)break;case"keydown":case"keyup":Ai(g,n,d)}var A;if(Ea)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else sr?mu(e,n)&&(k="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(pu&&n.locale!=="ko"&&(sr||k!=="onCompositionStart"?k==="onCompositionEnd"&&sr&&(A=fu()):(wn=d,Da="value"in wn?wn.value:wn.textContent,sr=!0)),M=co(h,k),0<M.length&&(k=new ki(k,e,null,n,d),g.push({event:k,listeners:M}),A?k.data=A:(A=hu(n),A!==null&&(k.data=A)))),(A=Ip?Pp(e,n):Rp(e,n))&&(h=co(h,"onBeforeInput"),0<h.length&&(d=new ki("onBeforeInput","beforeinput",null,n,d),g.push({event:d,listeners:h}),d.data=A))}Du(g,t)})}function cs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function co(e,t){for(var n=t+"Capture",s=[];e!==null;){var o=e,l=o.stateNode;o.tag===5&&l!==null&&(o=l,l=ns(e,n),l!=null&&s.unshift(cs(e,l,o)),l=ns(e,t),l!=null&&s.push(cs(e,l,o))),e=e.return}return s}function tr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Li(e,t,n,s,o){for(var l=t._reactName,a=[];n!==null&&n!==s;){var i=n,c=i.alternate,h=i.stateNode;if(c!==null&&c===s)break;i.tag===5&&h!==null&&(i=h,o?(c=ns(n,l),c!=null&&a.unshift(cs(n,c,i))):o||(c=ns(n,l),c!=null&&a.push(cs(n,c,i)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var qp=/\r\n?/g,Yp=/\u0000|\uFFFD/g;function Ui(e){return(typeof e=="string"?e:""+e).replace(qp,`
`).replace(Yp,"")}function Ts(e,t,n){if(t=Ui(t),Ui(e)!==t&&n)throw Error(se(425))}function uo(){}var Bl=null,zl=null;function Gl(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Fl=typeof setTimeout=="function"?setTimeout:void 0,Xp=typeof clearTimeout=="function"?clearTimeout:void 0,Bi=typeof Promise=="function"?Promise:void 0,Qp=typeof queueMicrotask=="function"?queueMicrotask:typeof Bi<"u"?function(e){return Bi.resolve(null).then(e).catch(Kp)}:Fl;function Kp(e){setTimeout(function(){throw e})}function il(e,t){var n=t,s=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(s===0){e.removeChild(o),os(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=o}while(n);os(t)}function Cn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function zi(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Er=Math.random().toString(36).slice(2),Kt="__reactFiber$"+Er,us="__reactProps$"+Er,un="__reactContainer$"+Er,Hl="__reactEvents$"+Er,Jp="__reactListeners$"+Er,Zp="__reactHandles$"+Er;function $n(e){var t=e[Kt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[un]||n[Kt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=zi(e);e!==null;){if(n=e[Kt])return n;e=zi(e)}return t}e=n,n=e.parentNode}return null}function ws(e){return e=e[Kt]||e[un],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ar(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(se(33))}function Po(e){return e[us]||null}var Vl=[],ir=-1;function Rn(e){return{current:e}}function Ue(e){0>ir||(e.current=Vl[ir],Vl[ir]=null,ir--)}function $e(e,t){ir++,Vl[ir]=e.current,e.current=t}var In={},ct=Rn(In),wt=Rn(!1),Gn=In;function br(e,t){var n=e.type.contextTypes;if(!n)return In;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var o={},l;for(l in n)o[l]=t[l];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function bt(e){return e=e.childContextTypes,e!=null}function fo(){Ue(wt),Ue(ct)}function Gi(e,t,n){if(ct.current!==In)throw Error(se(168));$e(ct,t),$e(wt,n)}function Mu(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var o in s)if(!(o in t))throw Error(se(108,$f(e)||"Unknown",o));return He({},n,s)}function po(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||In,Gn=ct.current,$e(ct,e),$e(wt,wt.current),!0}function Fi(e,t,n){var s=e.stateNode;if(!s)throw Error(se(169));n?(e=Mu(e,t,Gn),s.__reactInternalMemoizedMergedChildContext=e,Ue(wt),Ue(ct),$e(ct,e)):Ue(wt),$e(wt,n)}var rn=null,Ro=!1,cl=!1;function Eu(e){rn===null?rn=[e]:rn.push(e)}function em(e){Ro=!0,Eu(e)}function Tn(){if(!cl&&rn!==null){cl=!0;var e=0,t=Ae;try{var n=rn;for(Ae=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}rn=null,Ro=!1}catch(o){throw rn!==null&&(rn=rn.slice(e+1)),tu(ja,Tn),o}finally{Ae=t,cl=!1}}return null}var cr=[],ur=0,mo=null,ho=0,It=[],Pt=0,Fn=null,on=1,ln="";function An(e,t){cr[ur++]=ho,cr[ur++]=mo,mo=e,ho=t}function Iu(e,t,n){It[Pt++]=on,It[Pt++]=ln,It[Pt++]=Fn,Fn=e;var s=on;e=ln;var o=32-Ht(s)-1;s&=~(1<<o),n+=1;var l=32-Ht(t)+o;if(30<l){var a=o-o%5;l=(s&(1<<a)-1).toString(32),s>>=a,o-=a,on=1<<32-Ht(t)+o|n<<o|s,ln=l+e}else on=1<<l|n<<o|s,ln=e}function Pa(e){e.return!==null&&(An(e,1),Iu(e,1,0))}function Ra(e){for(;e===mo;)mo=cr[--ur],cr[ur]=null,ho=cr[--ur],cr[ur]=null;for(;e===Fn;)Fn=It[--Pt],It[Pt]=null,ln=It[--Pt],It[Pt]=null,on=It[--Pt],It[Pt]=null}var Ct=null,St=null,Be=!1,Ft=null;function Pu(e,t){var n=Rt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Hi(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ct=e,St=Cn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ct=e,St=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Fn!==null?{id:on,overflow:ln}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Rt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ct=e,St=null,!0):!1;default:return!1}}function Wl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ql(e){if(Be){var t=St;if(t){var n=t;if(!Hi(e,t)){if(Wl(e))throw Error(se(418));t=Cn(n.nextSibling);var s=Ct;t&&Hi(e,t)?Pu(s,n):(e.flags=e.flags&-4097|2,Be=!1,Ct=e)}}else{if(Wl(e))throw Error(se(418));e.flags=e.flags&-4097|2,Be=!1,Ct=e}}}function Vi(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ct=e}function As(e){if(e!==Ct)return!1;if(!Be)return Vi(e),Be=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Gl(e.type,e.memoizedProps)),t&&(t=St)){if(Wl(e))throw Ru(),Error(se(418));for(;t;)Pu(e,t),t=Cn(t.nextSibling)}if(Vi(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(se(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){St=Cn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}St=null}}else St=Ct?Cn(e.stateNode.nextSibling):null;return!0}function Ru(){for(var e=St;e;)e=Cn(e.nextSibling)}function Nr(){St=Ct=null,Be=!1}function Ta(e){Ft===null?Ft=[e]:Ft.push(e)}var tm=pn.ReactCurrentBatchConfig;function Lr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var s=n.stateNode}if(!s)throw Error(se(147,e));var o=s,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(a){var i=o.refs;a===null?delete i[l]:i[l]=a},t._stringRef=l,t)}if(typeof e!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,e))}return e}function Os(e,t){throw e=Object.prototype.toString.call(t),Error(se(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Wi(e){var t=e._init;return t(e._payload)}function Tu(e){function t(u,f){if(e){var x=u.deletions;x===null?(u.deletions=[f],u.flags|=16):x.push(f)}}function n(u,f){if(!e)return null;for(;f!==null;)t(u,f),f=f.sibling;return null}function s(u,f){for(u=new Map;f!==null;)f.key!==null?u.set(f.key,f):u.set(f.index,f),f=f.sibling;return u}function o(u,f){return u=Mn(u,f),u.index=0,u.sibling=null,u}function l(u,f,x){return u.index=x,e?(x=u.alternate,x!==null?(x=x.index,x<f?(u.flags|=2,f):x):(u.flags|=2,f)):(u.flags|=1048576,f)}function a(u){return e&&u.alternate===null&&(u.flags|=2),u}function i(u,f,x,S){return f===null||f.tag!==6?(f=gl(x,u.mode,S),f.return=u,f):(f=o(f,x),f.return=u,f)}function c(u,f,x,S){var $=x.type;return $===rr?d(u,f,x.props.children,S,x.key):f!==null&&(f.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===gn&&Wi($)===f.type)?(S=o(f,x.props),S.ref=Lr(u,f,x),S.return=u,S):(S=Zs(x.type,x.key,x.props,null,u.mode,S),S.ref=Lr(u,f,x),S.return=u,S)}function h(u,f,x,S){return f===null||f.tag!==4||f.stateNode.containerInfo!==x.containerInfo||f.stateNode.implementation!==x.implementation?(f=xl(x,u.mode,S),f.return=u,f):(f=o(f,x.children||[]),f.return=u,f)}function d(u,f,x,S,$){return f===null||f.tag!==7?(f=zn(x,u.mode,S,$),f.return=u,f):(f=o(f,x),f.return=u,f)}function g(u,f,x){if(typeof f=="string"&&f!==""||typeof f=="number")return f=gl(""+f,u.mode,x),f.return=u,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Cs:return x=Zs(f.type,f.key,f.props,null,u.mode,x),x.ref=Lr(u,null,f),x.return=u,x;case nr:return f=xl(f,u.mode,x),f.return=u,f;case gn:var S=f._init;return g(u,S(f._payload),x)}if(Gr(f)||Rr(f))return f=zn(f,u.mode,x,null),f.return=u,f;Os(u,f)}return null}function p(u,f,x,S){var $=f!==null?f.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return $!==null?null:i(u,f,""+x,S);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Cs:return x.key===$?c(u,f,x,S):null;case nr:return x.key===$?h(u,f,x,S):null;case gn:return $=x._init,p(u,f,$(x._payload),S)}if(Gr(x)||Rr(x))return $!==null?null:d(u,f,x,S,null);Os(u,x)}return null}function b(u,f,x,S,$){if(typeof S=="string"&&S!==""||typeof S=="number")return u=u.get(x)||null,i(f,u,""+S,$);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Cs:return u=u.get(S.key===null?x:S.key)||null,c(f,u,S,$);case nr:return u=u.get(S.key===null?x:S.key)||null,h(f,u,S,$);case gn:var M=S._init;return b(u,f,x,M(S._payload),$)}if(Gr(S)||Rr(S))return u=u.get(x)||null,d(f,u,S,$,null);Os(f,S)}return null}function w(u,f,x,S){for(var $=null,M=null,A=f,k=f=0,F=null;A!==null&&k<x.length;k++){A.index>k?(F=A,A=null):F=A.sibling;var E=p(u,A,x[k],S);if(E===null){A===null&&(A=F);break}e&&A&&E.alternate===null&&t(u,A),f=l(E,f,k),M===null?$=E:M.sibling=E,M=E,A=F}if(k===x.length)return n(u,A),Be&&An(u,k),$;if(A===null){for(;k<x.length;k++)A=g(u,x[k],S),A!==null&&(f=l(A,f,k),M===null?$=A:M.sibling=A,M=A);return Be&&An(u,k),$}for(A=s(u,A);k<x.length;k++)F=b(A,u,k,x[k],S),F!==null&&(e&&F.alternate!==null&&A.delete(F.key===null?k:F.key),f=l(F,f,k),M===null?$=F:M.sibling=F,M=F);return e&&A.forEach(function(q){return t(u,q)}),Be&&An(u,k),$}function D(u,f,x,S){var $=Rr(x);if(typeof $!="function")throw Error(se(150));if(x=$.call(x),x==null)throw Error(se(151));for(var M=$=null,A=f,k=f=0,F=null,E=x.next();A!==null&&!E.done;k++,E=x.next()){A.index>k?(F=A,A=null):F=A.sibling;var q=p(u,A,E.value,S);if(q===null){A===null&&(A=F);break}e&&A&&q.alternate===null&&t(u,A),f=l(q,f,k),M===null?$=q:M.sibling=q,M=q,A=F}if(E.done)return n(u,A),Be&&An(u,k),$;if(A===null){for(;!E.done;k++,E=x.next())E=g(u,E.value,S),E!==null&&(f=l(E,f,k),M===null?$=E:M.sibling=E,M=E);return Be&&An(u,k),$}for(A=s(u,A);!E.done;k++,E=x.next())E=b(A,u,k,E.value,S),E!==null&&(e&&E.alternate!==null&&A.delete(E.key===null?k:E.key),f=l(E,f,k),M===null?$=E:M.sibling=E,M=E);return e&&A.forEach(function(V){return t(u,V)}),Be&&An(u,k),$}function N(u,f,x,S){if(typeof x=="object"&&x!==null&&x.type===rr&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Cs:e:{for(var $=x.key,M=f;M!==null;){if(M.key===$){if($=x.type,$===rr){if(M.tag===7){n(u,M.sibling),f=o(M,x.props.children),f.return=u,u=f;break e}}else if(M.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===gn&&Wi($)===M.type){n(u,M.sibling),f=o(M,x.props),f.ref=Lr(u,M,x),f.return=u,u=f;break e}n(u,M);break}else t(u,M);M=M.sibling}x.type===rr?(f=zn(x.props.children,u.mode,S,x.key),f.return=u,u=f):(S=Zs(x.type,x.key,x.props,null,u.mode,S),S.ref=Lr(u,f,x),S.return=u,u=S)}return a(u);case nr:e:{for(M=x.key;f!==null;){if(f.key===M)if(f.tag===4&&f.stateNode.containerInfo===x.containerInfo&&f.stateNode.implementation===x.implementation){n(u,f.sibling),f=o(f,x.children||[]),f.return=u,u=f;break e}else{n(u,f);break}else t(u,f);f=f.sibling}f=xl(x,u.mode,S),f.return=u,u=f}return a(u);case gn:return M=x._init,N(u,f,M(x._payload),S)}if(Gr(x))return w(u,f,x,S);if(Rr(x))return D(u,f,x,S);Os(u,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,f!==null&&f.tag===6?(n(u,f.sibling),f=o(f,x),f.return=u,u=f):(n(u,f),f=gl(x,u.mode,S),f.return=u,u=f),a(u)):n(u,f)}return N}var jr=Tu(!0),Au=Tu(!1),go=Rn(null),xo=null,dr=null,Aa=null;function Oa(){Aa=dr=xo=null}function $a(e){var t=go.current;Ue(go),e._currentValue=t}function Yl(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function yr(e,t){xo=e,Aa=dr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(yt=!0),e.firstContext=null)}function Ot(e){var t=e._currentValue;if(Aa!==e)if(e={context:e,memoizedValue:t,next:null},dr===null){if(xo===null)throw Error(se(308));dr=e,xo.dependencies={lanes:0,firstContext:e}}else dr=dr.next=e;return t}var Ln=null;function La(e){Ln===null?Ln=[e]:Ln.push(e)}function Ou(e,t,n,s){var o=t.interleaved;return o===null?(n.next=n,La(t)):(n.next=o.next,o.next=n),t.interleaved=n,dn(e,s)}function dn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var xn=!1;function Ua(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $u(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function an(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function kn(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Te&2){var o=s.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),s.pending=t,dn(e,n)}return o=s.interleaved,o===null?(t.next=t,La(s)):(t.next=o.next,o.next=t),s.interleaved=t,dn(e,n)}function qs(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Sa(e,n)}}function qi(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var o=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?o=l=a:l=l.next=a,n=n.next}while(n!==null);l===null?o=l=t:l=l.next=t}else o=l=t;n={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:l,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function yo(e,t,n,s){var o=e.updateQueue;xn=!1;var l=o.firstBaseUpdate,a=o.lastBaseUpdate,i=o.shared.pending;if(i!==null){o.shared.pending=null;var c=i,h=c.next;c.next=null,a===null?l=h:a.next=h,a=c;var d=e.alternate;d!==null&&(d=d.updateQueue,i=d.lastBaseUpdate,i!==a&&(i===null?d.firstBaseUpdate=h:i.next=h,d.lastBaseUpdate=c))}if(l!==null){var g=o.baseState;a=0,d=h=c=null,i=l;do{var p=i.lane,b=i.eventTime;if((s&p)===p){d!==null&&(d=d.next={eventTime:b,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var w=e,D=i;switch(p=t,b=n,D.tag){case 1:if(w=D.payload,typeof w=="function"){g=w.call(b,g,p);break e}g=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=D.payload,p=typeof w=="function"?w.call(b,g,p):w,p==null)break e;g=He({},g,p);break e;case 2:xn=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,p=o.effects,p===null?o.effects=[i]:p.push(i))}else b={eventTime:b,lane:p,tag:i.tag,payload:i.payload,callback:i.callback,next:null},d===null?(h=d=b,c=g):d=d.next=b,a|=p;if(i=i.next,i===null){if(i=o.shared.pending,i===null)break;p=i,i=p.next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}while(!0);if(d===null&&(c=g),o.baseState=c,o.firstBaseUpdate=h,o.lastBaseUpdate=d,t=o.shared.interleaved,t!==null){o=t;do a|=o.lane,o=o.next;while(o!==t)}else l===null&&(o.shared.lanes=0);Vn|=a,e.lanes=a,e.memoizedState=g}}function Yi(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],o=s.callback;if(o!==null){if(s.callback=null,s=n,typeof o!="function")throw Error(se(191,o));o.call(s)}}}var bs={},Zt=Rn(bs),ds=Rn(bs),fs=Rn(bs);function Un(e){if(e===bs)throw Error(se(174));return e}function Ba(e,t){switch($e(fs,t),$e(ds,e),$e(Zt,bs),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:_l(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=_l(t,e)}Ue(Zt),$e(Zt,t)}function Sr(){Ue(Zt),Ue(ds),Ue(fs)}function Lu(e){Un(fs.current);var t=Un(Zt.current),n=_l(t,e.type);t!==n&&($e(ds,e),$e(Zt,n))}function za(e){ds.current===e&&(Ue(Zt),Ue(ds))}var Ge=Rn(0);function vo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ul=[];function Ga(){for(var e=0;e<ul.length;e++)ul[e]._workInProgressVersionPrimary=null;ul.length=0}var Ys=pn.ReactCurrentDispatcher,dl=pn.ReactCurrentBatchConfig,Hn=0,Fe=null,Je=null,et=null,wo=!1,Qr=!1,ps=0,nm=0;function lt(){throw Error(se(321))}function Fa(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Wt(e[n],t[n]))return!1;return!0}function Ha(e,t,n,s,o,l){if(Hn=l,Fe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ys.current=e===null||e.memoizedState===null?lm:am,e=n(s,o),Qr){l=0;do{if(Qr=!1,ps=0,25<=l)throw Error(se(301));l+=1,et=Je=null,t.updateQueue=null,Ys.current=im,e=n(s,o)}while(Qr)}if(Ys.current=bo,t=Je!==null&&Je.next!==null,Hn=0,et=Je=Fe=null,wo=!1,t)throw Error(se(300));return e}function Va(){var e=ps!==0;return ps=0,e}function Qt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return et===null?Fe.memoizedState=et=e:et=et.next=e,et}function $t(){if(Je===null){var e=Fe.alternate;e=e!==null?e.memoizedState:null}else e=Je.next;var t=et===null?Fe.memoizedState:et.next;if(t!==null)et=t,Je=e;else{if(e===null)throw Error(se(310));Je=e,e={memoizedState:Je.memoizedState,baseState:Je.baseState,baseQueue:Je.baseQueue,queue:Je.queue,next:null},et===null?Fe.memoizedState=et=e:et=et.next=e}return et}function ms(e,t){return typeof t=="function"?t(e):t}function fl(e){var t=$t(),n=t.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=e;var s=Je,o=s.baseQueue,l=n.pending;if(l!==null){if(o!==null){var a=o.next;o.next=l.next,l.next=a}s.baseQueue=o=l,n.pending=null}if(o!==null){l=o.next,s=s.baseState;var i=a=null,c=null,h=l;do{var d=h.lane;if((Hn&d)===d)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),s=h.hasEagerState?h.eagerState:e(s,h.action);else{var g={lane:d,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(i=c=g,a=s):c=c.next=g,Fe.lanes|=d,Vn|=d}h=h.next}while(h!==null&&h!==l);c===null?a=s:c.next=i,Wt(s,t.memoizedState)||(yt=!0),t.memoizedState=s,t.baseState=a,t.baseQueue=c,n.lastRenderedState=s}if(e=n.interleaved,e!==null){o=e;do l=o.lane,Fe.lanes|=l,Vn|=l,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function pl(e){var t=$t(),n=t.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=e;var s=n.dispatch,o=n.pending,l=t.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do l=e(l,a.action),a=a.next;while(a!==o);Wt(l,t.memoizedState)||(yt=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,s]}function Uu(){}function Bu(e,t){var n=Fe,s=$t(),o=t(),l=!Wt(s.memoizedState,o);if(l&&(s.memoizedState=o,yt=!0),s=s.queue,Wa(Fu.bind(null,n,s,e),[e]),s.getSnapshot!==t||l||et!==null&&et.memoizedState.tag&1){if(n.flags|=2048,hs(9,Gu.bind(null,n,s,o,t),void 0,null),tt===null)throw Error(se(349));Hn&30||zu(n,t,o)}return o}function zu(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Gu(e,t,n,s){t.value=n,t.getSnapshot=s,Hu(t)&&Vu(e)}function Fu(e,t,n){return n(function(){Hu(t)&&Vu(e)})}function Hu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Wt(e,n)}catch{return!0}}function Vu(e){var t=dn(e,1);t!==null&&Vt(t,e,1,-1)}function Xi(e){var t=Qt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ms,lastRenderedState:e},t.queue=e,e=e.dispatch=om.bind(null,Fe,e),[t.memoizedState,e]}function hs(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function Wu(){return $t().memoizedState}function Xs(e,t,n,s){var o=Qt();Fe.flags|=e,o.memoizedState=hs(1|t,n,void 0,s===void 0?null:s)}function To(e,t,n,s){var o=$t();s=s===void 0?null:s;var l=void 0;if(Je!==null){var a=Je.memoizedState;if(l=a.destroy,s!==null&&Fa(s,a.deps)){o.memoizedState=hs(t,n,l,s);return}}Fe.flags|=e,o.memoizedState=hs(1|t,n,l,s)}function Qi(e,t){return Xs(8390656,8,e,t)}function Wa(e,t){return To(2048,8,e,t)}function qu(e,t){return To(4,2,e,t)}function Yu(e,t){return To(4,4,e,t)}function Xu(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Qu(e,t,n){return n=n!=null?n.concat([e]):null,To(4,4,Xu.bind(null,t,e),n)}function qa(){}function Ku(e,t){var n=$t();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&Fa(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Ju(e,t){var n=$t();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&Fa(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function Zu(e,t,n){return Hn&21?(Wt(n,t)||(n=su(),Fe.lanes|=n,Vn|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,yt=!0),e.memoizedState=n)}function rm(e,t){var n=Ae;Ae=n!==0&&4>n?n:4,e(!0);var s=dl.transition;dl.transition={};try{e(!1),t()}finally{Ae=n,dl.transition=s}}function ed(){return $t().memoizedState}function sm(e,t,n){var s=_n(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},td(e))nd(t,n);else if(n=Ou(e,t,n,s),n!==null){var o=dt();Vt(n,e,s,o),rd(n,t,s)}}function om(e,t,n){var s=_n(e),o={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(td(e))nd(t,o);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var a=t.lastRenderedState,i=l(a,n);if(o.hasEagerState=!0,o.eagerState=i,Wt(i,a)){var c=t.interleaved;c===null?(o.next=o,La(t)):(o.next=c.next,c.next=o),t.interleaved=o;return}}catch{}finally{}n=Ou(e,t,o,s),n!==null&&(o=dt(),Vt(n,e,s,o),rd(n,t,s))}}function td(e){var t=e.alternate;return e===Fe||t!==null&&t===Fe}function nd(e,t){Qr=wo=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function rd(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Sa(e,n)}}var bo={readContext:Ot,useCallback:lt,useContext:lt,useEffect:lt,useImperativeHandle:lt,useInsertionEffect:lt,useLayoutEffect:lt,useMemo:lt,useReducer:lt,useRef:lt,useState:lt,useDebugValue:lt,useDeferredValue:lt,useTransition:lt,useMutableSource:lt,useSyncExternalStore:lt,useId:lt,unstable_isNewReconciler:!1},lm={readContext:Ot,useCallback:function(e,t){return Qt().memoizedState=[e,t===void 0?null:t],e},useContext:Ot,useEffect:Qi,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Xs(4194308,4,Xu.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Xs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Xs(4,2,e,t)},useMemo:function(e,t){var n=Qt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=Qt();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=sm.bind(null,Fe,e),[s.memoizedState,e]},useRef:function(e){var t=Qt();return e={current:e},t.memoizedState=e},useState:Xi,useDebugValue:qa,useDeferredValue:function(e){return Qt().memoizedState=e},useTransition:function(){var e=Xi(!1),t=e[0];return e=rm.bind(null,e[1]),Qt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=Fe,o=Qt();if(Be){if(n===void 0)throw Error(se(407));n=n()}else{if(n=t(),tt===null)throw Error(se(349));Hn&30||zu(s,t,n)}o.memoizedState=n;var l={value:n,getSnapshot:t};return o.queue=l,Qi(Fu.bind(null,s,l,e),[e]),s.flags|=2048,hs(9,Gu.bind(null,s,l,n,t),void 0,null),n},useId:function(){var e=Qt(),t=tt.identifierPrefix;if(Be){var n=ln,s=on;n=(s&~(1<<32-Ht(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=ps++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=nm++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},am={readContext:Ot,useCallback:Ku,useContext:Ot,useEffect:Wa,useImperativeHandle:Qu,useInsertionEffect:qu,useLayoutEffect:Yu,useMemo:Ju,useReducer:fl,useRef:Wu,useState:function(){return fl(ms)},useDebugValue:qa,useDeferredValue:function(e){var t=$t();return Zu(t,Je.memoizedState,e)},useTransition:function(){var e=fl(ms)[0],t=$t().memoizedState;return[e,t]},useMutableSource:Uu,useSyncExternalStore:Bu,useId:ed,unstable_isNewReconciler:!1},im={readContext:Ot,useCallback:Ku,useContext:Ot,useEffect:Wa,useImperativeHandle:Qu,useInsertionEffect:qu,useLayoutEffect:Yu,useMemo:Ju,useReducer:pl,useRef:Wu,useState:function(){return pl(ms)},useDebugValue:qa,useDeferredValue:function(e){var t=$t();return Je===null?t.memoizedState=e:Zu(t,Je.memoizedState,e)},useTransition:function(){var e=pl(ms)[0],t=$t().memoizedState;return[e,t]},useMutableSource:Uu,useSyncExternalStore:Bu,useId:ed,unstable_isNewReconciler:!1};function zt(e,t){if(e&&e.defaultProps){t=He({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Xl(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:He({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ao={isMounted:function(e){return(e=e._reactInternals)?Yn(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=dt(),o=_n(e),l=an(s,o);l.payload=t,n!=null&&(l.callback=n),t=kn(e,l,o),t!==null&&(Vt(t,e,o,s),qs(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=dt(),o=_n(e),l=an(s,o);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=kn(e,l,o),t!==null&&(Vt(t,e,o,s),qs(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=dt(),s=_n(e),o=an(n,s);o.tag=2,t!=null&&(o.callback=t),t=kn(e,o,s),t!==null&&(Vt(t,e,s,n),qs(t,e,s))}};function Ki(e,t,n,s,o,l,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,l,a):t.prototype&&t.prototype.isPureReactComponent?!as(n,s)||!as(o,l):!0}function sd(e,t,n){var s=!1,o=In,l=t.contextType;return typeof l=="object"&&l!==null?l=Ot(l):(o=bt(t)?Gn:ct.current,s=t.contextTypes,l=(s=s!=null)?br(e,o):In),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ao,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=l),t}function Ji(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Ao.enqueueReplaceState(t,t.state,null)}function Ql(e,t,n,s){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Ua(e);var l=t.contextType;typeof l=="object"&&l!==null?o.context=Ot(l):(l=bt(t)?Gn:ct.current,o.context=br(e,l)),o.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(Xl(e,t,l,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Ao.enqueueReplaceState(o,o.state,null),yo(e,n,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Cr(e,t){try{var n="",s=t;do n+=Of(s),s=s.return;while(s);var o=n}catch(l){o=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:o,digest:null}}function ml(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Kl(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var cm=typeof WeakMap=="function"?WeakMap:Map;function od(e,t,n){n=an(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){jo||(jo=!0,aa=s),Kl(e,t)},n}function ld(e,t,n){n=an(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=t.value;n.payload=function(){return s(o)},n.callback=function(){Kl(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){Kl(e,t),typeof s!="function"&&(Dn===null?Dn=new Set([this]):Dn.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Zi(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new cm;var o=new Set;s.set(t,o)}else o=s.get(t),o===void 0&&(o=new Set,s.set(t,o));o.has(n)||(o.add(n),e=jm.bind(null,e,t,n),t.then(e,e))}function ec(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function tc(e,t,n,s,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=an(-1,1),t.tag=2,kn(n,t,1))),n.lanes|=1),e)}var um=pn.ReactCurrentOwner,yt=!1;function ut(e,t,n,s){t.child=e===null?Au(t,null,n,s):jr(t,e.child,n,s)}function nc(e,t,n,s,o){n=n.render;var l=t.ref;return yr(t,o),s=Ha(e,t,n,s,l,o),n=Va(),e!==null&&!yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,fn(e,t,o)):(Be&&n&&Pa(t),t.flags|=1,ut(e,t,s,o),t.child)}function rc(e,t,n,s,o){if(e===null){var l=n.type;return typeof l=="function"&&!ti(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,ad(e,t,l,s,o)):(e=Zs(n.type,null,s,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&o)){var a=l.memoizedProps;if(n=n.compare,n=n!==null?n:as,n(a,s)&&e.ref===t.ref)return fn(e,t,o)}return t.flags|=1,e=Mn(l,s),e.ref=t.ref,e.return=t,t.child=e}function ad(e,t,n,s,o){if(e!==null){var l=e.memoizedProps;if(as(l,s)&&e.ref===t.ref)if(yt=!1,t.pendingProps=s=l,(e.lanes&o)!==0)e.flags&131072&&(yt=!0);else return t.lanes=e.lanes,fn(e,t,o)}return Jl(e,t,n,s,o)}function id(e,t,n){var s=t.pendingProps,o=s.children,l=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},$e(pr,jt),jt|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,$e(pr,jt),jt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=l!==null?l.baseLanes:n,$e(pr,jt),jt|=s}else l!==null?(s=l.baseLanes|n,t.memoizedState=null):s=n,$e(pr,jt),jt|=s;return ut(e,t,o,n),t.child}function cd(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Jl(e,t,n,s,o){var l=bt(n)?Gn:ct.current;return l=br(t,l),yr(t,o),n=Ha(e,t,n,s,l,o),s=Va(),e!==null&&!yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,fn(e,t,o)):(Be&&s&&Pa(t),t.flags|=1,ut(e,t,n,o),t.child)}function sc(e,t,n,s,o){if(bt(n)){var l=!0;po(t)}else l=!1;if(yr(t,o),t.stateNode===null)Qs(e,t),sd(t,n,s),Ql(t,n,s,o),s=!0;else if(e===null){var a=t.stateNode,i=t.memoizedProps;a.props=i;var c=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=Ot(h):(h=bt(n)?Gn:ct.current,h=br(t,h));var d=n.getDerivedStateFromProps,g=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";g||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(i!==s||c!==h)&&Ji(t,a,s,h),xn=!1;var p=t.memoizedState;a.state=p,yo(t,s,a,o),c=t.memoizedState,i!==s||p!==c||wt.current||xn?(typeof d=="function"&&(Xl(t,n,d,s),c=t.memoizedState),(i=xn||Ki(t,n,i,s,p,c,h))?(g||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),a.props=s,a.state=c,a.context=h,s=i):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{a=t.stateNode,$u(e,t),i=t.memoizedProps,h=t.type===t.elementType?i:zt(t.type,i),a.props=h,g=t.pendingProps,p=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=Ot(c):(c=bt(n)?Gn:ct.current,c=br(t,c));var b=n.getDerivedStateFromProps;(d=typeof b=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(i!==g||p!==c)&&Ji(t,a,s,c),xn=!1,p=t.memoizedState,a.state=p,yo(t,s,a,o);var w=t.memoizedState;i!==g||p!==w||wt.current||xn?(typeof b=="function"&&(Xl(t,n,b,s),w=t.memoizedState),(h=xn||Ki(t,n,h,s,p,w,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,w,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,w,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=w),a.props=s,a.state=w,a.context=c,s=h):(typeof a.componentDidUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),s=!1)}return Zl(e,t,n,s,l,o)}function Zl(e,t,n,s,o,l){cd(e,t);var a=(t.flags&128)!==0;if(!s&&!a)return o&&Fi(t,n,!1),fn(e,t,l);s=t.stateNode,um.current=t;var i=a&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&a?(t.child=jr(t,e.child,null,l),t.child=jr(t,null,i,l)):ut(e,t,i,l),t.memoizedState=s.state,o&&Fi(t,n,!0),t.child}function ud(e){var t=e.stateNode;t.pendingContext?Gi(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Gi(e,t.context,!1),Ba(e,t.containerInfo)}function oc(e,t,n,s,o){return Nr(),Ta(o),t.flags|=256,ut(e,t,n,s),t.child}var ea={dehydrated:null,treeContext:null,retryLane:0};function ta(e){return{baseLanes:e,cachePool:null,transitions:null}}function dd(e,t,n){var s=t.pendingProps,o=Ge.current,l=!1,a=(t.flags&128)!==0,i;if((i=a)||(i=e!==null&&e.memoizedState===null?!1:(o&2)!==0),i?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),$e(Ge,o&1),e===null)return ql(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=s.children,e=s.fallback,l?(s=t.mode,l=t.child,a={mode:"hidden",children:a},!(s&1)&&l!==null?(l.childLanes=0,l.pendingProps=a):l=Lo(a,s,0,null),e=zn(e,s,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=ta(n),t.memoizedState=ea,e):Ya(t,a));if(o=e.memoizedState,o!==null&&(i=o.dehydrated,i!==null))return dm(e,t,a,s,i,o,n);if(l){l=s.fallback,a=t.mode,o=e.child,i=o.sibling;var c={mode:"hidden",children:s.children};return!(a&1)&&t.child!==o?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=Mn(o,c),s.subtreeFlags=o.subtreeFlags&14680064),i!==null?l=Mn(i,l):(l=zn(l,a,n,null),l.flags|=2),l.return=t,s.return=t,s.sibling=l,t.child=s,s=l,l=t.child,a=e.child.memoizedState,a=a===null?ta(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},l.memoizedState=a,l.childLanes=e.childLanes&~n,t.memoizedState=ea,s}return l=e.child,e=l.sibling,s=Mn(l,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Ya(e,t){return t=Lo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function $s(e,t,n,s){return s!==null&&Ta(s),jr(t,e.child,null,n),e=Ya(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function dm(e,t,n,s,o,l,a){if(n)return t.flags&256?(t.flags&=-257,s=ml(Error(se(422))),$s(e,t,a,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=s.fallback,o=t.mode,s=Lo({mode:"visible",children:s.children},o,0,null),l=zn(l,o,a,null),l.flags|=2,s.return=t,l.return=t,s.sibling=l,t.child=s,t.mode&1&&jr(t,e.child,null,a),t.child.memoizedState=ta(a),t.memoizedState=ea,l);if(!(t.mode&1))return $s(e,t,a,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var i=s.dgst;return s=i,l=Error(se(419)),s=ml(l,s,void 0),$s(e,t,a,s)}if(i=(a&e.childLanes)!==0,yt||i){if(s=tt,s!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|a)?0:o,o!==0&&o!==l.retryLane&&(l.retryLane=o,dn(e,o),Vt(s,e,o,-1))}return ei(),s=ml(Error(se(421))),$s(e,t,a,s)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Sm.bind(null,e),o._reactRetry=t,null):(e=l.treeContext,St=Cn(o.nextSibling),Ct=t,Be=!0,Ft=null,e!==null&&(It[Pt++]=on,It[Pt++]=ln,It[Pt++]=Fn,on=e.id,ln=e.overflow,Fn=t),t=Ya(t,s.children),t.flags|=4096,t)}function lc(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Yl(e.return,t,n)}function hl(e,t,n,s,o){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:o}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=s,l.tail=n,l.tailMode=o)}function fd(e,t,n){var s=t.pendingProps,o=s.revealOrder,l=s.tail;if(ut(e,t,s.children,n),s=Ge.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&lc(e,n,t);else if(e.tag===19)lc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if($e(Ge,s),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&vo(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),hl(t,!1,o,n,l);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&vo(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}hl(t,!0,n,null,l);break;case"together":hl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Qs(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Vn|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(se(153));if(t.child!==null){for(e=t.child,n=Mn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Mn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function fm(e,t,n){switch(t.tag){case 3:ud(t),Nr();break;case 5:Lu(t);break;case 1:bt(t.type)&&po(t);break;case 4:Ba(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,o=t.memoizedProps.value;$e(go,s._currentValue),s._currentValue=o;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?($e(Ge,Ge.current&1),t.flags|=128,null):n&t.child.childLanes?dd(e,t,n):($e(Ge,Ge.current&1),e=fn(e,t,n),e!==null?e.sibling:null);$e(Ge,Ge.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return fd(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),$e(Ge,Ge.current),s)break;return null;case 22:case 23:return t.lanes=0,id(e,t,n)}return fn(e,t,n)}var pd,na,md,hd;pd=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};na=function(){};md=function(e,t,n,s){var o=e.memoizedProps;if(o!==s){e=t.stateNode,Un(Zt.current);var l=null;switch(n){case"input":o=Sl(e,o),s=Sl(e,s),l=[];break;case"select":o=He({},o,{value:void 0}),s=He({},s,{value:void 0}),l=[];break;case"textarea":o=Dl(e,o),s=Dl(e,s),l=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=uo)}Ml(n,s);var a;n=null;for(h in o)if(!s.hasOwnProperty(h)&&o.hasOwnProperty(h)&&o[h]!=null)if(h==="style"){var i=o[h];for(a in i)i.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(es.hasOwnProperty(h)?l||(l=[]):(l=l||[]).push(h,null));for(h in s){var c=s[h];if(i=o!=null?o[h]:void 0,s.hasOwnProperty(h)&&c!==i&&(c!=null||i!=null))if(h==="style")if(i){for(a in i)!i.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&i[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(l||(l=[]),l.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,i=i?i.__html:void 0,c!=null&&i!==c&&(l=l||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(l=l||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(es.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Le("scroll",e),l||i===c||(l=[])):(l=l||[]).push(h,c))}n&&(l=l||[]).push("style",n);var h=l;(t.updateQueue=h)&&(t.flags|=4)}};hd=function(e,t,n,s){n!==s&&(t.flags|=4)};function Ur(e,t){if(!Be)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function at(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function pm(e,t,n){var s=t.pendingProps;switch(Ra(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return at(t),null;case 1:return bt(t.type)&&fo(),at(t),null;case 3:return s=t.stateNode,Sr(),Ue(wt),Ue(ct),Ga(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(As(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ft!==null&&(ua(Ft),Ft=null))),na(e,t),at(t),null;case 5:za(t);var o=Un(fs.current);if(n=t.type,e!==null&&t.stateNode!=null)md(e,t,n,s,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(se(166));return at(t),null}if(e=Un(Zt.current),As(t)){s=t.stateNode,n=t.type;var l=t.memoizedProps;switch(s[Kt]=t,s[us]=l,e=(t.mode&1)!==0,n){case"dialog":Le("cancel",s),Le("close",s);break;case"iframe":case"object":case"embed":Le("load",s);break;case"video":case"audio":for(o=0;o<Hr.length;o++)Le(Hr[o],s);break;case"source":Le("error",s);break;case"img":case"image":case"link":Le("error",s),Le("load",s);break;case"details":Le("toggle",s);break;case"input":hi(s,l),Le("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!l.multiple},Le("invalid",s);break;case"textarea":xi(s,l),Le("invalid",s)}Ml(n,l),o=null;for(var a in l)if(l.hasOwnProperty(a)){var i=l[a];a==="children"?typeof i=="string"?s.textContent!==i&&(l.suppressHydrationWarning!==!0&&Ts(s.textContent,i,e),o=["children",i]):typeof i=="number"&&s.textContent!==""+i&&(l.suppressHydrationWarning!==!0&&Ts(s.textContent,i,e),o=["children",""+i]):es.hasOwnProperty(a)&&i!=null&&a==="onScroll"&&Le("scroll",s)}switch(n){case"input":ks(s),gi(s,l,!0);break;case"textarea":ks(s),yi(s);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(s.onclick=uo)}s=o,t.updateQueue=s,s!==null&&(t.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Fc(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=a.createElement(n,{is:s.is}):(e=a.createElement(n),n==="select"&&(a=e,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):e=a.createElementNS(e,n),e[Kt]=t,e[us]=s,pd(e,t,!1,!1),t.stateNode=e;e:{switch(a=El(n,s),n){case"dialog":Le("cancel",e),Le("close",e),o=s;break;case"iframe":case"object":case"embed":Le("load",e),o=s;break;case"video":case"audio":for(o=0;o<Hr.length;o++)Le(Hr[o],e);o=s;break;case"source":Le("error",e),o=s;break;case"img":case"image":case"link":Le("error",e),Le("load",e),o=s;break;case"details":Le("toggle",e),o=s;break;case"input":hi(e,s),o=Sl(e,s),Le("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=He({},s,{value:void 0}),Le("invalid",e);break;case"textarea":xi(e,s),o=Dl(e,s),Le("invalid",e);break;default:o=s}Ml(n,o),i=o;for(l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="style"?Wc(e,c):l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Hc(e,c)):l==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ts(e,c):typeof c=="number"&&ts(e,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(es.hasOwnProperty(l)?c!=null&&l==="onScroll"&&Le("scroll",e):c!=null&&ya(e,l,c,a))}switch(n){case"input":ks(e),gi(e,s,!1);break;case"textarea":ks(e),yi(e);break;case"option":s.value!=null&&e.setAttribute("value",""+En(s.value));break;case"select":e.multiple=!!s.multiple,l=s.value,l!=null?mr(e,!!s.multiple,l,!1):s.defaultValue!=null&&mr(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=uo)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return at(t),null;case 6:if(e&&t.stateNode!=null)hd(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(se(166));if(n=Un(fs.current),Un(Zt.current),As(t)){if(s=t.stateNode,n=t.memoizedProps,s[Kt]=t,(l=s.nodeValue!==n)&&(e=Ct,e!==null))switch(e.tag){case 3:Ts(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ts(s.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Kt]=t,t.stateNode=s}return at(t),null;case 13:if(Ue(Ge),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Be&&St!==null&&t.mode&1&&!(t.flags&128))Ru(),Nr(),t.flags|=98560,l=!1;else if(l=As(t),s!==null&&s.dehydrated!==null){if(e===null){if(!l)throw Error(se(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(se(317));l[Kt]=t}else Nr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;at(t),l=!1}else Ft!==null&&(ua(Ft),Ft=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||Ge.current&1?Ze===0&&(Ze=3):ei())),t.updateQueue!==null&&(t.flags|=4),at(t),null);case 4:return Sr(),na(e,t),e===null&&is(t.stateNode.containerInfo),at(t),null;case 10:return $a(t.type._context),at(t),null;case 17:return bt(t.type)&&fo(),at(t),null;case 19:if(Ue(Ge),l=t.memoizedState,l===null)return at(t),null;if(s=(t.flags&128)!==0,a=l.rendering,a===null)if(s)Ur(l,!1);else{if(Ze!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=vo(e),a!==null){for(t.flags|=128,Ur(l,!1),s=a.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)l=n,e=s,l.flags&=14680066,a=l.alternate,a===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,l.type=a.type,e=a.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return $e(Ge,Ge.current&1|2),t.child}e=e.sibling}l.tail!==null&&Ye()>kr&&(t.flags|=128,s=!0,Ur(l,!1),t.lanes=4194304)}else{if(!s)if(e=vo(a),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ur(l,!0),l.tail===null&&l.tailMode==="hidden"&&!a.alternate&&!Be)return at(t),null}else 2*Ye()-l.renderingStartTime>kr&&n!==1073741824&&(t.flags|=128,s=!0,Ur(l,!1),t.lanes=4194304);l.isBackwards?(a.sibling=t.child,t.child=a):(n=l.last,n!==null?n.sibling=a:t.child=a,l.last=a)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Ye(),t.sibling=null,n=Ge.current,$e(Ge,s?n&1|2:n&1),t):(at(t),null);case 22:case 23:return Za(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?jt&1073741824&&(at(t),t.subtreeFlags&6&&(t.flags|=8192)):at(t),null;case 24:return null;case 25:return null}throw Error(se(156,t.tag))}function mm(e,t){switch(Ra(t),t.tag){case 1:return bt(t.type)&&fo(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Sr(),Ue(wt),Ue(ct),Ga(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return za(t),null;case 13:if(Ue(Ge),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(se(340));Nr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ue(Ge),null;case 4:return Sr(),null;case 10:return $a(t.type._context),null;case 22:case 23:return Za(),null;case 24:return null;default:return null}}var Ls=!1,it=!1,hm=typeof WeakSet=="function"?WeakSet:Set,ge=null;function fr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){We(e,t,s)}else n.current=null}function ra(e,t,n){try{n()}catch(s){We(e,t,s)}}var ac=!1;function gm(e,t){if(Bl=ao,e=wu(),Ia(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var o=s.anchorOffset,l=s.focusNode;s=s.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var a=0,i=-1,c=-1,h=0,d=0,g=e,p=null;t:for(;;){for(var b;g!==n||o!==0&&g.nodeType!==3||(i=a+o),g!==l||s!==0&&g.nodeType!==3||(c=a+s),g.nodeType===3&&(a+=g.nodeValue.length),(b=g.firstChild)!==null;)p=g,g=b;for(;;){if(g===e)break t;if(p===n&&++h===o&&(i=a),p===l&&++d===s&&(c=a),(b=g.nextSibling)!==null)break;g=p,p=g.parentNode}g=b}n=i===-1||c===-1?null:{start:i,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(zl={focusedElem:e,selectionRange:n},ao=!1,ge=t;ge!==null;)if(t=ge,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ge=e;else for(;ge!==null;){t=ge;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var D=w.memoizedProps,N=w.memoizedState,u=t.stateNode,f=u.getSnapshotBeforeUpdate(t.elementType===t.type?D:zt(t.type,D),N);u.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(S){We(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,ge=e;break}ge=t.return}return w=ac,ac=!1,w}function Kr(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var l=o.destroy;o.destroy=void 0,l!==void 0&&ra(t,n,l)}o=o.next}while(o!==s)}}function Oo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function sa(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function gd(e){var t=e.alternate;t!==null&&(e.alternate=null,gd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Kt],delete t[us],delete t[Hl],delete t[Jp],delete t[Zp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function xd(e){return e.tag===5||e.tag===3||e.tag===4}function ic(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||xd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function oa(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=uo));else if(s!==4&&(e=e.child,e!==null))for(oa(e,t,n),e=e.sibling;e!==null;)oa(e,t,n),e=e.sibling}function la(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(la(e,t,n),e=e.sibling;e!==null;)la(e,t,n),e=e.sibling}var rt=null,Gt=!1;function hn(e,t,n){for(n=n.child;n!==null;)yd(e,t,n),n=n.sibling}function yd(e,t,n){if(Jt&&typeof Jt.onCommitFiberUnmount=="function")try{Jt.onCommitFiberUnmount(_o,n)}catch{}switch(n.tag){case 5:it||fr(n,t);case 6:var s=rt,o=Gt;rt=null,hn(e,t,n),rt=s,Gt=o,rt!==null&&(Gt?(e=rt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):rt.removeChild(n.stateNode));break;case 18:rt!==null&&(Gt?(e=rt,n=n.stateNode,e.nodeType===8?il(e.parentNode,n):e.nodeType===1&&il(e,n),os(e)):il(rt,n.stateNode));break;case 4:s=rt,o=Gt,rt=n.stateNode.containerInfo,Gt=!0,hn(e,t,n),rt=s,Gt=o;break;case 0:case 11:case 14:case 15:if(!it&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var l=o,a=l.destroy;l=l.tag,a!==void 0&&(l&2||l&4)&&ra(n,t,a),o=o.next}while(o!==s)}hn(e,t,n);break;case 1:if(!it&&(fr(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(i){We(n,t,i)}hn(e,t,n);break;case 21:hn(e,t,n);break;case 22:n.mode&1?(it=(s=it)||n.memoizedState!==null,hn(e,t,n),it=s):hn(e,t,n);break;default:hn(e,t,n)}}function cc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new hm),t.forEach(function(s){var o=Cm.bind(null,e,s);n.has(s)||(n.add(s),s.then(o,o))})}}function Bt(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var o=n[s];try{var l=e,a=t,i=a;e:for(;i!==null;){switch(i.tag){case 5:rt=i.stateNode,Gt=!1;break e;case 3:rt=i.stateNode.containerInfo,Gt=!0;break e;case 4:rt=i.stateNode.containerInfo,Gt=!0;break e}i=i.return}if(rt===null)throw Error(se(160));yd(l,a,o),rt=null,Gt=!1;var c=o.alternate;c!==null&&(c.return=null),o.return=null}catch(h){We(o,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)vd(t,e),t=t.sibling}function vd(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Bt(t,e),Yt(e),s&4){try{Kr(3,e,e.return),Oo(3,e)}catch(D){We(e,e.return,D)}try{Kr(5,e,e.return)}catch(D){We(e,e.return,D)}}break;case 1:Bt(t,e),Yt(e),s&512&&n!==null&&fr(n,n.return);break;case 5:if(Bt(t,e),Yt(e),s&512&&n!==null&&fr(n,n.return),e.flags&32){var o=e.stateNode;try{ts(o,"")}catch(D){We(e,e.return,D)}}if(s&4&&(o=e.stateNode,o!=null)){var l=e.memoizedProps,a=n!==null?n.memoizedProps:l,i=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{i==="input"&&l.type==="radio"&&l.name!=null&&zc(o,l),El(i,a);var h=El(i,l);for(a=0;a<c.length;a+=2){var d=c[a],g=c[a+1];d==="style"?Wc(o,g):d==="dangerouslySetInnerHTML"?Hc(o,g):d==="children"?ts(o,g):ya(o,d,g,h)}switch(i){case"input":Cl(o,l);break;case"textarea":Gc(o,l);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!l.multiple;var b=l.value;b!=null?mr(o,!!l.multiple,b,!1):p!==!!l.multiple&&(l.defaultValue!=null?mr(o,!!l.multiple,l.defaultValue,!0):mr(o,!!l.multiple,l.multiple?[]:"",!1))}o[us]=l}catch(D){We(e,e.return,D)}}break;case 6:if(Bt(t,e),Yt(e),s&4){if(e.stateNode===null)throw Error(se(162));o=e.stateNode,l=e.memoizedProps;try{o.nodeValue=l}catch(D){We(e,e.return,D)}}break;case 3:if(Bt(t,e),Yt(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{os(t.containerInfo)}catch(D){We(e,e.return,D)}break;case 4:Bt(t,e),Yt(e);break;case 13:Bt(t,e),Yt(e),o=e.child,o.flags&8192&&(l=o.memoizedState!==null,o.stateNode.isHidden=l,!l||o.alternate!==null&&o.alternate.memoizedState!==null||(Ka=Ye())),s&4&&cc(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(it=(h=it)||d,Bt(t,e),it=h):Bt(t,e),Yt(e),s&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!d&&e.mode&1)for(ge=e,d=e.child;d!==null;){for(g=ge=d;ge!==null;){switch(p=ge,b=p.child,p.tag){case 0:case 11:case 14:case 15:Kr(4,p,p.return);break;case 1:fr(p,p.return);var w=p.stateNode;if(typeof w.componentWillUnmount=="function"){s=p,n=p.return;try{t=s,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(D){We(s,n,D)}}break;case 5:fr(p,p.return);break;case 22:if(p.memoizedState!==null){dc(g);continue}}b!==null?(b.return=p,ge=b):dc(g)}d=d.sibling}e:for(d=null,g=e;;){if(g.tag===5){if(d===null){d=g;try{o=g.stateNode,h?(l=o.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(i=g.stateNode,c=g.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,i.style.display=Vc("display",a))}catch(D){We(e,e.return,D)}}}else if(g.tag===6){if(d===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(D){We(e,e.return,D)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;d===g&&(d=null),g=g.return}d===g&&(d=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Bt(t,e),Yt(e),s&4&&cc(e);break;case 21:break;default:Bt(t,e),Yt(e)}}function Yt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(xd(n)){var s=n;break e}n=n.return}throw Error(se(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(ts(o,""),s.flags&=-33);var l=ic(e);la(e,l,o);break;case 3:case 4:var a=s.stateNode.containerInfo,i=ic(e);oa(e,i,a);break;default:throw Error(se(161))}}catch(c){We(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function xm(e,t,n){ge=e,wd(e)}function wd(e,t,n){for(var s=(e.mode&1)!==0;ge!==null;){var o=ge,l=o.child;if(o.tag===22&&s){var a=o.memoizedState!==null||Ls;if(!a){var i=o.alternate,c=i!==null&&i.memoizedState!==null||it;i=Ls;var h=it;if(Ls=a,(it=c)&&!h)for(ge=o;ge!==null;)a=ge,c=a.child,a.tag===22&&a.memoizedState!==null?fc(o):c!==null?(c.return=a,ge=c):fc(o);for(;l!==null;)ge=l,wd(l),l=l.sibling;ge=o,Ls=i,it=h}uc(e)}else o.subtreeFlags&8772&&l!==null?(l.return=o,ge=l):uc(e)}}function uc(e){for(;ge!==null;){var t=ge;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:it||Oo(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!it)if(n===null)s.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:zt(t.type,n.memoizedProps);s.componentDidUpdate(o,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&Yi(t,l,s);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Yi(t,a,n)}break;case 5:var i=t.stateNode;if(n===null&&t.flags&4){n=i;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var d=h.memoizedState;if(d!==null){var g=d.dehydrated;g!==null&&os(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}it||t.flags&512&&sa(t)}catch(p){We(t,t.return,p)}}if(t===e){ge=null;break}if(n=t.sibling,n!==null){n.return=t.return,ge=n;break}ge=t.return}}function dc(e){for(;ge!==null;){var t=ge;if(t===e){ge=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ge=n;break}ge=t.return}}function fc(e){for(;ge!==null;){var t=ge;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Oo(4,t)}catch(c){We(t,n,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var o=t.return;try{s.componentDidMount()}catch(c){We(t,o,c)}}var l=t.return;try{sa(t)}catch(c){We(t,l,c)}break;case 5:var a=t.return;try{sa(t)}catch(c){We(t,a,c)}}}catch(c){We(t,t.return,c)}if(t===e){ge=null;break}var i=t.sibling;if(i!==null){i.return=t.return,ge=i;break}ge=t.return}}var ym=Math.ceil,No=pn.ReactCurrentDispatcher,Xa=pn.ReactCurrentOwner,Tt=pn.ReactCurrentBatchConfig,Te=0,tt=null,Qe=null,st=0,jt=0,pr=Rn(0),Ze=0,gs=null,Vn=0,$o=0,Qa=0,Jr=null,xt=null,Ka=0,kr=1/0,nn=null,jo=!1,aa=null,Dn=null,Us=!1,bn=null,So=0,Zr=0,ia=null,Ks=-1,Js=0;function dt(){return Te&6?Ye():Ks!==-1?Ks:Ks=Ye()}function _n(e){return e.mode&1?Te&2&&st!==0?st&-st:tm.transition!==null?(Js===0&&(Js=su()),Js):(e=Ae,e!==0||(e=window.event,e=e===void 0?16:du(e.type)),e):1}function Vt(e,t,n,s){if(50<Zr)throw Zr=0,ia=null,Error(se(185));ys(e,n,s),(!(Te&2)||e!==tt)&&(e===tt&&(!(Te&2)&&($o|=n),Ze===4&&vn(e,st)),Nt(e,s),n===1&&Te===0&&!(t.mode&1)&&(kr=Ye()+500,Ro&&Tn()))}function Nt(e,t){var n=e.callbackNode;tp(e,t);var s=lo(e,e===tt?st:0);if(s===0)n!==null&&bi(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&bi(n),t===1)e.tag===0?em(pc.bind(null,e)):Eu(pc.bind(null,e)),Qp(function(){!(Te&6)&&Tn()}),n=null;else{switch(ou(s)){case 1:n=ja;break;case 4:n=nu;break;case 16:n=oo;break;case 536870912:n=ru;break;default:n=oo}n=_d(n,bd.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function bd(e,t){if(Ks=-1,Js=0,Te&6)throw Error(se(327));var n=e.callbackNode;if(vr()&&e.callbackNode!==n)return null;var s=lo(e,e===tt?st:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Co(e,s);else{t=s;var o=Te;Te|=2;var l=jd();(tt!==e||st!==t)&&(nn=null,kr=Ye()+500,Bn(e,t));do try{bm();break}catch(i){Nd(e,i)}while(!0);Oa(),No.current=l,Te=o,Qe!==null?t=0:(tt=null,st=0,t=Ze)}if(t!==0){if(t===2&&(o=Al(e),o!==0&&(s=o,t=ca(e,o))),t===1)throw n=gs,Bn(e,0),vn(e,s),Nt(e,Ye()),n;if(t===6)vn(e,s);else{if(o=e.current.alternate,!(s&30)&&!vm(o)&&(t=Co(e,s),t===2&&(l=Al(e),l!==0&&(s=l,t=ca(e,l))),t===1))throw n=gs,Bn(e,0),vn(e,s),Nt(e,Ye()),n;switch(e.finishedWork=o,e.finishedLanes=s,t){case 0:case 1:throw Error(se(345));case 2:On(e,xt,nn);break;case 3:if(vn(e,s),(s&130023424)===s&&(t=Ka+500-Ye(),10<t)){if(lo(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){dt(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Fl(On.bind(null,e,xt,nn),t);break}On(e,xt,nn);break;case 4:if(vn(e,s),(s&4194240)===s)break;for(t=e.eventTimes,o=-1;0<s;){var a=31-Ht(s);l=1<<a,a=t[a],a>o&&(o=a),s&=~l}if(s=o,s=Ye()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*ym(s/1960))-s,10<s){e.timeoutHandle=Fl(On.bind(null,e,xt,nn),s);break}On(e,xt,nn);break;case 5:On(e,xt,nn);break;default:throw Error(se(329))}}}return Nt(e,Ye()),e.callbackNode===n?bd.bind(null,e):null}function ca(e,t){var n=Jr;return e.current.memoizedState.isDehydrated&&(Bn(e,t).flags|=256),e=Co(e,t),e!==2&&(t=xt,xt=n,t!==null&&ua(t)),e}function ua(e){xt===null?xt=e:xt.push.apply(xt,e)}function vm(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var o=n[s],l=o.getSnapshot;o=o.value;try{if(!Wt(l(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function vn(e,t){for(t&=~Qa,t&=~$o,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ht(t),s=1<<n;e[n]=-1,t&=~s}}function pc(e){if(Te&6)throw Error(se(327));vr();var t=lo(e,0);if(!(t&1))return Nt(e,Ye()),null;var n=Co(e,t);if(e.tag!==0&&n===2){var s=Al(e);s!==0&&(t=s,n=ca(e,s))}if(n===1)throw n=gs,Bn(e,0),vn(e,t),Nt(e,Ye()),n;if(n===6)throw Error(se(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,On(e,xt,nn),Nt(e,Ye()),null}function Ja(e,t){var n=Te;Te|=1;try{return e(t)}finally{Te=n,Te===0&&(kr=Ye()+500,Ro&&Tn())}}function Wn(e){bn!==null&&bn.tag===0&&!(Te&6)&&vr();var t=Te;Te|=1;var n=Tt.transition,s=Ae;try{if(Tt.transition=null,Ae=1,e)return e()}finally{Ae=s,Tt.transition=n,Te=t,!(Te&6)&&Tn()}}function Za(){jt=pr.current,Ue(pr)}function Bn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Xp(n)),Qe!==null)for(n=Qe.return;n!==null;){var s=n;switch(Ra(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&fo();break;case 3:Sr(),Ue(wt),Ue(ct),Ga();break;case 5:za(s);break;case 4:Sr();break;case 13:Ue(Ge);break;case 19:Ue(Ge);break;case 10:$a(s.type._context);break;case 22:case 23:Za()}n=n.return}if(tt=e,Qe=e=Mn(e.current,null),st=jt=t,Ze=0,gs=null,Qa=$o=Vn=0,xt=Jr=null,Ln!==null){for(t=0;t<Ln.length;t++)if(n=Ln[t],s=n.interleaved,s!==null){n.interleaved=null;var o=s.next,l=n.pending;if(l!==null){var a=l.next;l.next=o,s.next=a}n.pending=s}Ln=null}return e}function Nd(e,t){do{var n=Qe;try{if(Oa(),Ys.current=bo,wo){for(var s=Fe.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}wo=!1}if(Hn=0,et=Je=Fe=null,Qr=!1,ps=0,Xa.current=null,n===null||n.return===null){Ze=1,gs=t,Qe=null;break}e:{var l=e,a=n.return,i=n,c=t;if(t=st,i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,d=i,g=d.tag;if(!(d.mode&1)&&(g===0||g===11||g===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var b=ec(a);if(b!==null){b.flags&=-257,tc(b,a,i,l,t),b.mode&1&&Zi(l,h,t),t=b,c=h;var w=t.updateQueue;if(w===null){var D=new Set;D.add(c),t.updateQueue=D}else w.add(c);break e}else{if(!(t&1)){Zi(l,h,t),ei();break e}c=Error(se(426))}}else if(Be&&i.mode&1){var N=ec(a);if(N!==null){!(N.flags&65536)&&(N.flags|=256),tc(N,a,i,l,t),Ta(Cr(c,i));break e}}l=c=Cr(c,i),Ze!==4&&(Ze=2),Jr===null?Jr=[l]:Jr.push(l),l=a;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var u=od(l,c,t);qi(l,u);break e;case 1:i=c;var f=l.type,x=l.stateNode;if(!(l.flags&128)&&(typeof f.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Dn===null||!Dn.has(x)))){l.flags|=65536,t&=-t,l.lanes|=t;var S=ld(l,i,t);qi(l,S);break e}}l=l.return}while(l!==null)}Cd(n)}catch($){t=$,Qe===n&&n!==null&&(Qe=n=n.return);continue}break}while(!0)}function jd(){var e=No.current;return No.current=bo,e===null?bo:e}function ei(){(Ze===0||Ze===3||Ze===2)&&(Ze=4),tt===null||!(Vn&268435455)&&!($o&268435455)||vn(tt,st)}function Co(e,t){var n=Te;Te|=2;var s=jd();(tt!==e||st!==t)&&(nn=null,Bn(e,t));do try{wm();break}catch(o){Nd(e,o)}while(!0);if(Oa(),Te=n,No.current=s,Qe!==null)throw Error(se(261));return tt=null,st=0,Ze}function wm(){for(;Qe!==null;)Sd(Qe)}function bm(){for(;Qe!==null&&!Wf();)Sd(Qe)}function Sd(e){var t=Dd(e.alternate,e,jt);e.memoizedProps=e.pendingProps,t===null?Cd(e):Qe=t,Xa.current=null}function Cd(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=mm(n,t),n!==null){n.flags&=32767,Qe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ze=6,Qe=null;return}}else if(n=pm(n,t,jt),n!==null){Qe=n;return}if(t=t.sibling,t!==null){Qe=t;return}Qe=t=e}while(t!==null);Ze===0&&(Ze=5)}function On(e,t,n){var s=Ae,o=Tt.transition;try{Tt.transition=null,Ae=1,Nm(e,t,n,s)}finally{Tt.transition=o,Ae=s}return null}function Nm(e,t,n,s){do vr();while(bn!==null);if(Te&6)throw Error(se(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(se(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(np(e,l),e===tt&&(Qe=tt=null,st=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Us||(Us=!0,_d(oo,function(){return vr(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Tt.transition,Tt.transition=null;var a=Ae;Ae=1;var i=Te;Te|=4,Xa.current=null,gm(e,n),vd(n,e),Gp(zl),ao=!!Bl,zl=Bl=null,e.current=n,xm(n),qf(),Te=i,Ae=a,Tt.transition=l}else e.current=n;if(Us&&(Us=!1,bn=e,So=o),l=e.pendingLanes,l===0&&(Dn=null),Qf(n.stateNode),Nt(e,Ye()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],s(o.value,{componentStack:o.stack,digest:o.digest});if(jo)throw jo=!1,e=aa,aa=null,e;return So&1&&e.tag!==0&&vr(),l=e.pendingLanes,l&1?e===ia?Zr++:(Zr=0,ia=e):Zr=0,Tn(),null}function vr(){if(bn!==null){var e=ou(So),t=Tt.transition,n=Ae;try{if(Tt.transition=null,Ae=16>e?16:e,bn===null)var s=!1;else{if(e=bn,bn=null,So=0,Te&6)throw Error(se(331));var o=Te;for(Te|=4,ge=e.current;ge!==null;){var l=ge,a=l.child;if(ge.flags&16){var i=l.deletions;if(i!==null){for(var c=0;c<i.length;c++){var h=i[c];for(ge=h;ge!==null;){var d=ge;switch(d.tag){case 0:case 11:case 15:Kr(8,d,l)}var g=d.child;if(g!==null)g.return=d,ge=g;else for(;ge!==null;){d=ge;var p=d.sibling,b=d.return;if(gd(d),d===h){ge=null;break}if(p!==null){p.return=b,ge=p;break}ge=b}}}var w=l.alternate;if(w!==null){var D=w.child;if(D!==null){w.child=null;do{var N=D.sibling;D.sibling=null,D=N}while(D!==null)}}ge=l}}if(l.subtreeFlags&2064&&a!==null)a.return=l,ge=a;else e:for(;ge!==null;){if(l=ge,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Kr(9,l,l.return)}var u=l.sibling;if(u!==null){u.return=l.return,ge=u;break e}ge=l.return}}var f=e.current;for(ge=f;ge!==null;){a=ge;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,ge=x;else e:for(a=f;ge!==null;){if(i=ge,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:Oo(9,i)}}catch($){We(i,i.return,$)}if(i===a){ge=null;break e}var S=i.sibling;if(S!==null){S.return=i.return,ge=S;break e}ge=i.return}}if(Te=o,Tn(),Jt&&typeof Jt.onPostCommitFiberRoot=="function")try{Jt.onPostCommitFiberRoot(_o,e)}catch{}s=!0}return s}finally{Ae=n,Tt.transition=t}}return!1}function mc(e,t,n){t=Cr(n,t),t=od(e,t,1),e=kn(e,t,1),t=dt(),e!==null&&(ys(e,1,t),Nt(e,t))}function We(e,t,n){if(e.tag===3)mc(e,e,n);else for(;t!==null;){if(t.tag===3){mc(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Dn===null||!Dn.has(s))){e=Cr(n,e),e=ld(t,e,1),t=kn(t,e,1),e=dt(),t!==null&&(ys(t,1,e),Nt(t,e));break}}t=t.return}}function jm(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=dt(),e.pingedLanes|=e.suspendedLanes&n,tt===e&&(st&n)===n&&(Ze===4||Ze===3&&(st&130023424)===st&&500>Ye()-Ka?Bn(e,0):Qa|=n),Nt(e,t)}function kd(e,t){t===0&&(e.mode&1?(t=Ms,Ms<<=1,!(Ms&130023424)&&(Ms=4194304)):t=1);var n=dt();e=dn(e,t),e!==null&&(ys(e,t,n),Nt(e,n))}function Sm(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),kd(e,n)}function Cm(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(se(314))}s!==null&&s.delete(t),kd(e,n)}var Dd;Dd=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||wt.current)yt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return yt=!1,fm(e,t,n);yt=!!(e.flags&131072)}else yt=!1,Be&&t.flags&1048576&&Iu(t,ho,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Qs(e,t),e=t.pendingProps;var o=br(t,ct.current);yr(t,n),o=Ha(null,t,s,e,o,n);var l=Va();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,bt(s)?(l=!0,po(t)):l=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Ua(t),o.updater=Ao,t.stateNode=o,o._reactInternals=t,Ql(t,s,e,n),t=Zl(null,t,s,!0,l,n)):(t.tag=0,Be&&l&&Pa(t),ut(null,t,o,n),t=t.child),t;case 16:s=t.elementType;e:{switch(Qs(e,t),e=t.pendingProps,o=s._init,s=o(s._payload),t.type=s,o=t.tag=Dm(s),e=zt(s,e),o){case 0:t=Jl(null,t,s,e,n);break e;case 1:t=sc(null,t,s,e,n);break e;case 11:t=nc(null,t,s,e,n);break e;case 14:t=rc(null,t,s,zt(s.type,e),n);break e}throw Error(se(306,s,""))}return t;case 0:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:zt(s,o),Jl(e,t,s,o,n);case 1:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:zt(s,o),sc(e,t,s,o,n);case 3:e:{if(ud(t),e===null)throw Error(se(387));s=t.pendingProps,l=t.memoizedState,o=l.element,$u(e,t),yo(t,s,null,n);var a=t.memoizedState;if(s=a.element,l.isDehydrated)if(l={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){o=Cr(Error(se(423)),t),t=oc(e,t,s,n,o);break e}else if(s!==o){o=Cr(Error(se(424)),t),t=oc(e,t,s,n,o);break e}else for(St=Cn(t.stateNode.containerInfo.firstChild),Ct=t,Be=!0,Ft=null,n=Au(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Nr(),s===o){t=fn(e,t,n);break e}ut(e,t,s,n)}t=t.child}return t;case 5:return Lu(t),e===null&&ql(t),s=t.type,o=t.pendingProps,l=e!==null?e.memoizedProps:null,a=o.children,Gl(s,o)?a=null:l!==null&&Gl(s,l)&&(t.flags|=32),cd(e,t),ut(e,t,a,n),t.child;case 6:return e===null&&ql(t),null;case 13:return dd(e,t,n);case 4:return Ba(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=jr(t,null,s,n):ut(e,t,s,n),t.child;case 11:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:zt(s,o),nc(e,t,s,o,n);case 7:return ut(e,t,t.pendingProps,n),t.child;case 8:return ut(e,t,t.pendingProps.children,n),t.child;case 12:return ut(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,o=t.pendingProps,l=t.memoizedProps,a=o.value,$e(go,s._currentValue),s._currentValue=a,l!==null)if(Wt(l.value,a)){if(l.children===o.children&&!wt.current){t=fn(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var i=l.dependencies;if(i!==null){a=l.child;for(var c=i.firstContext;c!==null;){if(c.context===s){if(l.tag===1){c=an(-1,n&-n),c.tag=2;var h=l.updateQueue;if(h!==null){h=h.shared;var d=h.pending;d===null?c.next=c:(c.next=d.next,d.next=c),h.pending=c}}l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),Yl(l.return,n,t),i.lanes|=n;break}c=c.next}}else if(l.tag===10)a=l.type===t.type?null:l.child;else if(l.tag===18){if(a=l.return,a===null)throw Error(se(341));a.lanes|=n,i=a.alternate,i!==null&&(i.lanes|=n),Yl(a,n,t),a=l.sibling}else a=l.child;if(a!==null)a.return=l;else for(a=l;a!==null;){if(a===t){a=null;break}if(l=a.sibling,l!==null){l.return=a.return,a=l;break}a=a.return}l=a}ut(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,s=t.pendingProps.children,yr(t,n),o=Ot(o),s=s(o),t.flags|=1,ut(e,t,s,n),t.child;case 14:return s=t.type,o=zt(s,t.pendingProps),o=zt(s.type,o),rc(e,t,s,o,n);case 15:return ad(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:zt(s,o),Qs(e,t),t.tag=1,bt(s)?(e=!0,po(t)):e=!1,yr(t,n),sd(t,s,o),Ql(t,s,o,n),Zl(null,t,s,!0,e,n);case 19:return fd(e,t,n);case 22:return id(e,t,n)}throw Error(se(156,t.tag))};function _d(e,t){return tu(e,t)}function km(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rt(e,t,n,s){return new km(e,t,n,s)}function ti(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Dm(e){if(typeof e=="function")return ti(e)?1:0;if(e!=null){if(e=e.$$typeof,e===wa)return 11;if(e===ba)return 14}return 2}function Mn(e,t){var n=e.alternate;return n===null?(n=Rt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Zs(e,t,n,s,o,l){var a=2;if(s=e,typeof e=="function")ti(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case rr:return zn(n.children,o,l,t);case va:a=8,o|=8;break;case wl:return e=Rt(12,n,t,o|2),e.elementType=wl,e.lanes=l,e;case bl:return e=Rt(13,n,t,o),e.elementType=bl,e.lanes=l,e;case Nl:return e=Rt(19,n,t,o),e.elementType=Nl,e.lanes=l,e;case Lc:return Lo(n,o,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Oc:a=10;break e;case $c:a=9;break e;case wa:a=11;break e;case ba:a=14;break e;case gn:a=16,s=null;break e}throw Error(se(130,e==null?e:typeof e,""))}return t=Rt(a,n,t,o),t.elementType=e,t.type=s,t.lanes=l,t}function zn(e,t,n,s){return e=Rt(7,e,s,t),e.lanes=n,e}function Lo(e,t,n,s){return e=Rt(22,e,s,t),e.elementType=Lc,e.lanes=n,e.stateNode={isHidden:!1},e}function gl(e,t,n){return e=Rt(6,e,null,t),e.lanes=n,e}function xl(e,t,n){return t=Rt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _m(e,t,n,s,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ko(0),this.expirationTimes=Ko(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ko(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function ni(e,t,n,s,o,l,a,i,c){return e=new _m(e,t,n,i,c),t===1?(t=1,l===!0&&(t|=8)):t=0,l=Rt(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ua(l),e}function Mm(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nr,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function Md(e){if(!e)return In;e=e._reactInternals;e:{if(Yn(e)!==e||e.tag!==1)throw Error(se(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(bt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(se(171))}if(e.tag===1){var n=e.type;if(bt(n))return Mu(e,n,t)}return t}function Ed(e,t,n,s,o,l,a,i,c){return e=ni(n,s,!0,e,o,l,a,i,c),e.context=Md(null),n=e.current,s=dt(),o=_n(n),l=an(s,o),l.callback=t??null,kn(n,l,o),e.current.lanes=o,ys(e,o,s),Nt(e,s),e}function Uo(e,t,n,s){var o=t.current,l=dt(),a=_n(o);return n=Md(n),t.context===null?t.context=n:t.pendingContext=n,t=an(l,a),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=kn(o,t,a),e!==null&&(Vt(e,o,a,l),qs(e,o,a)),a}function ko(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ri(e,t){hc(e,t),(e=e.alternate)&&hc(e,t)}function Em(){return null}var Id=typeof reportError=="function"?reportError:function(e){console.error(e)};function si(e){this._internalRoot=e}Bo.prototype.render=si.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(se(409));Uo(e,t,null,null)};Bo.prototype.unmount=si.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Wn(function(){Uo(null,e,null,null)}),t[un]=null}};function Bo(e){this._internalRoot=e}Bo.prototype.unstable_scheduleHydration=function(e){if(e){var t=iu();e={blockedOn:null,target:e,priority:t};for(var n=0;n<yn.length&&t!==0&&t<yn[n].priority;n++);yn.splice(n,0,e),n===0&&uu(e)}};function oi(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function zo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function gc(){}function Im(e,t,n,s,o){if(o){if(typeof s=="function"){var l=s;s=function(){var h=ko(a);l.call(h)}}var a=Ed(t,s,e,0,null,!1,!1,"",gc);return e._reactRootContainer=a,e[un]=a.current,is(e.nodeType===8?e.parentNode:e),Wn(),a}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var i=s;s=function(){var h=ko(c);i.call(h)}}var c=ni(e,0,!1,null,null,!1,!1,"",gc);return e._reactRootContainer=c,e[un]=c.current,is(e.nodeType===8?e.parentNode:e),Wn(function(){Uo(t,c,n,s)}),c}function Go(e,t,n,s,o){var l=n._reactRootContainer;if(l){var a=l;if(typeof o=="function"){var i=o;o=function(){var c=ko(a);i.call(c)}}Uo(t,a,e,o)}else a=Im(n,t,e,o,s);return ko(a)}lu=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Fr(t.pendingLanes);n!==0&&(Sa(t,n|1),Nt(t,Ye()),!(Te&6)&&(kr=Ye()+500,Tn()))}break;case 13:Wn(function(){var s=dn(e,1);if(s!==null){var o=dt();Vt(s,e,1,o)}}),ri(e,1)}};Ca=function(e){if(e.tag===13){var t=dn(e,134217728);if(t!==null){var n=dt();Vt(t,e,134217728,n)}ri(e,134217728)}};au=function(e){if(e.tag===13){var t=_n(e),n=dn(e,t);if(n!==null){var s=dt();Vt(n,e,t,s)}ri(e,t)}};iu=function(){return Ae};cu=function(e,t){var n=Ae;try{return Ae=e,t()}finally{Ae=n}};Pl=function(e,t,n){switch(t){case"input":if(Cl(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var o=Po(s);if(!o)throw Error(se(90));Bc(s),Cl(s,o)}}}break;case"textarea":Gc(e,n);break;case"select":t=n.value,t!=null&&mr(e,!!n.multiple,t,!1)}};Xc=Ja;Qc=Wn;var Pm={usingClientEntryPoint:!1,Events:[ws,ar,Po,qc,Yc,Ja]},Br={findFiberByHostInstance:$n,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rm={bundleType:Br.bundleType,version:Br.version,rendererPackageName:Br.rendererPackageName,rendererConfig:Br.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zc(e),e===null?null:e.stateNode},findFiberByHostInstance:Br.findFiberByHostInstance||Em,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bs.isDisabled&&Bs.supportsFiber)try{_o=Bs.inject(Rm),Jt=Bs}catch{}}_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pm;_t.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oi(t))throw Error(se(200));return Mm(e,t,null,n)};_t.createRoot=function(e,t){if(!oi(e))throw Error(se(299));var n=!1,s="",o=Id;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=ni(e,1,!1,null,null,n,!1,s,o),e[un]=t.current,is(e.nodeType===8?e.parentNode:e),new si(t)};_t.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(se(188)):(e=Object.keys(e).join(","),Error(se(268,e)));return e=Zc(t),e=e===null?null:e.stateNode,e};_t.flushSync=function(e){return Wn(e)};_t.hydrate=function(e,t,n){if(!zo(t))throw Error(se(200));return Go(null,e,t,!0,n)};_t.hydrateRoot=function(e,t,n){if(!oi(e))throw Error(se(405));var s=n!=null&&n.hydratedSources||null,o=!1,l="",a=Id;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Ed(t,null,e,1,n??null,o,!1,l,a),e[un]=t.current,is(e),s)for(e=0;e<s.length;e++)n=s[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Bo(t)};_t.render=function(e,t,n){if(!zo(t))throw Error(se(200));return Go(null,e,t,!1,n)};_t.unmountComponentAtNode=function(e){if(!zo(e))throw Error(se(40));return e._reactRootContainer?(Wn(function(){Go(null,null,e,!1,function(){e._reactRootContainer=null,e[un]=null})}),!0):!1};_t.unstable_batchedUpdates=Ja;_t.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!zo(n))throw Error(se(200));if(e==null||e._reactInternals===void 0)throw Error(se(38));return Go(e,t,n,!1,s)};_t.version="18.3.1-next-f1338f8080-20240426";function Pd(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pd)}catch(e){console.error(e)}}Pd(),Pc.exports=_t;var Tm=Pc.exports,Rd,xc=Tm;Rd=xc.createRoot,xc.hydrateRoot;class Am{constructor(){this.config=null,this.isConfigLoaded=!1}async loadConfig(){var t;if(this.config&&this.isConfigLoaded)return this.config;try{const n=await fetch("../config.txt");if(!n.ok)throw new Error(`Failed to load config: ${n.status}`);const s=await n.text();if(this.config=JSON.parse(s),this.isConfigLoaded=!0,!((t=this.config)!=null&&t.domain))throw new Error("Invalid config: missing domain");return this.config}catch(n){throw console.error("Failed to load API config:",n),new Error("API configuration not available")}}async request(t,n={}){const o=`${(await this.loadConfig()).domain}${t}`,l={method:"POST",headers:{"Content-Type":"application/json",...n.headers},...n},a=new Date().toISOString();if(console.log(""),console.log(` API Request [${a}]`),console.log(" Endpoint:",t),console.log(" Full URL:",o),console.log(" Method:",l.method),console.log(" Headers:",l.headers),l.body){console.log(" Request Body:",l.body);try{const i=JSON.parse(l.body);console.log(" Parsed Body:",i)}catch{console.log(" Body (raw):",l.body)}}console.log("");try{const i=await fetch(o,l);if(console.log(""),console.log(` API Response [${new Date().toISOString()}]`),console.log(" Endpoint:",t),console.log(" Status:",i.status,i.statusText),console.log(" Response Headers:",Object.fromEntries(i.headers.entries())),!i.ok)throw console.log(" HTTP Error:",i.status),console.log(""),new Error(`HTTP error! status: ${i.status}`);const c=await i.json();return console.log(" Response Data:",c),console.log(""),c}catch(i){throw console.log(""),console.log(" API Request Failed"),console.log(" Endpoint:",t),console.log(" Error:",i),console.log(""),i}}async login(t){const n={Data:{ID:t.ID.trim(),Password:t.Password}};return this.request("/api/session/login",{method:"POST",body:JSON.stringify(n)})}async getDepartments(t={}){return this.request("/api/ServerSetting/get_name",{method:"POST",body:JSON.stringify(t)})}async getMedicineCloud(t={}){return this.request("/api/MED_page/get_med_cloud",{method:"POST",body:JSON.stringify({})})}async searchMedicine(t="",n="N"){try{const s=await this.getMedicineCloud();if(s.Code!==200||!s.Data)return console.error("API returned error:",s),[];let o=s.Data;if(o=o.filter(l=>l.DRUGKIND===n),o=o.filter(l=>l.FILE_STATUS!==""),t.trim()){const l=t.toLowerCase();o=o.filter(a=>a.CODE&&a.CODE.toLowerCase().includes(l)||a.CHT_NAME&&a.CHT_NAME.toLowerCase().includes(l)||a.NAME&&a.NAME.toLowerCase().includes(l))}return o}catch(s){return console.error("Medicine search failed:",s),[]}}async getMedMapByDepartment(t){const n={Data:{},ValueAry:[t]};return this.request("/api/medMap/get_medMap_by_department",{method:"POST",body:JSON.stringify(n)})}async updateContainerPosition(t){const n={Data:[t]};return this.request("/api/medMap/update_medMap_section",{method:"POST",body:JSON.stringify(n)})}async addMedMapBox(t){const n={Data:t};return this.request("/api/medMap/add_medMap_box",{method:"POST",body:JSON.stringify(n)})}async updateMedMapBox(t){const n={Data:t};return this.request("/api/medMap/update_medMap_box",{method:"POST",body:JSON.stringify(n)})}async updateEpd266Storages(t,n,s){const o={ServerName:t,ServerType:n,Data:s};return this.request("/api/device/update_epd266_storages",{method:"POST",body:JSON.stringify(o)})}async updateMedMapDrawer(t){const n={Data:t};return this.request("/api/medMap/update_medMap_drawer",{method:"POST",body:JSON.stringify(n)})}async updateMedMapShelf(t){const n={Data:t};return this.request("/api/medMap/update_medMap_shelf",{method:"POST",body:JSON.stringify(n)})}async addMedMapSection(t,n){const s={ValueAry:[t,n]};return this.request("/api/medMap/add_medMap_section",{method:"POST",body:JSON.stringify(s)})}async addMedMapShelf(t){const n={Data:t};return this.request("/api/medMap/add_medMap_shelf",{method:"POST",body:JSON.stringify(n)})}async addMedMapDrawer(t){const n={Data:t};return this.request("/api/medMap/add_medMap_drawer",{method:"POST",body:JSON.stringify(n)})}async addSubSection(t,n){const s={ValueAry:[t,n]};return this.request("/api/medMap/add_sub_section",{method:"POST",body:JSON.stringify(s)})}async updateSubSection(t){const n={Data:t};return this.request("/api/medMap/update_sub_section",{method:"POST",body:JSON.stringify(n)})}async updateEpd266Medcode(t,n,s,o){const l={ServerName:t,ServerType:n,ValueAry:[`code=${s}`],Data:o};return this.request("/api/device/update_epd266_medcode",{method:"POST",body:JSON.stringify(l)})}async getConfig(){return this.loadConfig()}async checkConnection(){try{return await this.loadConfig(),!0}catch(t){return console.error("API connection check failed:",t),!1}}async addStock(t){const n={Data:t};return console.log(n),this.request("/api/medMap/add_stock",{method:"POST",body:JSON.stringify(n)})}async updateStock(t){const n={Data:t};return this.request("/api/medMap/update_stock",{method:"POST",body:JSON.stringify(n)})}async addMedMap(t,n,s){const o={ValueAry:[t,n,s,"0,0"]};return this.request("/api/medMap/add_medMap",{method:"POST",body:JSON.stringify(o)})}async scanBarcode(t){const o=`${(await this.loadConfig()).ai||"https://www.kutech.tw:3000"}/barcode`,l=new FormData;l.append("file",t),console.log(""),console.log(` AI Barcode Scan Request [${new Date().toISOString()}]`),console.log(" URL:",o),console.log(" Image File:",t.name,t.size,"bytes"),console.log("");try{const a=await fetch(o,{method:"POST",body:l}),i=await a.json();return console.log(""),console.log(` AI Barcode Scan Response [${new Date().toISOString()}]`),console.log(" Status:",a.status),console.log(" Response Data:",i),console.log(""),i}catch(a){return console.error(" AI Barcode Scan Error:",a),{results:[]}}}async searchByBarCode(t){const n={Value:t};return this.request("/api/MED_page/serch_by_BarCode",{method:"POST",body:JSON.stringify(n)})}async addMedClouds(t,n,s,o){let l=o;l.push(t);const a={Data:[{BARCODE:l,CODE:n,BARCODE2:s||JSON.stringify([t])}]};return this.request("/api/MED_page/add_med_clouds",{method:"POST",body:JSON.stringify(a)})}async stockDeleteValidityPeriod(t,n){const s={ValueAry:[t,n]};return this.request("/api/medMap/stock_delete_Validity_period",{method:"POST",body:JSON.stringify(s)})}resetConfig(){this.config=null,this.isConfigLoaded=!1}async getRequisitionByTime(t,n){const s={ValueAry:[t,n]};return this.request("/api/materialRequisition/get_by_requestTime",{method:"POST",body:JSON.stringify(s)})}async getDistributionByTime(t,n){const s={ValueAry:[t,n]};return this.request("/api/drugStotreDistribution/get_by_addedTime",{method:"POST",body:JSON.stringify(s)})}async updateRequisitionNotice(t,n){const s={Data:{GUID:t,notice:n}};return this.request("/api/materialRequisition/update_notice",{method:"POST",body:JSON.stringify(s)})}async updateDistributionNotice(t,n){const s={ValueAry:[t,n]};return console.log(s),this.request("/api/drugStotreDistribution/update_notice",{method:"POST",body:JSON.stringify(s)})}async updateRequisitionActualQuantity(t,n){const s={Data:{GUID:t,actualQuantity:n}};return this.request("/api/materialRequisition/update_actual_quantity",{method:"POST",body:JSON.stringify(s)})}async updateRequisitionByGuid(t){const n={Data:[t]};return this.request("/api/materialRequisition/update_by_guid",{method:"POST",body:JSON.stringify(n)})}async updateDistributionActualQuantity(t,n){const s={ValueAry:[t,n]};return this.request("/api/drugStotreDistribution/update_actqty_by_guid",{method:"POST",body:JSON.stringify(s)})}async updateDistributionByGuid(t){const n={Data:[t]};return this.request("/api/drugStotreDistribution/update_by_guid",{method:"POST",body:JSON.stringify(n)})}async getAllStaffInfo(){return this.request("/api/person_page/get_all",{method:"POST",body:JSON.stringify({})})}}const _e=new Am;class Om{convertMedMapApiToFakeData(t){console.log("  MedMap API "),console.log("  API :",t);try{Array.isArray(t)||(console.warn(" API "),t=[t]);const s=t.map((o,l)=>this.convertSingleDepartment(o,l)).filter(o=>{if(Object.keys(o).length!==0)return o});return console.log(" MedMap :",s),s}catch(n){return console.error(" MedMap :",n),[]}}convertSingleDepartment(t,n){if(Object.keys(t).length!==0){let s;t.absolute_position?s=t.absolute_position.split(","):s=[0,0];const o={GUID:t.GUID||t.guid||`dept_${n}_${Date.now()}`,Master_GUID:t.Master_GUID,type:t.sys_ServerSetting.type||"",name:t.sys_ServerSetting.name||"",gird_position:t.position,position:{x:s[0],y:s[1]},contents:t.medMap_Section,department_type:t.sys_ServerSetting["department_type "],class:0};return Array.isArray(t.medMap_Section)&&t.medMap_Section.forEach((l,a)=>{let i;l.absolute_position?i=l.absolute_position.split(","):i=[0,0],o.contents[a]={GUID:l.GUID,Master_GUID:l.Master_GUID,name:`${a}`,type:"parent_container",class:1,gird_position:l.position,position:{x:i[0],y:i[1]},serverName:t.sys_ServerSetting.name,serverType:t.sys_ServerSetting.type,contents:[],med_list:[]},Array.isArray(l.sub_section)&&l.sub_section.forEach((c,h)=>{let d={GUID:c.GUID,Master_GUID:c.Master_GUID,name:c.name,type:"sub_container",class:2,gird_position:c.position,contents:[],serverName:t.sys_ServerSetting.name,serverType:t.sys_ServerSetting.type,oriMaxCol:0};o.contents[a].contents[h]=d;let g=0;Array.isArray(c.shelf)&&c.shelf.forEach((p,b)=>{let w={GUID:p.GUID,Master_GUID:p.Master_GUID,name:`_${b}`,class:3,gird_position:p.position,serverName:p.serverName||"",serverType:p.serverType||"",type:p.type,contents:[]};if(w.serverName&&(w.serverName=t.sys_ServerSetting.name),w.serverType&&(w.serverType=t.sys_ServerSetting.type),p.type=="dispensing_shelves"||p.type=="shelf")p.type=="shelf"&&(w.type="dispensing_shelves"),Array.isArray(p.medMapBox)&&p.medMapBox.forEach((N,u)=>{let f={GUID:N.GUID,Master_GUID:N.Master_GUID,name:"",class:4,gird_position:N.position,ip:N.ip_box,box_type:"",width:N.width,height:N.height,serverType:N.serverType,serverName:N.serverName,med_info:[],type:"med_box"},x={},S=p.position.split(","),$=N.position.split(",");if(N.storage){switch(f.device_type=N.storage.DeviceType,f.storage=N.storage,+f.device_type){case 10:f.box_type="2.9";break;case 118:f.box_type="2.13";break;case 13:f.box_type="4.2";break}x.name=N.storage.Name,x.code=N.storage.Code,x.cht_name=N.storage.ChineseName,x.SKDIACODE=N.storage.SKDIACODE,x.qty=N.storage.StorageName,x.stockCol=`${+S[0]+1}`,x.stockRow="",x.stock=`${+$[1]+1}`}else f.device_type=10,f.box_type="2.9",x.name="",x.code="",x.cht_name="",x.stockCol=`${+S[0]+1}`,x.stockRow="",x.stock=`${+$[1]+1}`;o.contents[a].med_list.push(x),f.med_info[0]=x,w.contents.push(f)});else{w.type="store_shelves",w.ip=p.ip_light,w.width=p.width,w.height=p.height;const N=p.medMapStock.sort((u,f)=>{const[x]=u.location.split(",").map(Number),[S]=f.location.split(",").map(Number);return x-S});w.medMapStock=N,w.name=p.name,N.forEach((u,f)=>{let x=p.position.split(",");if(u.code){let S={};S.name=u.name,S.code=u.code,S.cht_name="",S.SKDIACODE=u.material_no,S.qty=u.qty,S.stockCol=`${+x[0]+1}`,S.stockRow=`${+x[1]+1}`,S.stock=`${f+1}`,o.contents[a].med_list.push(S)}})}let D=p.position.split(",")[1];g<+D&&(g=+D,o.contents[a].contents[h].oriMaxCol=+g),o.contents[a].contents[h].contents.push(w)}),Array.isArray(c.drawer)&&c.drawer.forEach((p,b)=>{let w={GUID:p.GUID,Master_GUID:p.Master_GUID,name:` ${b}`,class:3,gird_position:p.position,ip:p.ip_drawer,serverName:p.serverName,serverType:p.serverType};w.serverName&&(w.serverName=t.sys_ServerSetting.name),w.serverType&&(w.serverType=t.sys_ServerSetting.type),p.drawer?(w.drawer=p.drawer,p.drawer.Boxes&&(w.type="grid_draw",w.name=p.drawer.Name,w.Boxes=[],Array.isArray(p.drawer.Boxes)?p.drawer.Boxes.forEach((u,f)=>{let x=[];Array.isArray(u)&&u.forEach((S,$)=>{let M={Row:S.Row,Column:S.Column,Width:1,Height:1,Slave:S.Slave,SlaveBox_Row:S.SlaveBox_Row,SlaveBox_Column:S.SlaveBox_Column,MasterBox_Column:S.MasterBox_Column,MasterBox_Row:S.MasterBox_Row,Name:S.Name,Code:S.Code,ChineseName:S.ChineseName,GUID:S.GUID};x.push(M),S.Code&&o.contents[a].med_list.push(S.Code)}),w.Boxes.push(x)}):w.Boxes=p.drawer.Boxes)):(w.type="list_draw",w.name=` ${b}`);let D=p.position.split(",")[1];g<+D&&(g=+D,o.contents[a].contents[h].oriMaxCol=+g),o.contents[a].contents[h].contents.push(w)})})}),o}else return{}}convertSingleComponent(t,n,s){var l,a,i,c,h;const o={GUID:t.GUID||t.guid||`comp_${n}_${Date.now()}`,type:this.mapComponentType(t.type||t.component_type||"unknown"),name:t.name||t.component_name||`_${n}`,position:{x:((l=t.position)==null?void 0:l.x)||t.x||50+n*200,y:((a=t.position)==null?void 0:a.y)||t.y||50+n*150},dimensions:{width:((i=t.dimensions)==null?void 0:i.width)||t.width||180,height:((c=t.dimensions)==null?void 0:c.height)||t.height||120,depth:((h=t.dimensions)==null?void 0:h.depth)||t.depth||30},med_box:t.med_box||t.medBox||t.medicine_boxes||[],Master_GUID:s};return t.components&&Array.isArray(t.components)&&(o.components=t.components.map((d,g)=>this.convertSingleComponent(d,g,o.GUID))),Object.keys(t).forEach(d=>{["GUID","type","name","position","dimensions","med_box","components"].includes(d)||(o[d]=t[d])}),o}mapDepartmentType(t){return{dispensing_station:"",warehouse:"",pharmacy:"",storage:""}[t]||t}mapComponentType(t){return{medicine_box_shelf:"med_box_shelf",medicine_shelf:"normal_shelf",grid_drawer:"grid_draw",list_drawer:"list_draw",medicine_box:"med_box",parent_container:"parent_container",sub_container:"sub_container",dispensing_shelves:"dispensing_shelves",store_shelves:"store_shelves"}[t]||t}validateConvertedData(t){try{if(!Array.isArray(t))return console.error(" "),!1;for(const n of t){if(!n.GUID||!n.type||!n.name)return console.error(" :",n),!1;if(!n.gird_position||typeof n.gird_position!="string")return console.error(" :",n.gird_position),!1;if(n.components&&Array.isArray(n.components)){for(const s of n.components)if(!s.GUID||!s.type)return console.error(" :",s),!1}}return console.log(" "),!0}catch(n){return console.error(" :",n),!1}}generateConversionReport(t,n){const s={timestamp:new Date().toISOString(),originalDataCount:Array.isArray(t)?t.length:0,convertedDataCount:n.length,conversionSuccess:n.length>0,totalComponents:n.reduce((o,l)=>{var a;return o+(((a=l.components)==null?void 0:a.length)||0)},0),departmentTypes:[...new Set(n.map(o=>o.type))],componentTypes:[...new Set(n.flatMap(o=>{var l;return((l=o.components)==null?void 0:l.map(a=>a.type))||[]}))]};return console.log(" :",s),s}}const At=new Om,$m=Object.freeze(Object.defineProperty({__proto__:null,default:At},Symbol.toStringTag,{value:"Module"})),Td=m.createContext(void 0),Lm=({children:e})=>{const[t,n]=m.useState(!1),[s,o]=m.useState(null),[l,a]=m.useState(!1),[i,c]=m.useState(null),[h,d]=m.useState(null),[g,p]=m.useState("medicine"),[b,w]=m.useState(!1),[D,N]=m.useState(0),[u,f]=m.useState({message:"",type:"success",isVisible:!1}),[x,S]=m.useState(!1),[$,M]=m.useState(null),[A,k]=m.useState("edit"),[F,E]=m.useState(!1),[q,V]=m.useState(null),[P,O]=m.useState(!1),[ne,y]=m.useState(null),[T,C]=m.useState(!1),[X,fe]=m.useState(!1),[Z,le]=m.useState(null),[Ne,ae]=m.useState(!1),[we,U]=m.useState(null),[ie,xe]=m.useState(!1),[he,L]=m.useState(null),[ce,H]=m.useState(!1),[_,ee]=m.useState(null),[I,j]=m.useState(null),[R,z]=m.useState("add"),[oe,pe]=m.useState(!1),[ve,ke]=m.useState([]),[De,Me]=m.useState([]),[me,ye]=m.useState(!1),[je,Ie]=m.useState(!1),[nt,Ce]=m.useState(""),[qe,ze]=m.useState(!1),[Lt,ht]=m.useState(""),[qt,en]=m.useState(!1),[Ns,Ir]=m.useState(null),[v,Y]=m.useState(null),[Q,G]=m.useState(!1),[J,B]=m.useState(null),re=()=>{sessionStorage.removeItem("user_session"),n(!1),o(null)},te=m.useCallback(()=>{N(Ee=>Ee+1)},[]),K=m.useCallback((Ee,Et)=>{f({message:Ee,type:Et,isVisible:!0})},[]),W=m.useCallback(()=>{f(Ee=>({...Ee,isVisible:!1}))},[]),de=Ee=>{M(Ee),k("edit"),S(!0)},ue=()=>{const Ee={GUID:`new_medbox_${Date.now()}`,name:"",box_type:"",width:[],width_index:0,med_info:[],parentShelf:null};M(Ee),k("add"),S(!0)},Se=()=>{S(!1),M(null),k("edit")},be=Ee=>{V(Ee),E(!0)},Re=()=>{E(!1),V(null)},gt=Ee=>{y(Ee),O(!0)},Ve=()=>{O(!1),y(null)},tn=Ee=>{le(Ee),fe(!0)},Pr=()=>{fe(!1),le(null)},Ho=Ee=>{U(Ee),ae(!0)},Gd=()=>{ae(!1),U(null)},Fd=Ee=>{L(Ee),xe(!0)},Hd=()=>{xe(!1),L(null)},Vd=Ee=>{ee(Ee),j(null),z("add"),H(!0)},Wd=(Ee,Et)=>{ee(Ee),j(Et),z("edit"),H(!0)},qd=()=>{H(!1),ee(null),j(null),z("add")},Yd=()=>{pe(!0)},Xd=()=>{pe(!1)},Qd=(Ee="")=>{Ce(Ee),Ie(!0)},Kd=()=>{Ie(!1)},Jd=Ee=>{ht(Ee),ze(!0)},Zd=()=>{ze(!1),ht("")},ef=(Ee,Et)=>{Ir(Ee),Y(Et||null),en(!0)},tf=()=>{en(!1),Ir(null),Y(null)},nf=Ee=>{B(Ee),G(!0)},rf=()=>{G(!1),B(null)},sf=m.useCallback(async()=>{if(!i){console.warn("");return}console.log(" :",i),C(!0);try{const Ee=await _e.getMedMapByDepartment(i);if(Ee.Code===200&&Ee.Data){console.log(" :",Ee.Data);const Et=At.convertMedMapApiToFakeData(Ee.Data);if(!At.validateConvertedData(Et)){console.error(" "),d(null);return}d(Et),console.log(" ")}else console.error(" API :",Ee),d(null)}catch(Ee){console.error(" :",Ee),d(null)}finally{C(!1)}},[i,C,d]),of=m.useCallback((Ee,Et)=>{d(Xn=>Xn&&Xn.map(ai=>{const Qn={...ai};return Qn.contents&&(Qn.contents=Qn.contents.map(Kn=>{const Jn={...Kn};return Jn.contents&&(Jn.contents=Jn.contents.map(Zn=>{const er={...Zn};return er.contents&&(er.contents=er.contents.map(mn=>{if(mn.GUID===Ee){const Ut={...mn};return Ut.medMapStock||(Ut.medMapStock=[]),Ut.medMapStock=[...Ut.medMapStock,Et],Ut}return mn})),er})),Jn})),Qn}))},[]),lf=m.useCallback((Ee,Et,Xn)=>{d(js=>js&&js.map(Qn=>{const Kn={...Qn};return Kn.contents&&(Kn.contents=Kn.contents.map(Jn=>{const Zn={...Jn};return Zn.contents&&(Zn.contents=Zn.contents.map(er=>{const mn={...er};return mn.contents&&(mn.contents=mn.contents.map(Ut=>{if(Ut.GUID===Ee&&Ut.medMapStock){const ii={...Ut};return ii.medMapStock=Ut.medMapStock.map(Vo=>Vo.GUID===Et?{...Vo,...Xn}:Vo),ii}return Ut})),mn})),Zn})),Kn}))},[]);return r.jsx(Td.Provider,{value:{isAuthenticated:t,setIsAuthenticated:n,currentUser:s,setCurrentUser:o,logout:re,sidebarOpen:l,setSidebarOpen:a,selectedDepartmentType:i,setSelectedDepartmentType:c,isAdminMode:b,setIsAdminMode:w,apiDepartmentData:h,setApiDepartmentData:d,viewMode:g,setViewMode:p,refreshTrigger:D,triggerRefresh:te,addStockToShelf:of,notification:u,showNotification:K,hideNotification:W,medBoxModalOpen:x,setMedBoxModalOpen:S,selectedMedBox:$,setSelectedMedBox:M,openMedBoxModal:de,closeMedBoxModal:Se,modalMode:A,setModalMode:k,openAddMedBoxModal:ue,listDrawModalOpen:F,setListDrawModalOpen:E,selectedListDraw:q,setSelectedListDraw:V,openListDrawModal:be,closeListDrawModal:Re,gridDrawModalOpen:P,setGridDrawModalOpen:O,selectedGridDraw:ne,setSelectedGridDraw:y,openGridDrawModal:gt,closeGridDrawModal:Ve,isLoadingMedMap:T,setIsLoadingMedMap:C,addParentContainerModalOpen:X,setAddParentContainerModalOpen:fe,selectedDepartmentForAdd:Z,setSelectedDepartmentForAdd:le,openAddParentContainerModal:tn,closeAddParentContainerModal:Pr,addShelfDrawContainerModalOpen:Ne,setAddShelfDrawContainerModalOpen:ae,selectedSubContainerForAdd:we,setSelectedSubContainerForAdd:U,openAddShelfDrawContainerModal:Ho,closeAddShelfDrawContainerModal:Gd,addSubContainerModalOpen:ie,setAddSubContainerModalOpen:xe,selectedParentContainerForAdd:he,setSelectedParentContainerForAdd:L,openAddSubContainerModal:Fd,closeAddSubContainerModal:Hd,addStoreItemModalOpen:ce,setAddStoreItemModalOpen:H,selectedStoreShelfForAdd:_,setSelectedStoreShelfForAdd:ee,selectedStockItemForEdit:I,setSelectedStockItemForEdit:j,storeItemModalMode:R,setStoreItemModalMode:z,openAddStoreItemModal:Vd,openEditStoreItemModal:Wd,closeAddStoreItemModal:qd,updateStockInShelf:lf,addDepartmentModalOpen:oe,setAddDepartmentModalOpen:pe,allDepartmentsList:ve,setAllDepartmentsList:ke,openAddDepartmentModal:Yd,closeAddDepartmentModal:Xd,reloadMedMapData:sf,qrCodeScannerModalOpen:je,qrCodeScannerMode:nt,setQRCodeScannerModalOpen:Ie,openQRCodeScannerModal:Qd,closeQRCodeScannerModal:Kd,addBarcodeModalOpen:qe,setAddBarcodeModalOpen:ze,openAddBarcodeModal:Jd,closeAddBarcodeModal:Zd,initialBarcodeValue:Lt,containerDetailModalOpen:qt,setContainerDetailModalOpen:en,selectedContainerForDetail:Ns,setSelectedContainerForDetail:Ir,highlightedMedicineCode:v,setHighlightedMedicineCode:Y,openContainerDetailModal:ef,closeContainerDetailModal:tf,editStoreShelfModalOpen:Q,setEditStoreShelfModalOpen:G,selectedStoreShelfForEdit:J,setSelectedStoreShelfForEdit:B,openEditStoreShelfModal:nf,closeEditStoreShelfModal:rf,medicineList:De,setMedicineList:Me,isLoadingMedicines:me,setIsLoadingMedicines:ye},children:e})},Ke=()=>{const e=m.useContext(Td);if(e===void 0)throw new Error("useDrugMap must be used within a DrugMapProvider");return e},Um={"zh-TW":{"nav.title":"","nav.home":"","nav.expandSidebar":"","nav.collapseSidebar":"","topbar.medicine":"","topbar.department":"","topbar.language":"","topbar.logout":"","sidebar.drugMap":"","sidebar.closeSidebar":"","sidebar.departmentCategories":"","sidebar.departments":"","canvas.lockCanvas":"","canvas.unlockCanvas":"","type.dispensingStation":"","type.warehouse":"","type.medBoxShelf":"","type.storeShelf":"","type.parentContainer":"","type.subContainer":"","type.gridDraw":"","type.listDraw":"","type.medBox":"","type.containers":"","modal.medBoxSettings":"","modal.addMedBox":"","modal.listDrawSettings":"","modal.gridDrawSettings":"","modal.settings":"","modal.add":"","form.medBoxName":"","form.medBoxType":"","form.widthSelection":"","form.ipAddress":"IP ","form.drugInfo":"","form.drawerName":"","form.drugList":"","form.drugCode":"","form.drugName":"","form.chineseName":"","form.drugSearch":"","placeholder.medBoxName":"  ","placeholder.ipAddress":" IP ","placeholder.drawerName":"","placeholder.gridDrawName":"","placeholder.drugSearch":" //","button.cancel":"","button.save":"","button.add":"","button.edit":"","button.change":"","button.remove":"","button.search":"","button.merge":"","button.unmerge":"","status.noDrugData":"","status.newMedBoxNoDrug":"","status.drawerNoDrug":"","status.gridDrawNotConfigured":"","status.noDrugInfo":"","status.drugListEmpty":"","status.noContent":"No content available","status.notSet":"","status.notAdded":"","status.searchResults":"","status.selectCellsForDrug":"","status.selectedCellsNoDrug":"","status.loadingMedMapData":"...","status.loadingMedMapHint":"","footer.copyright":"Copyright 2025 ","login.title":"","login.subtitle":"","login.userId":"","login.userIdPlaceholder":"","login.password":"","login.passwordPlaceholder":"","login.loginButton":"","login.loggingIn":"..."},en:{"nav.title":"Drug Map","nav.home":"Back to Home","nav.expandSidebar":"Expand Sidebar","nav.collapseSidebar":"Collapse Sidebar","topbar.medicine":"Medicine","topbar.department":"Department","topbar.language":"English","topbar.logout":"Logout","sidebar.drugMap":"Drug Map","sidebar.closeSidebar":"Close Sidebar","sidebar.departmentCategories":"Department Categories","sidebar.departments":"Departments","canvas.lockCanvas":"Lock Canvas","canvas.unlockCanvas":"Unlock Canvas","type.dispensingStation":"Dispensing Station","type.warehouse":"Warehouse","type.medBoxShelf":"Medicine Box Shelf","type.parentContainer":"Cabinet","type.subContainer":"sub container","type.gridDraw":"Grid Drawer","type.listDraw":"List Drawer","type.medBox":"Medicine Box","type.containers":"Containers","modal.medBoxSettings":"Medicine Box Settings","modal.addMedBox":"Add Medicine Box","modal.listDrawSettings":"Drawer Settings","modal.gridDrawSettings":"Grid Drawer Settings","modal.settings":"Edit Settings","modal.add":"Add Medicine Box","form.medBoxName":"Medicine Box Name","form.medBoxType":"Medicine Box Type","form.widthSelection":"Width Selection","form.ipAddress":"IP Address","form.drugInfo":"Drug Information","form.drawerName":"Drawer Name","form.drugList":"Drug List","form.drugCode":"Drug Code","form.drugName":"Drug Name","form.chineseName":"Chinese Name","form.drugSearch":"Drug Search","placeholder.medBoxName":"Enter medicine box name","placeholder.ipAddress":"Enter IP address","placeholder.drawerName":"Enter drawer name","placeholder.gridDrawName":"Enter grid drawer name","placeholder.drugSearch":"Enter drug code/name/Chinese name","button.cancel":"Cancel","button.save":"Save","button.add":"Add","button.edit":"Edit","button.change":"Change","button.remove":"Remove Drug","button.search":"Search","button.merge":"Merge","button.unmerge":"Unmerge","status.noDrugData":"This medicine box has no drug data configured","status.newMedBoxNoDrug":"New medicine box has no drug data configured","status.drawerNoDrug":"This drawer has no drugs configured","status.gridDrawNotConfigured":"This grid drawer is not configured","status.noDrugInfo":"No drug information","status.drugListEmpty":"Drug list is empty","status.noContent":"No content available","status.notSet":"Not set","status.notAdded":"No drugs added","status.searchResults":"Search results will be displayed here","status.selectCellsForDrug":"Select merged cells to display drug information","status.selectedCellsNoDrug":"Selected cells have no drug data","status.searching":"Searching...","status.noSearchResults":"No search results found","status.loadingMedMapData":"Loading medicine map data...","status.loadingMedMapHint":"Please wait while we process department data","footer.copyright":"Copyright 2025 Hongsen Intelligent Technology","login.title":"Drug Map System","login.subtitle":"Please login to continue","login.userId":"ID","login.userIdPlaceholder":"Enter your user ID","login.password":"Password","login.passwordPlaceholder":"Enter your password","login.loginButton":"Login","login.loggingIn":"Logging in..."}},Ad=m.createContext(void 0),Bm=({children:e})=>{const[t,n]=m.useState("zh-TW"),s=o=>Um[t][o]||o;return r.jsx(Ad.Provider,{value:{language:t,setLanguage:n,t:s},children:e})},mt=()=>{const e=m.useContext(Ad);if(e===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return e};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zm={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gm=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Oe=(e,t)=>{const n=m.forwardRef(({color:s="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:a,className:i="",children:c,...h},d)=>m.createElement("svg",{ref:d,...zm,width:o,height:o,stroke:s,strokeWidth:a?Number(l)*24/Number(o):l,className:["lucide",`lucide-${Gm(e)}`,i].join(" "),...h},[...t.map(([g,p])=>m.createElement(g,p)),...Array.isArray(c)?c:[c]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=Oe("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=Oe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=Oe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=Oe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=Oe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yl=Oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=Oe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=Oe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=Oe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=Oe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=Oe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xm=Oe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=Oe("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=Oe("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=Oe("ListX",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"m19 10-4 4",key:"1tz659"}],["path",{d:"m15 10 4 4",key:"1n7nei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=Oe("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=Oe("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=Oe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Km=Oe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=Oe("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=Oe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=Oe("Pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=Oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=Oe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=Oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bd=Oe("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=Oe("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nh=Oe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=Oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),rh=()=>{const{sidebarOpen:e,setSidebarOpen:t}=Ke(),{t:n}=mt();return r.jsx("div",{className:"fixed top-4 left-4 z-30",children:r.jsx("nav",{className:"bg-white/95 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg px-2 py-1",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("a",{href:"../frontpage",className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors",title:n("nav.home"),children:r.jsx(li,{className:"w-5 h-5"})}),r.jsx("div",{className:"ml-2 text-lg font-semibold text-gray-900",children:n("nav.title")}),r.jsx("button",{onClick:()=>t(!e),className:"ml-8 p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors",title:n(e?"nav.collapseSidebar":"nav.expandSidebar"),children:e?r.jsx(da,{className:"w-6 h-6"}):r.jsx(da,{className:"w-6 h-6"})})]})})})},sh=()=>{const{viewMode:e,setViewMode:t,logout:n,currentUser:s,selectedDepartmentType:o,openAddDepartmentModal:l,apiDepartmentData:a,allDepartmentsList:i}=Ke(),{language:c,setLanguage:h,t:d}=mt(),[g,p]=to.useState(!1),b=()=>{h(c==="zh-TW"?"en":"zh-TW")},w=to.useMemo(()=>{if(!o||!i||!a)return!1;const D=a.map(f=>f.name);return i.filter(f=>f["department_type "]===o).filter(f=>!D.includes(f.name)).length>0},[o,i,a]);return r.jsx("div",{className:"fixed top-20 left-4 right-auto sm:top-4 sm:left-auto sm:right-4 z-30",children:r.jsx("div",{className:"bg-white/95 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg px-2 py-1 sm:px-3 sm:py-2",children:r.jsxs("div",{className:"flex items-center gap-2 lg:gap-0 lg:space-x-2 flex-col lg:flex-row relative",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[r.jsxs("button",{onClick:()=>t("medicine"),className:`flex items-center space-x-2 px-3 py-1.5 rounded-md transition-all duration-300 ease-in-out transform ${e==="medicine"?"bg-white text-green-600 shadow-sm scale-105":"text-gray-600 hover:text-gray-900 hover:bg-gray-50 hover:scale-102"}`,children:[r.jsx(Zm,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:d("topbar.medicine")})]}),r.jsxs("button",{onClick:()=>t("department"),className:`flex items-center space-x-2 px-3 py-1.5 rounded-md transition-all duration-300 ease-in-out transform ${e==="department"?"bg-white text-blue-600 shadow-sm scale-105":"text-gray-600 hover:text-gray-900 hover:bg-gray-50 hover:scale-102"}`,children:[r.jsx(Od,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:d("topbar.department")})]})]}),r.jsx("button",{onClick:()=>p(!g),className:"lg:hidden flex items-center justify-center p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors",children:g?r.jsx(Wm,{className:"w-4 h-4"}):r.jsx($d,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:`
            flex items-center gap-2 lg:gap-0 lg:space-x-2 flex-col lg:flex-row
            lg:flex lg:opacity-100 lg:max-h-none
            transition-all duration-300 ease-in-out overflow-hidden
            ${g?"flex opacity-100 max-h-96":"hidden opacity-0 max-h-0 lg:flex lg:opacity-100 lg:max-h-none"}
          `,children:[r.jsx("div",{className:"mx-1 w-full lg:w-px lg:h-6 h-px bg-gray-300"}),o&&w&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>l(),className:"w-full lg:w-auto flex justify-center items-center space-x-2 px-3 py-1.5 text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors border border-green-700",children:[r.jsx(vt,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:""})]}),r.jsx("div",{className:"w-full lg:w-px lg:h-6 h-px bg-gray-300"})]}),r.jsxs("button",{onClick:b,className:"w-full lg:w-auto flex justify-center items-center space-x-2 px-3 py-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors border",children:[r.jsx(Xm,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:d("topbar.language")})]}),r.jsx("div",{className:"w-full lg:w-px lg:h-6 h-px bg-gray-300"}),s&&r.jsx("div",{className:"w-full lg:w-auto flex justify-center items-center space-x-2 px-3 py-1.5 bg-gray-50 border border-gray-200 rounded-lg",children:r.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.Name})}),r.jsxs("button",{onClick:n,className:"w-full lg:w-auto flex items-center space-x-2 px-3 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 hover:text-red-700 border border-red-200 rounded-lg transition-colors justify-center",children:[r.jsx(Km,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:d("topbar.logout")})]})]})]})})})},oh=[{name:"",value:"blue",bgr:"255,0,0",bgColor:"white",textColor:"text-black"},{name:"",value:"green",bgr:"0,255,0",bgColor:"white",textColor:"text-black"},{name:"",value:"red",bgr:"0,0,255",bgColor:"white",textColor:"text-black"},{name:"",value:"yellow",bgr:"0,255,255",bgColor:"white",textColor:"text-black"},{name:"",value:"purple",bgr:"255,0,255",bgColor:"white",textColor:"text-black"},{name:"",value:"cyan",bgr:"255,255,0",bgColor:"white",textColor:"text-black"}],lh=({isOpen:e,onClose:t})=>{const[n,s]=m.useState("blue"),[o,l]=m.useState(1),[a,i]=m.useState(60),[c,h]=m.useState(""),[d,g]=m.useState(""),[p,b]=m.useState([]),[w,D]=m.useState([]),[N,u]=m.useState([]),[f,x]=m.useState(!1),[S,$]=m.useState(!1),M=m.useRef(null),A=m.useRef(null),k=m.useRef(null),F=m.useRef(null);m.useEffect(()=>{if(e){const y=localStorage.getItem("medMap_setting");if(y)try{const T=JSON.parse(y);s(T.light_color||"blue"),l(T.brightness!==void 0?T.brightness:1),i(T.light_sec!==void 0?T.light_sec:60),h(T.default_person||""),g(T.default_person_id||"")}catch(T){console.error(":",T),s("blue"),l(1),i(60),h(""),g("")}else s("blue"),l(1),i(60),h(""),g("");E()}},[e]),m.useEffect(()=>{const y=T=>{k.current&&!k.current.contains(T.target)&&M.current&&!M.current.contains(T.target)&&x(!1),F.current&&!F.current.contains(T.target)&&A.current&&!A.current.contains(T.target)&&$(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const E=async()=>{try{const y=await _e.getAllStaffInfo();y.Code===200&&y.Data&&b(y.Data)}catch(y){console.error(":",y)}},q=y=>{if(h(y),y.trim()===""){D([]),x(!1);return}const T=p.filter(C=>C.name&&C.name.toLowerCase().includes(y.toLowerCase()));D(T),x(T.length>0)},V=y=>{if(g(y),y.trim()===""){u([]),$(!1);return}const T=p.filter(C=>C.ID&&C.ID.toLowerCase().includes(y.toLowerCase()));u(T),$(T.length>0)},P=y=>{h(y.name),g(y.ID),x(!1)},O=y=>{h(y.name),g(y.ID),$(!1)},ne=()=>{const y={light_color:n,brightness:o,light_sec:a,default_person:c,default_person_id:d};localStorage.setItem("medMap_setting",JSON.stringify(y)),console.log(":",y),t()};return e?r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),r.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 sticky top-0 bg-white z-10",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""}),r.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Xe,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"/"}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:""}),r.jsx("input",{ref:M,type:"text",value:c,onChange:y=>q(y.target.value),onFocus:()=>{c.trim()&&q(c)},placeholder:"",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),f&&r.jsx("div",{ref:k,className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:w.map((y,T)=>r.jsxs("div",{onClick:()=>P(y),className:"px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[r.jsx("div",{className:"font-medium text-gray-900",children:y.name}),r.jsx("div",{className:"text-xs text-gray-500",children:y.ID})]},T))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:" ID"}),r.jsx("input",{ref:A,type:"text",value:d,onChange:y=>V(y.target.value),onFocus:()=>{d.trim()&&V(d)},placeholder:" ID",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),S&&r.jsx("div",{ref:F,className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:N.map((y,T)=>r.jsxs("div",{onClick:()=>O(y),className:"px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[r.jsx("div",{className:"font-medium text-gray-900",children:y.ID}),r.jsx("div",{className:"text-xs text-gray-500",children:y.name})]},T))})]})]}),r.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"/"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" (BGR)"}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:oh.map(y=>r.jsxs("button",{onClick:()=>s(y.value),className:`
                    relative p-3 rounded-lg border-2 transition-all
                    ${y.bgColor} ${y.textColor}
                    ${n===y.value?"border-gray-900 shadow-lg scale-105":"border-gray-300 hover:border-gray-400 hover:shadow-md"}
                  `,children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"font-semibold text-sm mb-1",children:y.name}),r.jsx("div",{className:"text-xs opacity-90",children:y.bgr})]}),n===y.value&&r.jsx("div",{className:"absolute top-1 right-1 w-3 h-3 bg-white rounded-full border-2 border-gray-900"})]},y.value))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[": ",o.toFixed(1)]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:o,onChange:y=>l(parseFloat(y.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600",style:{background:`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${o*100}%, #e5e7eb ${o*100}%, #e5e7eb 100%)`}}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[r.jsx("span",{children:"0"}),r.jsx("span",{children:"0.5"}),r.jsx("span",{children:"1"})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[" (): ",a]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"range",min:"1",max:"120",step:"1",value:a,onChange:y=>i(parseInt(y.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600",style:{background:`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${(a-1)/119*100}%, #e5e7eb ${(a-1)/119*100}%, #e5e7eb 100%)`}}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[r.jsx("span",{children:"5"}),r.jsx("span",{children:"60"}),r.jsx("span",{children:"120"})]})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 bg-gray-50 rounded-b-xl sticky bottom-0",children:[r.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:""}),r.jsx("button",{onClick:ne,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:""})]})]})]}):null},ah=()=>{const{sidebarOpen:e,setSidebarOpen:t,selectedDepartmentType:n,setSelectedDepartmentType:s,setApiDepartmentData:o,isLoadingMedMap:l,setIsLoadingMedMap:a,setAllDepartmentsList:i,isAdminMode:c,setIsAdminMode:h}=Ke(),{t:d}=mt(),[g,p]=m.useState(new Set),[b,w]=m.useState([]),[D,N]=m.useState(!0),[u,f]=m.useState([]),[x,S]=m.useState(!1),$=()=>{c?h(!1):prompt("")==="66437068"?h(!0):alert("")};m.useEffect(()=>{(async()=>{N(!0);try{const q=await _e.getDepartments();q.Code===200&&q.Data?(console.log(q.Data),w(q.Data),i(q.Data)):(console.error("API returned error:",q),w([]),i([]))}catch(q){console.error("Failed to fetch department data:",q),w([]),i([])}finally{N(!1)}})()},[]);const M=b.reduce((E,q)=>{const V=q["department_type "];return E[V]||(E[V]=[]),E[V].push(q),E},{}),A=E=>{const q=new Set(g);q.has(E)?q.delete(E):q.add(E),p(q)},k=async E=>{console.log(" :",E),s(E),await F(E),t(!1)},F=async E=>{console.log(" :",E),a(!0);try{const q=await _e.getMedMapByDepartment(E);if(q.Code===200&&q.Data){console.log(" API :",q.Data);const V=At.convertMedMapApiToFakeData(q.Data);if(!At.validateConvertedData(V)){console.error(" "),f([]);return}const O=At.generateConversionReport(q.Data,V);f(V),o(V),console.log(" "),console.log(" :",V),console.log(" :",O)}else console.error(" API :",q),f([]),o(null)}catch(q){console.error(" :",q),f([]),o(null)}finally{a(!1)}};return r.jsxs(r.Fragment,{children:[e&&r.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-40 lg:hidden",onClick:()=>t(!1)}),r.jsx("div",{className:`fixed w-80 bg-white/95 backdrop-blur-sm shadow-xl border border-gray-200/50 z-50 transform transition-all duration-300 ease-in-out h-screen h-svh ${e?"translate-x-0 opacity-100":"-translate-x-full opacity-0"}`,children:r.jsxs("div",{className:"flex flex-col h-screen h-svh",children:[r.jsx("div",{className:"flex-shrink-0 px-4 py-2 border-b border-gray-200/50",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("a",{href:"../frontpage",className:"text-gray-600 hover:text-gray-900 transition-colors p-2 rounded-lg hover:bg-gray-100/50",title:d("nav.home"),children:r.jsx(li,{className:"w-5 h-5"})}),r.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:d("sidebar.drugMap")})]}),r.jsx("button",{onClick:()=>t(!e),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors",title:d("sidebar.closeSidebar"),children:r.jsx(Qm,{className:"w-6 h-6"})})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:D?r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsx("div",{className:"text-gray-500",children:"Loading departments..."})}):r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-base font-semibold text-gray-700 mb-4",children:d("sidebar.departmentCategories")}),Object.entries(M).map(([E,q])=>r.jsxs("div",{className:"space-y-1",children:[r.jsxs("button",{onClick:()=>k(E),disabled:l,className:`w-full flex items-center justify-between p-3 rounded-lg transition-all duration-200 border ${n===E?"bg-blue-50 text-blue-700 border-blue-200 shadow-sm":"text-gray-700 hover:bg-gray-50 hover:shadow-sm border-transparent"} ${l?"opacity-50 cursor-not-allowed":""}`,children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[E==="B1F"?r.jsx(Od,{className:"w-4 h-4"}):r.jsx(th,{className:"w-4 h-4"}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"font-medium",children:E}),r.jsxs("div",{className:"text-xs text-gray-500",children:[q.length," ",d("sidebar.departments")]})]})]}),r.jsx("div",{onClick:V=>{V.stopPropagation(),A(E)},className:"p-1 hover:bg-gray-200/50 rounded transition-colors",children:g.has(E)?r.jsx($d,{className:"w-4 h-4"}):r.jsx(Vm,{className:"w-4 h-4"})})]}),g.has(E)&&r.jsx("div",{className:"ml-6 space-y-2",children:q.map(V=>r.jsx("div",{className:"p-3 text-base text-gray-600 bg-gray-50 rounded-lg",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"font-medium text-gray-800",children:V.name}),r.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${V.type===""?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:V.type})]})},V.GUID))})]},E))]})}),r.jsx("div",{className:"flex-shrink-0 px-4 py-3 border-t border-gray-200/50",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("label",{htmlFor:"admin-mode-toggle",className:"text-sm font-medium text-gray-700 cursor-pointer select-none",children:""}),r.jsx("button",{id:"admin-mode-toggle",role:"switch","aria-checked":c,onClick:$,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${c?"bg-blue-600":"bg-gray-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${c?"translate-x-6":"translate-x-1"}`})})]}),r.jsx("button",{onClick:()=>S(!0),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors",title:"",children:r.jsx(sn,{className:"w-5 h-5"})})]})})]})}),r.jsx(lh,{isOpen:x,onClose:()=>S(!1)})]})},ih=()=>{const{t:e}=mt();return r.jsx("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-30",children:r.jsx("div",{className:"bg-white/95 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg px-4 py-2",children:r.jsx("p",{className:"text-sm text-gray-600 font-medium whitespace-nowrap",children:e("footer.copyright")})})})},ch=({component:e,scale:t,isLocked:n,isHighlighted:s=!1,onContainerClick:o})=>{const l=m.useRef(null),{t:a}=mt(),{apiDepartmentData:i,setApiDepartmentData:c,showNotification:h}=Ke(),[d,g]=m.useState(!1),[p,b]=m.useState({x:0,y:0}),[w,D]=m.useState(e.position),[N,u]=m.useState(!1),[f,x]=m.useState(null),[S,$]=m.useState({x:0,y:0}),[M,A]=m.useState({x:0,y:0}),k=m.useCallback(async(U,ie)=>{if(!i)return;console.log(" :",U,ie);const xe=JSON.parse(JSON.stringify(i)),he=ce=>{for(const H of ce){if(H.GUID===U)return H.position={x:ie.x.toFixed(3),y:ie.y.toFixed(3)},console.log(" :",H.name,ie.x.toFixed(3),ie.y.toFixed(3)),!0;if(H.components&&Array.isArray(H.components)&&he(H.components)||H.contents&&Array.isArray(H.contents)&&he(H.contents))return!0}return!1};if(he(xe)){c(xe),console.log(" ");try{console.log(" ...");const ce=await _e.updateContainerPosition({GUID:U,absolute_position:`${ie.x.toFixed(3)},${ie.y.toFixed(3)}`});ce.Code===200?(console.log(" ",ce),h("","success")):(console.error(" :",ce),h(`: ${ce.Result||""}`,"error"))}catch(ce){console.error(" :",ce),h(": ","error")}}else console.warn(" :",U)},[i,c,h]),{position:F,dimensions:E,name:q,type:V}=e,P=m.useCallback(U=>{const ie=l.current;if(ie)if(A({x:U.clientX,y:U.clientY}),n){U.preventDefault(),U.stopPropagation(),ie.setPointerCapture(U.pointerId);const xe=ie.getBoundingClientRect(),he=U.clientX-xe.left,L=U.clientY-xe.top;b({x:he,y:L}),g(!0),u(!1)}else u(!1)},[n]),O=m.useCallback(()=>{if(!i)return[];const U=[],ie=xe=>{for(const he of xe)he.GUID!==e.GUID&&he.position&&U.push({GUID:he.GUID,position:he.position,dimensions:he.dimensions}),he.components&&Array.isArray(he.components)&&ie(he.components),he.contents&&Array.isArray(he.contents)&&ie(he.contents)};return ie(i),U},[i,e.GUID]),ne=m.useCallback((U,ie)=>{const he=O();let L=U,ce=ie;for(const H of he){const _=parseFloat(H.position.x),ee=parseFloat(H.position.y);if(Math.abs(U-_)<20&&(L=_),Math.abs(ie-ee)<20&&(ce=ee),H.dimensions&&e.dimensions){const I=_+parseFloat(H.dimensions.width),j=U+parseFloat(e.dimensions.width);Math.abs(j-I)<20&&(L=I-parseFloat(e.dimensions.width));const R=ee+parseFloat(H.dimensions.depth),z=ie+parseFloat(e.dimensions.depth);Math.abs(z-R)<20&&(ce=R-parseFloat(e.dimensions.depth))}}return{x:L,y:ce}},[O,e.dimensions]),y=m.useCallback(U=>{const ie=Math.abs(U.clientX-M.x),xe=Math.abs(U.clientY-M.y);if((ie>5||xe>5)&&u(!0),!d||!n)return;U.preventDefault(),U.stopPropagation();const he=l.current;if(!he)return;const L=he.closest("[data-canvas-content]");if(!L)return;const ce=L.getBoundingClientRect(),H=(U.clientX-ce.left-p.x)/t,_=(U.clientY-ce.top-p.y)/t,ee=ne(H,_);D(ee)},[d,p,t,n,ne,M]),T=m.useCallback(U=>{const ie=Math.abs(U.clientX-M.x),xe=Math.abs(U.clientY-M.y),he=ie>5||xe>5;if(n){if(!d)return;U.preventDefault(),U.stopPropagation();const L=l.current;L&&L.releasePointerCapture(U.pointerId),g(!1),he?k(e.GUID,w):o&&o(e),u(!1)}else!he&&o&&(U.preventDefault(),U.stopPropagation(),o(e)),u(!1)},[d,n,o,e,k,w,M]),C=m.useCallback(U=>{const ie=l.current;if(!ie)return;const xe=U.touches[0];if(xe&&($({x:xe.clientX,y:xe.clientY}),n)){U.preventDefault(),U.stopPropagation(),x(xe.identifier);const he=ie.getBoundingClientRect(),L=xe.clientX-he.left,ce=xe.clientY-he.top;b({x:L,y:ce}),g(!0)}},[n]),X=m.useCallback(U=>{if(!d||!n||f===null)return;U.preventDefault(),U.stopPropagation();const ie=l.current;if(!ie)return;const xe=Array.from(U.touches).find(ee=>ee.identifier===f);if(!xe)return;const he=ie.closest("[data-canvas-content]");if(!he)return;const L=he.getBoundingClientRect(),ce=(xe.clientX-L.left-p.x)/t,H=(xe.clientY-L.top-p.y)/t,_=ne(ce,H);D(_)},[d,p,t,n,f,ne]),fe=m.useCallback(U=>{const ie=Array.from(U.changedTouches)[0];if(!ie)return;const xe=Math.abs(ie.clientX-S.x),he=Math.abs(ie.clientY-S.y),L=xe>10||he>10;if(n){if(!d||f===null||!Array.from(U.changedTouches).some(H=>H.identifier===f))return;U.preventDefault(),U.stopPropagation(),g(!1),x(null),$({x:0,y:0}),L?k(e.GUID,w):o&&o(e)}else!L&&o&&(U.preventDefault(),U.stopPropagation(),o(e)),$({x:0,y:0})},[d,n,f,k,e,w,S,o]),Z=m.useCallback(U=>{!d||!n||f===null||!Array.from(U.changedTouches).some(xe=>xe.identifier===f)||(U.preventDefault(),U.stopPropagation(),D(e.position),g(!1),x(null),$({x:0,y:0}))},[d,n,f,e.position]),le=U=>{if(s)return"bg-green-100 border-green-500";switch(U){case"":return"bg-gray-100 border-gray-400";case"":return"bg-gray-100 border-gray-400";case"parent_container":return"bg-gray-100 border-gray-400";default:return"bg-gray-50 border-gray-400"}},Ne=U=>{if(s)return"highlight-breathe-green";switch(U){case"":return"bg-gray-300 text-gray-900";case"":return"bg-gray-300 text-gray-900";case"parent_container":return"bg-gray-300 text-gray-900";default:return"bg-gray-200 text-gray-800"}},ae=U=>{if(s)return"bg-green-600 text-white";switch(U){case"":return"bg-gray-700 text-white";case"":return"bg-gray-700 text-white";case"parent_container":return"bg-gray-700 text-white";default:return"bg-gray-600 text-white"}},we=U=>{const ie=U===""?"type.dispensingStation":U===""?"type.warehouse":U==="parent_container"?"":"type."+U;return a(ie)||U};return r.jsx("div",{ref:l,className:`flex flex-col absolute border-2 rounded-lg shadow-lg hover:shadow-xl ${le(V)} overflow-hidden ${n?"cursor-move":"cursor-default"} ${d?"shadow-2xl z-50":""}`,style:{left:`${w.x}px`,top:`${w.y}px`,minWidth:V===""||V===""?"120px":"180px",minHeight:V===""||V===""?"60px":"120px",userSelect:"none",touchAction:"none",transition:d?"none":"transform 0.2s ease-out, box-shadow 0.2s ease-out"},onPointerDown:P,onPointerMove:y,onPointerUp:T,onTouchStart:C,onTouchMove:X,onTouchEnd:fe,onTouchCancel:Z,children:r.jsx("div",{className:`w-full min-w-[400px] h-auto flex items-start flex-1 justify-between p-2 border-b border-gray-200 ${Ne(V)}`,children:r.jsx("div",{className:"flex space-x-2 flex-1 min-w-0",children:r.jsxs("div",{className:"min-w-0 flex gap-4",children:[r.jsx("div",{className:"font-semibold text-lg truncate",children:q}),r.jsx("div",{className:`text-sm truncate py-1 px-3 rounded-2xl ${ae(V)}`,children:we(V)})]})})})})},Fo=({isOpen:e,onClose:t,onScanSuccess:n,mode:s})=>{const{showNotification:o,openAddBarcodeModal:l}=Ke();console.log(" QRCodeScannerModal props:",{isOpen:e,mode:s,hasOnScanSuccess:!!n});const a=m.useRef(null),i=m.useRef(null),c=m.useRef(null),h=m.useRef(null),d=m.useRef(null),[g,p]=m.useState(!1),[b,w]=m.useState(""),[D,N]=m.useState(0),[u,f]=m.useState(null),[x,S]=m.useState(!1);m.useEffect(()=>{const q=()=>{const V=window.innerWidth<680;S(V)};return q(),window.addEventListener("resize",q),()=>window.removeEventListener("resize",q)},[]);const $=async()=>{try{w("");const q=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}}});c.current=q,a.current&&(a.current.srcObject=q,await a.current.play(),console.log(" Camera started, setting isScanning to true"),p(!0))}catch(q){console.error(":",q),w("")}},M=()=>{h.current&&(clearInterval(h.current),h.current=null),c.current&&(c.current.getTracks().forEach(q=>q.stop()),c.current=null),a.current&&(a.current.srcObject=null),p(!1)},A=async()=>{if(console.log(" captureAndScan called"),console.log(" videoRef.current:",!!a.current),console.log(" canvasRef.current:",!!i.current),console.log(" isScanning:",g),!a.current||!i.current||!g){console.log(" Early return: missing refs or not scanning");return}const q=Date.now();if(q-D<1e3){console.log(" Throttled: too soon since last scan");return}N(q);const V=a.current,P=i.current,O=P.getContext("2d");if(console.log(" video.readyState:",V.readyState),console.log(" HAVE_ENOUGH_DATA:",V.HAVE_ENOUGH_DATA),!O||V.readyState!==V.HAVE_ENOUGH_DATA){console.log(" Video not ready or no context");return}P.width=V.videoWidth,P.height=V.videoHeight,O.drawImage(V,0,0,P.width,P.height),P.toBlob(async ne=>{if(!ne)return;const y=new File([ne],"scan.jpg",{type:"image/jpeg"});try{console.log(" ...");const T=await _e.scanBarcode(y);if(!T.results||T.results.length===0){console.log(" ");return}const C=T.results[0];if(!C.code){console.log(" ");return}console.log(" :",C.code),console.log(" :",C.type),console.log(" :",C.conf),M(),t();try{const X=await _e.searchByBarCode(C.code);console.log(" :",X),X.Code===200?(console.log(" :",X.Data),console.log("  onScanSuccess, mode:",s),o("","success"),n?(console.log(" onScanSuccess "),n(C.code,X.Data),console.log(" onScanSuccess ")):console.warn(" onScanSuccess ")):X.Code===-200&&X.Result===""?(console.log(" "),o("","warning"),l(C.code)):(console.log(" :",X.Result),o(X.Result||"","error"))}catch(X){console.error(":",X),o("","error")}}catch(T){console.error(":",T)}},"image/jpeg",1)},k=()=>{h.current&&clearInterval(h.current),h.current=setInterval(()=>{A()},1e3)};m.useEffect(()=>(e?$():M(),()=>{M()}),[e]),m.useEffect(()=>{g&&!h.current?(console.log(" isScanning became true, starting interval"),k()):!g&&h.current&&(console.log(" isScanning became false, stopping interval"),h.current&&(clearInterval(h.current),h.current=null))},[g]);const F=()=>{M(),t()},E=async q=>{if(!c.current||!d.current)return;const V=d.current.getBoundingClientRect(),P=(q.clientX-V.left)/V.width,O=(q.clientY-V.top)/V.height;console.log(" :",{x:P,y:O}),f({x:q.clientX-V.left,y:q.clientY-V.top}),setTimeout(()=>f(null),1e3);try{const ne=c.current.getVideoTracks()[0],y=ne.getCapabilities();if(console.log(" :",y),!y.focusMode||!y.focusMode.includes("manual")){console.log(" ");return}const T={advanced:[{focusMode:"manual",focusDistance:0,pointsOfInterest:[{x:P,y:O}]}]};await ne.applyConstraints(T),console.log(" ")}catch(ne){console.log("  ():",ne)}};return e?x?r.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 bg-opacity-90",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Dr,{className:"w-6 h-6 text-white"}),r.jsx("h2",{className:"text-lg font-semibold text-white",children:""})]}),r.jsx("button",{onClick:F,className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:r.jsx(Xe,{className:"w-6 h-6 text-white"})})]}),r.jsxs("div",{className:"flex-1 relative",children:[r.jsxs("div",{ref:d,className:"absolute inset-0 bg-black cursor-crosshair",onClick:E,children:[r.jsx("video",{ref:a,className:"w-full h-full object-cover",playsInline:!0,muted:!0}),u&&r.jsxs("div",{className:"absolute pointer-events-none",style:{left:u.x,top:u.y,transform:"translate(-50%, -50%)"},children:[r.jsx("div",{className:"w-16 h-16 border-2 border-yellow-400 rounded-full animate-ping"}),r.jsx("div",{className:"absolute inset-0 w-16 h-16 border-2 border-yellow-400 rounded-full"}),r.jsxs("div",{className:"absolute inset-0 w-16 h-16 flex items-center justify-center",children:[r.jsx("div",{className:"w-1 h-16 bg-yellow-400"}),r.jsx("div",{className:"absolute w-16 h-1 bg-yellow-400"})]})]})]}),r.jsx("canvas",{ref:i,className:"hidden"})]}),r.jsxs("div",{className:"p-4 bg-gray-900 bg-opacity-90",children:[b&&r.jsx("div",{className:"bg-red-500 bg-opacity-20 border border-red-500 rounded-lg px-3 py-2 mb-3",children:r.jsx("p",{className:"text-red-200 text-sm",children:b})}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-white text-base font-medium mb-1",children:""}),r.jsx("p",{className:"text-gray-300 text-sm mb-1",children:"QR Code"}),r.jsx("p",{className:"text-gray-400 text-xs",children:" "})]})]})]}):r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full overflow-hidden flex flex-col max-h-[90vh]",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",children:r.jsx(Dr,{className:"w-6 h-6 text-blue-500"})}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:F,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Xe,{className:"w-6 h-6 text-gray-600"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[b&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg px-3 py-2 mb-4",children:r.jsx("p",{className:"text-red-600 text-sm",children:b})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{ref:d,className:"relative bg-black rounded-xl overflow-hidden cursor-crosshair",style:{aspectRatio:"16/9"},onClick:E,children:r.jsx("video",{ref:a,className:"w-full h-full object-cover",playsInline:!0,muted:!0})}),r.jsx("canvas",{ref:i,className:"hidden"}),r.jsxs("div",{className:"text-center rounded-lg pb-4",children:[r.jsx("p",{className:"text-gray-800 text-base font-medium mb-2",children:""}),r.jsx("p",{className:"text-gray-600 text-sm",children:"QR Code"}),r.jsx("p",{className:"text-gray-500 text-xs mt-1",children:" "})]})]})]})]})}):null},uh=({children:e})=>{const t=m.useRef(null),n=m.useRef(null),{selectedDepartmentType:s,apiDepartmentData:o,showNotification:l,openAddBarcodeModal:a,openContainerDetailModal:i,setHighlightedMedicineCode:c}=Ke(),{t:h}=mt(),[d,g]=m.useState({x:0,y:0,scale:1}),[p,b]=m.useState(!1),[w,D]=m.useState(!1),[N,u]=m.useState({x:0,y:0}),[f,x]=m.useState(!1),[S,$]=m.useState(!1),[M,A]=m.useState(""),[k,F]=m.useState([]),[E,q]=m.useState(null),V=()=>{try{const I=localStorage.getItem("med_map_anchor");return I?JSON.parse(I):[]}catch(I){return console.error("Error reading canvas states from localStorage:",I),[]}},P=(I,j,R,z)=>{try{const oe=V(),pe=oe.findIndex(ke=>ke.department===I&&ke.canvasType===j),ve={department:I,canvasType:j,scale:R,position:z};pe>=0?oe[pe]=ve:oe.push(ve),localStorage.setItem("med_map_anchor",JSON.stringify(oe))}catch(oe){console.error("Error saving canvas state to localStorage:",oe)}},O=(I,j)=>V().find(z=>z.department===I&&z.canvasType===j)||null;m.useEffect(()=>{if(s){const I=O(s,"InfiniteCanvas");if(I)g({x:I.position.x,y:I.position.y,scale:I.scale});else{const j={x:0,y:0,scale:1};g(j),P(s,"InfiniteCanvas",j.scale,j)}}},[s]),m.useEffect(()=>{if(!s)return;const I=setTimeout(()=>{P(s,"InfiniteCanvas",d.scale,{x:d.x,y:d.y})},500);return()=>clearTimeout(I)},[d,s]),m.useEffect(()=>{const I=R=>{R.code==="Space"&&!R.repeat&&(R.preventDefault(),x(!0))},j=R=>{R.code==="Space"&&(R.preventDefault(),x(!1),b(!1))};return window.addEventListener("keydown",I),window.addEventListener("keyup",j),()=>{window.removeEventListener("keydown",I),window.removeEventListener("keyup",j)}},[]);const ne=m.useCallback(I=>{var R;if(w)return;if(I.ctrlKey&&!navigator.userAgent.includes("Mac")||I.metaKey&&navigator.userAgent.includes("Mac")){I.preventDefault(),I.stopPropagation();const z=(R=t.current)==null?void 0:R.getBoundingClientRect();if(!z)return;const oe=I.clientX-z.left,pe=I.clientY-z.top,ve=I.deltaY>0?.9:1.1,ke=Math.max(.1,Math.min(5,d.scale*ve)),De=ke/d.scale,Me=oe-(oe-d.x)*De,me=pe-(pe-d.y)*De;g({x:Me,y:me,scale:ke})}},[d,w]),y=m.useCallback(I=>{w||!f||(b(!0),u({x:I.clientX,y:I.clientY}),I.preventDefault())},[w,f]),T=m.useCallback(I=>{if(!p||w)return;const j=I.clientX-N.x,R=I.clientY-N.y;g(z=>({...z,x:z.x+j,y:z.y+R})),u({x:I.clientX,y:I.clientY})},[p,N,w]),C=m.useCallback(()=>{b(!1)},[]),X=m.useCallback(I=>{if(!o)return[];const j=[],R=z=>{for(const oe of z)oe.med_list&&Array.isArray(oe.med_list)&&oe.med_list.some(ve=>ve.code==I)&&(console.log(" :",oe.name,oe.GUID),j.push(oe.GUID)),oe.components&&Array.isArray(oe.components)&&R(oe.components),oe.contents&&Array.isArray(oe.contents)&&R(oe.contents)};return R(o),j},[o]),fe=m.useCallback(()=>{try{const j=localStorage.getItem("medMap_setting");if(j){const z=JSON.parse(j).light_sec;if(z!=null&&z!==""){const oe=Number(z);if(!isNaN(oe)&&oe>0)return oe*1e3}}}catch(j){console.error(":",j)}return 6e4},[]),Z=m.useCallback(I=>{if(!I.trim())return;n.current&&(clearTimeout(n.current),n.current=null),console.log(" :",I);const j=X(I);if(j.length>0){const R=fe();console.log(`  ${j.length} :`,j),console.log(` : ${R}ms (${R/1e3})`),F(j),q(I),c(I),n.current=setTimeout(()=>{console.log(" "),F([]),q(null),c(null),n.current=null},R)}else console.log(" "),F([]),q(null),c(null)},[X,fe,c]),le=(I,j)=>{var z,oe;console.log("  - :",{barcode:I,medicineData:j});const R=((z=j[0])==null?void 0:z.CODE)||((oe=j[0])==null?void 0:oe.code);$(!1),Z(R)},Ne=async I=>{var j,R;if(I.key==="Enter"){if(I.preventDefault(),!M.trim()){l("","warning");return}try{console.log(" :",M);const z=await _e.searchByBarCode(M);if(console.log(" :",z),z.Code===200&&z.Data&&z.Data.length>0){const oe=((j=z.Data[0])==null?void 0:j.CODE)||((R=z.Data[0])==null?void 0:R.code);console.log(" :",z.Data),l("","success"),Z(oe)}else z.Code===-200&&z.Result===""?(console.log(" "),l("","warning"),a(M)):(console.log(" :",z.Result),l(z.Result||"","error"))}catch(z){console.error(":",z),l("","error")}}};m.useEffect(()=>()=>{n.current&&clearTimeout(n.current)},[]);const[ae,we]=m.useState(null),[U,ie]=m.useState({x:0,y:0}),xe=I=>{if(I.length<2)return null;const j=I[0],R=I[1];return Math.sqrt(Math.pow(R.clientX-j.clientX,2)+Math.pow(R.clientY-j.clientY,2))},he=I=>{if(I.length===1)return{x:I[0].clientX,y:I[0].clientY};const j=I[0],R=I[1];return{x:(j.clientX+R.clientX)/2,y:(j.clientY+R.clientY)/2}},L=m.useCallback(I=>{if(!w){if(I.touches.length===2){const j=xe(I.touches),R=he(I.touches);we(j),ie(R)}else if(I.touches.length===1){const j=I.touches[0];u({x:j.clientX,y:j.clientY}),b(!0)}}},[w]),ce=m.useCallback(I=>{var j;if(!w){if(I.preventDefault(),I.touches.length===2&&ae!==null){const R=xe(I.touches),z=he(I.touches);if(R&&ae){const oe=(j=t.current)==null?void 0:j.getBoundingClientRect();if(!oe)return;const pe=R/ae,ve=Math.max(.1,Math.min(5,d.scale*pe)),ke=z.x-oe.left,De=z.y-oe.top,Me=ve/d.scale,me=ke-(ke-d.x)*Me,ye=De-(De-d.y)*Me;g({x:me,y:ye,scale:ve}),we(R),ie(z)}}else if(I.touches.length===1&&p){const R=I.touches[0],z=R.clientX-N.x,oe=R.clientY-N.y;g(pe=>({...pe,x:pe.x+z,y:pe.y+oe})),u({x:R.clientX,y:R.clientY})}}},[d,ae,p,N,w]),H=m.useCallback(()=>{we(null),b(!1)},[]);m.useEffect(()=>{const I=t.current;if(I)return I.addEventListener("wheel",ne,{passive:!1}),()=>I.removeEventListener("wheel",ne)},[ne]),m.useCallback(()=>{g({x:0,y:0,scale:1})},[]);const ee=(()=>{if(!o||o.length===0)return[];const I=o,j=[];for(const R of I)if(R.type===""||R.type==="")for(const z of R.contents)j.push({GUID:z.GUID,type:z.type,name:`${z.name}`,position:z.position,dimensions:z.dimensions,med_list:z.med_list,serverName:z.serverName,serverType:z.serverType,Master_GUID:R.GUID,contents:z.contents||[]});else R.componets&&R.componets.length>0&&j.push(...R.componets);return j})();return r.jsxs("div",{className:"relative w-full h-full overflow-hidden bg-gray-50",children:[r.jsx("div",{className:"absolute md:bottom-4 md:left-4 bottom-16 left-[50%] md:translate-x-[0%] translate-x-[-50%] z-10",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg flex items-center overflow-hidden border border-gray-200",children:[r.jsx("input",{type:"text",value:M,onChange:I=>A(I.target.value),onKeyPress:Ne,placeholder:"...",className:"px-4 py-2 w-50 focus:outline-none text-gray-700 disabled:opacity-50"}),r.jsx("button",{onClick:()=>$(!0),className:"p-2",title:"",children:r.jsx(Dr,{className:"w-6 h-6 text-blue-600"})})]})}),r.jsx("div",{className:"absolute bottom-4 right-4 z-10 flex gap-2",children:r.jsx("button",{onClick:()=>D(!w),className:`p-3 rounded-lg shadow-lg transition-colors ${w?"bg-red-500 text-white hover:bg-red-600":"bg-white text-gray-700 hover:bg-gray-50"}`,title:h(w?"canvas.unlockCanvas":"canvas.lockCanvas"),children:w?r.jsx(Ud,{className:"w-6 h-6"}):r.jsx(Bd,{className:"w-6 h-6"})})}),r.jsx("div",{ref:t,className:`w-full h-full relative ${f&&!w?"cursor-grab":"cursor-default"} ${p?"cursor-grabbing":""}`,onMouseDown:y,onMouseMove:T,onMouseUp:C,onMouseLeave:C,onTouchStart:L,onTouchMove:ce,onTouchEnd:H,children:r.jsxs("div",{className:"absolute inset-0 origin-top-left",style:{transform:`translate(${d.x}px, ${d.y}px) scale(${d.scale})`,transformOrigin:"0 0"},children:[r.jsx("div",{className:"absolute",style:{left:-1e4,top:-1e4,width:2e4,height:2e4,backgroundImage:`
                linear-gradient(to right, #e5e7eb 1px, transparent 1px),
                linear-gradient(to bottom, #e5e7eb 1px, transparent 1px)
              `,backgroundSize:"50px 50px"}}),r.jsxs("div",{className:"relative","data-canvas-content":!0,children:[ee.map(I=>r.jsx(ch,{component:I,scale:d.scale,isLocked:w,isHighlighted:k.includes(I.GUID),onContainerClick:j=>{console.log(" :",E),i(j,E)}},I.GUID)),e]})]})}),r.jsx(Fo,{isOpen:S,onClose:()=>$(!1),onScanSuccess:le,mode:"med_light_location_mode"})]})},zs=({content:e,isAdminMode:t})=>{const{openMedBoxModal:n,openAddMedBoxModal:s,openListDrawModal:o,openGridDrawModal:l,openAddShelfDrawContainerModal:a,openAddSubContainerModal:i,openAddStoreItemModal:c,setSelectedMedBox:h,setModalMode:d,setMedBoxModalOpen:g,showNotification:p,triggerRefresh:b,openEditStoreShelfModal:w,reloadMedMapData:D}=Ke(),{t:N}=mt(),[u,f]=m.useState(!1),[x,S]=m.useState(""),[$,M]=m.useState(!1),[A,k]=m.useState(e.name);m.useEffect(()=>{k(e.name)},[e.name]);const F=y=>{y.stopPropagation(),S(e.name||""),f(!0)},E=y=>{y.stopPropagation(),f(!1),S("")},q=async y=>{if(y.stopPropagation(),!x.trim()){p("","error");return}if(x===e.name){f(!1);return}M(!0);try{const T=[{GUID:e.GUID,name:x.trim(),Master_GUID:e.Master_GUID,position:e.gird_position,serverName:e.serverName,serverType:e.serverType}];let C;if(e.type==="store_shelves"||e.type==="dispensing_shelves")C=await _e.updateMedMapShelf(T);else if(e.type==="sub_container")C=await _e.updateSubSection(T);else{p("","error"),M(!1);return}C.Code===200?(p("","success"),f(!1),await D()):p(C.Result||"","error")}catch(T){console.error(":",T),p("","error")}finally{M(!1)}},V=y=>{switch(y){case"parent_container":return"bg-pink-100";case"sub_container":return"bg-blue-100";case"dispensing_shelves":case"store_shelves":return"bg-green-100";case"med_box":return"bg-yellow-100";case"grid_draw":case"list_draw":return"bg-violet-100";default:return"bg-gray-100"}},P=y=>{switch(y){case"parent_container":return"border-pink-200";case"sub_container":return"border-blue-200";case"dispensing_shelves":case"store_shelves":return"border-green-200";case"med_box":return"border-yellow-200";case"grid_draw":case"list_draw":return"border-violet-200";default:return"border-gray-200"}},O=y=>{switch(y){case"parent_container":return"bg-pink-400";case"sub_container":return"bg-blue-400";case"dispensing_shelves":case"store_shelves":return"bg-green-400";case"med_box":return"bg-yellow-400";case"grid_draw":case"list_draw":return"bg-violet-400";default:return"bg-gray-200"}},ne=y=>{switch(y){case"parent_container":return N("type.parentContainer");case"sub_container":return N("type.subContainer");case"dispensing_shelves":return N("type.medBoxShelf");case"store_shelves":return N("type.storeShelf");case"grid_draw":return N("type.gridDraw");case"list_draw":return N("type.listDraw");case"med_box":return N("type.medBox");default:return y}};switch(e.type){case"sub_container":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${V(e.type||0)} ${P(e.type||0)}`,children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6 flex-1",children:[u?r.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[r.jsx("input",{type:"text",value:x,onChange:y=>S(y.target.value),onClick:y=>y.stopPropagation(),className:"text-base font-semibold text-gray-800 border-2 border-blue-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:$,autoFocus:!0}),r.jsx("button",{onClick:q,disabled:$,className:"p-1 hover:bg-green-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(yl,{className:"w-5 h-5 text-green-600"})}),r.jsx("button",{onClick:E,disabled:$,className:"p-1 hover:bg-red-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(Xe,{className:"w-5 h-5 text-red-600"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:A}),r.jsx("button",{onClick:F,className:"p-1 hover:bg-black/10 rounded transition-colors",title:"",children:r.jsx(eo,{className:"w-4 h-4 text-gray-600"})})]}),e.type!="parent_container"&&!u&&r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${O(e.type)}`,children:ne(e.type)})]}),e.type!=="none"&&!u&&r.jsx("div",{className:"flex items-center space-x-1",children:r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:y=>{y.stopPropagation(),a(e)},title:N("modal.add"),children:r.jsx(vt,{className:"w-6 h-6 text-green-700"})})})]});case"parent_container":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${V(e.type||0)} ${P(e.type||0)}`,children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6",children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:e.name}),e.type!="parent_container"?r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${O(e.type)}`,children:ne(e.type)}):null]}),e.type!=="none"&&r.jsx("div",{className:"flex items-center space-x-1",children:r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:y=>{y.stopPropagation(),i(e)},title:N("modal.add"),children:r.jsx(vt,{className:"w-6 h-6 text-green-700"})})})]});case"med_box":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${V(e.type||0)} ${P(e.type||0)}`,children:[r.jsx("div",{className:"flex items-center mr-4",children:e.type!="parent_container"?r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${O(e.type)}`,children:ne(e.type)}):null}),r.jsx("div",{className:"flex items-center space-x-1",children:r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:y=>{y.stopPropagation(),n(e)},title:N("modal.settings"),children:r.jsx(sn,{className:"w-6 h-6 text-gray-600"})})})]});case"dispensing_shelves":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${V(e.type||0)} ${P(e.type||0)}`,children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6 flex-1",children:[u?r.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[r.jsx("input",{type:"text",value:x,onChange:y=>S(y.target.value),onClick:y=>y.stopPropagation(),className:"text-base font-semibold text-gray-800 border-2 border-blue-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:$,autoFocus:!0}),r.jsx("button",{onClick:q,disabled:$,className:"p-1 hover:bg-green-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(yl,{className:"w-5 h-5 text-green-600"})}),r.jsx("button",{onClick:E,disabled:$,className:"p-1 hover:bg-red-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(Xe,{className:"w-5 h-5 text-red-600"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:A}),r.jsx("button",{onClick:F,className:"p-1 hover:bg-black/10 rounded transition-colors",title:"",children:r.jsx(eo,{className:"w-4 h-4 text-gray-600"})})]}),e.type!="parent_container"&&!u&&r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${O(e.type)}`,children:ne(e.type)})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:y=>{y.stopPropagation();const T={GUID:`new_medbox_${Date.now()}`,name:"",box_type:"",width:[],width_index:0,med_info:[],parentShelf:e};h(T),d("add"),g(!0)},title:N("modal.add"),children:r.jsx(vt,{className:"w-6 h-6 text-green-700"})}),r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:y=>{},title:N("modal.settings"),children:r.jsx(sn,{className:"w-6 h-6 text-gray-600"})})]})]});case"store_shelves":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${V(e.type||0)} ${P(e.type||0)} cursor-pointer hover:bg-black/5 transition-colors`,onClick:y=>{u||w(e)},children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6 flex-1",children:[u?r.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[r.jsx("input",{type:"text",value:x,onChange:y=>S(y.target.value),onClick:y=>y.stopPropagation(),className:"text-base font-semibold text-gray-800 border-2 border-blue-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:$,autoFocus:!0}),r.jsx("button",{onClick:y=>{y.stopPropagation(),q(y)},disabled:$,className:"p-1 hover:bg-green-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(yl,{className:"w-5 h-5 text-green-600"})}),r.jsx("button",{onClick:y=>{y.stopPropagation(),E(y)},disabled:$,className:"p-1 hover:bg-red-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(Xe,{className:"w-5 h-5 text-red-600"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:A}),r.jsx("button",{onClick:y=>{y.stopPropagation(),F(y)},className:"p-1 hover:bg-black/10 rounded transition-colors",title:"",children:r.jsx(eo,{className:"w-4 h-4 text-gray-600"})})]}),e.type!="parent_container"&&!u&&r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${O(e.type)}`,children:ne(e.type)})]}),r.jsx("div",{className:"flex items-center space-x-1",children:r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:y=>{y.stopPropagation(),c(e)},title:N("modal.add"),children:r.jsx(vt,{className:"w-6 h-6 text-green-700"})})})]});case"list_draw":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${V(e.type||0)} ${P(e.type||0)}`,children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6",children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:e.name}),e.type!="parent_container"?r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${O(e.type)}`,children:ne(e.type)}):null]}),r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:y=>{y.stopPropagation(),o(e)},title:N("modal.settings"),children:r.jsx(sn,{className:"w-6 h-6 text-gray-600"})})]});case"grid_draw":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${V(e.type||0)} ${P(e.type||0)}`,children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6",children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:e.name}),e.type!="parent_container"?r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${O(e.type)}`,children:ne(e.type)}):null]}),r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:y=>{y.stopPropagation(),l(e)},title:N("modal.settings"),children:r.jsx(sn,{className:"w-6 h-6 text-gray-600"})})]});default:return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${V(e.type||0)} ${P(e.type||0)}`,children:[r.jsx("div",{className:"flex items-center space-x-2 mr-6",children:e.type!="parent_container"?r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${O(e.type)}`,children:ne(e.type)}):null}),e.type!=="none"&&r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",title:N("modal.settings"),children:r.jsx(sn,{className:"w-6 h-6 text-gray-600"})})]})}},zd=m.forwardRef(({children:e},t)=>{const n=m.useRef(null),{selectedDepartmentType:s,apiDepartmentData:o,setSidebarOpen:l,openAddParentContainerModal:a,openEditStoreItemModal:i,openQRCodeScannerModal:c,openAddBarcodeModal:h,showNotification:d,isAdminMode:g}=Ke(),[p,b]=m.useState({x:0,y:0,scale:1}),[w,D]=m.useState(!1),[N,u]=m.useState(!1),[f,x]=m.useState({x:0,y:0}),[S,$]=m.useState(!1),[M,A]=m.useState(""),[k,F]=m.useState(!1),[E,q]=m.useState(null),[V,P]=m.useState(!1),[O,ne]=m.useState({isDragging:!1,draggedContainer:null,draggedElement:null,floatingElement:null,originalParent:null,originalPosition:"",originalIndex:-1,mouseOffset:{x:0,y:0},isMobileDrag:!1,originalData:null,draggedStockItem:null,draggedStockShelf:null}),[y,T]=m.useState(null),C=m.useRef({}),X=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window||navigator.maxTouchPoints>0,fe=8,Z=()=>{try{const v=localStorage.getItem("med_map_anchor");return v?JSON.parse(v):[]}catch(v){return console.error("Error reading canvas states from localStorage:",v),[]}},le=(v,Y,Q,G)=>{try{const J=Z(),B=J.findIndex(te=>te.department===v&&te.canvasType===Y),re={department:v,canvasType:Y,scale:Q,position:G};B>=0?J[B]=re:J.push(re),localStorage.setItem("med_map_anchor",JSON.stringify(J))}catch(J){console.error("Error saving canvas state to localStorage:",J)}},Ne=(v,Y)=>Z().find(G=>G.department===v&&G.canvasType===Y)||null;m.useEffect(()=>{if(s){const v=Ne(s,"drugCanvas");if(v)b({x:v.position.x,y:v.position.y,scale:v.scale});else{const Y={x:0,y:0,scale:1};b(Y),le(s,"drugCanvas",Y.scale,Y)}}},[s]),m.useEffect(()=>{if(!s)return;const v=setTimeout(()=>{le(s,"drugCanvas",p.scale,{x:p.x,y:p.y})},500);return()=>clearTimeout(v)},[p,s]);const ae=v=>["parent_container","sub_container","dispensing_shelves","store_shelves","grid_draw","list_draw","med_box"].includes(v),we=v=>({parent_container:["parent_container","",""],sub_container:["parent_container","sub_container"],dispensing_shelves:["dispensing_shelves","store_shelves","sub_container","grid_draw","list_draw"],store_shelves:["dispensing_shelves","store_shelves","sub_container","grid_draw","list_draw"],grid_draw:["grid_draw","list_draw","sub_container","dispensing_shelves","store_shelves"],list_draw:["grid_draw","list_draw","sub_container","dispensing_shelves","store_shelves"],med_box:["med_box","dispensing_shelves"]})[v]||[],U=v=>{const[Y,Q]=v.split(",").map(Number);return{row:Y||0,col:Q||0}},ie=(v,Y)=>`${v},${Y}`,xe=(v,Y)=>{const Q=(J,B=null)=>{if(J.GUID===v)return{container:J,parent:B};if(J.contents)for(const re of J.contents){const te=Q(re,J);if(te)return te}return null},G=nt();for(const J of G){const B=Q(J);if(B)return B}return null},he=(v,Y)=>{if(!v.contents)return;const{sortedContents:Q,maxRow:G,maxCol:J}=Ce(v.contents),B=Y;if(!B)return;const re=U(B.gird_position);console.log(G),console.log(J),console.log(B),console.log(re);for(let te=0;te<Q.length;te++){const K=Q[te],W=U(K.gird_position);if(W.row===re.row&&W.col>re.col)K.gird_position=ie(W.row,W.col-1),C.current[K.GUID]={GUID:K.GUID,Master_GUID:v.GUID,position:`${W.row},${W.col-1}`,serverName:v.serverName,serverType:v.serverType,type:K.type};else if(W.row>re.row){const de=W.col===0?J:W.col-1,ue=W.col===0?W.row-1:W.row;K.gird_position=ie(ue,de),C.current[K.GUID]={GUID:K.GUID,Master_GUID:v.GUID,position:`${ue},${de}`,serverName:v.serverName,serverType:v.serverType,type:K.type}}}return console.log("",Q),Q},L=(v,Y,Q,G,J)=>{v.contents||(v.contents=[]);let B=Math.max(1,...v.contents.map(K=>U(K.gird_position||"0,0").col+1)),re=Math.max(1,...v.contents.map(K=>U(K.gird_position||"0,0").row+1));console.log("--------",v),console.log("",B),console.log("",re),(v.type=="sub_container"||v.type=="parent_container"||v.type==""||v.type=="")&&(B=+v.oriMaxCol+1),J!=null&&J==="right"&&Y.type!=="med_box"&&G==B&&(Q=Q+1,v.contents.filter(W=>`${Q},0`==W.gird_position).length>0?G=B-1:G=0),console.log(Q),console.log(G);const te=v.contents.filter(K=>{const W=U(K.gird_position||"0,0");return W.row>Q||W.row===Q&&W.col>=G});te.sort((K,W)=>{const de=U(K.gird_position||"0,0"),ue=U(W.gird_position||"0,0");return de.row!==ue.row?ue.row-de.row:ue.col-de.col}),console.log("",te),te.forEach(K=>{const W=U(K.gird_position||"0,0");let de=W.row,ue=W.col;K.type==="med_box"||ue<B-1?ue+=1:(de+=1,ue=0),K.gird_position=`${de},${ue}`,C.current[K.GUID]={GUID:K.GUID,Master_GUID:v.GUID,position:`${de},${ue}`,serverName:v.serverName,serverType:v.serverType,type:K.type},console.log(`Shifted container ${K.GUID} from ${W.row},${W.col} to ${de},${ue}`)}),v.contents.length==0&&(Q=0,G=0),Y.gird_position=`${Q},${G}`,Y.Master_GUID=v.GUID,console.log(`Inserted container ${Y.GUID} at position ${Q},${G}`),v.contents.push(Y),C.current[Y.GUID]={GUID:Y.GUID,Master_GUID:v.GUID,position:`${Q},${G}`,serverName:v.serverName,serverType:v.serverType,type:Y.type},Y.type==="dispensing_shelves"&&Y.contents&&Y.contents.forEach(K=>{K.type==="med_box"&&(C.current[K.GUID]={GUID:K.GUID,Master_GUID:K.Master_GUID,position:K.gird_position,serverName:v.serverName,serverType:v.serverType,type:K.type})})},ce=(v,Y,Q)=>{const G=v.getBoundingClientRect(),J=G.left+G.width/2,B=G.top+G.height/2,re=Y-J,te=Q-B;return Math.abs(re)>Math.abs(te)?re>0?"right":"left":te>0?"bottom":"top"},H=(v,Y,Q,G)=>{if(!N)return;G.preventDefault(),G.stopPropagation();const J=X(),B="touches"in G?G.touches[0].clientX:("pointerId"in G,G.clientX),re="touches"in G?G.touches[0].clientY:("pointerId"in G,G.clientY),te=Q.getBoundingClientRect(),K={x:B-te.left,y:re-te.top},W=Q.cloneNode(!0);W.style.position="fixed",W.style.left=`${B-K.x}px`,W.style.top=`${re-K.y}px`,W.style.width=`${te.width}px`,W.style.height=`${te.height}px`,W.style.zIndex="9999",W.style.opacity="0.8",W.style.boxShadow="0 10px 25px rgba(0,0,0,0.3)",W.style.pointerEvents="none",document.body.appendChild(W),console.log(" stockItem:",v),console.log(" shelf:",Y),ne({isDragging:!0,draggedContainer:null,draggedElement:Q,floatingElement:W,originalParent:null,originalPosition:"",originalIndex:-1,mouseOffset:K,isMobileDrag:J,originalData:null,draggedStockItem:v,draggedStockShelf:Y})},_=(v,Y,Q)=>{if(!N||!ae(v.type))return;C.current={},Q.preventDefault(),Q.stopPropagation();const G=X(),J="touches"in Q?Q.touches[0].clientX:("pointerId"in Q,Q.clientX),B="touches"in Q?Q.touches[0].clientY:("pointerId"in Q,Q.clientY),re=Y.getBoundingClientRect(),te={x:J-re.left,y:B-re.top},K=xe(v.GUID);if(!K)return;console.log("",v),console.log("",K);const W=Y.cloneNode(!0);if(W.style.position="fixed",W.style.left=`${J-te.x}px`,W.style.top=`${B-te.y}px`,W.style.width=`${re.width}px`,W.style.height=`${re.height}px`,W.style.zIndex="9999",W.style.opacity="0.8",W.style.boxShadow="0 10px 25px rgba(0,0,0,0.3)",W.style.pointerEvents="none",document.body.appendChild(W),G){const de=K.parent.contents.findIndex(Se=>Se.GUID===v.GUID);K.parent.contents.splice(de,1),console.log(de),K.parent;const ue=he(K.parent,v);K.parent.contents=ue,console.log(K.parent),ne({isDragging:!0,draggedContainer:v,draggedElement:Y,floatingElement:W,originalParent:K.parent,originalPosition:v.gird_position,originalIndex:de,mouseOffset:te,isMobileDrag:!1,originalData:null})}else{const de=K.parent.contents.findIndex(be=>be.GUID===v.GUID);K.parent.contents.splice(de,1),console.log(de);const ue=K.parent,Se=he(K.parent,v);K.parent.contents=Se,console.log(K.parent),ne({isDragging:!0,draggedContainer:v,draggedElement:Y,floatingElement:W,originalParent:ue,originalPosition:v.gird_position,originalIndex:de,mouseOffset:te,isMobileDrag:!1,originalData:null})}},ee=v=>{if(!O.isDragging||!O.floatingElement)return;const Y="touches"in v?v.touches[0].clientX:v.clientX,Q="touches"in v?v.touches[0].clientY:v.clientY;if(O.floatingElement.style.left=`${Y-O.mouseOffset.x}px`,O.floatingElement.style.top=`${Q-O.mouseOffset.y}px`,O.draggedStockItem){const B=document.elementFromPoint(Y,Q),re=B==null?void 0:B.closest("[data-stock-guid]");if(re){const K=re.getAttribute("data-stock-guid"),W=ue=>{for(const Se of ue){if(Se.type==="store_shelves"&&Se.medMapStock){const be=Se.medMapStock.find(Re=>Re.GUID===K);if(be)return{stockItem:be,shelf:Se}}if(Se.contents){const be=W(Se.contents);if(be)return be}}return null},de=W(o);if(de&&de.stockItem.GUID!==O.draggedStockItem.GUID){const ue=re.getBoundingClientRect(),Se=ue.left+ue.width/2,be=Y<Se?"left":"right";T({container:de.shelf,direction:null,element:re,stockItem:de.stockItem,stockItemDirection:be});return}}const te=B==null?void 0:B.closest("[data-container-guid]");if(te){const K=te.getAttribute("data-container-guid"),W=xe(K);if(W&&W.container.type==="store_shelves"){T({container:W.container,direction:null,element:te});return}}T(null);return}const G=document.elementFromPoint(Y,Q),J=G==null?void 0:G.closest("[data-container-guid]");if(J){const B=J.getAttribute("data-container-guid"),re=xe(B);if(re&&we(O.draggedContainer.type).includes(re.container.type)){const K=ce(J,Y,Q);if(O.draggedContainer.type==="med_box"&&!["left","right"].includes(K)){T(null);return}T({container:re.container,direction:K,element:J});return}}T(null)},I=async v=>{if(!O.isDragging)return;if(O.floatingElement&&document.body.removeChild(O.floatingElement),O.draggedStockItem&&O.draggedStockShelf){if(console.log("StockItem "),console.log("Drop Target:",y),y){const J=[];if(y.stockItem&&y.stockItemDirection){console.log(` stockItem ${y.stockItem.GUID}  ${y.stockItemDirection} `);const B=y.container,re=O.draggedStockShelf,te=O.draggedStockItem,K=Number(y.stockItem.location),W=Number(te.location);if(B.GUID===re.GUID){console.log("");const ue=re.medMapStock.findIndex(Re=>Re.GUID===te.GUID);ue!==-1&&re.medMapStock.splice(ue,1),re.medMapStock.forEach(Re=>{const gt=Number(Re.location);gt>W&&(Re.location=String(gt-1),J.push({...Re}))});let Se;const be=K>W?K-1:K;y.stockItemDirection==="left"?Se=be:Se=be+1,re.medMapStock.forEach(Re=>{const gt=Number(Re.location);gt>=Se&&(Re.location=String(gt+1),J.push({...Re}))}),te.location=String(Se),re.medMapStock.push(te),re.medMapStock.sort((Re,gt)=>Number(Re.location)-Number(gt.location)),J.push({...te})}else{console.log("");const ue=re.medMapStock.findIndex(be=>be.GUID===te.GUID);ue!==-1&&re.medMapStock.splice(ue,1),re.medMapStock.forEach(be=>{const Re=Number(be.location);Re>W&&(be.location=String(Re-1),J.push({...be}))});let Se;y.stockItemDirection==="left"?Se=K:Se=K+1,B.medMapStock.forEach(be=>{const Re=Number(be.location);Re>=Se&&(be.location=String(Re+1),J.push({...be}))}),te.location=String(Se),te.shelf_guid=B.GUID,B.medMapStock.push(te),B.medMapStock.sort((be,Re)=>Number(be.location)-Number(Re.location)),J.push({...te})}}else if(y.container.type==="store_shelves"){console.log(" store_shelves ");const B=y.container,re=O.draggedStockShelf,te=O.draggedStockItem,K=Number(te.location),W=re.medMapStock.findIndex(de=>de.GUID===te.GUID);W!==-1&&(re.medMapStock.splice(W,1),re.medMapStock.forEach(de=>{const ue=Number(de.location);ue>K&&(de.location=String(ue-1),J.push({...de}))})),te.location="0",te.shelf_guid=B.GUID,B.medMapStock||(B.medMapStock=[]),B.medMapStock.forEach(de=>{const ue=Number(de.location);de.location=String(ue+1),J.push({...de})}),B.medMapStock.push(te),B.medMapStock.sort((de,ue)=>Number(de.location)-Number(ue.location)),J.push({...te})}if(J.length>0){console.log(" stockItems:",J);try{const B=await _e.updateStock(J);B.Code===200?d("","success"):d(B.Result||"","error")}catch(B){console.error(" stockItem :",B),d("","error")}}}ne({isDragging:!1,draggedContainer:null,draggedElement:null,floatingElement:null,originalParent:null,originalPosition:"",originalIndex:-1,mouseOffset:{x:0,y:0},isMobileDrag:!1,originalData:null,draggedStockItem:null,draggedStockShelf:null}),T(null);return}let Y=null,Q=null,G=null;if(console.log("Drop Target:",y),console.log("Is Mobile Drag:",O.isMobileDrag),O.isMobileDrag)if(y){Y=y.direction,G=y.container;const J=xe(O.draggedContainer.GUID);if(J){const de=J.parent.contents.findIndex(Se=>Se.GUID===O.draggedContainer.GUID);J.parent.contents.splice(de,1);const ue=he(J.parent,O.draggedContainer);J.parent.contents=ue}const B=U(y.container.gird_position||"0,0");let re=B.row,te=B.col;switch(y.direction){case"top":re=Math.max(0,B.row);break;case"bottom":re=B.row+1;break;case"left":te=Math.max(0,B.col);break;case"right":te=B.col+1;break}const K=xe(y.container.Master_GUID||y.container.GUID);let W=(K==null?void 0:K.container)||y.container;if(O.draggedContainer.class!=y.class&&(W=y),O.draggedContainer.type==="med_box"&&y.container.type!=="med_box")if(console.log(""),W=y.container,W.contents.length>0){let de=0,ue=0;W.contents.forEach(Se=>{const be=U(Se.gird_position||"0,0").row,Re=U(Se.gird_position||"0,0").col;de>be&&(de=be),ue>Re&&(ue=Re)});for(let Se=0;Se<=ue;Se++)for(let be=0;be<=de;be++){const Re=`${Se},${be}`;W.contents.filter(Ve=>Ve.grid_position===Re).length===0&&(re=Se,te=be)}}else re=0,te=0;Q=W,L(W,O.draggedContainer,re,te,y.direction)}else Y=null,G=null,Q=O.originalParent;else if(y){Y=y.direction,G=y.container;const J=U(y.container.gird_position||"0,0");let B=J.row,re=J.col;switch(y.direction){case"top":B=Math.max(0,J.row);break;case"bottom":B=J.row+1;break;case"left":re=Math.max(0,J.col);break;case"right":re=J.col+1;break}const te=xe(y.container.Master_GUID||y.container.GUID);console.log("------",y),console.log("------",O.draggedContainer);let K=(te==null?void 0:te.container)||y.container;if(console.log(O.draggedContainer.class),console.log(y.container.class),console.log(O.draggedContainer.class!=y.container.class),O.draggedContainer.class!=y.container.class&&(K=y.container,console.log("------"),console.log("------",y),console.log("------",O.draggedContainer),console.log("------",K)),O.draggedContainer.type==="med_box"&&y.container.type!=="med_box")if(console.log(""),K=y.container,K.contents.length>0){let W=0,de=0;K.contents.forEach(ue=>{const Se=U(ue.gird_position||"0,0").row,be=U(ue.gird_position||"0,0").col;W>Se&&(W=Se),de>be&&(de=be)});for(let ue=0;ue<=de;ue++)for(let Se=0;Se<=W;Se++){const be=`${ue},${Se}`;K.contents.filter(gt=>gt.grid_position===be).length===0&&(B=ue,re=Se)}}else B=0,re=0;Q=K,L(K,O.draggedContainer,B,re,y.direction)}else{Y=null,G=null,Q=O.originalParent,O.draggedContainer.gird_position=O.originalPosition;const J=U(O.originalPosition||"0,0").row,B=U(O.originalPosition||"0,0").col;L(O.originalParent,O.draggedContainer,J,B,null)}ne({isDragging:!1,draggedContainer:null,draggedElement:null,floatingElement:null,originalParent:null,originalPosition:"",originalIndex:-1,mouseOffset:{x:0,y:0},isMobileDrag:!1,originalData:null,draggedStockItem:null,draggedStockShelf:null}),T(null),console.log("Drop Direction:",Y),console.log("Parent Object:",Q),console.log("Target Object:",G),console.log("API",C),await dh(C)};m.useEffect(()=>{if(O.isDragging)if(X()){const Y=J=>{J.preventDefault(),ee(J)},Q=J=>I(),G=J=>I();return document.addEventListener("pointermove",Y,{passive:!1}),document.addEventListener("pointerup",Q),document.addEventListener("pointercancel",G),()=>{document.removeEventListener("pointermove",Y),document.removeEventListener("pointerup",Q),document.removeEventListener("pointercancel",G)}}else{const Y=B=>ee(B),Q=B=>I(),G=B=>{B.preventDefault(),ee(B)},J=B=>I();return document.addEventListener("mousemove",Y),document.addEventListener("mouseup",Q),document.addEventListener("touchmove",G,{passive:!1}),document.addEventListener("touchend",J),()=>{document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",Q),document.removeEventListener("touchmove",G),document.removeEventListener("touchend",J)}}},[O.isDragging,y]),m.useEffect(()=>{const v=Q=>{Q.code==="Space"&&!Q.repeat&&(Q.preventDefault(),$(!0))},Y=Q=>{Q.code==="Space"&&(Q.preventDefault(),$(!1),D(!1))};return window.addEventListener("keydown",v),window.addEventListener("keyup",Y),()=>{window.removeEventListener("keydown",v),window.removeEventListener("keyup",Y)}},[]);const j=m.useCallback(v=>{var Q;if(N)return;if(v.ctrlKey||v.metaKey){v.preventDefault(),v.stopPropagation();const G=(Q=n.current)==null?void 0:Q.getBoundingClientRect();if(!G)return;const J=v.clientX-G.left,B=v.clientY-G.top,re=v.deltaY>0?.9:1.1,te=Math.max(.1,Math.min(5,p.scale*re)),K=te/p.scale,W=J-(J-p.x)*K,de=B-(B-p.y)*K;b({x:W,y:de,scale:te})}},[p,N]),R=m.useCallback(v=>{N||!S||(D(!0),x({x:v.clientX,y:v.clientY}),q({x:v.clientX,y:v.clientY}),P(!1),v.preventDefault())},[N,S]),z=m.useCallback(v=>{if(!w||N)return;const Y=v.clientX-f.x,Q=v.clientY-f.y;if(E){const G=Math.abs(v.clientX-E.x),J=Math.abs(v.clientY-E.y);(G>5||J>5)&&P(!0)}b(G=>({...G,x:G.x+Y,y:G.y+Q})),x({x:v.clientX,y:v.clientY})},[w,f,N,E]),oe=m.useCallback(()=>{D(!1),q(null)},[]),[pe,ve]=m.useState(null),[ke,De]=m.useState({x:0,y:0}),Me=v=>{if(v.length<2)return null;const Y=v[0],Q=v[1];return Math.sqrt(Math.pow(Q.clientX-Y.clientX,2)+Math.pow(Q.clientY-Y.clientY,2))},me=v=>{if(v.length===1)return{x:v[0].clientX,y:v[0].clientY};const Y=v[0],Q=v[1];return{x:(Y.clientX+Q.clientX)/2,y:(Y.clientY+Q.clientY)/2}},ye=m.useCallback(v=>{if(!N){if(v.touches.length===2){const Y=Me(v.touches),Q=me(v.touches);ve(Y),De(Q)}else if(v.touches.length===1){const Y=v.touches[0];x({x:Y.clientX,y:Y.clientY}),D(!0)}}},[N]),je=m.useCallback(v=>{var Y;if(!N){if(v.preventDefault(),v.touches.length===2&&pe!==null){const Q=Me(v.touches),G=me(v.touches);if(Q&&pe){const J=(Y=n.current)==null?void 0:Y.getBoundingClientRect();if(!J)return;const B=Q/pe,re=Math.max(.1,Math.min(5,p.scale*B)),te=G.x-J.left,K=G.y-J.top,W=re/p.scale,de=te-(te-p.x)*W,ue=K-(K-p.y)*W;b({x:de,y:ue,scale:re}),ve(Q),De(G)}}else if(v.touches.length===1&&w){const Q=v.touches[0],G=Q.clientX-f.x,J=Q.clientY-f.y;b(B=>({...B,x:B.x+G,y:B.y+J})),x({x:Q.clientX,y:Q.clientY})}}},[p,pe,w,f,N]),Ie=m.useCallback(()=>{ve(null),D(!1)},[]);m.useEffect(()=>{const v=n.current;if(v)return v.addEventListener("wheel",j,{passive:!1}),()=>v.removeEventListener("wheel",j)},[j]);const nt=()=>!o||o.length===0?[]:o,Ce=v=>{if(!v||v.length===0)return{sortedContents:[],maxRow:0,maxCol:0};const Y=v.map(B=>({...B,gridPos:U(B.gird_position||"0,0")})),Q=Math.max(...Y.map(B=>B.gridPos.row),0),G=Math.max(...Y.map(B=>B.gridPos.col),0);return{sortedContents:Y.sort((B,re)=>B.gridPos.row!==re.gridPos.row?B.gridPos.row-re.gridPos.row:B.gridPos.col-re.gridPos.col),maxRow:Q,maxCol:G}},qe=nt(),ze=Math.max(...qe.map(v=>U(v.gird_position||"0,0").row),0),Lt=Math.max(...qe.map(v=>U(v.gird_position||"0,0").col),0),ht=v=>{const Y=G=>{if(G.width&&Array.isArray(G.width)&&typeof G.width_index=="number"&&G.width_index>=0&&G.width_index<G.width.length){const B=parseFloat(G.width[G.width_index]);if(!isNaN(B)){const re=B*20;return Math.max(200,re)}}return 200},Q=G=>{switch(G){case"parent_container":return"bg-pink-50 border-pink-300";case"sub_container":return"bg-blue-50 border-blue-300";case"dispensing_shelves":case"store_shelves":return"bg-green-50 border-green-300";case"med_box":return"bg-yellow-50 border-yellow-300";case"grid_draw":case"list_draw":return"bg-violet-50 border-violet-300";default:return"bg-gray-50 border-gray-300"}};switch(v.type){case"med_box":return Y(v),r.jsxs("div",{"data-container-guid":v.GUID,className:`${v.type!=="sub_container"?"border-2 rounded-lg shadow-sm":""} ${Q(v.type||0)} min-h-[80px] flex flex-col flex-shrink-0 h-full overflow-hidden`,children:[r.jsx("div",{onMouseDown:N&&ae(v.type)&&!X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,onTouchStart:N&&ae(v.type)&&!X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,onPointerDown:N&&ae(v.type)&&X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,className:N&&ae(v.type)?"cursor-move":"",children:r.jsx(zs,{content:v,isAdminMode:g})}),r.jsx("div",{className:"flex-1 p-1",children:qt(v)})]},v.GUID);case"sub_container":case"parent_container":return r.jsxs("div",{"data-container-guid":v.GUID,className:`${Q(v.type||0)} border-2 overflow-hidden rounded-lg shadow-sm min-h-[80px] flex flex-col h-full`,children:[r.jsx("div",{onMouseDown:N&&ae(v.type)&&!X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,onTouchStart:N&&ae(v.type)&&!X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,onPointerDown:N&&ae(v.type)&&X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,className:N&&ae(v.type)?"cursor-move":"",children:r.jsx(zs,{content:v,isAdminMode:g})}),r.jsx("div",{className:"flex-1  p-1",children:qt(v)})]},v.GUID);case"grid_draw":return r.jsxs("div",{"data-container-guid":v.GUID,className:`${v.type!=="sub_container"?"border-2 rounded-lg shadow-sm":""} ${Q(v.type||0)} min-h-[80px] flex flex-col h-full overflow-hidden`,children:[r.jsx("div",{onMouseDown:N&&ae(v.type)&&!X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,onTouchStart:N&&ae(v.type)&&!X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,onPointerDown:N&&ae(v.type)&&X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,className:N&&ae(v.type)?"cursor-move":"",children:r.jsx(zs,{content:v,isAdminMode:g})}),r.jsx("div",{className:"flex-1 p-1 flex items-center",children:qt(v)})]},v.GUID);default:return r.jsxs("div",{"data-container-guid":v.GUID,className:`${v.type!=="sub_container"?"border-2 rounded-lg shadow-sm":""} ${Q(v.type||0)} min-h-[80px] flex flex-col h-full overflow-hidden ${v.type=="none"?"opacity-0":""}`,children:[r.jsx("div",{onMouseDown:N&&ae(v.type)&&!X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,onTouchStart:N&&ae(v.type)&&!X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,onPointerDown:N&&ae(v.type)&&X()?G=>_(v,G.currentTarget.closest("[data-container-guid]"),G):void 0,className:N&&ae(v.type)?"cursor-move":"",children:r.jsx(zs,{content:v,isAdminMode:g})}),r.jsx("div",{className:"flex-1 p-1",children:qt(v)})]},v.GUID)}},qt=v=>{const Y=(Q,G,J)=>{const B=Array(G+1).fill(null).map(()=>Array(J+1).fill(!1)),re={};return Q.forEach(te=>{const K=U(te.gird_position||"0,0");re[`${K.row},${K.col}`]=te,B[K.row][K.col]=!0}),r.jsx("table",{className:"w-full h-full",style:{borderCollapse:"none",borderSpacing:"0px"},children:r.jsx("tbody",{children:Array.from({length:G+1},(te,K)=>r.jsx("tr",{className:"h-full",style:{height:`${100/(G+1)}%`,minHeight:"80px"},children:Array.from({length:J+1},(W,de)=>{const ue=`${K},${de}`,Se=re[ue];return Se?r.jsxs("td",{className:"align-top bg-transparent",style:{width:`${100/(J+1)}%`,height:`${100/(G+1)}%`,minHeight:"80px",border:"none",position:"relative"},children:[ht(Se),(y==null?void 0:y.container.GUID)===Se.GUID&&r.jsx("div",{className:"absolute inset-0 pointer-events-none",children:r.jsx("div",{className:`absolute bg-blue-400 opacity-50 ${y.direction==="top"?"top-0 left-0 right-0 h-1":y.direction==="bottom"?"bottom-0 left-0 right-0 h-1":y.direction==="left"?"left-0 top-0 bottom-0 w-1":"right-0 top-0 bottom-0 w-1"}`})})]},de):r.jsx("td",{className:"p-1 align-top bg-transparent",style:{width:`${100/(J+1)}%`,height:`${100/(G+1)}%`,minHeight:"80px",border:"none"},children:r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-sm",children:""})},de)})},K))})})};switch(v.type){case"parent_container":case"sub_container":if(v.contents&&v.contents.length>0){const{sortedContents:W,maxRow:de,maxCol:ue}=Ce(v.contents);return Y(W,de,ue)}else return r.jsx("table",{className:"bg-transparent w-full h-full",style:{borderCollapse:"separate",borderSpacing:"1px"},children:r.jsx("tbody",{children:r.jsx("tr",{})})});case"dispensing_shelves":if(v.contents&&v.contents.length>0){const{sortedContents:W,maxRow:de,maxCol:ue}=Ce(v.contents);return Y(W,de,ue)}else return r.jsx("table",{className:"bg-transparent w-full h-full",style:{borderCollapse:"separate",borderSpacing:"0px"},children:r.jsx("tbody",{children:r.jsx("tr",{children:r.jsx("td",{className:"p-4 text-center text-gray-500 bg-transparent",children:r.jsx("div",{className:"text-base",children:""})})})})});case"store_shelves":if(v.medMapStock&&v.medMapStock.length>0){const W=v.medMapStock,de=W.length,ue=de>0?100/de:100,Se=v.width?v.width*5:500;return r.jsx("div",{className:"flex h-full",style:{minWidth:`${Se}px`},children:W.map((be,Re)=>{const gt=Number(be.location);return r.jsx("div",{className:"m-1 flex-shrink-0",style:{width:`calc(${ue}% - 8px)`},"data-stock-guid":be.GUID,children:r.jsxs("div",{className:`border-2 bg-yellow-50 border-yellow-400 rounded-lg p-2 h-full flex flex-col justify-center items-center cursor-pointer bg-white hover:bg-yellow-100 hover:border-yellow-500 hover:shadow-md transition-all ${N?"cursor-move":""}`,onMouseDown:Ve=>{N?H(be,v,Ve.currentTarget.closest("[data-stock-guid]"),Ve):!w&&!S&&(q({x:Ve.clientX,y:Ve.clientY}),P(!1))},onMouseUp:Ve=>{if(!w&&!S&&!V&&E&&!N){const tn=Math.abs(Ve.clientX-E.x),Pr=Math.abs(Ve.clientY-E.y);tn<=5&&Pr<=5&&(Ve.stopPropagation(),i(v,be))}N||(q(null),P(!1))},onTouchStart:Ve=>{if(N&&X())H(be,v,Ve.currentTarget.closest("[data-stock-guid]"),Ve);else if(!w&&!N){const tn=Ve.touches[0];q({x:tn.clientX,y:tn.clientY}),P(!1)}},onTouchEnd:Ve=>{if(!w&&!V&&E&&!N){const tn=Ve.changedTouches[0],Pr=Math.abs(tn.clientX-E.x),Ho=Math.abs(tn.clientY-E.y);Pr<=5&&Ho<=5&&(Ve.stopPropagation(),i(v,be))}N||(q(null),P(!1))},onPointerDown:Ve=>{N&&X()&&H(be,v,Ve.currentTarget.closest("[data-stock-guid]"),Ve)},children:[r.jsx("div",{className:"text-base font-semibold text-gray-800 truncate w-full text-center",children:be.name||be.material_no}),r.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[": ",be.qty||0]}),r.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[": ",gt]})]})},be.GUID||Re)})})}else if(v.contents&&v.contents.length>0){const{sortedContents:W,maxRow:de,maxCol:ue}=Ce(v.contents);return Y(W,de,ue)}else return r.jsx("table",{className:"bg-transparent w-full h-full",style:{borderCollapse:"separate",borderSpacing:"0px"},children:r.jsx("tbody",{children:r.jsx("tr",{children:r.jsx("td",{className:"p-4 text-center text-gray-500 bg-transparent",children:r.jsx("div",{className:"text-base",children:""})})})})});case"none":if(v.contents&&v.contents.length>0){const{sortedContents:W,maxRow:de,maxCol:ue}=Ce(v.contents);return Y(W,de,ue)}else return r.jsx("table",{className:"bg-transparent w-full h-full",style:{borderCollapse:"separate",borderSpacing:"0px"},children:r.jsx("tbody",{children:r.jsx("tr",{children:r.jsx("td",{className:"p-4 text-center text-gray-500 bg-transparent",children:r.jsx("div",{className:"text-base",children:""})})})})});case"grid_draw":const Q=Math.max(...v.Boxes.flat().map(W=>+W.Row+ +W.Height-1)),G=Math.max(...v.Boxes.flat().map(W=>+W.Column+ +W.Width-1)),J=Q+1,B=G+1,re=v.Boxes.flat(),te=Array(J).fill(null).map(()=>Array(B).fill(!1)),K={};return re.forEach(W=>{W.Slave||(K[`${W.Row},${W.Column}`]=W)}),re.forEach(W=>{if(!W.Slave&&(W.Width>1||W.Height>1))for(let de=W.Row;de<W.Row+W.Height;de++)for(let ue=W.Column;ue<W.Column+W.Width;ue++)(de!==W.Row||ue!==W.Column)&&(te[de][ue]=!0)}),r.jsxs("div",{className:"bg-violet-100 h-20 flex ml-2 mt-2 mb-6 rounded-xl border-2 border-violet-400 w-[140px] items-center justify-center",children:[r.jsx("div",{className:"h-[60%] bg-violet-400 w-[3%] rounded-xl"}),r.jsx("div",{className:"h-[80%] border-2 border-violet-400 w-[82%] mx-1",children:r.jsx("div",{className:"flex items-center justify-center text-base text-violet-400 h-[100%]"})}),r.jsx("div",{className:"h-[60%] bg-violet-400 w-[3%]"})]});case"list_draw":return r.jsxs("div",{className:"bg-violet-100 h-20 flex ml-2 mt-2 mb-6 rounded-xl border-2 border-violet-400 w-[140px] items-center justify-center",children:[r.jsx("div",{className:"h-[60%] bg-violet-400 w-[3%] rounded-xl"}),r.jsx("div",{className:"h-[80%] border-2 border-violet-400 w-[82%] mx-1",children:r.jsx("div",{className:"flex items-center justify-center text-base text-violet-400 h-[100%]"})}),r.jsx("div",{className:"h-[60%] bg-violet-400 w-[3%]"})]});case"med_box":return v.med_info&&v.med_info.length>0?r.jsxs("div",{className:"text-base text-left h-full min-h-[40px] max-w-[200px] min-w-[200px] p-1 flex items-center justify-between flex-col",children:[r.jsx("div",{className:"text-gray-700 font-bold truncate w-full",children:v.med_info[0].name}),r.jsxs("div",{className:"text-gray-700 w-full flex justify-between px-1",children:[r.jsxs("div",{children:[v.box_type,""]}),r.jsxs("div",{children:[v.width[v.width_index],"cm"]})]})]}):r.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:r.jsx("div",{className:"text-base",children:""})});default:return v.contents&&v.contents.length>0?r.jsx("div",{className:"space-y-2",children:v.contents.map(W=>ht(W))}):r.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:r.jsxs("div",{className:"text-base",children:[": ",v.type]})})}},en=v=>{if(U(v.gird_position||"0,0"),v.type!==""&&v.type!=="")return null;const Y=Q=>{if(!Q||Q.length===0)return r.jsx("table",{className:"w-full h-full border-none",children:r.jsx("tbody",{children:r.jsx("tr",{children:r.jsx("td",{className:"p-4 text-center text-gray-500",children:r.jsx("div",{className:"text-center",children:r.jsx("div",{className:"text-base",children:""})})})})})});const{sortedContents:G,maxRow:J,maxCol:B}=Ce(Q),re=Array(J+1).fill(null).map(()=>Array(B+1).fill(!1)),te={};return G.forEach(K=>{const W=U(K.gird_position||"0,0");te[`${W.row},${W.col}`]=K,re[W.row][W.col]=!0}),r.jsx("table",{className:"w-full h-full",style:{borderCollapse:"none",borderSpacing:"0px"},children:r.jsx("tbody",{children:Array.from({length:J+1},(K,W)=>r.jsx("tr",{className:"h-full",children:Array.from({length:B+1},(de,ue)=>{const Se=`${W},${ue}`,be=te[Se];return be?r.jsx("td",{className:"p-1 align-top bg-transparent",style:{width:`${100/(B+1)}%`,height:`${100/(J+1)}%`,minHeight:"120px",border:"none"},children:ht(be)},ue):r.jsx("td",{className:"p-1 align-top bg-transparent",style:{width:`${100/(B+1)}%`,height:`${100/(J+1)}%`,minHeight:"120px",border:"1px dashed #e5e7eb"},children:r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-sm",children:""})},ue)})},W))})})};return r.jsxs("div",{"data-container-guid":v.GUID,className:"border-2 rounded-lg shadow-lg bg-orange-50 border-orange-300 min-h-[120px] flex flex-col overflow-hidden w-full h-full",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b-2 bg-orange-100 border-b-orange-200",children:[r.jsx("div",{className:"flex items-center space-x-2",children:r.jsx("span",{className:"text-lg font-semibold text-gray-800",children:v.name})}),r.jsx("div",{className:"flex items-center space-x-1",children:r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:Q=>{Q.stopPropagation(),console.log(" "),console.log(" :",v),v?(console.log("  openAddParentContainerModal"),a(v)):console.warn(" ")},title:"",children:r.jsx(vt,{className:"w-6 h-6 text-green-700"})})})]}),r.jsx("div",{className:`flex-1 bg-orange-50 ${(y==null?void 0:y.container.GUID)===v.GUID?"ring-2 ring-blue-400 ring-inset":""}`,children:Y(v.contents||[])})]},v.GUID)},Ns=m.useCallback(v=>{if(console.log(" locateDrugOnCanvas :",v),console.log(" apiDepartmentData:",!!o),console.log(" canvasRef.current:",!!n.current),!o||!n.current){console.warn(" ",{hasApiData:!!o,hasCanvasRef:!!n.current});return}const Y=v[0].CODE||v[0].code;if(console.log(" :",Y),!Y){console.warn(" ");return}console.log(" :",Y);const Q=J=>{for(const B of J){if(B.type==="grid_draw"&&B.Boxes){for(const re of B.Boxes)for(const te of re)if(te.Code===Y){const K=document.querySelector(`[data-container-guid="${B.GUID}"]`);if(K)return console.log("  (grid_draw):",B),{element:K,bounds:K.getBoundingClientRect()}}}if(B.type==="list_draw"&&B.drugs&&B.drugs.some(te=>te.code===Y)){const te=document.querySelector(`[data-container-guid="${B.GUID}"]`);if(te)return console.log("  (list_draw):",B),{element:te,bounds:te.getBoundingClientRect()}}if((B.type==="store_shelves"||B.type==="dispensing_shelves")&&B.medMapStock&&B.medMapStock.some(te=>te.code===Y||te.material_no===Y)){const te=document.querySelector(`[data-container-guid="${B.GUID}"]`);if(te)return console.log("  (store_shelves):",B),{element:te,bounds:te.getBoundingClientRect()}}if(B.type==="med_box"&&B.med_info&&B.med_info.length>0&&B.med_info.some(te=>te.code===Y)){const te=document.querySelector(`[data-container-guid="${B.GUID}"]`);if(te)return console.log("  (med_box):",B),{element:te,bounds:te.getBoundingClientRect()}}if(B.contents&&B.contents.length>0){const re=Q(B.contents);if(re)return re}}return null},G=Q(o);if(G){const J=n.current.getBoundingClientRect(),B=G.bounds,re=(B.left+B.right)/2,te=(B.top+B.bottom)/2,K=(re-J.left-p.x)/p.scale,W=(te-J.top-p.y)/p.scale,de=J.width/2,ue=J.height/2,Se=de-K*p.scale,be=ue-W*p.scale;b(Re=>({...Re,x:Se,y:be})),console.log(" ",{elementScreenCenter:{x:re,y:te},elementCanvasPos:{x:K,y:W},screenCenter:{x:de,y:ue},newTransform:{x:Se,y:be}}),d(`${v.CHT_NAME||v.NAME||Y}`,"success")}else console.warn(" "),d("","error")},[o,p,d]);m.useImperativeHandle(t,()=>(console.log(" useImperativeHandle  ref "),{locateDrug:Ns}));const Ir=async v=>{if(v.key==="Enter"&&M.trim()&&!k){v.preventDefault(),F(!0);try{console.log(" :",M);const Y=await _e.searchByBarCode(M.trim());console.log(" :",Y),Y.Code===200?(console.log(" :",Y.Data),d("","success"),Ns(Y.Data)):Y.Code===-200&&Y.Result===""?(console.log(" "),d("","error"),h(M.trim()),A("")):(console.log(" :",Y.Result),d(Y.Result||"","error"))}catch(Y){console.error(":",Y),d("","error")}finally{F(!1)}}};return r.jsxs("div",{className:"relative w-full h-full overflow-hidden bg-gray-50",children:[r.jsx("div",{className:"absolute md:bottom-4 md:left-4 bottom-16 left-[50%] md:translate-x-[0%] translate-x-[-50%] z-10",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg flex items-center overflow-hidden border border-gray-200",children:[r.jsx("input",{type:"text",value:M,onChange:v=>A(v.target.value),onKeyDown:Ir,placeholder:"...",className:"px-4 py-2 w-50 focus:outline-none text-gray-700 disabled:opacity-50",disabled:k}),r.jsx("button",{onClick:()=>c("track_Drug_mode"),className:"p-2",title:"",disabled:k,children:r.jsx(Dr,{className:"w-6 h-6 text-blue-600"})})]})}),r.jsx("div",{className:"absolute bottom-4 right-4 z-10 flex gap-2",children:r.jsx("button",{onClick:()=>u(!N),className:`rounded-lg shadow-lg p-2 transition-colors ${N?"bg-red-500 text-white hover:bg-red-600":"bg-white text-gray-700 hover:bg-gray-50"}`,title:N?"Unlock Canvas":"Lock Canvas",children:N?r.jsx(Ud,{className:"w-6 h-6"}):r.jsx(Bd,{className:"w-6 h-6"})})}),r.jsx("div",{ref:n,className:`w-full h-full relative ${S&&!N?"cursor-grab":"cursor-default"} ${w?"cursor-grabbing":""}`,onMouseDown:R,onMouseMove:z,onMouseUp:oe,onMouseLeave:oe,onTouchStart:ye,onTouchMove:je,onTouchEnd:Ie,children:r.jsxs("div",{className:"absolute inset-0 origin-top-left",style:{transform:`translate(${p.x}px, ${p.y}px) scale(${p.scale})`,transformOrigin:"0 0"},children:[r.jsx("div",{className:"relative","data-canvas-content":!0,children:r.jsx("table",{className:"h-full",style:{borderCollapse:"separate",borderSpacing:`${fe}px`,minWidth:"fit-content",minHeight:"fit-content"},children:r.jsx("tbody",{children:Array.from({length:ze+1},(v,Y)=>r.jsx("tr",{children:Array.from({length:Lt+1},(Q,G)=>{const J=qe.find(B=>{const re=U(B.gird_position||"0,0");return re.row===Y&&re.col===G});return J?r.jsx("td",{className:"align-top",style:{minWidth:"150px",minHeight:"120px",border:"none"},children:en(J)},G):r.jsx("td",{className:"align-top",style:{minWidth:"150px",minHeight:"120px",border:"none"},children:r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-base"})},G)})},Y))})})}),e]})})]})});zd.displayName="DrugCanvas";const dh=async e=>{if(console.log(e),Object.keys(e.current).length===0){console.log("");return}console.log(" :",e.current);const t=[],n=[],s=[];Object.values(e.current).forEach(l=>{console.log("API REQ",l);const a={GUID:l.GUID,position:l.position,Master_GUID:l.Master_GUID,serverName:l.serverName,serverType:l.serverType};switch(l.type){case"med_box":t.push(a);break;case"grid_draw":case"list_draw":n.push(a);break;case"dispensing_shelves":case"store_shelves":s.push(a);break;default:console.warn(":",l.type)}});const o=[];if(t.length>0&&(console.log(" :",t),o.push(_e.updateMedMapBox(t).then(l=>({type:"med_box",response:l,count:t.length})).catch(l=>({type:"med_box",error:l,count:t.length})))),n.length>0&&(console.log(" :",n),o.push(_e.updateMedMapDrawer(n).then(l=>({type:"drawer",response:l,count:n.length})).catch(l=>({type:"drawer",error:l,count:n.length})))),s.length>0&&(console.log(" :",s),o.push(_e.updateMedMapShelf(s).then(l=>({type:"shelf",response:l,count:s.length})).catch(l=>({type:"shelf",error:l,count:s.length})))),o.length===0){console.log(" API");return}try{const l=await Promise.all(o);let a=0,i=0;const c=[];l.forEach(h=>{var d,g;if(h.error)i+=h.count,c.push(`${h.type}: ${h.error.message||""}`),console.error(` ${h.type} API :`,h.error);else if(((d=h.response)==null?void 0:d.Code)===200)a+=h.count,console.log(` ${h.type} API :`,h.response);else{i+=h.count;const p=((g=h.response)==null?void 0:g.Result)||"";c.push(`${h.type}: ${p}`),console.error(` ${h.type} API :`,h.response)}})}catch(l){console.error(" :",l)}finally{console.log("")}},fh="modulepreload",ph=function(e){return"/"+e},vc={},mh=function(t,n,s){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),i=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=Promise.allSettled(n.map(c=>{if(c=ph(c),c in vc)return;vc[c]=!0;const h=c.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":fh,h||(g.as="script"),g.crossOrigin="",g.href=c,i&&g.setAttribute("nonce",i),document.head.appendChild(g),h)return new Promise((p,b)=>{g.addEventListener("load",p),g.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${c}`)))})}))}function l(a){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}return o.then(a=>{for(const i of a||[])i.status==="rejected"&&l(i.reason);return t().catch(l)})},Xt=[{name:"2.13",box_type:"2.13",width:["7.5"],unit:"cm"},{name:"2.9",type:"2.9",width:["10","15","20"],unit:"cm"},{name:"4.2",type:"4.2",width:["11","16"],unit:"cm"}],hh=()=>{const{medBoxModalOpen:e,closeMedBoxModal:t,selectedMedBox:n,selectedDepartmentType:s,setApiDepartmentData:o,setIsLoadingMedMap:l,showNotification:a,triggerRefresh:i,modalMode:c,medicineList:h}=Ke(),{t:d}=mt(),[g,p]=m.useState(0),[b,w]=m.useState({}),[D,N]=m.useState(""),[u,f]=m.useState(""),[x,S]=m.useState("N"),[$,M]=m.useState([]),[A,k]=m.useState(!1),[F,E]=m.useState(!1),[q,V]=m.useState(null),[P,O]=m.useState(null),[ne,y]=m.useState(!1),[T,C]=m.useState(!1);m.useEffect(()=>{if(n&&e)if(c==="add"){p(0);const H={};Xt.forEach((_,ee)=>{H[ee]=0}),w(H),N(""),E(!1),X()}else{const H=Xt.findIndex(_=>_.box_type===n.box_type||_.type===n.box_type);if(console.log(n),H>=0){p(H);const ee=Xt[H].width.findIndex(j=>{var R;return j===((R=n.width)==null?void 0:R[n.width_index||0])}),I={};Xt.forEach((j,R)=>{R===H?I[R]=ee>=0?ee:0:I[R]=0}),w(I)}else{p(0);const _={};Xt.forEach((ee,I)=>{_[I]=0}),w(_)}N(n.ip||""),O({box_type:n.box_type,width:n.width,width_index:n.width_index,ip:n.ip||"",storage:n.storage?JSON.parse(JSON.stringify(n.storage)):null})}},[n,e,c]);const X=()=>{n&&n.parentShelf&&V(n.parentShelf)},fe=H=>{if(!H||!H.contents||H.contents.length===0)return"0,0";let _=-1,ee=0;return H.contents.forEach(I=>{if(I.gird_position){const[j,R]=I.gird_position.split(",").map(Number);R>_&&(_=R,ee=j)}}),`${ee},${_+1}`},Z=()=>{if(!P||c!=="edit")return!1;const H=Xt[g],_=b[g]||0,ee=H.box_type||H.type||H.name;return P.box_type!==ee||P.width_index!==_||P.ip!==D||JSON.stringify(P.storage)!==JSON.stringify(n==null?void 0:n.storage)},le=H=>{p(H)},Ne=(H,_)=>{w(ee=>({...ee,[H]:_}))},ae=()=>{n&&(c==="add"?U():ie())},we=()=>{t()},U=async()=>{if(!n||!q){a("","error");return}E(!0);try{const H=Xt[g],_=b[g]||0,ee=H.width[_],I=fe(q),j={Master_GUID:q.GUID,position:I,width:ee.toString(),height:"60",ip_box:D,serverName:q.serverName||"",serverType:q.serverType||""};console.log("  API :",j);const R=await _e.addMedMapBox(j);R.Code===200?(a("","success"),t(),await xe()):a(`${R.Result||""}`,"error")}catch(H){console.error("Add med box failed:",H),a("","error")}finally{E(!1)}},ie=async()=>{var H;if(!n||!Z()){a("","error");return}y(!0);try{const _=Xt[g],ee=b[g]||0,I=_.width[ee],j=_.box_type||_.type||_.name,R=P.box_type!==j||P.width_index!==ee||P.ip!==D,z=JSON.stringify(P.storage)!==JSON.stringify(n==null?void 0:n.storage),oe=[];if(R){const ke={GUID:n.GUID,Master_GUID:n.Master_GUID,position:n.gird_position,ip_light:D,serverName:n.serverName,serverType:n.serverType};oe.push(_e.updateMedMapBox([ke]))}z&&oe.push(_e.updateEpd266Storages(n.serverName||"",n.serverType||"",[n.storage]));const pe=await Promise.all(oe);if(pe.every(ke=>ke.Code===200))a("","success"),t(),await xe();else{const ke=pe.filter(De=>De.Code!==200);a(`${((H=ke[0])==null?void 0:H.Result)||""}`,"error")}}catch(_){console.error("Update med box failed:",_),a("","error")}finally{y(!1)}},xe=async()=>{if(!s){console.warn(" ");return}console.log(" :",s),l(!0);try{const H=await _e.getMedMapByDepartment(s);if(H.Code===200&&H.Data){console.log(" API ");const _=await mh(()=>Promise.resolve().then(()=>$m),void 0),ee=_.default.convertMedMapApiToFakeData(H.Data);if(!_.default.validateConvertedData(ee)){console.error(" "),a("","error");return}o(ee),console.log(" ")}else console.error(" API :",H),a("API ","error")}catch(H){console.error(" :",H),a("","error")}finally{l(!1)}},he=async()=>{k(!0);try{const H=u.toLowerCase().trim();let _=h;H&&(_=_.filter(ee=>{var I,j,R;return((I=ee.CODE)==null?void 0:I.toLowerCase().includes(H))||((j=ee.NAME)==null?void 0:j.toLowerCase().includes(H))||((R=ee.CHT_NAME)==null?void 0:R.toLowerCase().includes(H))})),x!=="N"&&(_=_.filter(ee=>ee.DRUGKIND===x)),M(_)}catch(H){console.error("Search failed:",H),M([])}finally{k(!1)}},L=(H,_)=>{console.log(" :",_),C(!1),ce(_)},ce=async H=>{if(n)try{console.log(" :",H.CODE);const _=await _e.updateEpd266Medcode(n.serverName||"",n.serverType||"",H.CODE,n.storage||{});_.Code===200?(console.log(" :",_.Data),n.storage=_.Data,n.med_info=[{name:H.NAME,cht_name:H.CHT_NAME,code:H.CODE}],a("","success"),i()):(console.error(" :",_),a(`${_.Result||""}`,"error"))}catch(_){console.error(" :",_),a("","error")}};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:we}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh"},onClick:H=>H.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(sn,{className:"w-6 h-6 text-gray-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:d(c==="add"?"modal.addMedBox":"modal.medBoxSettings")})]}),r.jsx("button",{onClick:we,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Xe,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-4 py-2 overflow-y-auto",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"gap-16 flex",children:r.jsxs("div",{className:"space-y-1",children:[r.jsx("h3",{className:"text-base font-medium text-gray-900",children:d("form.ipAddress")}),r.jsx("div",{className:"flex items-center",children:r.jsx("input",{type:"text",onChange:H=>N(H.target.value),placeholder:(n==null?void 0:n.ip)||(n==null?void 0:n.name)||d("placeholder.ipAddress"),className:"px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors w-64"})})]})}),r.jsxs("div",{className:"flex gap-16",children:[r.jsxs("div",{className:"space-y-1 min-w-[260px]",children:[r.jsx("h3",{className:"text-base font-medium text-gray-900",children:d("form.medBoxType")}),r.jsx("div",{className:"flex gap-4 justify-between",children:Xt.map((H,_)=>r.jsxs("label",{className:`flex items-center px-4 py-2 border-2 rounded-lg cursor-pointer transition-all ${g===_?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[r.jsx("input",{type:"radio",name:"boxType",value:_,checked:g===_,onChange:()=>le(_),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 hidden"}),r.jsx("div",{children:r.jsx("div",{className:"text-sm font-medium text-gray-900",children:H.name})})]},_))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("h3",{className:"text-base font-medium text-gray-900",children:d("form.widthSelection")}),Xt.map((H,_)=>r.jsx("div",{className:`flex gap-4 ${g===_?"block":"hidden"}`,children:H.width.map((ee,I)=>r.jsxs("label",{className:`flex items-center justify-center px-4 py-2 border-2 rounded-lg cursor-pointer transition-all ${g===_&&(b[_]||0)===I?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[r.jsx("input",{type:"radio",name:`width-${_}`,value:I,checked:g===_&&(b[_]||0)===I,onChange:()=>Ne(_,I),className:"w-4 h-4 text-green-600 border-gray-300 focus:ring-green-500 hidden"}),r.jsx("div",{className:"text-center",children:r.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:[ee," ",H.unit]})})]},`${_}-${I}`))},_))]})]}),r.jsxs("div",{className:"flex gap-6",children:[c==="edit"&&r.jsxs("div",{className:"space-y-2 w-[50%]",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:d("form.drugInfo")}),r.jsx("div",{children:n!=null&&n.med_info&&n.med_info.length>0?r.jsx("div",{children:n.med_info.map((H,_)=>r.jsxs("div",{className:"space-y-2 p-4 border border-gray-200 rounded-lg min-h-[262px] max-h-[262px]",children:[r.jsxs("div",{children:[r.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[d("form.drugCode"),":"]}),r.jsx("div",{className:"text-base text-gray-900 mt-1",children:H.code||d("status.notSet")})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[d("form.drugName"),":"]}),r.jsx("div",{className:"text-base text-gray-900 mt-1",children:H.name||d("status.notSet")})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[d("form.chineseName"),":"]}),r.jsx("div",{className:"text-base text-gray-900 mt-1",children:H.cht_name||d("status.notSet")})]})]},_))}):r.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg py-8 px-4 text-center space-y-4",children:r.jsx("div",{className:"text-gray-500 text-base",children:d("status.noDrugData")})})})]}),c==="add"&&r.jsxs("div",{className:"space-y-2 w-[50%]",children:[r.jsx("h3",{className:"text-base font-medium text-gray-900",children:d("form.drugInfo")}),r.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg py-2 px-4 min-h-[262px] max-h-[262px]",children:r.jsx("div",{className:"text-center py-8 space-y-4",children:r.jsx("div",{className:"text-gray-500 text-base",children:d("status.newMedBoxNoDrug")})})})]}),r.jsxs("div",{className:"space-y-2 w-[50%]",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:d("form.drugSearch")}),r.jsx("button",{onClick:()=>C(!0),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",title:"",children:r.jsx(Dr,{className:"w-5 h-5 text-gray-600"})})]}),r.jsxs("div",{className:"flex gap-2 mb-2",children:[r.jsx("input",{type:"text",value:u,onChange:H=>f(H.target.value),placeholder:d("placeholder.drugSearch"),className:"border rounded px-3 py-1 flex-1 min-w-0 focus:border-blue-500 focus:outline-none transition-colors"}),r.jsxs("select",{value:x,onChange:H=>S(H.target.value),className:"border rounded px-2 py-1 focus:border-blue-500 focus:outline-none transition-colors",title:"",children:[r.jsx("option",{value:"N",children:"N"}),r.jsx("option",{value:"1",children:"1"}),r.jsx("option",{value:"2",children:"2"}),r.jsx("option",{value:"3",children:"3"}),r.jsx("option",{value:"4",children:"4"})]}),r.jsxs("button",{onClick:he,disabled:A,className:"bg-blue-600 text-white px-4 py-1.5 rounded hover:bg-blue-700 transition-colors whitespace-nowrap disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:[A&&r.jsx(kt,{className:"w-4 h-4 animate-spin"}),d("button.search")]})]}),r.jsx("div",{className:"bg-white border rounded p-3 min-h-[220px] max-h-[220px] overflow-y-auto",children:A?r.jsxs("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:[r.jsx(kt,{className:"w-5 h-5 animate-spin mr-2"}),d("status.searching")]}):$.length>0?r.jsx("div",{className:"space-y-1",children:$.map((H,_)=>r.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded hover:bg-gray-50 transition-colors",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:H.NAME}),r.jsx("div",{className:"text-xs text-gray-500 truncate",children:H.CHT_NAME}),r.jsx("div",{className:"text-xs text-gray-400 font-mono",children:H.CODE})]}),r.jsx("button",{onClick:()=>ce(H),className:"ml-2 p-1 text-green-600 hover:text-green-700 hover:bg-green-50 rounded transition-colors flex-shrink-0",title:d("button.add"),children:r.jsx(vt,{className:"w-4 h-4"})})]},H.GUID||_))}):r.jsx("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:d(u||x!=="N"?"status.noSearchResults":"status.searchResults")})})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 py-2 px-4 border-t border-gray-200",children:[r.jsx("button",{onClick:we,disabled:F||ne,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:d("button.cancel")}),r.jsxs("button",{onClick:ae,disabled:F||ne,className:"px-6 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[(F||ne)&&r.jsx(kt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:F?"...":ne?"...":d(c==="add"?"button.add":"button.save")})]})]})]}),r.jsx(Fo,{isOpen:T,onClose:()=>C(!1),onScanSuccess:L,mode:"set_med_box_med_mode"})]})},gh=()=>{const{listDrawModalOpen:e,closeListDrawModal:t,selectedListDraw:n,triggerRefresh:s}=Ke(),{t:o}=mt(),[l,a]=m.useState(""),[i,c]=m.useState([]),[h,d]=m.useState(""),[g,p]=m.useState("N"),[b,w]=m.useState([]),[D,N]=m.useState(!1);m.useEffect(()=>{n&&e&&(a(n.name||""),c(n.med_info||[]))},[n,e]);const u=M=>{c(A=>A.filter(k=>k.code!==M))},f=async()=>{N(!0);try{const M=await _e.searchMedicine(h,g);w(M)}catch(M){console.error("Search failed:",M),w([])}finally{N(!1)}},x=M=>{const A={id:M.GUID||`${Date.now()}_${Math.random()}`,name:M.NAME,cht_name:M.CHT_NAME,code:M.CODE};c(k=>k.some(E=>E.code===A.code)?k:[...k,A])},S=()=>{n&&(n.name=l,n.med_info=i,s(),t())},$=()=>{t()};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:$}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh"},onClick:M=>M.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(sn,{className:"w-6 h-6 text-gray-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o("modal.listDrawSettings")})]}),r.jsx("button",{onClick:$,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Xe,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-4 py-1 overflow-y-auto",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:o("form.drawerName")}),r.jsx("input",{type:"text",value:l,onChange:M=>a(M.target.value),placeholder:(n==null?void 0:n.name)||o("placeholder.drawerName"),className:"w-full px-2 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors text-base"})]}),r.jsxs("div",{className:"flex gap-6",children:[r.jsxs("div",{className:"space-y-2 w-[50%]",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:o("form.drugList")}),i.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-2",children:i.map(M=>r.jsx("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-1 hover:border-gray-300 transition-colors",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsx("div",{className:"flex-1 min-w-0",children:r.jsxs("div",{children:[M.code&&r.jsx("div",{children:r.jsx("div",{className:"text-sm text-gray-900 font-mono",children:M.code})}),r.jsx("div",{children:r.jsx("div",{className:"text-sm text-gray-900 font-medium",children:M.name||o("status.notSet")})}),r.jsx("div",{children:r.jsx("div",{className:"text-sm text-gray-900",children:M.cht_name||o("status.notSet")})})]})}),r.jsx("button",{onClick:()=>u(M.code),className:"ml-3 p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors flex-shrink-0",title:o("button.remove"),children:r.jsx(Xe,{className:"w-5 h-5"})})]})},M.id))}):r.jsx("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg py-12",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-gray-500 text-lg mb-2",children:o("status.drawerNoDrug")}),r.jsx("div",{className:"text-gray-400 text-sm",children:o("status.drugListEmpty")})]})})]}),r.jsxs("div",{className:"space-y-2 w-[50%]",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:o("form.drugSearch")}),r.jsxs("div",{className:"flex gap-2 mb-2",children:[r.jsx("input",{type:"text",value:h,onChange:M=>d(M.target.value),placeholder:o("placeholder.drugSearch"),className:"border rounded px-3 py-1 flex-1 min-w-0 focus:border-blue-500 focus:outline-none transition-colors"}),r.jsxs("select",{value:g,onChange:M=>p(M.target.value),className:"border rounded px-2 py-1 focus:border-blue-500 focus:outline-none transition-colors",title:"",children:[r.jsx("option",{value:"N",children:"N"}),r.jsx("option",{value:"1",children:"1"}),r.jsx("option",{value:"2",children:"2"}),r.jsx("option",{value:"3",children:"3"}),r.jsx("option",{value:"4",children:"4"})]}),r.jsxs("button",{onClick:f,disabled:D,className:"bg-blue-600 text-white px-4 py-1.5 rounded hover:bg-blue-700 transition-colors whitespace-nowrap disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:[D&&r.jsx(kt,{className:"w-4 h-4 animate-spin"}),o("button.search")]})]}),r.jsx("div",{className:"bg-white border rounded p-3 min-h-[300px] max-h-[300px] overflow-y-auto",children:D?r.jsxs("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:[r.jsx(kt,{className:"w-5 h-5 animate-spin mr-2"}),o("status.searching")]}):b.length>0?r.jsx("div",{className:"space-y-1",children:b.map((M,A)=>r.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded hover:bg-gray-50 transition-colors",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:M.NAME}),r.jsx("div",{className:"text-xs text-gray-500 truncate",children:M.CHT_NAME}),r.jsx("div",{className:"text-xs text-gray-400 font-mono",children:M.CODE})]}),r.jsx("button",{onClick:()=>x(M),className:"ml-2 p-1 text-green-600 hover:text-green-700 hover:bg-green-50 rounded transition-colors flex-shrink-0",title:o("button.add"),children:r.jsx(vt,{className:"w-4 h-4"})})]},M.GUID||A))}):r.jsx("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:o(h||g!=="N"?"status.noSearchResults":"status.searchResults")})})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:$,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:o("button.cancel")}),r.jsx("button",{onClick:S,className:"px-6 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:o("button.save")})]})]})]})},xh=()=>{const{gridDrawModalOpen:e,closeGridDrawModal:t,selectedGridDraw:n,triggerRefresh:s,apiDepartmentData:o,setApiDepartmentData:l,showNotification:a,medicineList:i}=Ke(),{t:c}=mt(),[h,d]=m.useState(""),[g,p]=m.useState(null),[b,w]=m.useState(!1),[D,N]=m.useState(!1),[u,f]=m.useState(null),[x,S]=m.useState(""),[$,M]=m.useState("N"),[A,k]=m.useState([]),[F,E]=m.useState(!1),[q,V]=m.useState(0),[P,O]=m.useState({x:0,y:0});m.useEffect(()=>{if(n&&e)if(d(n.name||""),n.drawer){if(!b){console.log("  drawer :",n);const j=JSON.parse(JSON.stringify(n.drawer));p(j),w(!0),console.log(" :",j)}}else console.log("  drawer "),p(null),w(!1)},[n,e,b]),m.useEffect(()=>{e||(w(!1),p(null),f(null))},[e]);const ne=()=>{n&&ee()},y=()=>{if(console.log(" ..."),console.log(":",g),console.log(" selectedGridDraw:",n),n&&g&&b){console.log("  drawer ...");const j=JSON.parse(JSON.stringify(g));if(n.drawer=j,o){const R=oe=>{oe.forEach(pe=>{pe.GUID===n.GUID&&(console.log(" "),pe.drawer=j),pe.contents&&Array.isArray(pe.contents)&&R(pe.contents),pe.components&&Array.isArray(pe.components)&&R(pe.components)})},z=JSON.parse(JSON.stringify(o));R(z),l(z),console.log(" ")}console.log(" :",n.drawer)}else console.log("  - selectedGridDraworiginalDrawerData  hasBackup "),console.log("selectedGridDraw:",!!n),console.log("originalDrawerData:",!!g),console.log("hasBackup:",b);f(null),w(!1),p(null),s(),t()},T=(j,R)=>{if(!u)return!1;const z=Math.min(u.startRow,u.endRow),oe=Math.max(u.startRow,u.endRow),pe=Math.min(u.startCol,u.endCol),ve=Math.max(u.startCol,u.endCol);return j>=z&&j<=oe&&R>=pe&&R<=ve},C=j=>{var Me;if(!((Me=n==null?void 0:n.drawer)!=null&&Me.Boxes)||j.Slave)return{width:1,height:1};const z=n.drawer.Boxes.flat().filter(me=>me.Slave&&me.MasterBox_Row===j.Row&&me.MasterBox_Column===j.Column);if(z.length===0)return{width:1,height:1};const oe=[j,...z],pe=Math.min(...oe.map(me=>me.Row)),ve=Math.max(...oe.map(me=>me.Row)),ke=Math.min(...oe.map(me=>me.Column));return{width:Math.max(...oe.map(me=>me.Column))-ke+1,height:ve-pe+1}},X=()=>{var ke;if(!u||!((ke=n==null?void 0:n.drawer)!=null&&ke.Boxes))return[];const j=n.drawer.Boxes.flat(),R=Math.min(u.startRow,u.endRow),z=Math.max(u.startRow,u.endRow),oe=Math.min(u.startCol,u.endCol),pe=Math.max(u.startCol,u.endCol),ve=[];return j.forEach(De=>{if(!De.Slave){const Me=C(De),me=De.Row+Me.height-1,ye=De.Column+Me.width-1;De.Row>=R&&me<=z&&De.Column>=oe&&ye<=pe&&ve.push(De)}}),ve},fe=(j,R,z,oe)=>{var ye;if(!u||!((ye=n==null?void 0:n.drawer)!=null&&ye.Boxes))return!1;const pe=n.drawer.Boxes.flat();let ve=!0,ke=j,De=R,Me=z,me=oe;for(;ve;)ve=!1,pe.forEach(je=>{if(!je.Slave){const Ie=C(je),nt=je.Row+Ie.height-1,Ce=je.Column+Ie.width-1;!(je.Row>De||nt<ke||je.Column>me||Ce<Me)&&(je.Row<ke&&(ke=je.Row,ve=!0),nt>De&&(De=nt,ve=!0),je.Column<Me&&(Me=je.Column,ve=!0),Ce>me&&(me=Ce,ve=!0))}});return{minRow:ke,maxRow:De,minCol:Me,maxCol:me}},Z=()=>{var ve;if(!u||!((ve=n==null?void 0:n.drawer)!=null&&ve.Boxes))return!1;const j=Math.min(u.startRow,u.endRow),R=Math.max(u.startRow,u.endRow),z=Math.min(u.startCol,u.endCol),oe=Math.max(u.startCol,u.endCol),pe=n.drawer.Boxes.flat();for(let ke=j;ke<=R;ke++)for(let De=z;De<=oe;De++){let Me=!1;for(const me of pe)if(!me.Slave){const ye=C(me),je=me.Row+ye.height-1,Ie=me.Column+ye.width-1;if(ke>=me.Row&&ke<=je&&De>=me.Column&&De<=Ie){Me=!0;break}}if(!Me)return!1}return!0},le=()=>{var ye,je;const j=X();if(!u)return{canMerge:!1,canUnmerge:!1};if(j.length===0)return{canMerge:!1,canUnmerge:!1};const R=((je=(ye=n==null?void 0:n.drawer)==null?void 0:ye.Boxes)==null?void 0:je.flat())||[],z=j.some(Ie=>R.filter(Ce=>Ce.Slave&&Ce.MasterBox_Row===Ie.Row&&Ce.MasterBox_Column===Ie.Column).length>0),oe=Math.min(u.startRow,u.endRow),pe=Math.max(u.startRow,u.endRow),ve=Math.min(u.startCol,u.endCol),ke=Math.max(u.startCol,u.endCol),De=R.some(Ie=>Ie.Slave&&Ie.Row>=oe&&Ie.Row<=pe&&Ie.Column>=ve&&Ie.Column<=ke);return{canMerge:j.length>1&&Z(),canUnmerge:z||De}},{canMerge:Ne,canUnmerge:ae}=le(),we=async()=>{E(!0);try{const j=x.toLowerCase().trim();let R=i;j&&(R=R.filter(z=>{var oe,pe,ve;return((oe=z.CODE)==null?void 0:oe.toLowerCase().includes(j))||((pe=z.NAME)==null?void 0:pe.toLowerCase().includes(j))||((ve=z.CHT_NAME)==null?void 0:ve.toLowerCase().includes(j))})),$!=="N"&&(R=R.filter(z=>z.DRUGKIND===$)),k(R)}catch(j){console.error("Search failed:",j),k([])}finally{E(!1)}},U=async j=>{var z;if(!u||!((z=n==null?void 0:n.drawer)!=null&&z.Boxes))return;const R=X();if(R.length!==0)try{const oe={ServerName:n.serverName,ServerType:n.serverType,ValueAry:[`guid=${R[0].GUID}`,`code=${j.CODE}`],Data:n.drawer};console.log("  API :",oe);const pe=await _e.request("/api/device/update_drawer_medcode",{method:"POST",body:JSON.stringify(oe)});if(console.log("  API :",pe),pe.Code===200&&pe.Data){if(n.drawer=pe.Data,pe.Data.Boxes&&(n.Boxes=pe.Data.Boxes),console.log(" "),o){const ve=De=>{De.forEach(Me=>{Me.GUID===n.GUID&&(console.log(" "),Me.drawer=n.drawer,n.Boxes&&(Me.Boxes=n.Boxes)),Me.contents&&Array.isArray(Me.contents)&&ve(Me.contents),Me.components&&Array.isArray(Me.components)&&ve(Me.components)})},ke=JSON.parse(JSON.stringify(o));ve(ke),l(ke)}f(null),s()}else console.error(" :",pe),a(`${pe.Result||""}`,"error")}catch(oe){console.error("  API :",oe),a("","error")}},ie=(j,R,z)=>{z.preventDefault(),z.stopPropagation(),"touches"in z&&(V(Date.now()),O({x:z.touches[0].clientX,y:z.touches[0].clientY})),N(!0),f({startRow:j,startCol:R,endRow:j,endCol:R})},xe=(j,R)=>{if(!D||!u)return;const z=Math.min(u.startRow,j),oe=Math.max(u.startRow,j),pe=Math.min(u.startCol,R),ve=Math.max(u.startCol,R),ke=fe(z,oe,pe,ve);ke&&f(De=>De?{startRow:De.startRow,startCol:De.startCol,endRow:j>=De.startRow?ke.maxRow:ke.minRow,endCol:R>=De.startCol?ke.maxCol:ke.minCol}:null)},he=()=>{if(D&&(N(!1),u&&(n!=null&&n.Boxes))){const j=Math.min(u.startRow,u.endRow),R=Math.max(u.startRow,u.endRow),z=Math.min(u.startCol,u.endCol),oe=Math.max(u.startCol,u.endCol),pe=fe(j,R,z,oe);pe&&f({startRow:pe.minRow,startCol:pe.minCol,endRow:pe.maxRow,endCol:pe.maxCol})}},L=()=>{var j;!Ne||!((j=n==null?void 0:n.drawer)!=null&&j.Boxes)||!u||_()},ce=()=>{var j;!ae||!((j=n==null?void 0:n.drawer)!=null&&j.Boxes)||!u||(console.log(u),H())},H=async()=>{var j;if(!(!u||!((j=n==null?void 0:n.drawer)!=null&&j.Boxes)))try{const R=Math.min(u.startRow,u.endRow),z=Math.max(u.startRow,u.endRow),oe=Math.min(u.startCol,u.endCol),pe=Math.max(u.startCol,u.endCol),ke=n.drawer.Boxes.flat().filter(je=>je.Row>=R&&je.Row<=z&&je.Column>=oe&&je.Column<=pe),De=[],Me=[];ke.forEach(je=>{De.push(je.Column.toString()),Me.push(je.Row.toString())});const me={ServerName:n.serverName,ServerType:n.serverType,ValueAry:[`SelectColumns=${De.join(",")}`,`SelectRows=${Me.join(",")}`],Data:{IP:n.ip,Boxes:n.Boxes}};console.log("  API :",me);const ye=await _e.request("/api/device/separate_drawer_boxes",{method:"POST",body:JSON.stringify(me)});if(console.log(" API :",ye),ye.Code===200&&ye.Data){if(ye.Data.Boxes&&Array.isArray(ye.Data.Boxes)&&(n.Boxes=ye.Data.Boxes,n.drawer=ye.Data,console.log(" "),o)){const je=nt=>{nt.forEach(Ce=>{Ce.GUID===n.GUID&&(console.log(" "),Ce.drawer=n.drawer),Ce.contents&&Array.isArray(Ce.contents)&&je(Ce.contents),Ce.components&&Array.isArray(Ce.components)&&je(Ce.components)})},Ie=JSON.parse(JSON.stringify(o));je(Ie),l(Ie)}}else console.error(" API :",ye),a(`${ye.Result||""}`,"error")}catch(R){console.error(" API :",R),a("","error")}finally{console.log("",n),console.log("",o),f(null),s()}},_=async()=>{var j;if(!(!u||!((j=n==null?void 0:n.drawer)!=null&&j.Boxes)))try{const R=Math.min(u.startRow,u.endRow),z=Math.max(u.startRow,u.endRow),oe=Math.min(u.startCol,u.endCol),pe=Math.max(u.startCol,u.endCol),ke=n.drawer.Boxes.flat().filter(je=>je.Row>=R&&je.Row<=z&&je.Column>=oe&&je.Column<=pe),De=[],Me=[];ke.forEach(je=>{De.push(je.Column.toString()),Me.push(je.Row.toString())});const me={ServerName:n.serverName,ServerType:n.serverType,ValueAry:[`SelectColumns=${De.join(",")}`,`SelectRows=${Me.join(",")}`],Data:{IP:n.ip,Boxes:n.Boxes}};console.log("  API :",me);const ye=await _e.request("/api/device/combine_drawer_boxes",{method:"POST",body:JSON.stringify(me)});if(console.log(" API :",ye),ye.Code===200&&ye.Data){if(ye.Data.Boxes&&Array.isArray(ye.Data.Boxes)&&(n.Boxes=ye.Data.Boxes,n.drawer=ye.Data,console.log(" "),o)){const je=nt=>{nt.forEach(Ce=>{Ce.GUID===n.GUID&&(console.log(" "),Ce.drawer=n.drawer),Ce.contents&&Array.isArray(Ce.contents)&&je(Ce.contents),Ce.components&&Array.isArray(Ce.components)&&je(Ce.components)})},Ie=JSON.parse(JSON.stringify(o));je(Ie),l(Ie)}}else console.error(" API :",ye),a(`${ye.Result||""}`,"error")}catch(R){console.error(" API :",R),a("","error")}finally{console.log("",n),console.log("",o),f(null),s()}},ee=async()=>{if(n)try{n.name=h;const j={ServerName:n.serverName,ServerType:n.serverType,Data:[n.drawer]};console.log("  API :",j);const R=await _e.request("/api/device/update_epd583_drawers",{method:"POST",body:JSON.stringify(j)});if(console.log("  API :",R),R.Code===200){if(console.log(" "),a("","success"),o){const z=pe=>{pe.forEach(ve=>{ve.GUID===n.GUID&&(console.log(" "),ve.name=n.name),ve.contents&&Array.isArray(ve.contents)&&z(ve.contents),ve.components&&Array.isArray(ve.components)&&z(ve.components)})},oe=JSON.parse(JSON.stringify(o));z(oe),l(oe)}w(!1),p(null),s(),t()}else console.error(" :",R),a(`${R.Result||""}`,"error")}catch(j){console.error("  API :",j),a("","error")}},I=()=>{var Me;if(!((Me=n==null?void 0:n.drawer)!=null&&Me.Boxes)||n.drawer.Boxes.length===0)return r.jsx("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg py-12",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Ld,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("div",{className:"text-gray-500 text-lg mb-2",children:c("status.gridDrawNotConfigured")}),r.jsx("div",{className:"text-gray-400 text-sm",children:c("status.noDrugInfo")})]})});const j=n.drawer.Boxes.flat(),R=me=>{if(me.Slave)return{width:1,height:1};const ye=j.filter(ze=>ze.Slave&&ze.MasterBox_Row===me.Row&&ze.MasterBox_Column===me.Column);if(ye.length===0)return{width:1,height:1};const je=[me,...ye],Ie=Math.min(...je.map(ze=>ze.Row)),nt=Math.max(...je.map(ze=>ze.Row)),Ce=Math.min(...je.map(ze=>ze.Column));return{width:Math.max(...je.map(ze=>ze.Column))-Ce+1,height:nt-Ie+1}},z=Math.max(...j.map(me=>me.Row+1-1)),oe=Math.max(...j.map(me=>me.Column+1-1)),pe=z+1,ve=oe+1,ke=Array(pe).fill(null).map(()=>Array(ve).fill(!1)),De={};return j.forEach(me=>{if(!me.Slave){const ye=R(me);De[`${me.Row},${me.Column}`]=me,me.calculatedWidth=ye.width,me.calculatedHeight=ye.height}}),j.forEach(me=>{if(!me.Slave&&(me.calculatedWidth>1||me.calculatedHeight>1))for(let ye=me.Row;ye<me.Row+me.calculatedHeight;ye++)for(let je=me.Column;je<me.Column+me.calculatedWidth;je++)(ye!==me.Row||je!==me.Column)&&(ke[ye][je]=!0)}),r.jsx("div",{className:"rounded-lg",children:r.jsx("table",{className:"w-full",children:r.jsx("tbody",{children:Array.from({length:pe},(me,ye)=>r.jsx("tr",{children:Array.from({length:ve},(je,Ie)=>{if(ke[ye][Ie])return null;const nt=`${ye},${Ie}`,Ce=De[nt];return Ce?r.jsx("td",{className:`border border-gray-400 pt-1 pl-1 align-top cursor-pointer select-none ${T(ye,Ie)?"bg-blue-200":"bg-white hover:bg-gray-100"}`,style:{width:`${100/ve}%`,minHeight:"40px",height:`${50*Ce.calculatedHeight}px`,maxHeight:`${50*Ce.calculatedHeight}px`},colSpan:Ce.calculatedWidth,rowSpan:Ce.calculatedHeight,onMouseDown:qe=>ie(ye,Ie,qe),onMouseEnter:()=>xe(ye,Ie),onMouseUp:he,onTouchStart:qe=>ie(ye,Ie,qe),onTouchMove:qe=>{if(qe.preventDefault(),!D)return;const ze=qe.touches[0],Lt=document.elementFromPoint(ze.clientX,ze.clientY),ht=Lt==null?void 0:Lt.closest("td");if(ht){const qt=parseInt(ht.getAttribute("data-row")||"0"),en=parseInt(ht.getAttribute("data-col")||"0");xe(qt,en)}},onTouchEnd:he,"data-row":ye,"data-col":Ie,children:r.jsx("div",{className:"h-full flex flex-col",children:Ce.Code||Ce.Name||Ce.ChineseName?r.jsxs(r.Fragment,{children:[Ce.Code&&r.jsx("div",{className:"text-xs font-mono text-gray-600",children:Ce.Code}),Ce.Name&&r.jsx("div",{className:"text-xs font-medium text-gray-900",children:Ce.Name}),Ce.ChineseName&&r.jsx("div",{className:"text-xs text-gray-700",children:Ce.ChineseName})]}):r.jsx("div",{className:"h-full flex justify-center items-center text-xs text-gray-400 italic text-center",children:c("status.notAdded")})})},Ie):r.jsx("td",{className:`border border-gray-300 p-2 align-top cursor-pointer select-none ${T(ye,Ie)?"border-1 border-blue-500 bg-blue-100":"bg-gray-50 hover:bg-gray-100"}`,style:{width:`${100/ve}%`,minWidth:"80px",minHeight:"80px"},onMouseDown:qe=>ie(ye,Ie,qe),onMouseEnter:()=>xe(ye,Ie),onMouseUp:he,onTouchStart:qe=>ie(ye,Ie,qe),onTouchMove:qe=>{if(qe.preventDefault(),!D)return;const ze=qe.touches[0],Lt=document.elementFromPoint(ze.clientX,ze.clientY),ht=Lt==null?void 0:Lt.closest("td");if(ht){const qt=parseInt(ht.getAttribute("data-row")||"0"),en=parseInt(ht.getAttribute("data-col")||"0");xe(qt,en)}},onTouchEnd:he,"data-row":ye,"data-col":Ie,children:r.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-xs",children:c("status.notAdded")})},Ie)})},ye))})})})};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:y}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh"},onClick:j=>j.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(sn,{className:"w-6 h-6 text-gray-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:c("modal.gridDrawSettings")})]}),r.jsx("button",{onClick:y,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Xe,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"flex-1 px-4 py-2 overflow-y-auto",children:[r.jsxs("div",{className:"space-y-4 pt-2",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("h3",{className:"text-lg whitespace-nowrap font-medium text-gray-900",children:c("form.drawerName")}),r.jsx("input",{type:"text",value:h,onChange:j=>d(j.target.value),disabled:!0,placeholder:(n==null?void 0:n.name)||c("placeholder.gridDrawName"),className:"px-2 py-1 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors text-base"})]}),r.jsx("div",{className:"space-y-1",children:I()})]}),r.jsxs("div",{className:"py-2 flex space-x-4",children:[r.jsx("div",{className:"grid grid-cols-1 gap-2 w-[10%]",children:r.jsxs("div",{className:"grid grid-cols-1 gap-2 items-strat",children:[r.jsx("button",{onClick:L,disabled:!Ne,className:`px-4 py-2 rounded transition-colors ${Ne?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:c("button.merge")}),r.jsx("button",{onClick:ce,disabled:!ae,className:`px-4 py-2 rounded transition-colors ${ae?"bg-red-600 text-white hover:bg-red-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:c("button.unmerge")})]})}),r.jsx("div",{className:"space-y-2 w-[30%]",children:(()=>{const j=X(),R=j.find(z=>!z.Slave);return R&&(R.Code||R.Name||R.ChineseName)?r.jsxs("div",{className:"border border-blue-200 rounded-lg p-2 space-y-1 h-full",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-900 mb-1",children:c("form.drugCode")}),r.jsx("div",{className:"text-base text-gray-900",children:R.Code||"-"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-900  mb-1",children:c("form.drugName")}),r.jsx("div",{className:"text-base text-gray-900",children:R.Name||"-"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-900 mb-1",children:c("form.chineseName")}),r.jsx("div",{className:"text-base text-gray-900",children:R.ChineseName||"-"})]})]}):r.jsx("div",{className:"bg-gray-50 border h-full border-gray-200 rounded-lg p-3 text-center",children:r.jsx("div",{className:"text-gray-500 h-full w-full flex justify-center items-center",children:u&&j.length>0?c("status.selectedCellsNoDrug"):c("status.selectCellsForDrug")})})})()}),r.jsxs("div",{className:"w-[60%]",children:[r.jsxs("div",{className:"flex gap-2 mb-2",children:[r.jsx("input",{type:"text",value:x,onChange:j=>S(j.target.value),placeholder:c("placeholder.drugSearch"),className:"border rounded px-3 py-1 flex-1 min-w-0 focus:border-blue-500 focus:outline-none transition-colors"}),r.jsxs("select",{value:$,onChange:j=>M(j.target.value),className:"border rounded px-2 py-1 focus:border-blue-500 focus:outline-none transition-colors",title:"",children:[r.jsx("option",{value:"N",children:"N"}),r.jsx("option",{value:"1",children:"1"}),r.jsx("option",{value:"2",children:"2"}),r.jsx("option",{value:"3",children:"3"}),r.jsx("option",{value:"4",children:"4"})]}),r.jsxs("button",{onClick:we,disabled:F,className:"bg-blue-600 text-white px-4 py-1.5 rounded hover:bg-blue-700 transition-colors whitespace-nowrap disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:[F&&r.jsx(kt,{className:"w-4 h-4 animate-spin"}),c("button.search")]})]}),r.jsx("div",{className:"bg-white border rounded p-3 min-h-[150px] max-h-[150px] overflow-y-auto",children:F?r.jsxs("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:[r.jsx(kt,{className:"w-5 h-5 animate-spin mr-2"}),c("status.searching")]}):A.length>0?r.jsx("div",{className:"space-y-1",children:A.map((j,R)=>r.jsxs("div",{className:"flex items-center justify-between p-1 border border-gray-200 rounded hover:bg-gray-50 transition-colors",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:j.NAME}),r.jsx("div",{className:"text-xs text-gray-500 truncate",children:j.CHT_NAME}),r.jsx("div",{className:"text-xs text-gray-400 font-mono",children:j.CODE})]}),r.jsx("button",{onClick:()=>U(j),className:"ml-2 p-1 text-green-600 hover:text-green-700 hover:bg-green-50 rounded transition-colors flex-shrink-0",title:c("button.add"),children:r.jsx(vt,{className:"w-4 h-4"})})]},j.GUID||R))}):r.jsx("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:c(x||$!=="N"?"status.noSearchResults":"status.searchResults")})})]})]}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:y,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:c("button.cancel")}),r.jsx("button",{onClick:ne,className:"px-6 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:c("button.save")})]})]}),r.jsx("div",{className:"fixed inset-0 pointer-events-none",onMouseUp:he,onMouseLeave:he,onTouchEnd:he,onTouchCancel:he})]})]})},yh=()=>{var V;const{addParentContainerModalOpen:e,closeAddParentContainerModal:t,selectedDepartmentForAdd:n,selectedDepartmentType:s,setApiDepartmentData:o,setIsLoadingMedMap:l,showNotification:a,triggerRefresh:i,setSidebarOpen:c}=Ke(),{t:h}=mt(),[d,g]=m.useState(null),[p,b]=m.useState(0),[w,D]=m.useState(0),[N,u]=m.useState(!1);m.useEffect(()=>{e&&(g(null),b(0),D(0),u(!1))},[e]),m.useEffect(()=>{d&&(b(d.row),D(d.col))},[d]);const f=()=>{const P=new Set;return n!=null&&n.contents&&n.contents.forEach(O=>{O.type==="parent_container"&&O.gird_position&&P.add(O.gird_position)}),P},x=()=>{const P=f(),O=[];if(P.size===0)return O.push({row:0,col:0}),O;const ne=[];P.forEach(T=>{const[C,X]=T.split(",").map(Number);ne.push({row:C,col:X})});const y=new Set;return ne.forEach(({row:T,col:C})=>{y.add(`${T},${C+1}`),y.add(`${T+1},${C}`),C>0&&y.add(`${T},${C-1}`),T>0&&y.add(`${T-1},${C}`)}),y.forEach(T=>{if(!P.has(T)){const[C,X]=T.split(",").map(Number);C>=0&&X>=0&&O.push({row:C,col:X})}}),P.has("0,1")||O.some(C=>C.row===0&&C.col===1)||O.push({row:0,col:1}),P.has("1,0")||O.some(C=>C.row===1&&C.col===0)||O.push({row:1,col:0}),O.sort((T,C)=>T.row===C.row?T.col-C.col:T.row-C.row)},S=P=>{g(P)},$=P=>{b(P),g({row:P,col:w})},M=P=>{D(P),g({row:p,col:P})},A=d&&!f().has(`${d.row},${d.col}`)&&d.row>=0&&d.col>=0,k=async()=>{if(!(!d||!n||!A)){u(!0);try{const P=`${d.row},${d.col}`,O=await _e.addMedMapSection(n.GUID,P);O.Code===200?(a("","success"),t(),c(!1),await F()):a(`${O.Result||""}`,"error")}catch(P){console.error("Add parent container failed:",P),a("","error")}finally{u(!1)}}},F=async()=>{if(!s){console.warn(" ");return}console.log(" :",s),l(!0);try{const P=await _e.getMedMapByDepartment(s);if(P.Code===200&&P.Data){console.log(" API ");const O=At.convertMedMapApiToFakeData(P.Data);if(!At.validateConvertedData(O)){console.error(" "),a("","error");return}o(O),console.log(" ")}else console.error(" API :",P),a("API ","error")}catch(P){console.error(" :",P),a("","error")}finally{l(!1)}},E=()=>{t()},q=()=>{const P=f(),O=x(),ne=[...P].map(le=>{const[Ne,ae]=le.split(",").map(Number);return{row:Ne,col:ae}}).concat(O);ne.length===0&&ne.push({row:0,col:0});const y=Math.max(...ne.map(le=>le.row)),T=Math.max(...ne.map(le=>le.col)),C=Math.min(...ne.map(le=>le.row)),X=Math.min(...ne.map(le=>le.col)),fe=y-C+1,Z=T-X+1;return r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:r.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${Z}, 1fr)`},children:Array.from({length:fe*Z},(le,Ne)=>{const ae=Math.floor(Ne/Z)+C,we=Ne%Z+X,U=`${ae},${we}`,ie=P.has(U),xe=O.some(L=>L.row===ae&&L.col===we),he=(d==null?void 0:d.row)===ae&&(d==null?void 0:d.col)===we;return r.jsx("button",{onClick:()=>xe&&S({row:ae,col:we}),disabled:ie||!xe,className:`
                    w-16 h-16 border-2 rounded-lg transition-all duration-200 flex items-center justify-center text-sm font-medium
                    ${ie?"bg-red-100 border-red-300 text-red-600 cursor-not-allowed":he?"bg-blue-500 border-blue-600 text-white shadow-lg":xe?"bg-green-100 border-green-300 text-green-700 hover:bg-green-200 hover:border-green-400 cursor-pointer":"bg-gray-100 border-gray-300 text-gray-400 cursor-not-allowed"}
                  `,title:ie?"":xe?"":"",children:ie?"":`${ae},${we}`},U)})})})]})};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:E}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh",maxWidth:"800px"},onClick:P=>P.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(vt,{className:"w-6 h-6 text-green-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:E,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Xe,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-6 py-4 overflow-y-auto",children:r.jsxs("div",{className:"space-y-6",children:[q(),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Row):"}),r.jsx("input",{type:"number",min:"0",value:p,onChange:P=>$(parseInt(P.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Column):"}),r.jsx("input",{type:"number",min:"0",value:w,onChange:P=>M(parseInt(P.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]})]}),d&&r.jsx("div",{className:`text-sm p-2 rounded ${A?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:A?`${d.row},${d.col}`:` ${d.row},${d.col} `})]}),r.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsxs("div",{children:["",(n==null?void 0:n.name)||""]}),r.jsxs("div",{children:["",(n==null?void 0:n.type)||""]}),r.jsxs("div",{children:["",((V=n==null?void 0:n.contents)==null?void 0:V.filter(P=>P.type==="parent_container").length)||0]})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:E,disabled:N,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h("button.cancel")}),r.jsxs("button",{onClick:k,disabled:!A||N,className:"px-6 py-2 text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[N&&r.jsx(kt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:N?"...":""})]})]})]})]})},wc=[{value:"dispensing_shelves",label:"",icon:r.jsx(Jm,{className:"w-5 h-5"}),isShelf:!0},{value:"store_shelves",label:"",icon:r.jsx(Fm,{className:"w-5 h-5"}),isShelf:!0},{value:"list_draw",label:"",icon:r.jsx(da,{className:"w-5 h-5"}),isShelf:!1},{value:"grid_draw",label:"",icon:r.jsx(Ld,{className:"w-5 h-5"}),isShelf:!1}],vh=()=>{var fe;const{addShelfDrawContainerModalOpen:e,closeAddShelfDrawContainerModal:t,selectedSubContainerForAdd:n,selectedDepartmentType:s,setApiDepartmentData:o,setIsLoadingMedMap:l,showNotification:a,triggerRefresh:i,setSidebarOpen:c}=Ke(),{t:h}=mt(),[d,g]=m.useState("dispensing_shelves"),[p,b]=m.useState("1"),[w,D]=m.useState("1"),[N,u]=m.useState(""),[f,x]=m.useState(null),[S,$]=m.useState(0),[M,A]=m.useState(0),[k,F]=m.useState(!1);m.useEffect(()=>{e&&(g("dispensing_shelves"),b("1"),D("1"),u(""),x(null),$(0),A(0),F(!1))},[e]),m.useEffect(()=>{f&&($(f.row),A(f.col))},[f]);const E=()=>{const Z=new Set;return n!=null&&n.contents&&n.contents.forEach(le=>{le.gird_position&&Z.add(le.gird_position)}),Z},q=()=>{const Z=E(),le=[];if(Z.size===0)return le.push({row:0,col:0}),le;const Ne=[];Z.forEach(we=>{const[U,ie]=we.split(",").map(Number);Ne.push({row:U,col:ie})});const ae=new Set;return Ne.forEach(({row:we,col:U})=>{ae.add(`${we},${U+1}`),ae.add(`${we+1},${U}`),U>0&&ae.add(`${we},${U-1}`),we>0&&ae.add(`${we-1},${U}`)}),ae.forEach(we=>{if(!Z.has(we)){const[U,ie]=we.split(",").map(Number);U>=0&&ie>=0&&le.push({row:U,col:ie})}}),Z.has("0,1")||le.some(U=>U.row===0&&U.col===1)||le.push({row:0,col:1}),Z.has("1,0")||le.some(U=>U.row===1&&U.col===0)||le.push({row:1,col:0}),le.sort((we,U)=>we.row===U.row?we.col-U.col:we.row-U.row)},V=Z=>{x(Z)},P=Z=>{$(Z),x({row:Z,col:M})},O=Z=>{A(Z),x({row:S,col:Z})},ne=f&&!E().has(`${f.row},${f.col}`)&&f.row>=0&&f.col>=0,y=async()=>{if(!(!f||!n||!ne)){F(!0);try{const Z=`${f.row},${f.col}`,le=wc.find(ae=>ae.value===d);let Ne;le!=null&&le.isShelf?Ne=await _e.addMedMapShelf({Master_GUID:n.GUID,position:Z,width:p,height:w,ip_light:N,type:d}):Ne=await _e.addMedMapDrawer({Master_GUID:n.GUID,position:Z,width:p,height:w,ip_drawer:N,type:d}),Ne.Code===200?(a("","success"),t(),c(!1),await T()):a(`${Ne.Result||""}`,"error")}catch(Z){console.error("Add container failed:",Z),a("","error")}finally{F(!1)}}},T=async()=>{if(!s){console.warn(" ");return}console.log(" :",s),l(!0);try{const Z=await _e.getMedMapByDepartment(s);if(Z.Code===200&&Z.Data){console.log(" API ");const le=At.convertMedMapApiToFakeData(Z.Data);if(!At.validateConvertedData(le)){console.error(" "),a("","error");return}o(le),console.log(" ")}else console.error(" API :",Z),a("API ","error")}catch(Z){console.error(" :",Z),a("","error")}finally{l(!1)}},C=()=>{t()},X=()=>{const Z=E(),le=q(),Ne=[...Z].map(L=>{const[ce,H]=L.split(",").map(Number);return{row:ce,col:H}}).concat(le);Ne.length===0&&Ne.push({row:0,col:0});const ae=Math.max(...Ne.map(L=>L.row)),we=Math.max(...Ne.map(L=>L.col)),U=Math.min(...Ne.map(L=>L.row)),ie=Math.min(...Ne.map(L=>L.col)),xe=ae-U+1,he=we-ie+1;return r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:r.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${he}, 1fr)`},children:Array.from({length:xe*he},(L,ce)=>{const H=Math.floor(ce/he)+U,_=ce%he+ie,ee=`${H},${_}`,I=Z.has(ee),j=le.some(z=>z.row===H&&z.col===_),R=(f==null?void 0:f.row)===H&&(f==null?void 0:f.col)===_;return r.jsx("button",{onClick:()=>j&&V({row:H,col:_}),disabled:I||!j,className:`
                    w-16 h-16 border-2 rounded-lg transition-all duration-200 flex items-center justify-center text-sm font-medium
                    ${I?"bg-red-100 border-red-300 text-red-600 cursor-not-allowed":R?"bg-blue-500 border-blue-600 text-white shadow-lg":j?"bg-green-100 border-green-300 text-green-700 hover:bg-green-200 hover:border-green-400 cursor-pointer":"bg-gray-100 border-gray-300 text-gray-400 cursor-not-allowed"}
                  `,title:I?"":j?"":"",children:I?"":`${H},${_}`},ee)})})})]})};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:C}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh",maxWidth:"1000px"},onClick:Z=>Z.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(vt,{className:"w-6 h-6 text-green-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"/"})]}),r.jsx("button",{onClick:C,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Xe,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-6 py-4 overflow-y-auto",children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:wc.map(Z=>r.jsxs("label",{className:`flex items-center space-x-3 p-4 border-2 rounded-lg cursor-pointer transition-all ${d===Z.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[r.jsx("input",{type:"radio",name:"containerType",value:Z.value,checked:d===Z.value,onChange:le=>g(le.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 hidden"}),r.jsxs("div",{className:"flex items-center space-x-3",children:[Z.icon,r.jsx("span",{className:"font-medium text-gray-900",children:Z.label})]})]},Z.value))})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:""}),r.jsx("input",{type:"number",min:"1",value:p,onChange:Z=>b(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:""}),r.jsx("input",{type:"number",min:"1",value:w,onChange:Z=>D(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"IP "}),r.jsx("input",{type:"text",value:N,onChange:Z=>u(Z.target.value),placeholder:" IP ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),X(),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Row):"}),r.jsx("input",{type:"number",min:"0",value:S,onChange:Z=>P(parseInt(Z.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Column):"}),r.jsx("input",{type:"number",min:"0",value:M,onChange:Z=>O(parseInt(Z.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]})]}),f&&r.jsx("div",{className:`text-sm p-2 rounded ${ne?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:ne?`${f.row},${f.col}`:` ${f.row},${f.col} `})]}),r.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsxs("div",{children:["",(n==null?void 0:n.name)||""]}),r.jsxs("div",{children:["",(n==null?void 0:n.type)||""]}),r.jsxs("div",{children:["",((fe=n==null?void 0:n.contents)==null?void 0:fe.length)||0]})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:C,disabled:k,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h("button.cancel")}),r.jsxs("button",{onClick:y,disabled:!ne||k,className:"px-6 py-2 text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[k&&r.jsx(kt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:k?"...":""})]})]})]})]})},wh=()=>{var V;const{addSubContainerModalOpen:e,closeAddSubContainerModal:t,selectedParentContainerForAdd:n,selectedDepartmentType:s,setApiDepartmentData:o,setIsLoadingMedMap:l,showNotification:a,triggerRefresh:i,setSidebarOpen:c}=Ke(),{t:h}=mt(),[d,g]=m.useState(null),[p,b]=m.useState(0),[w,D]=m.useState(0),[N,u]=m.useState(!1);m.useEffect(()=>{e&&(g(null),b(0),D(0),u(!1))},[e]),m.useEffect(()=>{d&&(b(d.row),D(d.col))},[d]);const f=()=>{const P=new Set;return n!=null&&n.contents&&n.contents.forEach(O=>{O.type==="sub_container"&&O.gird_position&&P.add(O.gird_position)}),P},x=()=>{const P=f(),O=[];if(P.size===0)return O.push({row:0,col:0}),O;const ne=[];P.forEach(T=>{const[C,X]=T.split(",").map(Number);ne.push({row:C,col:X})});const y=new Set;return ne.forEach(({row:T,col:C})=>{y.add(`${T},${C+1}`),y.add(`${T+1},${C}`),C>0&&y.add(`${T},${C-1}`),T>0&&y.add(`${T-1},${C}`)}),y.forEach(T=>{if(!P.has(T)){const[C,X]=T.split(",").map(Number);C>=0&&X>=0&&O.push({row:C,col:X})}}),P.has("0,1")||O.some(C=>C.row===0&&C.col===1)||O.push({row:0,col:1}),P.has("1,0")||O.some(C=>C.row===1&&C.col===0)||O.push({row:1,col:0}),O.sort((T,C)=>T.row===C.row?T.col-C.col:T.row-C.row)},S=P=>{g(P)},$=P=>{b(P),g({row:P,col:w})},M=P=>{D(P),g({row:p,col:P})},A=d&&!f().has(`${d.row},${d.col}`)&&d.row>=0&&d.col>=0,k=async()=>{if(!(!d||!n||!A)){u(!0);try{const P=`${d.row},${d.col}`,O=await _e.addSubSection(n.GUID,P);O.Code===200?(a("","success"),t(),c(!1),await F()):a(`${O.Result||""}`,"error")}catch(P){console.error("Add sub container failed:",P),a("","error")}finally{u(!1)}}},F=async()=>{if(!s){console.warn(" ");return}console.log(" :",s),l(!0);try{const P=await _e.getMedMapByDepartment(s);if(P.Code===200&&P.Data){console.log(" API ");const O=At.convertMedMapApiToFakeData(P.Data);if(!At.validateConvertedData(O)){console.error(" "),a("","error");return}o(O),console.log(" ")}else console.error(" API :",P),a("API ","error")}catch(P){console.error(" :",P),a("","error")}finally{l(!1)}},E=()=>{t()},q=()=>{const P=f(),O=x(),ne=[...P].map(le=>{const[Ne,ae]=le.split(",").map(Number);return{row:Ne,col:ae}}).concat(O);ne.length===0&&ne.push({row:0,col:0});const y=Math.max(...ne.map(le=>le.row)),T=Math.max(...ne.map(le=>le.col)),C=Math.min(...ne.map(le=>le.row)),X=Math.min(...ne.map(le=>le.col)),fe=y-C+1,Z=T-X+1;return r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:r.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${Z}, 1fr)`},children:Array.from({length:fe*Z},(le,Ne)=>{const ae=Math.floor(Ne/Z)+C,we=Ne%Z+X,U=`${ae},${we}`,ie=P.has(U),xe=O.some(L=>L.row===ae&&L.col===we),he=(d==null?void 0:d.row)===ae&&(d==null?void 0:d.col)===we;return r.jsx("button",{onClick:()=>xe&&S({row:ae,col:we}),disabled:ie||!xe,className:`
                    w-16 h-16 border-2 rounded-lg transition-all duration-200 flex items-center justify-center text-sm font-medium
                    ${ie?"bg-red-100 border-red-300 text-red-600 cursor-not-allowed":he?"bg-blue-500 border-blue-600 text-white shadow-lg":xe?"bg-green-100 border-green-300 text-green-700 hover:bg-green-200 hover:border-green-400 cursor-pointer":"bg-gray-100 border-gray-300 text-gray-400 cursor-not-allowed"}
                  `,title:ie?"":xe?"":"",children:ie?"":`${ae},${we}`},U)})})})]})};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:E}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh",maxWidth:"800px"},onClick:P=>P.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(vt,{className:"w-6 h-6 text-green-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:E,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Xe,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-6 py-4 overflow-y-auto",children:r.jsxs("div",{className:"space-y-6",children:[q(),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Row):"}),r.jsx("input",{type:"number",min:"0",value:p,onChange:P=>$(parseInt(P.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Column):"}),r.jsx("input",{type:"number",min:"0",value:w,onChange:P=>M(parseInt(P.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]})]}),d&&r.jsx("div",{className:`text-sm p-2 rounded ${A?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:A?`${d.row},${d.col}`:` ${d.row},${d.col} `})]}),r.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsxs("div",{children:["",(n==null?void 0:n.name)||""]}),r.jsxs("div",{children:["",(n==null?void 0:n.type)||""]}),r.jsxs("div",{children:["",((V=n==null?void 0:n.contents)==null?void 0:V.filter(P=>P.type==="sub_container").length)||0]})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:E,disabled:N,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h("button.cancel")}),r.jsxs("button",{onClick:k,disabled:!A||N,className:"px-6 py-2 text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[N&&r.jsx(kt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:N?"...":""})]})]})]})]})},bh=({isOpen:e,onClose:t,storeShelf:n})=>{const{showNotification:s,medicineList:o,isLoadingMedicines:l,addStockToShelf:a,selectedStockItemForEdit:i,storeItemModalMode:c,updateStockInShelf:h}=Ke(),[d,g]=m.useState(""),[p,b]=m.useState(""),[w,D]=m.useState(""),[N,u]=m.useState(""),[f,x]=m.useState([]),[S,$]=m.useState([]),[M,A]=m.useState(""),[k,F]=m.useState(""),[E,q]=m.useState(""),[V,P]=m.useState(null),[O,ne]=m.useState([]),[y,T]=m.useState(""),[C,X]=m.useState(!1),fe=m.useRef(null);m.useEffect(()=>{if(e&&c==="edit"&&i){g(i.code||""),b(i.name||""),D(""),u(i.material_no||"");const L=i.lot||[],ce=i.expiry_date||[],H=i.qty||[],_=[];if(L.length>0||ce.length>0||H.length>0){const ee=Math.max(L.length,ce.length,H.length),I=[];for(let j=0;j<ee;j++){const R=ce[j]||"";let z="";R&&(z=R.split("T")[0]),z=z.replace(/\//g,"-"),I.push({id:`batch_${Date.now()}_${j}`,lot:L[j]||"",expiryDate:z,qty:String(H[j]||"")}),z&&_.push(z)}x(I),$(_)}else x([]),$([]);A(i.location||""),F(i.led_index||""),q(i.ip||"")}else e&&c==="add"&&(g(""),b(""),D(""),u(""),x([]),$([]),A(""),F(""),q(""))},[e,c,i]),m.useEffect(()=>{const L=ce=>{fe.current&&!fe.current.contains(ce.target)&&P(null)};return document.addEventListener("mousedown",L),()=>{document.removeEventListener("mousedown",L)}},[]);const Z=(L,ce)=>{if(!ce.trim()){ne([]);return}const H=ce.toLowerCase(),_=o.filter(ee=>{var I,j,R,z;switch(L){case"code":return(I=ee.CODE)==null?void 0:I.toLowerCase().includes(H);case"name":return(j=ee.NAME)==null?void 0:j.toLowerCase().includes(H);case"chineseName":return(R=ee.CHT_NAME)==null?void 0:R.toLowerCase().includes(H);case"skdiacode":return(z=ee.SKDIACODE)==null?void 0:z.toLowerCase().includes(H);default:return!1}});ne(_.slice(0,50))},le=(L,ce)=>{switch(P(L),L){case"code":g(ce);break;case"name":b(ce);break;case"chineseName":D(ce);break;case"skdiacode":u(ce);break}Z(L,ce)},Ne=(L,ce)=>{switch(ce){case"code":g(L.CODE||""),b(L.NAME||""),D(L.CHT_NAME||""),u(L.SKDIACODE||"");break;case"name":g(L.CODE||""),b(L.NAME||""),D(L.CHT_NAME||""),u(L.SKDIACODE||"");break;case"chineseName":g(L.CODE||""),b(L.NAME||""),D(L.CHT_NAME||""),u(L.SKDIACODE||"");break;case"skdiacode":g(L.CODE||""),b(L.NAME||""),D(L.CHT_NAME||""),u(L.SKDIACODE||"");break}T(L.GUID),P(null),ne([])},ae=()=>{const L={id:`batch_${Date.now()}`,lot:"",expiryDate:"",qty:""};x([...f,L])},we=L=>{x(f.filter(ce=>ce.id!==L))},U=(L,ce,H)=>{x(f.map(_=>_.id===L?{..._,[ce]:H}:_))},ie=async()=>{var _;if(!d||!p){s("","error");return}if(!n||!n.GUID){s("","error");return}const L=[],ce=[],H=[];f.forEach(ee=>{L.push(ee.lot||"");let I="";ee.expiryDate&&(I=`${ee.expiryDate}`),ce.push(I),H.push(ee.qty?`${Number(ee.qty)}`:"0")});try{if(c==="edit"&&i){const ee={GUID:i.GUID,code:d,device_type:"EPD290",expiry_date:ce,ip:E||"",led_index:k||"",location:M||"",lot:L,material_no:N||"",name:p,qty:H,shelf_guid:n.GUID},I=await _e.updateStock([ee]);if(I.Code===200){h(n.GUID,i.GUID,ee),console.log("");const j=S.filter(R=>!ce.includes(R));if(console.log(j),j.length>0){console.log(" :",j);let R="";try{i.Value&&(R=JSON.parse(i.Value).GUID||"",console.log("  Value  GUID:",R))}catch(z){console.error("  Value :",z)}if(R){for(const z of j)try{console.log(` GUID: ${R}, : ${z}`);const oe=await _e.stockDeleteValidityPeriod(R,z);oe.Code===200?console.log(` : ${z}`):console.warn(`  (: ${z}):`,oe.Result)}catch(oe){console.error(`  (: ${z}):`,oe)}s(` ${j.length} `,"success")}else console.warn("  Value GUID"),s("","success")}else s("","success");he()}else s(I.Result||"","error")}else{const ee={code:d,device_type:"EPD290",expiry_date:ce,ip:E||"",led_index:k||"",location:M||"",lot:L,material_no:N||"",name:p,qty:H,shelf_guid:n.GUID},I=await _e.addStock([ee]);I.Code===200?(a(n.GUID,{GUID:((_=I.Data)==null?void 0:_.GUID)||`stock_${Date.now()}`,...ee}),s("","success"),he()):s(I.Result||"","error")}}catch(ee){console.error(":",ee),s(c==="edit"?"":"","error")}},xe=(L,ce)=>{console.log(" :",ce),g(ce[0].CODE||ce[0].code||""),b(ce[0].NAME||ce[0].name||""),D(ce[0].CHT_NAME||ce[0].cht_name||""),u(ce[0].SKDIACODE||ce[0].skdiacode||ce[0].material_no||""),T(ce[0].GUID||""),X(!1),s("","success")},he=()=>{g(""),b(""),D(""),u(""),x([]),$([]),A(""),F(""),q(""),T(""),ne([]),P(null),t()};return e?r.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between z-10",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800",children:c==="edit"?"":""}),r.jsx("button",{onClick:he,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:r.jsx(Xe,{className:"w-5 h-5"})})]}),r.jsx("div",{className:"p-6 space-y-6",children:l?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"..."})]}):o.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-gray-600",children:""}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:""})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex w-full border-b items-center pb-1",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700 mr-6",children:""}),r.jsx("button",{onClick:()=>X(!0),className:"hover:bg-gray-100 rounded-lg transition-colors p-2",title:"",children:r.jsx(Dr,{className:"w-7 h-7 text-blue-600"})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"relative",ref:V==="code"?fe:null,children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:d,onChange:L=>le("code",L.target.value),onFocus:()=>P("code"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""}),V==="code"&&O.length>0&&r.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:O.map(L=>r.jsxs("div",{onClick:()=>Ne(L,"code"),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer border-b last:border-b-0",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx("span",{className:"font-medium text-gray-900",children:L.CODE}),r.jsx("span",{className:"text-gray-600",children:"|"}),r.jsx("span",{className:"text-gray-700",children:L.NAME})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1",children:[r.jsx("span",{className:"text-gray-600",children:L.CHT_NAME}),r.jsx("span",{className:"text-gray-400",children:"|"}),r.jsxs("span",{className:"text-gray-500",children:[": ",L.SKDIACODE]})]})]},L.GUID))})]}),r.jsxs("div",{className:"relative",ref:V==="name"?fe:null,children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:p,onChange:L=>le("name",L.target.value),onFocus:()=>P("name"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""}),V==="name"&&O.length>0&&r.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:O.map(L=>r.jsxs("div",{onClick:()=>Ne(L,"name"),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer border-b last:border-b-0",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx("span",{className:"font-medium text-gray-900",children:L.CODE}),r.jsx("span",{className:"text-gray-600",children:"|"}),r.jsx("span",{className:"text-gray-700",children:L.NAME})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1",children:[r.jsx("span",{className:"text-gray-600",children:L.CHT_NAME}),r.jsx("span",{className:"text-gray-400",children:"|"}),r.jsxs("span",{className:"text-gray-500",children:[": ",L.SKDIACODE]})]})]},L.GUID))})]}),r.jsxs("div",{className:"relative",ref:V==="chineseName"?fe:null,children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:w,onChange:L=>le("chineseName",L.target.value),onFocus:()=>P("chineseName"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""}),V==="chineseName"&&O.length>0&&r.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:O.map(L=>r.jsxs("div",{onClick:()=>Ne(L,"chineseName"),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer border-b last:border-b-0",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx("span",{className:"font-medium text-gray-900",children:L.CODE}),r.jsx("span",{className:"text-gray-600",children:"|"}),r.jsx("span",{className:"text-gray-700",children:L.NAME})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1",children:[r.jsx("span",{className:"text-gray-600",children:L.CHT_NAME}),r.jsx("span",{className:"text-gray-400",children:"|"}),r.jsxs("span",{className:"text-gray-500",children:[": ",L.SKDIACODE]})]})]},L.GUID))})]}),r.jsxs("div",{className:"relative",ref:V==="skdiacode"?fe:null,children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:N,onChange:L=>le("skdiacode",L.target.value),onFocus:()=>P("skdiacode"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""}),V==="skdiacode"&&O.length>0&&r.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:O.map(L=>r.jsxs("div",{onClick:()=>Ne(L,"skdiacode"),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer border-b last:border-b-0",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx("span",{className:"font-medium text-gray-900",children:L.CODE}),r.jsx("span",{className:"text-gray-600",children:"|"}),r.jsx("span",{className:"text-gray-700",children:L.NAME})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1",children:[r.jsx("span",{className:"text-gray-600",children:L.CHT_NAME}),r.jsx("span",{className:"text-gray-400",children:"|"}),r.jsxs("span",{className:"text-gray-500",children:[": ",L.SKDIACODE]})]})]},L.GUID))})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:""}),r.jsxs("button",{onClick:ae,className:"flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"",children:[r.jsx(vt,{className:"w-4 h-4"}),""]})]}),f.length===0?r.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[r.jsx("p",{className:"text-gray-500",children:""}),r.jsx("p",{className:"text-sm text-gray-400 mt-1",children:""})]}):r.jsx("div",{className:"space-y-3",children:f.map((L,ce)=>r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[" ",ce+1]}),r.jsx("button",{onClick:()=>we(L.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:r.jsx(eh,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),r.jsx("input",{type:"text",value:L.lot,onChange:H=>U(L.id,"lot",H.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),r.jsx("input",{type:"date",value:L.expiryDate,onChange:H=>U(L.id,"expiryDate",H.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),r.jsx("input",{type:"number",value:L.qty,onChange:H=>U(L.id,"qty",H.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"",min:"0"})]})]})]},L.id))})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:""}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:M,onChange:L=>A(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LED "}),r.jsx("input",{type:"text",value:k,onChange:L=>F(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:" LED "})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" IP"}),r.jsx("input",{type:"text",value:E,onChange:L=>q(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:" IP"})]})]})]})]})}),r.jsxs("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 border-t flex justify-end space-x-3",children:[r.jsx("button",{onClick:he,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition-colors",children:""}),r.jsx("button",{onClick:ie,disabled:l||o.length===0,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400",children:c==="edit"?"":""})]})]}),r.jsx(Fo,{isOpen:C,onClose:()=>X(!1),onScanSuccess:xe,mode:"set_store_med_mode"})]}):null},Nh=({isOpen:e,onClose:t})=>{const{selectedDepartmentType:n,apiDepartmentData:s,allDepartmentsList:o,showNotification:l,triggerRefresh:a,reloadMedMapData:i}=Ke(),[c,h]=m.useState(null),[d,g]=m.useState(""),[p,b]=m.useState(!1),w=()=>s?s.map(A=>A.name):[],D=()=>!n||!o?[]:o.filter(A=>A["department_type "]===n),N=()=>{const A=w();return D().filter(F=>!A.includes(F.name))},u=()=>s?s.map(A=>A.gird_position):[],f=()=>{const A=u(),k=[];for(let F=0;F<10;F++)for(let E=0;E<10;E++){const q=`${F},${E}`;A.includes(q)||k.push(q)}return k.slice(0,20)};m.useEffect(()=>{e&&(h(null),g(""))},[e]);const x=async()=>{if(!c){l("","error");return}if(!d){l("","error");return}if(!n){l("","error");return}b(!0);try{const A=await _e.addMedMap(c.name,c.type,d);A.Code===200?(l("","success"),await i(),S()):l(A.Result||"","error")}catch(A){console.error(":",A),l("","error")}finally{b(!1)}},S=()=>{h(null),g(""),t()};if(!e)return null;const $=N(),M=f();return r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800",children:""}),r.jsx("button",{onClick:S,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:r.jsx(Xe,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-6 space-y-6",children:[n&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["",r.jsx("span",{className:"font-bold",children:n})]})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:""}),$.length===0?r.jsx("div",{className:"text-center py-8",children:r.jsx("p",{className:"text-gray-600",children:""})}):r.jsx("div",{className:"space-y-2",children:$.map(A=>r.jsxs("label",{className:`flex items-center p-4 border-2 rounded-lg cursor-pointer transition-all ${(c==null?void 0:c.name)===A.name?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300 hover:bg-gray-50"}`,children:[r.jsx("input",{type:"radio",name:"department",value:A.name,checked:(c==null?void 0:c.name)===A.name,onChange:()=>h(A),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),r.jsxs("div",{className:"ml-3",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:A.name}),r.jsx("div",{className:"text-xs text-gray-500",children:A.type})]})]},A.name))})]}),c&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:""}),M.length===0?r.jsx("div",{className:"text-center py-8",children:r.jsx("p",{className:"text-gray-600",children:""})}):r.jsx("div",{className:"grid grid-cols-5 gap-2",children:M.map(A=>{const[k,F]=A.split(",");return r.jsxs("button",{onClick:()=>g(A),className:`p-3 border-2 rounded-lg text-sm font-medium transition-all ${d===A?"border-blue-500 bg-blue-500 text-white":"border-gray-200 hover:border-blue-300 hover:bg-blue-50 text-gray-700"}`,children:["(",k,",",F,")"]},A)})})]})]}),r.jsxs("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 border-t flex justify-end space-x-3",children:[r.jsx("button",{onClick:S,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition-colors",disabled:p,children:""}),r.jsx("button",{onClick:x,disabled:!c||!d||p,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:p?"...":""})]})]})})},jh=({isOpen:e,onClose:t,initialBarcode:n=""})=>{const{showNotification:s,medicineList:o,isLoadingMedicines:l}=Ke(),[a,i]=m.useState(""),[c,h]=m.useState(""),[d,g]=m.useState(""),[p,b]=m.useState(""),[w,D]=m.useState(""),[N,u]=m.useState(null),[f,x]=m.useState([]),[S,$]=m.useState(""),[M,A]=m.useState(null),[k,F]=m.useState(!1),E=m.useRef(null);m.useEffect(()=>{e&&(i(n),h(""),g(""),b(""),D(""),$(""),A(null),u(null))},[e,n]),m.useEffect(()=>{const y=T=>{E.current&&!E.current.contains(T.target)&&u(null)};return document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[]);const q=(y,T)=>{if(!T.trim()||l){x([]);return}const C=T.toLowerCase(),X=o.filter(fe=>{var Z,le,Ne,ae;switch(y){case"code":return(Z=fe.CODE)==null?void 0:Z.toLowerCase().includes(C);case"name":return(le=fe.NAME)==null?void 0:le.toLowerCase().includes(C);case"chineseName":return(Ne=fe.CHT_NAME)==null?void 0:Ne.toLowerCase().includes(C);case"skdiacode":return(ae=fe.SKDIACODE)==null?void 0:ae.toLowerCase().includes(C);default:return!1}});x(X.slice(0,10))},V=(y,T)=>{switch(u(y),y){case"code":h(T);break;case"name":g(T);break;case"chineseName":b(T);break;case"skdiacode":D(T);break}q(y,T)},P=y=>{$(y.GUID),A(y),h(y.CODE||""),g(y.NAME||""),b(y.CHT_NAME||""),D(y.SKDIACODE||""),u(null),x([])},O=()=>{i(""),h(""),g(""),b(""),D(""),$(""),A(null),u(null),x([]),t()},ne=async()=>{if(!c.trim()){s("","error");return}if(!a.trim()){s("","error");return}F(!0);try{let y=[];if(M&&M.BARCODE2)try{const C=JSON.parse(M.BARCODE2);Array.isArray(C)?y=[...C]:typeof C=="string"&&(y=[C])}catch{console.warn(" BARCODE2 :",M.BARCODE2),M.BARCODE2&&(y=[M.BARCODE2])}y.includes(a.trim())||y.push(a.trim()),console.log("  BARCODE2 :",y);const T=await _e.addMedClouds(a.trim(),c.trim(),JSON.stringify(y),M.BARCODE);T.Code===200?(s("","success"),O()):s(T.Result||"","error")}catch(y){console.error(":",y),s("","error")}finally{F(!1)}};return e?r.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between p-2 border-b",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:r.jsx(vt,{className:"w-6 h-6 text-blue-500"})}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:O,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",disabled:k,children:r.jsx(Xe,{className:"w-6 h-6 text-gray-600"})})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:r.jsxs("div",{className:"space-y-4",ref:E,children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:a,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-600 cursor-not-allowed"})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[" ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:c,onChange:y=>V("code",y.target.value),onFocus:()=>u("code"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"...",disabled:k}),N==="code"&&f.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:f.map(y=>r.jsxs("div",{onClick:()=>P(y),className:"px-4 py-2 hover:bg-green-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[r.jsx("div",{className:"font-medium text-gray-800",children:y.CODE}),r.jsx("div",{className:"text-sm text-gray-600",children:y.NAME})]},y.GUID))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:d,onChange:y=>V("name",y.target.value),onFocus:()=>u("name"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"...",disabled:k}),N==="name"&&f.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:f.map(y=>r.jsxs("div",{onClick:()=>P(y),className:"px-4 py-2 hover:bg-green-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[r.jsx("div",{className:"font-medium text-gray-800",children:y.NAME}),r.jsx("div",{className:"text-sm text-gray-600",children:y.CODE})]},y.GUID))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:p,onChange:y=>V("chineseName",y.target.value),onFocus:()=>u("chineseName"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"...",disabled:k}),N==="chineseName"&&f.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:f.map(y=>r.jsxs("div",{onClick:()=>P(y),className:"px-4 py-2 hover:bg-green-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[r.jsx("div",{className:"font-medium text-gray-800",children:y.CHT_NAME}),r.jsx("div",{className:"text-sm text-gray-600",children:y.CODE})]},y.GUID))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:w,onChange:y=>V("skdiacode",y.target.value),onFocus:()=>u("skdiacode"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"...",disabled:k}),N==="skdiacode"&&f.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:f.map(y=>r.jsxs("div",{onClick:()=>P(y),className:"px-4 py-2 hover:bg-green-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[r.jsx("div",{className:"font-medium text-gray-800",children:y.SKDIACODE}),r.jsx("div",{className:"text-sm text-gray-600",children:y.NAME})]},y.GUID))})]}),l&&r.jsx("div",{className:"text-center py-2 text-gray-500 text-sm",children:"..."})]})}),r.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:O,disabled:k,className:"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:""}),r.jsx("button",{onClick:ne,disabled:k||!c.trim(),className:"px-6 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:k?"...":""})]})})]})}):null},Sh=({container:e,highlightedMedicineCode:t,pendingRequisitionCodes:n=[],onMedicineClick:s})=>{const o=d=>{const[g,p]=d.split(",").map(Number);return{row:g||0,col:p||0}},l=d=>{if(!d||d.length===0)return{sortedContents:[],maxRow:0,maxCol:0};const g=d.map(D=>({...D,gridPos:o(D.gird_position||"0,0")})),p=Math.max(...g.map(D=>D.gridPos.row),0),b=Math.max(...g.map(D=>D.gridPos.col),0);return{sortedContents:g.sort((D,N)=>D.gridPos.row!==N.gridPos.row?D.gridPos.row-N.gridPos.row:D.gridPos.col-N.gridPos.col),maxRow:p,maxCol:b}},a=d=>{switch(d){case"parent_container":return"border-gray-300";case"sub_container":return"border-gray-300";case"dispensing_shelves":case"store_shelves":return"border-gray-300";case"med_box":return"border-gray-300";case"grid_draw":case"list_draw":return"border-gray-300";default:return"border-gray-300"}},i=d=>{const g=["med_box","dispensing_shelves","store_shelves","grid_draw","list_draw"].includes(d.type);return r.jsx("div",{className:`${g?"shadow-sm border-2 p-1 rounded-lg":""} ${a(d.type)} flex flex-col h-full overflow-hidden`,children:r.jsx("div",{className:"flex-1",children:h(d)})},d.GUID)},c=(d,g,p)=>{const b={};return d.forEach(w=>{const D=o(w.gird_position||"0,0");b[`${D.row},${D.col}`]=w}),r.jsx("table",{className:"w-full h-full",style:{borderCollapse:"separate",borderSpacing:"0px"},children:r.jsx("tbody",{children:Array.from({length:g+1},(w,D)=>r.jsx("tr",{className:"h-full",children:Array.from({length:p+1},(N,u)=>{const f=`${D},${u}`,x=b[f];return x?r.jsx("td",{className:"align-top bg-transparent",style:{width:`${100/(p+1)}%`},children:i(x)},u):r.jsx("td",{className:"align-top bg-transparent",style:{width:`${100/(p+1)}%`},children:r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300 text-xs border border-dashed border-gray-200 rounded",children:""})},u)})},D))})})},h=d=>{switch(d.type){case"parent_container":if(d.contents&&d.contents.length>0){const{sortedContents:g,maxRow:p,maxCol:b}=l(d.contents);return c(g,p,b)}else return r.jsx("div",{className:""});case"sub_container":if(d.contents&&d.contents.length>0){const{sortedContents:g,maxRow:p,maxCol:b}=l(d.contents);return c(g,p,b)}else return r.jsx("div",{className:""});case"dispensing_shelves":if(d.contents&&d.contents.length>0){const{sortedContents:g,maxRow:p,maxCol:b}=l(d.contents);return c(g,p,b)}else return r.jsx("div",{className:"border-2 rounded-lg flex py-3 items-center justify-center h-full text-gray-400 text-sm",children:""});case"store_shelves":if(d.medMapStock&&d.medMapStock.length>0){const g=d.medMapStock,p=g.length,b=p>0?100/p:100;return r.jsx("div",{className:"flex h-full",children:g.map((w,D)=>{const N=t&&(w.code==t||w.material_no==t),u=n.includes(w.code)||n.includes(w.material_no);return r.jsxs("div",{className:`border-2 rounded-lg border-gray-300 p-2 flex flex-col text-gray-800 justify-center items-center transition-colors cursor-pointer ${u?"highlight-breathe-red":N?"highlight-breathe-green":""}`,style:{width:`${b}%`},onClick:()=>s&&s({code:w.code||w.material_no,name:w.name}),children:[r.jsx("div",{className:"text-sm font-semibold truncate w-full text-center",children:w.name||w.material_no}),r.jsxs("div",{className:"text-xs mt-1",children:[": ",w.qty||0]})]},w.GUID||D)})})}else if(d.contents&&d.contents.length>0){const{sortedContents:g,maxRow:p,maxCol:b}=l(d.contents);return c(g,p,b)}else return r.jsx("div",{className:"border-2 flex py-3 items-center justify-center h-full text-gray-400 text-sm",children:""});case"grid_draw":return r.jsxs("div",{className:"border-2 bg-violet-100 h-16 flex rounded-lg border-2 border-violet-400 w-[120px] items-center justify-center mx-auto",children:[r.jsx("div",{className:"h-[50%] bg-violet-400 w-[3%] rounded"}),r.jsx("div",{className:"h-[70%] border-2 border-violet-400 w-[82%] mx-1 flex items-center justify-center",children:r.jsx("span",{className:"text-xs text-violet-600",children:""})}),r.jsx("div",{className:"h-[50%] bg-violet-400 w-[3%]"})]});case"list_draw":return r.jsxs("div",{className:"border-2 bg-violet-100 h-16 flex rounded-lg border-2 border-violet-400 w-[120px] items-center justify-center mx-auto",children:[r.jsx("div",{className:"h-[50%] bg-violet-400 w-[3%] rounded"}),r.jsx("div",{className:"h-[70%] border-2 border-violet-400 w-[82%] mx-1 flex items-center justify-center",children:r.jsx("span",{className:"text-xs text-violet-600",children:""})}),r.jsx("div",{className:"h-[50%] bg-violet-400 w-[3%]"})]});case"med_box":if(d.med_info&&d.med_info.length>0){const g=t&&d.med_info.some(b=>b.code==t),p=d.med_info.some(b=>n.includes(b.code));return r.jsx("div",{className:`text-sm text-center h-full p-2 flex flex-col text-gray-800 justify-center transition-colors cursor-pointer ${p?"highlight-breathe-red":g?"highlight-breathe-green":""}`,onClick:()=>s&&s(d.med_info[0]),children:r.jsx("div",{className:"font-semibold truncate",children:d.med_info[0].name||"-"})})}else return r.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-xs",children:""});default:if(d.contents&&d.contents.length>0){const{sortedContents:g,maxRow:p,maxCol:b}=l(d.contents);return c(g,p,b)}else return r.jsxs("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:[": ",d.type]})}};return e?r.jsx("div",{className:"w-full h-full overflow-auto",children:r.jsx("div",{className:"max-w-full",children:h(e)})}):r.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:r.jsx("p",{children:""})})},Ch=({isOpen:e,onClose:t,type:n,data:s,onApprove:o})=>{const[l,a]=m.useState("0"),[i,c]=m.useState("0"),[h,d]=m.useState(null),[g,p]=m.useState(null),[b,w]=m.useState(!1),[D,N]=m.useState(!1),[u,f]=m.useState(""),[x,S]=m.useState(""),[$,M]=m.useState([]),[A,k]=m.useState([]),[F,E]=m.useState([]),[q,V]=m.useState(!1),[P,O]=m.useState(!1),ne=m.useRef(null),y=m.useRef(null),T=m.useRef(null),C=m.useRef(null);m.useEffect(()=>{if(e&&s){const _=s.issuedQuantity||s.requestedQuantity||"0";a(_),c(_),d(null),p(null),w(!1);const ee=localStorage.getItem("medMap_setting");if(ee)try{const I=JSON.parse(ee);f(I.default_person||""),S(I.default_person_id||"")}catch(I){console.error(":",I),f(""),S("")}else f(""),S("");X()}},[e,s]),m.useEffect(()=>{const _=ee=>{T.current&&!T.current.contains(ee.target)&&ne.current&&!ne.current.contains(ee.target)&&V(!1),C.current&&!C.current.contains(ee.target)&&y.current&&!y.current.contains(ee.target)&&O(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]);const X=async()=>{try{const _=await _e.getAllStaffInfo();_.Code===200&&_.Data&&M(_.Data)}catch(_){console.error(":",_)}},fe=_=>{if(f(_),_.trim()===""){k([]),V(!1);return}const ee=$.filter(I=>I.name&&I.name.toLowerCase().includes(_.toLowerCase()));k(ee),V(ee.length>0)},Z=_=>{if(S(_),_.trim()===""){E([]),O(!1);return}const ee=$.filter(I=>I.ID&&I.ID.toLowerCase().includes(_.toLowerCase()));E(ee),O(ee.length>0)},le=_=>{f(_.name),S(_.ID),V(!1)},Ne=_=>{f(_.name),S(_.ID),O(!1)};if(!e||!s)return null;const ae=_=>{if(b)a(_),c(_),w(!1);else{const ee=l==="0"?_:l+_;a(ee),c(ee)}},we=_=>{h&&g!==null&&!b&&U(),p(i),d(_),w(!0)},U=()=>{if(h===null||g===null)return;const _=parseFloat(g),ee=parseFloat(i);let I=0;switch(h){case"+":I=_+ee;break;case"-":I=_-ee;break;case"":I=_*ee;break;case"":I=ee!==0?_/ee:0;break;default:return}const j=I.toString();a(j),c(j),d(null),p(null),w(!0)},ie=()=>{U()},xe=()=>{if(b)a("0."),c("0."),w(!1);else if(!l.includes(".")){const _=l+".";a(_),c(_)}},he=()=>{a("0"),c("0"),d(null),p(null),w(!1)},L=()=>{const _=new Date,ee=_.getFullYear(),I=String(_.getMonth()+1).padStart(2,"0"),j=String(_.getDate()).padStart(2,"0"),R=String(_.getHours()).padStart(2,"0"),z=String(_.getMinutes()).padStart(2,"0"),oe=String(_.getSeconds()).padStart(2,"0");return`${ee}-${I}-${j}T${R}:${z}:${oe}`},ce=async()=>{if(!s)return;if(!u.trim()){alert("");return}const _=n==="requisition"?"":"";if(window.confirm(`

${s.name}
${l}
${u}${x?` (${x})`:""}

${_}`)){N(!0);try{const I=L();if(n==="requisition"){const j=await _e.updateRequisitionActualQuantity(s.GUID,l);if(j.Code!==200){alert(`${j.Message||""}`),N(!1);return}const R={...s,actualQuantity:l,notice:"False",state:"",issuingPerson:u,issueTime:I};console.log("request",R);const z=await _e.updateRequisitionByGuid(R);if(z.Code!==200){alert(`${z.Message||""}`),N(!1);return}console.log(" :",{GUID:s.GUID,name:s.name,actualQuantity:l,issuingPerson:u,issueTime:I})}else{const j=await _e.updateDistributionActualQuantity(s.GUID,l);if(j.Code!==200){alert(`${j.Message||""}`),N(!1);return}const R={...s,actualQuantity:l,notice:"False",state:"",issuer:u,issuanceTime:I};console.log("request",R);const z=await _e.updateDistributionByGuid(R);if(z.Code!==200){alert(`${z.Message||""}`),N(!1);return}console.log(" :",{GUID:s.GUID,name:s.name,actualQuantity:l,issuer:u,issuanceTime:I})}o&&await o(),alert(`${_}`),t()}catch(I){console.error(`${_}:`,I),alert(`${_}`)}finally{N(!1)}}},H=n==="requisition"?s.requestedQuantity:s.issuedQuantity;return r.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),r.jsxs("div",{className:"relative w-full max-w-md bg-white shadow-2xl rounded-xl overflow-hidden flex flex-col m-4 max-h-[90vh]",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200",children:[r.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:[n==="requisition"?"":"",""]}),r.jsx("button",{onClick:t,className:"p-2 hover:bg-white/50 rounded-full transition-colors",title:"",children:r.jsx(Xe,{className:"w-5 h-5 text-gray-700"})})]}),r.jsx("div",{className:"overflow-y-auto flex-1",children:r.jsxs("div",{className:"p-4 space-y-2",children:[r.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 space-y-2",children:[r.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:""}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{ref:ne,type:"text",value:u,onChange:_=>fe(_.target.value),onFocus:()=>{u.trim()&&fe(u)},placeholder:"",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),q&&r.jsx("div",{ref:T,className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:A.map((_,ee)=>r.jsxs("div",{onClick:()=>le(_),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[r.jsx("div",{className:"text-xs text-gray-500",children:_.ID}),r.jsx("div",{className:"font-medium text-gray-900 text-sm",children:_.name})]},ee))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{ref:y,type:"text",value:x,onChange:_=>Z(_.target.value),onFocus:()=>{x.trim()&&Z(x)},placeholder:" ID",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),P&&r.jsx("div",{ref:C,className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:F.map((_,ee)=>r.jsxs("div",{onClick:()=>Ne(_),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[r.jsx("div",{className:"font-medium text-gray-900 text-sm",children:_.ID}),r.jsx("div",{className:"text-xs text-gray-500",children:_.name})]},ee))})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-gray-600",children:""}),r.jsx("div",{className:"text-base text-gray-800 mt-1",children:s.name||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-gray-600",children:""}),r.jsx("div",{className:"text-base text-gray-800 mt-1",children:s.code||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-gray-600",children:n==="requisition"?"":""}),r.jsx("div",{className:"text-base text-gray-800 mt-1",children:H||"-"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-base font-semibold text-gray-600 block mb-2",children:""}),r.jsx("input",{type:"text",value:l,disabled:!0,className:"w-full px-4 py-3 text-lg font-semibold text-gray-800 bg-gray-100 border border-gray-300 rounded-lg"})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[r.jsx("button",{onClick:()=>ae("7"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"7"}),r.jsx("button",{onClick:()=>ae("8"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"8"}),r.jsx("button",{onClick:()=>ae("9"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"9"}),r.jsx("button",{onClick:()=>we(""),className:"py-4 text-lg font-semibold bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-lg transition-colors",children:""}),r.jsx("button",{onClick:()=>ae("4"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"4"}),r.jsx("button",{onClick:()=>ae("5"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"5"}),r.jsx("button",{onClick:()=>ae("6"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"6"}),r.jsx("button",{onClick:()=>we(""),className:"py-4 text-lg font-semibold bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-lg transition-colors",children:""}),r.jsx("button",{onClick:()=>ae("1"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"1"}),r.jsx("button",{onClick:()=>ae("2"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"2"}),r.jsx("button",{onClick:()=>ae("3"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"3"}),r.jsx("button",{onClick:()=>we("-"),className:"py-4 text-lg font-semibold bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-lg transition-colors",children:"-"}),r.jsx("button",{onClick:()=>ae("0"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"0"}),r.jsx("button",{onClick:xe,className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"."}),r.jsx("button",{onClick:ie,className:"py-4 text-lg font-semibold bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors",children:"="}),r.jsx("button",{onClick:()=>we("+"),className:"py-4 text-lg font-semibold bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-lg transition-colors",children:"+"})]})]})}),r.jsxs("div",{className:"flex items-center justify-end gap-2 p-3 border-t border-gray-200 bg-gray-50",children:[r.jsx("button",{onClick:he,className:"px-6 py-2.5 font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors",children:""}),r.jsx("button",{onClick:t,className:"px-6 py-2.5 font-semibold text-gray-700 bg-white border border-gray-300 hover:bg-gray-100 rounded-lg transition-colors",children:""}),r.jsx("button",{onClick:ce,disabled:D,className:"px-6 py-2.5 font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:D?"...":""})]})]})]})},kh=({isOpen:e,onClose:t,medicineInfo:n,requisitions:s,distributions:o,onNoticeUpdated:l})=>{const[a,i]=m.useState(s),[c,h]=m.useState(o),[d,g]=m.useState(null),[p,b]=m.useState(!1),[w,D]=m.useState(null),[N,u]=m.useState("requisition");to.useEffect(()=>{i(s),h(o)},[s,o]);const f=async k=>{const F=k.notice==="True"?"False":"True";g(k.GUID);const E=[...a],q=E.findIndex(V=>V.GUID===k.GUID);if(q===-1){g(null);return}E[q]={...k,notice:F},i(E);try{const V=await _e.updateRequisitionNotice(k.GUID,F);V.Code!==200?(E[q]={...k,notice:k.notice},i(E),console.error(":",V)):l&&l()}catch(V){E[q]={...k,notice:k.notice},i(E),console.error(":",V)}finally{g(null)}},x=async k=>{const F=k.notice==="True"?"False":"True";g(k.GUID);const E=[...c],q=E.findIndex(V=>V.GUID===k.GUID);if(q===-1){g(null);return}E[q]={...k,notice:F},h(E);try{const V=await _e.updateDistributionNotice(k.GUID,F);V.Code!==200?(E[q]={...k,notice:k.notice},h(E),console.error(":",V)):l&&l()}catch(V){E[q]={...k,notice:k.notice},h(E),console.error(":",V)}finally{g(null)}};if(!e||!n)return null;const S=a.filter(k=>k.state===""),$=c.filter(k=>k.state===""),M=S.length===0&&$.length===0,A=k=>{if(!k||k==="1/01/01 00:00:00"||k==="0001-01-01T00:00:00")return"-";try{const F=new Date(k);if(isNaN(F.getTime()))return k;const E=F.getFullYear(),q=String(F.getMonth()+1).padStart(2,"0"),V=String(F.getDate()).padStart(2,"0"),P=String(F.getHours()).padStart(2,"0"),O=String(F.getMinutes()).padStart(2,"0");return`${E}/${q}/${V} ${P}:${O}`}catch{return k}};return r.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),r.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] bg-white shadow-2xl rounded-lg overflow-hidden flex flex-col m-4",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800",children:""}),r.jsx("button",{onClick:t,className:"p-2 hover:bg-white/50 rounded-full transition-colors",title:"",children:r.jsx(Xe,{className:"w-6 h-6 text-gray-700"})})]}),r.jsx("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:n.name||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:n.skdiacode||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:n.code||"-"})]}),n.cht_name&&r.jsxs("div",{className:"col-span-2",children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:n.cht_name})]})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:M?r.jsx("div",{className:"flex items-center justify-center h-40 text-gray-400 text-lg",children:""}):r.jsxs("div",{className:"space-y-2",children:[S.map((k,F)=>r.jsxs("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50 hover:shadow-md transition-shadow",onClick:()=>{u("requisition"),D(k),b(!0)},children:[r.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[r.jsxs("div",{className:"flex items-center gap-6",children:[r.jsx("span",{className:"underline font-medium text-xl font-semibold text-gray-700",children:""}),r.jsx("button",{onClick:E=>{E.stopPropagation(),f(k)},disabled:d===k.GUID,className:`p-2 rounded-full transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:scale-110 ${k.notice==="True"?"bg-green-500 text-white hover:bg-green-600":"bg-gray-300 text-gray-600 hover:bg-gray-400"}`,title:k.notice==="True"?"":"",children:r.jsx(yc,{className:"w-5 h-5"})})]}),r.jsx("span",{className:`px-3 text-sm py-2 text-white font-semibold rounded-full ${k.actionType.includes("")?"bg-green-600":"bg-blue-600"}`,children:k.actionType})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:k.requestingUnit||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:k.requestingPerson||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:k.requestedQuantity||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:A(k.requestTime)})]})]})]},k.GUID)),$.map((k,F)=>r.jsxs("div",{className:"border border-yellow-200 rounded-lg p-3 bg-yellow-50 hover:shadow-md transition-shadow",onClick:()=>{u("distribution"),D(k),b(!0)},children:[r.jsxs("div",{className:"flex items-center gap-6 mb-2",children:[r.jsx("span",{className:"underline font-medium text-xl rounded-full text-gray-700",children:""}),r.jsx("button",{onClick:E=>{E.stopPropagation(),x(k)},disabled:d===k.GUID,className:`p-2 rounded-full transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:scale-110 ${k.notice==="True"?"bg-green-500 text-white hover:bg-green-600":"bg-gray-300 text-gray-600 hover:bg-gray-400"}`,title:k.notice==="True"?"":"",children:r.jsx(yc,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:k.sourceStoreType||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:k.destinationStoreType||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:k.LOT||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:k.VAL||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:k.issuedQuantity||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:k.reportName||"-"})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:A(k.addedTime)})]})]})]},k.GUID))]})})]}),r.jsx(Ch,{isOpen:p,onClose:()=>b(!1),type:N,data:w,onApprove:l})]})},Dh=({isOpen:e,onClose:t,container:n})=>{const[s,o]=m.useState("list_mode"),{highlightedMedicineCode:l}=Ke(),[a,i]=m.useState(!1),[c,h]=m.useState([]),[d,g]=m.useState([]),[p,b]=m.useState([]),[w,D]=m.useState(!1),[N,u]=m.useState(null),f=m.useRef(null),x=m.useRef(null),S=()=>{try{const E=localStorage.getItem("medMap_setting");if(E){const V=JSON.parse(E).light_sec;if(V!=null&&V!==""){const P=Number(V);if(!isNaN(P)&&P>0)return P*1e3}}}catch(E){console.error(":",E)}return 6e4},$=m.useCallback(async()=>{try{const F=new Date,E=`${F.getFullYear()}-${String(F.getMonth()+1).padStart(2,"0")}-${String(F.getDate()).padStart(2,"0")} 00:00:00`,q=`${F.getFullYear()}-${String(F.getMonth()+1).padStart(2,"0")}-${String(F.getDate()).padStart(2,"0")} 23:59:59`,[V,P]=await Promise.all([_e.getRequisitionByTime(E,q),_e.getDistributionByTime(E,q)]),O=[];if(V.Code===200&&V.Data){const ne=V.Data.filter(T=>{var C;return(C=n==null?void 0:n.med_list)==null?void 0:C.some(X=>X.code===T.code)});g(ne),ne.filter(T=>T.state===""&&T.notice==="True").forEach(T=>{T.code&&O.push(T.code)})}if(P.Code===200&&P.Data){const ne=P.Data.filter(T=>{var C;return(C=n==null?void 0:n.med_list)==null?void 0:C.some(X=>X.code===T.code)});b(ne),ne.filter(T=>T.state===""&&T.notice==="True").forEach(T=>{T.code&&(O.includes(T.code)||O.push(T.code))})}h(O)}catch(F){console.error(":",F)}},[n]);m.useEffect(()=>(e?($(),x.current&&clearInterval(x.current),x.current=setInterval(()=>{$()},1e4)):x.current&&(clearInterval(x.current),x.current=null),()=>{x.current&&(clearInterval(x.current),x.current=null)}),[e,$]),m.useEffect(()=>{if(console.log("",n),console.log(" ContainerDetailModal - :",{isOpen:e,highlightedMedicineCode:l,containerName:n==null?void 0:n.name}),e&&l){i(!0);const F=S();console.log(" ContainerDetailModal - :",{medicineCode:l,duration:F/1e3+""}),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{console.log(" ContainerDetailModal - "),i(!1),f.current=null},F)}else i(!1);return()=>{f.current&&clearTimeout(f.current)}},[e,l]);const M=F=>{d.filter(E=>E.code===F.code),p.filter(E=>E.code===F.code),u({code:F.code,name:F.name,cht_name:F.cht_name,skdiacode:F.SKDIACODE||F.skdiacode}),D(!0)};if(!e)return null;const A=()=>!(n!=null&&n.med_list)||n.med_list.length===0?r.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:r.jsx("p",{children:""})}):r.jsx("div",{className:"overflow-y-auto h-full",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{className:"sticky top-0",children:r.jsxs("tr",{children:[r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700 text-right",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700 text-center",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700 text-center",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700 text-center",children:""})]})}),r.jsx("tbody",{children:n.med_list.map((F,E)=>{const q=a&&l&&F.code==l,V=c.includes(F.code);return E===0&&console.log(" ContainerDetailModal - :",{medCode:F.code,highlightedCode:l,isHighlightActive:a,isHighlighted:q,isPendingRequisition:V,comparison:`${F.code} == ${l} = ${F.code==l}`}),r.jsxs("tr",{className:`transition-colors cursor-pointer ${V?"highlight-breathe-red":q?"highlight-breathe-green":"hover:bg-gray-50"}`,onClick:()=>M(F),children:[r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm",children:F.code||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm",children:F.SKDIACODE||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm",children:F.name||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm text-right",children:F.qty||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm text-center",children:F.stockCol||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm text-center",children:F.stockRow||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm text-center",children:F.stock||"-"})]},E)})})]})}),k=()=>n?r.jsx(Sh,{container:n,highlightedMedicineCode:a?l:null,pendingRequisitionCodes:c,onMedicineClick:M}):r.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:r.jsx("p",{children:""})});return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),r.jsxs("div",{className:"relative w-full h-full bg-white shadow-2xl overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200 bg-white",children:[r.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[r.jsx("button",{onClick:()=>o("list_mode"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="list_mode"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:""}),r.jsx("button",{onClick:()=>o("view_mode"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="view_mode"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:""})]}),r.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",title:"",children:r.jsx(Xe,{className:"w-6 h-6 text-gray-700"})})]}),r.jsx("div",{className:"flex-1 overflow-hidden p-3",children:s==="list_mode"?A():k()})]})]}),r.jsx(kh,{isOpen:w,onClose:()=>D(!1),medicineInfo:N,requisitions:N?d.filter(F=>F.code===N.code):[],distributions:N?p.filter(F=>F.code===N.code):[],onNoticeUpdated:$})]})},_h=()=>{const{editStoreShelfModalOpen:e,closeEditStoreShelfModal:t,selectedStoreShelfForEdit:n,showNotification:s,reloadMedMapData:o}=Ke(),[l,a]=m.useState({name:"",position:"",width:"85",height:"29",ip:"",serverName:"",serverType:""}),[i,c]=m.useState(!1);m.useEffect(()=>{n&&e&&a({name:n.name||"",position:n.gird_position||"",width:n.width||"85",height:n.height||"29",ip:n.ip||"",serverName:n.serverName||"",serverType:n.serverType||""})},[n,e]);const h=(p,b)=>{a(w=>({...w,[p]:b}))},d=async()=>{if(n){if(!l.name.trim()){s("","error");return}if(!l.position.trim()){s("","error");return}c(!0);try{const p={Data:[{Master_GUID:n.Master_GUID,name:l.name.trim(),position:l.position.trim(),type:n.type,width:l.width,height:l.height,ip_light:l.ip.trim(),device_type:"RowsLED",serverName:l.serverName.trim(),serverType:l.serverType.trim(),GUID:n.GUID}]},w=`${(await _e.getConfig()).domain}/api/medmap/update_shelf`,N=await(await fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).json();N.Code===200?(s("","success"),t(),await o()):s(N.Result||"","error")}catch(p){console.error(":",p),s("","error")}finally{c(!1)}}},g=()=>{t()};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:g}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200 w-[600px]",onClick:p=>p.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(eo,{className:"w-6 h-6 text-gray-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:g,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Xe,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-6 py-4 overflow-y-auto",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.name,onChange:p=>h("name",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (grid_position)"}),r.jsx("input",{type:"text",value:l.position,onChange:p=>h("position",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"0,0"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.width,onChange:p=>h("width",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"85"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.height,onChange:p=>h("height",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"29"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IP"}),r.jsx("input",{type:"text",value:l.ip,onChange:p=>h("ip",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"IP"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.serverName,onChange:p=>h("serverName",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.serverType,onChange:p=>h("serverType",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:""})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 py-4 px-6 border-t border-gray-200",children:[r.jsx("button",{onClick:g,disabled:i,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:""}),r.jsxs("button",{onClick:d,disabled:i,className:"px-6 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[i&&r.jsx(kt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:i?"...":""})]})]})]})]})},Mh=({isOpen:e,onLoginSuccess:t})=>{const{t:n}=mt(),[s,o]=m.useState(""),[l,a]=m.useState(""),[i,c]=m.useState(!1),[h,d]=m.useState(!1),[g,p]=m.useState(""),b=async D=>{if(D.preventDefault(),!s.trim()||!l.trim()){p("Please enter both ID and password");return}d(!0),p("");try{const N=await _e.login({ID:s.trim(),Password:l});if(N.Code===200&&N.Data){const u={...N.Data,loginTime:new Date().toISOString()};sessionStorage.setItem("user_session",JSON.stringify(u)),t(u)}else p(N.Result||"Login failed")}catch(N){console.error("Login failed:",N),p("Network error. Please try again.")}finally{d(!1)}},w=D=>{D.key==="Enter"&&!h&&b(D)};return e?r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900",children:[r.jsx("div",{className:"absolute inset-0 bg-white"}),r.jsxs("div",{className:"relative z-10 w-full max-w-md mx-4",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8 text-center",children:n("login.title")}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-4 md:p-6",children:[g&&r.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-red-600 text-sm",children:g})}),r.jsxs("form",{onSubmit:b,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"userId",className:"block text-sm font-medium text-gray-700 mb-2",children:n("login.userId")}),r.jsx("input",{id:"userId",type:"text",value:s,onChange:D=>o(D.target.value),onKeyPress:w,placeholder:n("login.userIdPlaceholder"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",disabled:h,autoComplete:"username"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:n("login.password")}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{id:"password",type:i?"text":"password",value:l,onChange:D=>a(D.target.value),onKeyPress:w,placeholder:n("login.passwordPlaceholder"),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",disabled:h,autoComplete:"current-password"}),r.jsx("button",{type:"button",onClick:()=>c(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",disabled:h,children:i?r.jsx(qm,{className:"w-5 h-5"}):r.jsx(Ym,{className:"w-5 h-5"})})]})]}),r.jsx("button",{type:"submit",disabled:h||!s.trim()||!l.trim(),className:"w-full flex items-center justify-center px-4 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:h?r.jsxs(r.Fragment,{children:[r.jsx(kt,{className:"w-5 h-5 animate-spin mr-2"}),n("login.loggingIn")]}):r.jsx(r.Fragment,{children:n("login.loginButton")})})]})]})]})]}):null},Eh=({isVisible:e,message:t})=>{const{t:n}=mt();return e?r.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),r.jsx("div",{className:"relative z-10 flex flex-col items-center justify-center p-8",children:r.jsxs("div",{className:"bg-white/95 backdrop-blur-sm border border-gray-200/50 rounded-2xl shadow-2xl px-8 py-6 flex flex-col items-center space-y-4 min-w-[280px]",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[r.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:r.jsx(li,{className:"w-8 h-8 text-blue-600"})}),r.jsx("div",{className:"text-xl font-semibold text-gray-900",children:n("nav.title")})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(kt,{className:"w-8 h-8 text-blue-600 animate-spin"}),r.jsx("div",{className:"text-lg font-medium text-gray-700",children:t||n("status.loadingMedMapData")})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-blue-600 rounded-full animate-pulse",style:{width:"100%"}})}),r.jsx("div",{className:"text-sm text-gray-500 text-center max-w-xs",children:n("status.loadingMedMapHint")})]})})]}):null},Ih=({message:e,type:t,isVisible:n,onClose:s,duration:o=3e3})=>{const[l,a]=m.useState(!1);return m.useEffect(()=>{if(n){a(!0);const i=setTimeout(()=>{s()},o);return()=>clearTimeout(i)}else{const i=setTimeout(()=>{a(!1)},300);return()=>clearTimeout(i)}},[n,o,s]),l?r.jsx("div",{className:`fixed top-4 left-1/2 transform -translate-x-1/2 z-[9999] transition-all duration-300 ease-in-out ${n?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:r.jsxs("div",{className:`flex items-center space-x-3 px-4 py-3 rounded-lg shadow-lg border ${t==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:[t==="success"?r.jsx(Hm,{className:"w-5 h-5 text-green-600"}):r.jsx(nh,{className:"w-5 h-5 text-red-600"}),r.jsx("span",{className:"text-sm font-medium",children:e}),r.jsx("button",{onClick:s,className:`p-1 rounded-full hover:bg-black/10 transition-colors ${t==="success"?"text-green-600":"text-red-600"}`,children:r.jsx(Xe,{className:"w-4 h-4"})})]})}):null};function Ph(){const{selectedDepartmentType:e,viewMode:t,isAuthenticated:n,setIsAuthenticated:s,setCurrentUser:o,isLoadingMedMap:l,notification:a,hideNotification:i,addParentContainerModalOpen:c,closeAddParentContainerModal:h,selectedDepartmentForAdd:d,addStoreItemModalOpen:g,closeAddStoreItemModal:p,selectedStoreShelfForAdd:b,addDepartmentModalOpen:w,closeAddDepartmentModal:D,qrCodeScannerModalOpen:N,qrCodeScannerMode:u,closeQRCodeScannerModal:f,addBarcodeModalOpen:x,closeAddBarcodeModal:S,initialBarcodeValue:$,containerDetailModalOpen:M,closeContainerDetailModal:A,selectedContainerForDetail:k,setMedicineList:F,setIsLoadingMedicines:E,showNotification:q}=Ke();m.useEffect(()=>{(()=>{try{const y=sessionStorage.getItem("user_session");if(y){const T=JSON.parse(y);T.GUID&&T.ID&&T.Name?(o(T),s(!0)):sessionStorage.removeItem("user_session")}}catch(y){console.error("Error checking session:",y),sessionStorage.removeItem("user_session")}})()},[s,o]),m.useEffect(()=>{let ne=!0;return(async()=>{if(n){E(!0);try{console.log("...");const T=await _e.getMedicineCloud();if(console.log(" API :",T),!ne)return;T.Code===200&&T.Data?(F(T.Data),console.log(`  ${T.Data.length} `),q(` ${T.Data.length} `,"success")):(console.warn("API :",T),F([]),q("","error"))}catch(T){if(!ne)return;console.error(":",T),F([]),q("","error")}finally{ne&&E(!1)}}})(),()=>{ne=!1}},[n]);const V=ne=>{o(ne),s(!0)},P=to.useRef(null),O=(ne,y)=>{if(console.log(" QR - handleQRScanSuccess :",{barcode:ne,medicineData:y,mode:u}),console.log("  mode:",u),console.log("  viewMode:",t),console.log(" drugCanvasRef.current:",P.current),u==="track_Drug_mode"){if(console.log("  track_Drug_mode "),t!=="medicine"){console.warn(" "),q("","error");return}P.current?(console.log(" drugCanvasRef.current "),console.log(" drugCanvasRef.current.locateDrug :",typeof P.current.locateDrug),typeof P.current.locateDrug=="function"?(console.log("  locateDrug "),P.current.locateDrug(y)):console.warn(" locateDrug ")):console.warn(" drugCanvasRef.current ")}else console.log(" mode  track_Drug_mode mode:",u)};return n?r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(rh,{}),r.jsx(sh,{}),r.jsx(ah,{}),r.jsx("div",{className:"fixed inset-0",children:r.jsx("div",{className:"w-full h-full",children:t==="department"?r.jsx(uh,{}):r.jsx(zd,{ref:P})})}),r.jsx(ih,{}),r.jsx(hh,{}),r.jsx(gh,{}),r.jsx(xh,{}),r.jsx(yh,{}),r.jsx(vh,{}),r.jsx(wh,{}),r.jsx(bh,{isOpen:g,onClose:p,storeShelf:b}),r.jsx(Nh,{isOpen:w,onClose:D}),r.jsx(Fo,{isOpen:N,onClose:f,mode:u,onScanSuccess:O}),r.jsx(jh,{isOpen:x,onClose:S,initialBarcode:$}),r.jsx(Dh,{isOpen:M,onClose:A,container:k}),r.jsx(_h,{}),r.jsx(Eh,{isVisible:l}),r.jsx(Ih,{message:a.message,type:a.type,isVisible:a.isVisible,onClose:i})]}):r.jsx(Mh,{isOpen:!0,onLoginSuccess:V})}function Rh(){return r.jsx(Bm,{children:r.jsx(Lm,{children:r.jsx(Ph,{})})})}Rd(document.getElementById("root")).render(r.jsx(m.StrictMode,{children:r.jsx(Rh,{})}));
