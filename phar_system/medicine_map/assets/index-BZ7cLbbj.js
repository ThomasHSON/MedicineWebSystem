(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();function Sf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Tc={exports:{}},Lo={},Rc={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Is=Symbol.for("react.element"),Cf=Symbol.for("react.portal"),kf=Symbol.for("react.fragment"),Df=Symbol.for("react.strict_mode"),_f=Symbol.for("react.profiler"),Mf=Symbol.for("react.provider"),Ef=Symbol.for("react.context"),If=Symbol.for("react.forward_ref"),Pf=Symbol.for("react.suspense"),Tf=Symbol.for("react.memo"),Rf=Symbol.for("react.lazy"),bi=Symbol.iterator;function $f(e){return e===null||typeof e!="object"?null:(e=bi&&e[bi]||e["@@iterator"],typeof e=="function"?e:null)}var $c={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ac=Object.assign,Oc={};function Lr(e,t,n){this.props=e,this.context=t,this.refs=Oc,this.updater=n||$c}Lr.prototype.isReactComponent={};Lr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Lr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Uc(){}Uc.prototype=Lr.prototype;function Sa(e,t,n){this.props=e,this.context=t,this.refs=Oc,this.updater=n||$c}var Ca=Sa.prototype=new Uc;Ca.constructor=Sa;Ac(Ca,Lr.prototype);Ca.isPureReactComponent=!0;var Ni=Array.isArray,Lc=Object.prototype.hasOwnProperty,ka={current:null},Bc={key:!0,ref:!0,__self:!0,__source:!0};function zc(e,t,n){var s,o={},l=null,a=null;if(t!=null)for(s in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(l=""+t.key),t)Lc.call(t,s)&&!Bc.hasOwnProperty(s)&&(o[s]=t[s]);var i=arguments.length-2;if(i===1)o.children=n;else if(1<i){for(var c=Array(i),g=0;g<i;g++)c[g]=arguments[g+2];o.children=c}if(e&&e.defaultProps)for(s in i=e.defaultProps,i)o[s]===void 0&&(o[s]=i[s]);return{$$typeof:Is,type:e,key:l,ref:a,props:o,_owner:ka.current}}function Af(e,t){return{$$typeof:Is,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Da(e){return typeof e=="object"&&e!==null&&e.$$typeof===Is}function Of(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ji=/\/+/g;function ol(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Of(""+e.key):t.toString(36)}function to(e,t,n,s,o){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(l){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Is:case Cf:a=!0}}if(a)return a=e,o=o(a),e=s===""?"."+ol(a,0):s,Ni(o)?(n="",e!=null&&(n=e.replace(ji,"$&/")+"/"),to(o,t,n,"",function(g){return g})):o!=null&&(Da(o)&&(o=Af(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(ji,"$&/")+"/")+e)),t.push(o)),1;if(a=0,s=s===""?".":s+":",Ni(e))for(var i=0;i<e.length;i++){l=e[i];var c=s+ol(l,i);a+=to(l,t,n,c,o)}else if(c=$f(e),typeof c=="function")for(e=c.call(e),i=0;!(l=e.next()).done;)l=l.value,c=s+ol(l,i++),a+=to(l,t,n,c,o);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Os(e,t,n){if(e==null)return e;var s=[],o=0;return to(e,s,"","",function(l){return t.call(n,l,o++)}),s}function Uf(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var St={current:null},no={transition:null},Lf={ReactCurrentDispatcher:St,ReactCurrentBatchConfig:no,ReactCurrentOwner:ka};function Gc(){throw Error("act(...) is not supported in production builds of React.")}Ue.Children={map:Os,forEach:function(e,t,n){Os(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Os(e,function(){t++}),t},toArray:function(e){return Os(e,function(t){return t})||[]},only:function(e){if(!Da(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ue.Component=Lr;Ue.Fragment=kf;Ue.Profiler=_f;Ue.PureComponent=Sa;Ue.StrictMode=Df;Ue.Suspense=Pf;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lf;Ue.act=Gc;Ue.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=Ac({},e.props),o=e.key,l=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,a=ka.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(c in t)Lc.call(t,c)&&!Bc.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&i!==void 0?i[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){i=Array(c);for(var g=0;g<c;g++)i[g]=arguments[g+2];s.children=i}return{$$typeof:Is,type:e.type,key:o,ref:l,props:s,_owner:a}};Ue.createContext=function(e){return e={$$typeof:Ef,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Mf,_context:e},e.Consumer=e};Ue.createElement=zc;Ue.createFactory=function(e){var t=zc.bind(null,e);return t.type=e,t};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(e){return{$$typeof:If,render:e}};Ue.isValidElement=Da;Ue.lazy=function(e){return{$$typeof:Rf,_payload:{_status:-1,_result:e},_init:Uf}};Ue.memo=function(e,t){return{$$typeof:Tf,type:e,compare:t===void 0?null:t}};Ue.startTransition=function(e){var t=no.transition;no.transition={};try{e()}finally{no.transition=t}};Ue.unstable_act=Gc;Ue.useCallback=function(e,t){return St.current.useCallback(e,t)};Ue.useContext=function(e){return St.current.useContext(e)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(e){return St.current.useDeferredValue(e)};Ue.useEffect=function(e,t){return St.current.useEffect(e,t)};Ue.useId=function(){return St.current.useId()};Ue.useImperativeHandle=function(e,t,n){return St.current.useImperativeHandle(e,t,n)};Ue.useInsertionEffect=function(e,t){return St.current.useInsertionEffect(e,t)};Ue.useLayoutEffect=function(e,t){return St.current.useLayoutEffect(e,t)};Ue.useMemo=function(e,t){return St.current.useMemo(e,t)};Ue.useReducer=function(e,t,n){return St.current.useReducer(e,t,n)};Ue.useRef=function(e){return St.current.useRef(e)};Ue.useState=function(e){return St.current.useState(e)};Ue.useSyncExternalStore=function(e,t,n){return St.current.useSyncExternalStore(e,t,n)};Ue.useTransition=function(){return St.current.useTransition()};Ue.version="18.3.1";Rc.exports=Ue;var f=Rc.exports;const mo=Sf(f);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bf=f,zf=Symbol.for("react.element"),Gf=Symbol.for("react.fragment"),Ff=Object.prototype.hasOwnProperty,Hf=Bf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Vf={key:!0,ref:!0,__self:!0,__source:!0};function Fc(e,t,n){var s,o={},l=null,a=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(a=t.ref);for(s in t)Ff.call(t,s)&&!Vf.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)o[s]===void 0&&(o[s]=t[s]);return{$$typeof:zf,type:e,key:l,ref:a,props:o,_owner:Hf.current}}Lo.Fragment=Gf;Lo.jsx=Fc;Lo.jsxs=Fc;Tc.exports=Lo;var r=Tc.exports,Hc={exports:{}},Bt={},Vc={exports:{}},qc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,I){var Z=D.length;D.push(I);e:for(;0<Z;){var z=Z-1>>>1,oe=D[z];if(0<o(oe,I))D[z]=I,D[Z]=oe,Z=z;else break e}}function n(D){return D.length===0?null:D[0]}function s(D){if(D.length===0)return null;var I=D[0],Z=D.pop();if(Z!==I){D[0]=Z;e:for(var z=0,oe=D.length,be=oe>>>1;z<be;){var fe=2*(z+1)-1,W=D[fe],he=fe+1,Y=D[he];if(0>o(W,Z))he<oe&&0>o(Y,W)?(D[z]=Y,D[he]=Z,z=he):(D[z]=W,D[fe]=Z,z=fe);else if(he<oe&&0>o(Y,Z))D[z]=Y,D[he]=Z,z=he;else break e}}return I}function o(D,I){var Z=D.sortIndex-I.sortIndex;return Z!==0?Z:D.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var a=Date,i=a.now();e.unstable_now=function(){return a.now()-i}}var c=[],g=[],y=1,h=null,p=3,b=!1,N=!1,S=!1,A=typeof setTimeout=="function"?setTimeout:null,d=typeof clearTimeout=="function"?clearTimeout:null,u=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(D){for(var I=n(g);I!==null;){if(I.callback===null)s(g);else if(I.startTime<=D)s(g),I.sortIndex=I.expirationTime,t(c,I);else break;I=n(g)}}function C(D){if(S=!1,m(D),!N)if(n(c)!==null)N=!0,w(P);else{var I=n(g);I!==null&&j(C,I.startTime-D)}}function P(D,I){N=!1,S&&(S=!1,d(G),G=-1),b=!0;var Z=p;try{for(m(I),h=n(c);h!==null&&(!(h.expirationTime>I)||D&&!le());){var z=h.callback;if(typeof z=="function"){h.callback=null,p=h.priorityLevel;var oe=z(h.expirationTime<=I);I=e.unstable_now(),typeof oe=="function"?h.callback=oe:h===n(c)&&s(c),m(I)}else s(c);h=n(c)}if(h!==null)var be=!0;else{var fe=n(g);fe!==null&&j(C,fe.startTime-I),be=!1}return be}finally{h=null,p=Z,b=!1}}var k=!1,T=null,G=-1,M=5,U=-1;function le(){return!(e.unstable_now()-U<M)}function ue(){if(T!==null){var D=e.unstable_now();U=D;var I=!0;try{I=T(!0,D)}finally{I?_():(k=!1,T=null)}}else k=!1}var _;if(typeof u=="function")_=function(){u(ue)};else if(typeof MessageChannel<"u"){var v=new MessageChannel,H=v.port2;v.port1.onmessage=ue,_=function(){H.postMessage(null)}}else _=function(){A(ue,0)};function w(D){T=D,k||(k=!0,_())}function j(D,I){G=A(function(){D(e.unstable_now())},I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){N||b||(N=!0,w(P))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(D){switch(p){case 1:case 2:case 3:var I=3;break;default:I=p}var Z=p;p=I;try{return D()}finally{p=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,I){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var Z=p;p=D;try{return I()}finally{p=Z}},e.unstable_scheduleCallback=function(D,I,Z){var z=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?z+Z:z):Z=z,D){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=Z+oe,D={id:y++,callback:I,priorityLevel:D,startTime:Z,expirationTime:oe,sortIndex:-1},Z>z?(D.sortIndex=Z,t(g,D),n(c)===null&&D===n(g)&&(S?(d(G),G=-1):S=!0,j(C,Z-z))):(D.sortIndex=oe,t(c,D),N||b||(N=!0,w(P))),D},e.unstable_shouldYield=le,e.unstable_wrapCallback=function(D){var I=p;return function(){var Z=p;p=I;try{return D.apply(this,arguments)}finally{p=Z}}}})(qc);Vc.exports=qc;var qf=Vc.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wf=f,Lt=qf;function ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Wc=new Set,ms={};function or(e,t){Ir(e,t),Ir(e+"Capture",t)}function Ir(e,t){for(ms[e]=t,e=0;e<t.length;e++)Wc.add(t[e])}var xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Il=Object.prototype.hasOwnProperty,Yf=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Si={},Ci={};function Xf(e){return Il.call(Ci,e)?!0:Il.call(Si,e)?!1:Yf.test(e)?Ci[e]=!0:(Si[e]=!0,!1)}function Qf(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Kf(e,t,n,s){if(t===null||typeof t>"u"||Qf(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ct(e,t,n,s,o,l,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=a}var gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){gt[e]=new Ct(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];gt[t]=new Ct(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){gt[e]=new Ct(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){gt[e]=new Ct(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){gt[e]=new Ct(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){gt[e]=new Ct(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){gt[e]=new Ct(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){gt[e]=new Ct(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){gt[e]=new Ct(e,5,!1,e.toLowerCase(),null,!1,!1)});var _a=/[\-:]([a-z])/g;function Ma(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(_a,Ma);gt[t]=new Ct(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(_a,Ma);gt[t]=new Ct(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(_a,Ma);gt[t]=new Ct(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){gt[e]=new Ct(e,1,!1,e.toLowerCase(),null,!1,!1)});gt.xlinkHref=new Ct("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){gt[e]=new Ct(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ea(e,t,n,s){var o=gt.hasOwnProperty(t)?gt[t]:null;(o!==null?o.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Kf(t,n,o,s)&&(n=null),s||o===null?Xf(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,s=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var bn=Wf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Us=Symbol.for("react.element"),ur=Symbol.for("react.portal"),fr=Symbol.for("react.fragment"),Ia=Symbol.for("react.strict_mode"),Pl=Symbol.for("react.profiler"),Yc=Symbol.for("react.provider"),Xc=Symbol.for("react.context"),Pa=Symbol.for("react.forward_ref"),Tl=Symbol.for("react.suspense"),Rl=Symbol.for("react.suspense_list"),Ta=Symbol.for("react.memo"),Cn=Symbol.for("react.lazy"),Qc=Symbol.for("react.offscreen"),ki=Symbol.iterator;function Vr(e){return e===null||typeof e!="object"?null:(e=ki&&e[ki]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,ll;function es(e){if(ll===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ll=t&&t[1]||""}return`
`+ll+e}var al=!1;function il(e,t){if(!e||al)return"";al=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(g){var s=g}Reflect.construct(e,[],t)}else{try{t.call()}catch(g){s=g}e.call(t.prototype)}else{try{throw Error()}catch(g){s=g}e()}}catch(g){if(g&&s&&typeof g.stack=="string"){for(var o=g.stack.split(`
`),l=s.stack.split(`
`),a=o.length-1,i=l.length-1;1<=a&&0<=i&&o[a]!==l[i];)i--;for(;1<=a&&0<=i;a--,i--)if(o[a]!==l[i]){if(a!==1||i!==1)do if(a--,i--,0>i||o[a]!==l[i]){var c=`
`+o[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=i);break}}}finally{al=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?es(e):""}function Jf(e){switch(e.tag){case 5:return es(e.type);case 16:return es("Lazy");case 13:return es("Suspense");case 19:return es("SuspenseList");case 0:case 2:case 15:return e=il(e.type,!1),e;case 11:return e=il(e.type.render,!1),e;case 1:return e=il(e.type,!0),e;default:return""}}function $l(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case fr:return"Fragment";case ur:return"Portal";case Pl:return"Profiler";case Ia:return"StrictMode";case Tl:return"Suspense";case Rl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Xc:return(e.displayName||"Context")+".Consumer";case Yc:return(e._context.displayName||"Context")+".Provider";case Pa:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ta:return t=e.displayName||null,t!==null?t:$l(e.type)||"Memo";case Cn:t=e._payload,e=e._init;try{return $l(e(t))}catch{}}return null}function Zf(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $l(t);case 8:return t===Ia?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Bn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Kc(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ep(e){var t=Kc(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(a){s=""+a,l.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ls(e){e._valueTracker||(e._valueTracker=ep(e))}function Jc(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Kc(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function ho(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Al(e,t){var n=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Di(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=Bn(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Zc(e,t){t=t.checked,t!=null&&Ea(e,"checked",t,!1)}function Ol(e,t){Zc(e,t);var n=Bn(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ul(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ul(e,t.type,Bn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function _i(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ul(e,t,n){(t!=="number"||ho(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ts=Array.isArray;function Cr(e,t,n,s){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Bn(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function Ll(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ce(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Mi(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ce(92));if(ts(n)){if(1<n.length)throw Error(ce(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Bn(n)}}function ed(e,t){var n=Bn(t.value),s=Bn(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function Ei(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function td(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bl(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?td(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Bs,nd=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Bs=Bs||document.createElement("div"),Bs.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Bs.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function hs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ss={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tp=["Webkit","ms","Moz","O"];Object.keys(ss).forEach(function(e){tp.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ss[t]=ss[e]})});function rd(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ss.hasOwnProperty(e)&&ss[e]?(""+t).trim():t+"px"}function sd(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,o=rd(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,o):e[n]=o}}var np=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zl(e,t){if(t){if(np[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ce(62))}}function Gl(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fl=null;function Ra(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Hl=null,kr=null,Dr=null;function Ii(e){if(e=Rs(e)){if(typeof Hl!="function")throw Error(ce(280));var t=e.stateNode;t&&(t=Ho(t),Hl(e.stateNode,e.type,t))}}function od(e){kr?Dr?Dr.push(e):Dr=[e]:kr=e}function ld(){if(kr){var e=kr,t=Dr;if(Dr=kr=null,Ii(e),t)for(e=0;e<t.length;e++)Ii(t[e])}}function ad(e,t){return e(t)}function id(){}var cl=!1;function cd(e,t,n){if(cl)return e(t,n);cl=!0;try{return ad(e,t,n)}finally{cl=!1,(kr!==null||Dr!==null)&&(id(),ld())}}function gs(e,t){var n=e.stateNode;if(n===null)return null;var s=Ho(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ce(231,t,typeof n));return n}var Vl=!1;if(xn)try{var qr={};Object.defineProperty(qr,"passive",{get:function(){Vl=!0}}),window.addEventListener("test",qr,qr),window.removeEventListener("test",qr,qr)}catch{Vl=!1}function rp(e,t,n,s,o,l,a,i,c){var g=Array.prototype.slice.call(arguments,3);try{t.apply(n,g)}catch(y){this.onError(y)}}var os=!1,go=null,xo=!1,ql=null,sp={onError:function(e){os=!0,go=e}};function op(e,t,n,s,o,l,a,i,c){os=!1,go=null,rp.apply(sp,arguments)}function lp(e,t,n,s,o,l,a,i,c){if(op.apply(this,arguments),os){if(os){var g=go;os=!1,go=null}else throw Error(ce(198));xo||(xo=!0,ql=g)}}function lr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function dd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Pi(e){if(lr(e)!==e)throw Error(ce(188))}function ap(e){var t=e.alternate;if(!t){if(t=lr(e),t===null)throw Error(ce(188));return t!==e?null:e}for(var n=e,s=t;;){var o=n.return;if(o===null)break;var l=o.alternate;if(l===null){if(s=o.return,s!==null){n=s;continue}break}if(o.child===l.child){for(l=o.child;l;){if(l===n)return Pi(o),e;if(l===s)return Pi(o),t;l=l.sibling}throw Error(ce(188))}if(n.return!==s.return)n=o,s=l;else{for(var a=!1,i=o.child;i;){if(i===n){a=!0,n=o,s=l;break}if(i===s){a=!0,s=o,n=l;break}i=i.sibling}if(!a){for(i=l.child;i;){if(i===n){a=!0,n=l,s=o;break}if(i===s){a=!0,s=l,n=o;break}i=i.sibling}if(!a)throw Error(ce(189))}}if(n.alternate!==s)throw Error(ce(190))}if(n.tag!==3)throw Error(ce(188));return n.stateNode.current===n?e:t}function ud(e){return e=ap(e),e!==null?fd(e):null}function fd(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=fd(e);if(t!==null)return t;e=e.sibling}return null}var pd=Lt.unstable_scheduleCallback,Ti=Lt.unstable_cancelCallback,ip=Lt.unstable_shouldYield,cp=Lt.unstable_requestPaint,ot=Lt.unstable_now,dp=Lt.unstable_getCurrentPriorityLevel,$a=Lt.unstable_ImmediatePriority,md=Lt.unstable_UserBlockingPriority,yo=Lt.unstable_NormalPriority,up=Lt.unstable_LowPriority,hd=Lt.unstable_IdlePriority,Bo=null,cn=null;function fp(e){if(cn&&typeof cn.onCommitFiberRoot=="function")try{cn.onCommitFiberRoot(Bo,e,void 0,(e.current.flags&128)===128)}catch{}}var tn=Math.clz32?Math.clz32:hp,pp=Math.log,mp=Math.LN2;function hp(e){return e>>>=0,e===0?32:31-(pp(e)/mp|0)|0}var zs=64,Gs=4194304;function ns(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function vo(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,o=e.suspendedLanes,l=e.pingedLanes,a=n&268435455;if(a!==0){var i=a&~o;i!==0?s=ns(i):(l&=a,l!==0&&(s=ns(l)))}else a=n&~o,a!==0?s=ns(a):l!==0&&(s=ns(l));if(s===0)return 0;if(t!==0&&t!==s&&!(t&o)&&(o=s&-s,l=t&-t,o>=l||o===16&&(l&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-tn(t),o=1<<n,s|=e[n],t&=~o;return s}function gp(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xp(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,l=e.pendingLanes;0<l;){var a=31-tn(l),i=1<<a,c=o[a];c===-1?(!(i&n)||i&s)&&(o[a]=gp(i,t)):c<=t&&(e.expiredLanes|=i),l&=~i}}function Wl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function gd(){var e=zs;return zs<<=1,!(zs&4194240)&&(zs=64),e}function dl(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ps(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-tn(t),e[t]=n}function yp(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-tn(n),l=1<<o;t[o]=0,s[o]=-1,e[o]=-1,n&=~l}}function Aa(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-tn(n),o=1<<s;o&t|e[s]&t&&(e[s]|=t),n&=~o}}var Fe=0;function xd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var yd,Oa,vd,wd,bd,Yl=!1,Fs=[],Pn=null,Tn=null,Rn=null,xs=new Map,ys=new Map,Dn=[],vp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ri(e,t){switch(e){case"focusin":case"focusout":Pn=null;break;case"dragenter":case"dragleave":Tn=null;break;case"mouseover":case"mouseout":Rn=null;break;case"pointerover":case"pointerout":xs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ys.delete(t.pointerId)}}function Wr(e,t,n,s,o,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:l,targetContainers:[o]},t!==null&&(t=Rs(t),t!==null&&Oa(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function wp(e,t,n,s,o){switch(t){case"focusin":return Pn=Wr(Pn,e,t,n,s,o),!0;case"dragenter":return Tn=Wr(Tn,e,t,n,s,o),!0;case"mouseover":return Rn=Wr(Rn,e,t,n,s,o),!0;case"pointerover":var l=o.pointerId;return xs.set(l,Wr(xs.get(l)||null,e,t,n,s,o)),!0;case"gotpointercapture":return l=o.pointerId,ys.set(l,Wr(ys.get(l)||null,e,t,n,s,o)),!0}return!1}function Nd(e){var t=Xn(e.target);if(t!==null){var n=lr(t);if(n!==null){if(t=n.tag,t===13){if(t=dd(n),t!==null){e.blockedOn=t,bd(e.priority,function(){vd(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ro(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xl(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Fl=s,n.target.dispatchEvent(s),Fl=null}else return t=Rs(n),t!==null&&Oa(t),e.blockedOn=n,!1;t.shift()}return!0}function $i(e,t,n){ro(e)&&n.delete(t)}function bp(){Yl=!1,Pn!==null&&ro(Pn)&&(Pn=null),Tn!==null&&ro(Tn)&&(Tn=null),Rn!==null&&ro(Rn)&&(Rn=null),xs.forEach($i),ys.forEach($i)}function Yr(e,t){e.blockedOn===t&&(e.blockedOn=null,Yl||(Yl=!0,Lt.unstable_scheduleCallback(Lt.unstable_NormalPriority,bp)))}function vs(e){function t(o){return Yr(o,e)}if(0<Fs.length){Yr(Fs[0],e);for(var n=1;n<Fs.length;n++){var s=Fs[n];s.blockedOn===e&&(s.blockedOn=null)}}for(Pn!==null&&Yr(Pn,e),Tn!==null&&Yr(Tn,e),Rn!==null&&Yr(Rn,e),xs.forEach(t),ys.forEach(t),n=0;n<Dn.length;n++)s=Dn[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<Dn.length&&(n=Dn[0],n.blockedOn===null);)Nd(n),n.blockedOn===null&&Dn.shift()}var _r=bn.ReactCurrentBatchConfig,wo=!0;function Np(e,t,n,s){var o=Fe,l=_r.transition;_r.transition=null;try{Fe=1,Ua(e,t,n,s)}finally{Fe=o,_r.transition=l}}function jp(e,t,n,s){var o=Fe,l=_r.transition;_r.transition=null;try{Fe=4,Ua(e,t,n,s)}finally{Fe=o,_r.transition=l}}function Ua(e,t,n,s){if(wo){var o=Xl(e,t,n,s);if(o===null)wl(e,t,s,bo,n),Ri(e,s);else if(wp(o,e,t,n,s))s.stopPropagation();else if(Ri(e,s),t&4&&-1<vp.indexOf(e)){for(;o!==null;){var l=Rs(o);if(l!==null&&yd(l),l=Xl(e,t,n,s),l===null&&wl(e,t,s,bo,n),l===o)break;o=l}o!==null&&s.stopPropagation()}else wl(e,t,s,null,n)}}var bo=null;function Xl(e,t,n,s){if(bo=null,e=Ra(s),e=Xn(e),e!==null)if(t=lr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=dd(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return bo=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dp()){case $a:return 1;case md:return 4;case yo:case up:return 16;case hd:return 536870912;default:return 16}default:return 16}}var Mn=null,La=null,so=null;function Sd(){if(so)return so;var e,t=La,n=t.length,s,o="value"in Mn?Mn.value:Mn.textContent,l=o.length;for(e=0;e<n&&t[e]===o[e];e++);var a=n-e;for(s=1;s<=a&&t[n-s]===o[l-s];s++);return so=o.slice(e,1<s?1-s:void 0)}function oo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Hs(){return!0}function Ai(){return!1}function zt(e){function t(n,s,o,l,a){this._reactName=n,this._targetInst=o,this.type=s,this.nativeEvent=l,this.target=a,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],this[i]=n?n(l):l[i]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Hs:Ai,this.isPropagationStopped=Ai,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Hs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Hs)},persist:function(){},isPersistent:Hs}),t}var Br={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ba=zt(Br),Ts=et({},Br,{view:0,detail:0}),Sp=zt(Ts),ul,fl,Xr,zo=et({},Ts,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:za,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xr&&(Xr&&e.type==="mousemove"?(ul=e.screenX-Xr.screenX,fl=e.screenY-Xr.screenY):fl=ul=0,Xr=e),ul)},movementY:function(e){return"movementY"in e?e.movementY:fl}}),Oi=zt(zo),Cp=et({},zo,{dataTransfer:0}),kp=zt(Cp),Dp=et({},Ts,{relatedTarget:0}),pl=zt(Dp),_p=et({},Br,{animationName:0,elapsedTime:0,pseudoElement:0}),Mp=zt(_p),Ep=et({},Br,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ip=zt(Ep),Pp=et({},Br,{data:0}),Ui=zt(Pp),Tp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$p={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ap(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$p[e])?!!t[e]:!1}function za(){return Ap}var Op=et({},Ts,{key:function(e){if(e.key){var t=Tp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=oo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Rp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:za,charCode:function(e){return e.type==="keypress"?oo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?oo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Up=zt(Op),Lp=et({},zo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Li=zt(Lp),Bp=et({},Ts,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:za}),zp=zt(Bp),Gp=et({},Br,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fp=zt(Gp),Hp=et({},zo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Vp=zt(Hp),qp=[9,13,27,32],Ga=xn&&"CompositionEvent"in window,ls=null;xn&&"documentMode"in document&&(ls=document.documentMode);var Wp=xn&&"TextEvent"in window&&!ls,Cd=xn&&(!Ga||ls&&8<ls&&11>=ls),Bi=" ",zi=!1;function kd(e,t){switch(e){case"keyup":return qp.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var pr=!1;function Yp(e,t){switch(e){case"compositionend":return Dd(t);case"keypress":return t.which!==32?null:(zi=!0,Bi);case"textInput":return e=t.data,e===Bi&&zi?null:e;default:return null}}function Xp(e,t){if(pr)return e==="compositionend"||!Ga&&kd(e,t)?(e=Sd(),so=La=Mn=null,pr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cd&&t.locale!=="ko"?null:t.data;default:return null}}var Qp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Qp[e.type]:t==="textarea"}function _d(e,t,n,s){od(s),t=No(t,"onChange"),0<t.length&&(n=new Ba("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var as=null,ws=null;function Kp(e){Ld(e,0)}function Go(e){var t=gr(e);if(Jc(t))return e}function Jp(e,t){if(e==="change")return t}var Md=!1;if(xn){var ml;if(xn){var hl="oninput"in document;if(!hl){var Fi=document.createElement("div");Fi.setAttribute("oninput","return;"),hl=typeof Fi.oninput=="function"}ml=hl}else ml=!1;Md=ml&&(!document.documentMode||9<document.documentMode)}function Hi(){as&&(as.detachEvent("onpropertychange",Ed),ws=as=null)}function Ed(e){if(e.propertyName==="value"&&Go(ws)){var t=[];_d(t,ws,e,Ra(e)),cd(Kp,t)}}function Zp(e,t,n){e==="focusin"?(Hi(),as=t,ws=n,as.attachEvent("onpropertychange",Ed)):e==="focusout"&&Hi()}function em(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Go(ws)}function tm(e,t){if(e==="click")return Go(t)}function nm(e,t){if(e==="input"||e==="change")return Go(t)}function rm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rn=typeof Object.is=="function"?Object.is:rm;function bs(e,t){if(rn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var o=n[s];if(!Il.call(t,o)||!rn(e[o],t[o]))return!1}return!0}function Vi(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function qi(e,t){var n=Vi(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Vi(n)}}function Id(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Id(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Pd(){for(var e=window,t=ho();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ho(e.document)}return t}function Fa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function sm(e){var t=Pd(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Id(n.ownerDocument.documentElement,n)){if(s!==null&&Fa(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,l=Math.min(s.start,o);s=s.end===void 0?l:Math.min(s.end,o),!e.extend&&l>s&&(o=s,s=l,l=o),o=qi(n,l);var a=qi(n,s);o&&a&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),l>s?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var om=xn&&"documentMode"in document&&11>=document.documentMode,mr=null,Ql=null,is=null,Kl=!1;function Wi(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Kl||mr==null||mr!==ho(s)||(s=mr,"selectionStart"in s&&Fa(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),is&&bs(is,s)||(is=s,s=No(Ql,"onSelect"),0<s.length&&(t=new Ba("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=mr)))}function Vs(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var hr={animationend:Vs("Animation","AnimationEnd"),animationiteration:Vs("Animation","AnimationIteration"),animationstart:Vs("Animation","AnimationStart"),transitionend:Vs("Transition","TransitionEnd")},gl={},Td={};xn&&(Td=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);function Fo(e){if(gl[e])return gl[e];if(!hr[e])return e;var t=hr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Td)return gl[e]=t[n];return e}var Rd=Fo("animationend"),$d=Fo("animationiteration"),Ad=Fo("animationstart"),Od=Fo("transitionend"),Ud=new Map,Yi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gn(e,t){Ud.set(e,t),or(t,[e])}for(var xl=0;xl<Yi.length;xl++){var yl=Yi[xl],lm=yl.toLowerCase(),am=yl[0].toUpperCase()+yl.slice(1);Gn(lm,"on"+am)}Gn(Rd,"onAnimationEnd");Gn($d,"onAnimationIteration");Gn(Ad,"onAnimationStart");Gn("dblclick","onDoubleClick");Gn("focusin","onFocus");Gn("focusout","onBlur");Gn(Od,"onTransitionEnd");Ir("onMouseEnter",["mouseout","mouseover"]);Ir("onMouseLeave",["mouseout","mouseover"]);Ir("onPointerEnter",["pointerout","pointerover"]);Ir("onPointerLeave",["pointerout","pointerover"]);or("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));or("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));or("onBeforeInput",["compositionend","keypress","textInput","paste"]);or("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));or("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));or("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),im=new Set("cancel close invalid load scroll toggle".split(" ").concat(rs));function Xi(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,lp(s,t,void 0,e),e.currentTarget=null}function Ld(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],o=s.event;s=s.listeners;e:{var l=void 0;if(t)for(var a=s.length-1;0<=a;a--){var i=s[a],c=i.instance,g=i.currentTarget;if(i=i.listener,c!==l&&o.isPropagationStopped())break e;Xi(o,i,g),l=c}else for(a=0;a<s.length;a++){if(i=s[a],c=i.instance,g=i.currentTarget,i=i.listener,c!==l&&o.isPropagationStopped())break e;Xi(o,i,g),l=c}}}if(xo)throw e=ql,xo=!1,ql=null,e}function qe(e,t){var n=t[na];n===void 0&&(n=t[na]=new Set);var s=e+"__bubble";n.has(s)||(Bd(t,e,2,!1),n.add(s))}function vl(e,t,n){var s=0;t&&(s|=4),Bd(n,e,s,t)}var qs="_reactListening"+Math.random().toString(36).slice(2);function Ns(e){if(!e[qs]){e[qs]=!0,Wc.forEach(function(n){n!=="selectionchange"&&(im.has(n)||vl(n,!1,e),vl(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[qs]||(t[qs]=!0,vl("selectionchange",!1,t))}}function Bd(e,t,n,s){switch(jd(t)){case 1:var o=Np;break;case 4:o=jp;break;default:o=Ua}n=o.bind(null,t,n,e),o=void 0,!Vl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function wl(e,t,n,s,o){var l=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var i=s.stateNode.containerInfo;if(i===o||i.nodeType===8&&i.parentNode===o)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===o||c.nodeType===8&&c.parentNode===o))return;a=a.return}for(;i!==null;){if(a=Xn(i),a===null)return;if(c=a.tag,c===5||c===6){s=l=a;continue e}i=i.parentNode}}s=s.return}cd(function(){var g=l,y=Ra(n),h=[];e:{var p=Ud.get(e);if(p!==void 0){var b=Ba,N=e;switch(e){case"keypress":if(oo(n)===0)break e;case"keydown":case"keyup":b=Up;break;case"focusin":N="focus",b=pl;break;case"focusout":N="blur",b=pl;break;case"beforeblur":case"afterblur":b=pl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=Oi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=kp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=zp;break;case Rd:case $d:case Ad:b=Mp;break;case Od:b=Fp;break;case"scroll":b=Sp;break;case"wheel":b=Vp;break;case"copy":case"cut":case"paste":b=Ip;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=Li}var S=(t&4)!==0,A=!S&&e==="scroll",d=S?p!==null?p+"Capture":null:p;S=[];for(var u=g,m;u!==null;){m=u;var C=m.stateNode;if(m.tag===5&&C!==null&&(m=C,d!==null&&(C=gs(u,d),C!=null&&S.push(js(u,C,m)))),A)break;u=u.return}0<S.length&&(p=new b(p,N,null,n,y),h.push({event:p,listeners:S}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",b=e==="mouseout"||e==="pointerout",p&&n!==Fl&&(N=n.relatedTarget||n.fromElement)&&(Xn(N)||N[yn]))break e;if((b||p)&&(p=y.window===y?y:(p=y.ownerDocument)?p.defaultView||p.parentWindow:window,b?(N=n.relatedTarget||n.toElement,b=g,N=N?Xn(N):null,N!==null&&(A=lr(N),N!==A||N.tag!==5&&N.tag!==6)&&(N=null)):(b=null,N=g),b!==N)){if(S=Oi,C="onMouseLeave",d="onMouseEnter",u="mouse",(e==="pointerout"||e==="pointerover")&&(S=Li,C="onPointerLeave",d="onPointerEnter",u="pointer"),A=b==null?p:gr(b),m=N==null?p:gr(N),p=new S(C,u+"leave",b,n,y),p.target=A,p.relatedTarget=m,C=null,Xn(y)===g&&(S=new S(d,u+"enter",N,n,y),S.target=m,S.relatedTarget=A,C=S),A=C,b&&N)t:{for(S=b,d=N,u=0,m=S;m;m=dr(m))u++;for(m=0,C=d;C;C=dr(C))m++;for(;0<u-m;)S=dr(S),u--;for(;0<m-u;)d=dr(d),m--;for(;u--;){if(S===d||d!==null&&S===d.alternate)break t;S=dr(S),d=dr(d)}S=null}else S=null;b!==null&&Qi(h,p,b,S,!1),N!==null&&A!==null&&Qi(h,A,N,S,!0)}}e:{if(p=g?gr(g):window,b=p.nodeName&&p.nodeName.toLowerCase(),b==="select"||b==="input"&&p.type==="file")var P=Jp;else if(Gi(p))if(Md)P=nm;else{P=em;var k=Zp}else(b=p.nodeName)&&b.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(P=tm);if(P&&(P=P(e,g))){_d(h,P,n,y);break e}k&&k(e,p,g),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&Ul(p,"number",p.value)}switch(k=g?gr(g):window,e){case"focusin":(Gi(k)||k.contentEditable==="true")&&(mr=k,Ql=g,is=null);break;case"focusout":is=Ql=mr=null;break;case"mousedown":Kl=!0;break;case"contextmenu":case"mouseup":case"dragend":Kl=!1,Wi(h,n,y);break;case"selectionchange":if(om)break;case"keydown":case"keyup":Wi(h,n,y)}var T;if(Ga)e:{switch(e){case"compositionstart":var G="onCompositionStart";break e;case"compositionend":G="onCompositionEnd";break e;case"compositionupdate":G="onCompositionUpdate";break e}G=void 0}else pr?kd(e,n)&&(G="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(G="onCompositionStart");G&&(Cd&&n.locale!=="ko"&&(pr||G!=="onCompositionStart"?G==="onCompositionEnd"&&pr&&(T=Sd()):(Mn=y,La="value"in Mn?Mn.value:Mn.textContent,pr=!0)),k=No(g,G),0<k.length&&(G=new Ui(G,e,null,n,y),h.push({event:G,listeners:k}),T?G.data=T:(T=Dd(n),T!==null&&(G.data=T)))),(T=Wp?Yp(e,n):Xp(e,n))&&(g=No(g,"onBeforeInput"),0<g.length&&(y=new Ui("onBeforeInput","beforeinput",null,n,y),h.push({event:y,listeners:g}),y.data=T))}Ld(h,t)})}function js(e,t,n){return{instance:e,listener:t,currentTarget:n}}function No(e,t){for(var n=t+"Capture",s=[];e!==null;){var o=e,l=o.stateNode;o.tag===5&&l!==null&&(o=l,l=gs(e,n),l!=null&&s.unshift(js(e,l,o)),l=gs(e,t),l!=null&&s.push(js(e,l,o))),e=e.return}return s}function dr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Qi(e,t,n,s,o){for(var l=t._reactName,a=[];n!==null&&n!==s;){var i=n,c=i.alternate,g=i.stateNode;if(c!==null&&c===s)break;i.tag===5&&g!==null&&(i=g,o?(c=gs(n,l),c!=null&&a.unshift(js(n,c,i))):o||(c=gs(n,l),c!=null&&a.push(js(n,c,i)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var cm=/\r\n?/g,dm=/\u0000|\uFFFD/g;function Ki(e){return(typeof e=="string"?e:""+e).replace(cm,`
`).replace(dm,"")}function Ws(e,t,n){if(t=Ki(t),Ki(e)!==t&&n)throw Error(ce(425))}function jo(){}var Jl=null,Zl=null;function ea(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ta=typeof setTimeout=="function"?setTimeout:void 0,um=typeof clearTimeout=="function"?clearTimeout:void 0,Ji=typeof Promise=="function"?Promise:void 0,fm=typeof queueMicrotask=="function"?queueMicrotask:typeof Ji<"u"?function(e){return Ji.resolve(null).then(e).catch(pm)}:ta;function pm(e){setTimeout(function(){throw e})}function bl(e,t){var n=t,s=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(s===0){e.removeChild(o),vs(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=o}while(n);vs(t)}function $n(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Zi(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var zr=Math.random().toString(36).slice(2),an="__reactFiber$"+zr,Ss="__reactProps$"+zr,yn="__reactContainer$"+zr,na="__reactEvents$"+zr,mm="__reactListeners$"+zr,hm="__reactHandles$"+zr;function Xn(e){var t=e[an];if(t)return t;for(var n=e.parentNode;n;){if(t=n[yn]||n[an]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Zi(e);e!==null;){if(n=e[an])return n;e=Zi(e)}return t}e=n,n=e.parentNode}return null}function Rs(e){return e=e[an]||e[yn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function gr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ce(33))}function Ho(e){return e[Ss]||null}var ra=[],xr=-1;function Fn(e){return{current:e}}function We(e){0>xr||(e.current=ra[xr],ra[xr]=null,xr--)}function Ve(e,t){xr++,ra[xr]=e.current,e.current=t}var zn={},bt=Fn(zn),It=Fn(!1),er=zn;function Pr(e,t){var n=e.type.contextTypes;if(!n)return zn;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var o={},l;for(l in n)o[l]=t[l];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Pt(e){return e=e.childContextTypes,e!=null}function So(){We(It),We(bt)}function ec(e,t,n){if(bt.current!==zn)throw Error(ce(168));Ve(bt,t),Ve(It,n)}function zd(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var o in s)if(!(o in t))throw Error(ce(108,Zf(e)||"Unknown",o));return et({},n,s)}function Co(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||zn,er=bt.current,Ve(bt,e),Ve(It,It.current),!0}function tc(e,t,n){var s=e.stateNode;if(!s)throw Error(ce(169));n?(e=zd(e,t,er),s.__reactInternalMemoizedMergedChildContext=e,We(It),We(bt),Ve(bt,e)):We(It),Ve(It,n)}var pn=null,Vo=!1,Nl=!1;function Gd(e){pn===null?pn=[e]:pn.push(e)}function gm(e){Vo=!0,Gd(e)}function Hn(){if(!Nl&&pn!==null){Nl=!0;var e=0,t=Fe;try{var n=pn;for(Fe=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}pn=null,Vo=!1}catch(o){throw pn!==null&&(pn=pn.slice(e+1)),pd($a,Hn),o}finally{Fe=t,Nl=!1}}return null}var yr=[],vr=0,ko=null,Do=0,Ft=[],Ht=0,tr=null,mn=1,hn="";function Wn(e,t){yr[vr++]=Do,yr[vr++]=ko,ko=e,Do=t}function Fd(e,t,n){Ft[Ht++]=mn,Ft[Ht++]=hn,Ft[Ht++]=tr,tr=e;var s=mn;e=hn;var o=32-tn(s)-1;s&=~(1<<o),n+=1;var l=32-tn(t)+o;if(30<l){var a=o-o%5;l=(s&(1<<a)-1).toString(32),s>>=a,o-=a,mn=1<<32-tn(t)+o|n<<o|s,hn=l+e}else mn=1<<l|n<<o|s,hn=e}function Ha(e){e.return!==null&&(Wn(e,1),Fd(e,1,0))}function Va(e){for(;e===ko;)ko=yr[--vr],yr[vr]=null,Do=yr[--vr],yr[vr]=null;for(;e===tr;)tr=Ft[--Ht],Ft[Ht]=null,hn=Ft[--Ht],Ft[Ht]=null,mn=Ft[--Ht],Ft[Ht]=null}var Ut=null,Ot=null,Qe=!1,en=null;function Hd(e,t){var n=Vt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function nc(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ut=e,Ot=$n(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ut=e,Ot=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=tr!==null?{id:mn,overflow:hn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Vt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ut=e,Ot=null,!0):!1;default:return!1}}function sa(e){return(e.mode&1)!==0&&(e.flags&128)===0}function oa(e){if(Qe){var t=Ot;if(t){var n=t;if(!nc(e,t)){if(sa(e))throw Error(ce(418));t=$n(n.nextSibling);var s=Ut;t&&nc(e,t)?Hd(s,n):(e.flags=e.flags&-4097|2,Qe=!1,Ut=e)}}else{if(sa(e))throw Error(ce(418));e.flags=e.flags&-4097|2,Qe=!1,Ut=e}}}function rc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ut=e}function Ys(e){if(e!==Ut)return!1;if(!Qe)return rc(e),Qe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ea(e.type,e.memoizedProps)),t&&(t=Ot)){if(sa(e))throw Vd(),Error(ce(418));for(;t;)Hd(e,t),t=$n(t.nextSibling)}if(rc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ot=$n(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ot=null}}else Ot=Ut?$n(e.stateNode.nextSibling):null;return!0}function Vd(){for(var e=Ot;e;)e=$n(e.nextSibling)}function Tr(){Ot=Ut=null,Qe=!1}function qa(e){en===null?en=[e]:en.push(e)}var xm=bn.ReactCurrentBatchConfig;function Qr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ce(309));var s=n.stateNode}if(!s)throw Error(ce(147,e));var o=s,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(a){var i=o.refs;a===null?delete i[l]:i[l]=a},t._stringRef=l,t)}if(typeof e!="string")throw Error(ce(284));if(!n._owner)throw Error(ce(290,e))}return e}function Xs(e,t){throw e=Object.prototype.toString.call(t),Error(ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function sc(e){var t=e._init;return t(e._payload)}function qd(e){function t(d,u){if(e){var m=d.deletions;m===null?(d.deletions=[u],d.flags|=16):m.push(u)}}function n(d,u){if(!e)return null;for(;u!==null;)t(d,u),u=u.sibling;return null}function s(d,u){for(d=new Map;u!==null;)u.key!==null?d.set(u.key,u):d.set(u.index,u),u=u.sibling;return d}function o(d,u){return d=Ln(d,u),d.index=0,d.sibling=null,d}function l(d,u,m){return d.index=m,e?(m=d.alternate,m!==null?(m=m.index,m<u?(d.flags|=2,u):m):(d.flags|=2,u)):(d.flags|=1048576,u)}function a(d){return e&&d.alternate===null&&(d.flags|=2),d}function i(d,u,m,C){return u===null||u.tag!==6?(u=Ml(m,d.mode,C),u.return=d,u):(u=o(u,m),u.return=d,u)}function c(d,u,m,C){var P=m.type;return P===fr?y(d,u,m.props.children,C,m.key):u!==null&&(u.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Cn&&sc(P)===u.type)?(C=o(u,m.props),C.ref=Qr(d,u,m),C.return=d,C):(C=po(m.type,m.key,m.props,null,d.mode,C),C.ref=Qr(d,u,m),C.return=d,C)}function g(d,u,m,C){return u===null||u.tag!==4||u.stateNode.containerInfo!==m.containerInfo||u.stateNode.implementation!==m.implementation?(u=El(m,d.mode,C),u.return=d,u):(u=o(u,m.children||[]),u.return=d,u)}function y(d,u,m,C,P){return u===null||u.tag!==7?(u=Zn(m,d.mode,C,P),u.return=d,u):(u=o(u,m),u.return=d,u)}function h(d,u,m){if(typeof u=="string"&&u!==""||typeof u=="number")return u=Ml(""+u,d.mode,m),u.return=d,u;if(typeof u=="object"&&u!==null){switch(u.$$typeof){case Us:return m=po(u.type,u.key,u.props,null,d.mode,m),m.ref=Qr(d,null,u),m.return=d,m;case ur:return u=El(u,d.mode,m),u.return=d,u;case Cn:var C=u._init;return h(d,C(u._payload),m)}if(ts(u)||Vr(u))return u=Zn(u,d.mode,m,null),u.return=d,u;Xs(d,u)}return null}function p(d,u,m,C){var P=u!==null?u.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return P!==null?null:i(d,u,""+m,C);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Us:return m.key===P?c(d,u,m,C):null;case ur:return m.key===P?g(d,u,m,C):null;case Cn:return P=m._init,p(d,u,P(m._payload),C)}if(ts(m)||Vr(m))return P!==null?null:y(d,u,m,C,null);Xs(d,m)}return null}function b(d,u,m,C,P){if(typeof C=="string"&&C!==""||typeof C=="number")return d=d.get(m)||null,i(u,d,""+C,P);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Us:return d=d.get(C.key===null?m:C.key)||null,c(u,d,C,P);case ur:return d=d.get(C.key===null?m:C.key)||null,g(u,d,C,P);case Cn:var k=C._init;return b(d,u,m,k(C._payload),P)}if(ts(C)||Vr(C))return d=d.get(m)||null,y(u,d,C,P,null);Xs(u,C)}return null}function N(d,u,m,C){for(var P=null,k=null,T=u,G=u=0,M=null;T!==null&&G<m.length;G++){T.index>G?(M=T,T=null):M=T.sibling;var U=p(d,T,m[G],C);if(U===null){T===null&&(T=M);break}e&&T&&U.alternate===null&&t(d,T),u=l(U,u,G),k===null?P=U:k.sibling=U,k=U,T=M}if(G===m.length)return n(d,T),Qe&&Wn(d,G),P;if(T===null){for(;G<m.length;G++)T=h(d,m[G],C),T!==null&&(u=l(T,u,G),k===null?P=T:k.sibling=T,k=T);return Qe&&Wn(d,G),P}for(T=s(d,T);G<m.length;G++)M=b(T,d,G,m[G],C),M!==null&&(e&&M.alternate!==null&&T.delete(M.key===null?G:M.key),u=l(M,u,G),k===null?P=M:k.sibling=M,k=M);return e&&T.forEach(function(le){return t(d,le)}),Qe&&Wn(d,G),P}function S(d,u,m,C){var P=Vr(m);if(typeof P!="function")throw Error(ce(150));if(m=P.call(m),m==null)throw Error(ce(151));for(var k=P=null,T=u,G=u=0,M=null,U=m.next();T!==null&&!U.done;G++,U=m.next()){T.index>G?(M=T,T=null):M=T.sibling;var le=p(d,T,U.value,C);if(le===null){T===null&&(T=M);break}e&&T&&le.alternate===null&&t(d,T),u=l(le,u,G),k===null?P=le:k.sibling=le,k=le,T=M}if(U.done)return n(d,T),Qe&&Wn(d,G),P;if(T===null){for(;!U.done;G++,U=m.next())U=h(d,U.value,C),U!==null&&(u=l(U,u,G),k===null?P=U:k.sibling=U,k=U);return Qe&&Wn(d,G),P}for(T=s(d,T);!U.done;G++,U=m.next())U=b(T,d,G,U.value,C),U!==null&&(e&&U.alternate!==null&&T.delete(U.key===null?G:U.key),u=l(U,u,G),k===null?P=U:k.sibling=U,k=U);return e&&T.forEach(function(ue){return t(d,ue)}),Qe&&Wn(d,G),P}function A(d,u,m,C){if(typeof m=="object"&&m!==null&&m.type===fr&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Us:e:{for(var P=m.key,k=u;k!==null;){if(k.key===P){if(P=m.type,P===fr){if(k.tag===7){n(d,k.sibling),u=o(k,m.props.children),u.return=d,d=u;break e}}else if(k.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Cn&&sc(P)===k.type){n(d,k.sibling),u=o(k,m.props),u.ref=Qr(d,k,m),u.return=d,d=u;break e}n(d,k);break}else t(d,k);k=k.sibling}m.type===fr?(u=Zn(m.props.children,d.mode,C,m.key),u.return=d,d=u):(C=po(m.type,m.key,m.props,null,d.mode,C),C.ref=Qr(d,u,m),C.return=d,d=C)}return a(d);case ur:e:{for(k=m.key;u!==null;){if(u.key===k)if(u.tag===4&&u.stateNode.containerInfo===m.containerInfo&&u.stateNode.implementation===m.implementation){n(d,u.sibling),u=o(u,m.children||[]),u.return=d,d=u;break e}else{n(d,u);break}else t(d,u);u=u.sibling}u=El(m,d.mode,C),u.return=d,d=u}return a(d);case Cn:return k=m._init,A(d,u,k(m._payload),C)}if(ts(m))return N(d,u,m,C);if(Vr(m))return S(d,u,m,C);Xs(d,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,u!==null&&u.tag===6?(n(d,u.sibling),u=o(u,m),u.return=d,d=u):(n(d,u),u=Ml(m,d.mode,C),u.return=d,d=u),a(d)):n(d,u)}return A}var Rr=qd(!0),Wd=qd(!1),_o=Fn(null),Mo=null,wr=null,Wa=null;function Ya(){Wa=wr=Mo=null}function Xa(e){var t=_o.current;We(_o),e._currentValue=t}function la(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Mr(e,t){Mo=e,Wa=wr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(_t=!0),e.firstContext=null)}function Wt(e){var t=e._currentValue;if(Wa!==e)if(e={context:e,memoizedValue:t,next:null},wr===null){if(Mo===null)throw Error(ce(308));wr=e,Mo.dependencies={lanes:0,firstContext:e}}else wr=wr.next=e;return t}var Qn=null;function Qa(e){Qn===null?Qn=[e]:Qn.push(e)}function Yd(e,t,n,s){var o=t.interleaved;return o===null?(n.next=n,Qa(t)):(n.next=o.next,o.next=n),t.interleaved=n,vn(e,s)}function vn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var kn=!1;function Ka(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function gn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function An(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Be&2){var o=s.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),s.pending=t,vn(e,n)}return o=s.interleaved,o===null?(t.next=t,Qa(s)):(t.next=o.next,o.next=t),s.interleaved=t,vn(e,n)}function lo(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Aa(e,n)}}function oc(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var o=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?o=l=a:l=l.next=a,n=n.next}while(n!==null);l===null?o=l=t:l=l.next=t}else o=l=t;n={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:l,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Eo(e,t,n,s){var o=e.updateQueue;kn=!1;var l=o.firstBaseUpdate,a=o.lastBaseUpdate,i=o.shared.pending;if(i!==null){o.shared.pending=null;var c=i,g=c.next;c.next=null,a===null?l=g:a.next=g,a=c;var y=e.alternate;y!==null&&(y=y.updateQueue,i=y.lastBaseUpdate,i!==a&&(i===null?y.firstBaseUpdate=g:i.next=g,y.lastBaseUpdate=c))}if(l!==null){var h=o.baseState;a=0,y=g=c=null,i=l;do{var p=i.lane,b=i.eventTime;if((s&p)===p){y!==null&&(y=y.next={eventTime:b,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var N=e,S=i;switch(p=t,b=n,S.tag){case 1:if(N=S.payload,typeof N=="function"){h=N.call(b,h,p);break e}h=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=S.payload,p=typeof N=="function"?N.call(b,h,p):N,p==null)break e;h=et({},h,p);break e;case 2:kn=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,p=o.effects,p===null?o.effects=[i]:p.push(i))}else b={eventTime:b,lane:p,tag:i.tag,payload:i.payload,callback:i.callback,next:null},y===null?(g=y=b,c=h):y=y.next=b,a|=p;if(i=i.next,i===null){if(i=o.shared.pending,i===null)break;p=i,i=p.next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}while(!0);if(y===null&&(c=h),o.baseState=c,o.firstBaseUpdate=g,o.lastBaseUpdate=y,t=o.shared.interleaved,t!==null){o=t;do a|=o.lane,o=o.next;while(o!==t)}else l===null&&(o.shared.lanes=0);rr|=a,e.lanes=a,e.memoizedState=h}}function lc(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],o=s.callback;if(o!==null){if(s.callback=null,s=n,typeof o!="function")throw Error(ce(191,o));o.call(s)}}}var $s={},dn=Fn($s),Cs=Fn($s),ks=Fn($s);function Kn(e){if(e===$s)throw Error(ce(174));return e}function Ja(e,t){switch(Ve(ks,t),Ve(Cs,e),Ve(dn,$s),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Bl(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Bl(t,e)}We(dn),Ve(dn,t)}function $r(){We(dn),We(Cs),We(ks)}function Qd(e){Kn(ks.current);var t=Kn(dn.current),n=Bl(t,e.type);t!==n&&(Ve(Cs,e),Ve(dn,n))}function Za(e){Cs.current===e&&(We(dn),We(Cs))}var Je=Fn(0);function Io(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var jl=[];function ei(){for(var e=0;e<jl.length;e++)jl[e]._workInProgressVersionPrimary=null;jl.length=0}var ao=bn.ReactCurrentDispatcher,Sl=bn.ReactCurrentBatchConfig,nr=0,Ze=null,it=null,ut=null,Po=!1,cs=!1,Ds=0,ym=0;function yt(){throw Error(ce(321))}function ti(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!rn(e[n],t[n]))return!1;return!0}function ni(e,t,n,s,o,l){if(nr=l,Ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ao.current=e===null||e.memoizedState===null?Nm:jm,e=n(s,o),cs){l=0;do{if(cs=!1,Ds=0,25<=l)throw Error(ce(301));l+=1,ut=it=null,t.updateQueue=null,ao.current=Sm,e=n(s,o)}while(cs)}if(ao.current=To,t=it!==null&&it.next!==null,nr=0,ut=it=Ze=null,Po=!1,t)throw Error(ce(300));return e}function ri(){var e=Ds!==0;return Ds=0,e}function ln(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?Ze.memoizedState=ut=e:ut=ut.next=e,ut}function Yt(){if(it===null){var e=Ze.alternate;e=e!==null?e.memoizedState:null}else e=it.next;var t=ut===null?Ze.memoizedState:ut.next;if(t!==null)ut=t,it=e;else{if(e===null)throw Error(ce(310));it=e,e={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},ut===null?Ze.memoizedState=ut=e:ut=ut.next=e}return ut}function _s(e,t){return typeof t=="function"?t(e):t}function Cl(e){var t=Yt(),n=t.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=e;var s=it,o=s.baseQueue,l=n.pending;if(l!==null){if(o!==null){var a=o.next;o.next=l.next,l.next=a}s.baseQueue=o=l,n.pending=null}if(o!==null){l=o.next,s=s.baseState;var i=a=null,c=null,g=l;do{var y=g.lane;if((nr&y)===y)c!==null&&(c=c.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),s=g.hasEagerState?g.eagerState:e(s,g.action);else{var h={lane:y,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};c===null?(i=c=h,a=s):c=c.next=h,Ze.lanes|=y,rr|=y}g=g.next}while(g!==null&&g!==l);c===null?a=s:c.next=i,rn(s,t.memoizedState)||(_t=!0),t.memoizedState=s,t.baseState=a,t.baseQueue=c,n.lastRenderedState=s}if(e=n.interleaved,e!==null){o=e;do l=o.lane,Ze.lanes|=l,rr|=l,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function kl(e){var t=Yt(),n=t.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=e;var s=n.dispatch,o=n.pending,l=t.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do l=e(l,a.action),a=a.next;while(a!==o);rn(l,t.memoizedState)||(_t=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,s]}function Kd(){}function Jd(e,t){var n=Ze,s=Yt(),o=t(),l=!rn(s.memoizedState,o);if(l&&(s.memoizedState=o,_t=!0),s=s.queue,si(tu.bind(null,n,s,e),[e]),s.getSnapshot!==t||l||ut!==null&&ut.memoizedState.tag&1){if(n.flags|=2048,Ms(9,eu.bind(null,n,s,o,t),void 0,null),ft===null)throw Error(ce(349));nr&30||Zd(n,t,o)}return o}function Zd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function eu(e,t,n,s){t.value=n,t.getSnapshot=s,nu(t)&&ru(e)}function tu(e,t,n){return n(function(){nu(t)&&ru(e)})}function nu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!rn(e,n)}catch{return!0}}function ru(e){var t=vn(e,1);t!==null&&nn(t,e,1,-1)}function ac(e){var t=ln();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_s,lastRenderedState:e},t.queue=e,e=e.dispatch=bm.bind(null,Ze,e),[t.memoizedState,e]}function Ms(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function su(){return Yt().memoizedState}function io(e,t,n,s){var o=ln();Ze.flags|=e,o.memoizedState=Ms(1|t,n,void 0,s===void 0?null:s)}function qo(e,t,n,s){var o=Yt();s=s===void 0?null:s;var l=void 0;if(it!==null){var a=it.memoizedState;if(l=a.destroy,s!==null&&ti(s,a.deps)){o.memoizedState=Ms(t,n,l,s);return}}Ze.flags|=e,o.memoizedState=Ms(1|t,n,l,s)}function ic(e,t){return io(8390656,8,e,t)}function si(e,t){return qo(2048,8,e,t)}function ou(e,t){return qo(4,2,e,t)}function lu(e,t){return qo(4,4,e,t)}function au(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function iu(e,t,n){return n=n!=null?n.concat([e]):null,qo(4,4,au.bind(null,t,e),n)}function oi(){}function cu(e,t){var n=Yt();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&ti(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function du(e,t){var n=Yt();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&ti(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function uu(e,t,n){return nr&21?(rn(n,t)||(n=gd(),Ze.lanes|=n,rr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,_t=!0),e.memoizedState=n)}function vm(e,t){var n=Fe;Fe=n!==0&&4>n?n:4,e(!0);var s=Sl.transition;Sl.transition={};try{e(!1),t()}finally{Fe=n,Sl.transition=s}}function fu(){return Yt().memoizedState}function wm(e,t,n){var s=Un(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},pu(e))mu(t,n);else if(n=Yd(e,t,n,s),n!==null){var o=jt();nn(n,e,s,o),hu(n,t,s)}}function bm(e,t,n){var s=Un(e),o={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(pu(e))mu(t,o);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var a=t.lastRenderedState,i=l(a,n);if(o.hasEagerState=!0,o.eagerState=i,rn(i,a)){var c=t.interleaved;c===null?(o.next=o,Qa(t)):(o.next=c.next,c.next=o),t.interleaved=o;return}}catch{}finally{}n=Yd(e,t,o,s),n!==null&&(o=jt(),nn(n,e,s,o),hu(n,t,s))}}function pu(e){var t=e.alternate;return e===Ze||t!==null&&t===Ze}function mu(e,t){cs=Po=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function hu(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Aa(e,n)}}var To={readContext:Wt,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useInsertionEffect:yt,useLayoutEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useMutableSource:yt,useSyncExternalStore:yt,useId:yt,unstable_isNewReconciler:!1},Nm={readContext:Wt,useCallback:function(e,t){return ln().memoizedState=[e,t===void 0?null:t],e},useContext:Wt,useEffect:ic,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,io(4194308,4,au.bind(null,t,e),n)},useLayoutEffect:function(e,t){return io(4194308,4,e,t)},useInsertionEffect:function(e,t){return io(4,2,e,t)},useMemo:function(e,t){var n=ln();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=ln();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=wm.bind(null,Ze,e),[s.memoizedState,e]},useRef:function(e){var t=ln();return e={current:e},t.memoizedState=e},useState:ac,useDebugValue:oi,useDeferredValue:function(e){return ln().memoizedState=e},useTransition:function(){var e=ac(!1),t=e[0];return e=vm.bind(null,e[1]),ln().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=Ze,o=ln();if(Qe){if(n===void 0)throw Error(ce(407));n=n()}else{if(n=t(),ft===null)throw Error(ce(349));nr&30||Zd(s,t,n)}o.memoizedState=n;var l={value:n,getSnapshot:t};return o.queue=l,ic(tu.bind(null,s,l,e),[e]),s.flags|=2048,Ms(9,eu.bind(null,s,l,n,t),void 0,null),n},useId:function(){var e=ln(),t=ft.identifierPrefix;if(Qe){var n=hn,s=mn;n=(s&~(1<<32-tn(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ds++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=ym++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},jm={readContext:Wt,useCallback:cu,useContext:Wt,useEffect:si,useImperativeHandle:iu,useInsertionEffect:ou,useLayoutEffect:lu,useMemo:du,useReducer:Cl,useRef:su,useState:function(){return Cl(_s)},useDebugValue:oi,useDeferredValue:function(e){var t=Yt();return uu(t,it.memoizedState,e)},useTransition:function(){var e=Cl(_s)[0],t=Yt().memoizedState;return[e,t]},useMutableSource:Kd,useSyncExternalStore:Jd,useId:fu,unstable_isNewReconciler:!1},Sm={readContext:Wt,useCallback:cu,useContext:Wt,useEffect:si,useImperativeHandle:iu,useInsertionEffect:ou,useLayoutEffect:lu,useMemo:du,useReducer:kl,useRef:su,useState:function(){return kl(_s)},useDebugValue:oi,useDeferredValue:function(e){var t=Yt();return it===null?t.memoizedState=e:uu(t,it.memoizedState,e)},useTransition:function(){var e=kl(_s)[0],t=Yt().memoizedState;return[e,t]},useMutableSource:Kd,useSyncExternalStore:Jd,useId:fu,unstable_isNewReconciler:!1};function Jt(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function aa(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:et({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Wo={isMounted:function(e){return(e=e._reactInternals)?lr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=jt(),o=Un(e),l=gn(s,o);l.payload=t,n!=null&&(l.callback=n),t=An(e,l,o),t!==null&&(nn(t,e,o,s),lo(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=jt(),o=Un(e),l=gn(s,o);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=An(e,l,o),t!==null&&(nn(t,e,o,s),lo(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=jt(),s=Un(e),o=gn(n,s);o.tag=2,t!=null&&(o.callback=t),t=An(e,o,s),t!==null&&(nn(t,e,s,n),lo(t,e,s))}};function cc(e,t,n,s,o,l,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,l,a):t.prototype&&t.prototype.isPureReactComponent?!bs(n,s)||!bs(o,l):!0}function gu(e,t,n){var s=!1,o=zn,l=t.contextType;return typeof l=="object"&&l!==null?l=Wt(l):(o=Pt(t)?er:bt.current,s=t.contextTypes,l=(s=s!=null)?Pr(e,o):zn),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Wo,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=l),t}function dc(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Wo.enqueueReplaceState(t,t.state,null)}function ia(e,t,n,s){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Ka(e);var l=t.contextType;typeof l=="object"&&l!==null?o.context=Wt(l):(l=Pt(t)?er:bt.current,o.context=Pr(e,l)),o.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(aa(e,t,l,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Wo.enqueueReplaceState(o,o.state,null),Eo(e,n,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Ar(e,t){try{var n="",s=t;do n+=Jf(s),s=s.return;while(s);var o=n}catch(l){o=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:o,digest:null}}function Dl(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ca(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Cm=typeof WeakMap=="function"?WeakMap:Map;function xu(e,t,n){n=gn(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){$o||($o=!0,va=s),ca(e,t)},n}function yu(e,t,n){n=gn(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=t.value;n.payload=function(){return s(o)},n.callback=function(){ca(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){ca(e,t),typeof s!="function"&&(On===null?On=new Set([this]):On.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function uc(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new Cm;var o=new Set;s.set(t,o)}else o=s.get(t),o===void 0&&(o=new Set,s.set(t,o));o.has(n)||(o.add(n),e=Lm.bind(null,e,t,n),t.then(e,e))}function fc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function pc(e,t,n,s,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=gn(-1,1),t.tag=2,An(n,t,1))),n.lanes|=1),e)}var km=bn.ReactCurrentOwner,_t=!1;function Nt(e,t,n,s){t.child=e===null?Wd(t,null,n,s):Rr(t,e.child,n,s)}function mc(e,t,n,s,o){n=n.render;var l=t.ref;return Mr(t,o),s=ni(e,t,n,s,l,o),n=ri(),e!==null&&!_t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,wn(e,t,o)):(Qe&&n&&Ha(t),t.flags|=1,Nt(e,t,s,o),t.child)}function hc(e,t,n,s,o){if(e===null){var l=n.type;return typeof l=="function"&&!pi(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,vu(e,t,l,s,o)):(e=po(n.type,null,s,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&o)){var a=l.memoizedProps;if(n=n.compare,n=n!==null?n:bs,n(a,s)&&e.ref===t.ref)return wn(e,t,o)}return t.flags|=1,e=Ln(l,s),e.ref=t.ref,e.return=t,t.child=e}function vu(e,t,n,s,o){if(e!==null){var l=e.memoizedProps;if(bs(l,s)&&e.ref===t.ref)if(_t=!1,t.pendingProps=s=l,(e.lanes&o)!==0)e.flags&131072&&(_t=!0);else return t.lanes=e.lanes,wn(e,t,o)}return da(e,t,n,s,o)}function wu(e,t,n){var s=t.pendingProps,o=s.children,l=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(Nr,At),At|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ve(Nr,At),At|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=l!==null?l.baseLanes:n,Ve(Nr,At),At|=s}else l!==null?(s=l.baseLanes|n,t.memoizedState=null):s=n,Ve(Nr,At),At|=s;return Nt(e,t,o,n),t.child}function bu(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function da(e,t,n,s,o){var l=Pt(n)?er:bt.current;return l=Pr(t,l),Mr(t,o),n=ni(e,t,n,s,l,o),s=ri(),e!==null&&!_t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,wn(e,t,o)):(Qe&&s&&Ha(t),t.flags|=1,Nt(e,t,n,o),t.child)}function gc(e,t,n,s,o){if(Pt(n)){var l=!0;Co(t)}else l=!1;if(Mr(t,o),t.stateNode===null)co(e,t),gu(t,n,s),ia(t,n,s,o),s=!0;else if(e===null){var a=t.stateNode,i=t.memoizedProps;a.props=i;var c=a.context,g=n.contextType;typeof g=="object"&&g!==null?g=Wt(g):(g=Pt(n)?er:bt.current,g=Pr(t,g));var y=n.getDerivedStateFromProps,h=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(i!==s||c!==g)&&dc(t,a,s,g),kn=!1;var p=t.memoizedState;a.state=p,Eo(t,s,a,o),c=t.memoizedState,i!==s||p!==c||It.current||kn?(typeof y=="function"&&(aa(t,n,y,s),c=t.memoizedState),(i=kn||cc(t,n,i,s,p,c,g))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),a.props=s,a.state=c,a.context=g,s=i):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{a=t.stateNode,Xd(e,t),i=t.memoizedProps,g=t.type===t.elementType?i:Jt(t.type,i),a.props=g,h=t.pendingProps,p=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=Wt(c):(c=Pt(n)?er:bt.current,c=Pr(t,c));var b=n.getDerivedStateFromProps;(y=typeof b=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(i!==h||p!==c)&&dc(t,a,s,c),kn=!1,p=t.memoizedState,a.state=p,Eo(t,s,a,o);var N=t.memoizedState;i!==h||p!==N||It.current||kn?(typeof b=="function"&&(aa(t,n,b,s),N=t.memoizedState),(g=kn||cc(t,n,g,s,p,N,c)||!1)?(y||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,N,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,N,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=N),a.props=s,a.state=N,a.context=c,s=g):(typeof a.componentDidUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),s=!1)}return ua(e,t,n,s,l,o)}function ua(e,t,n,s,o,l){bu(e,t);var a=(t.flags&128)!==0;if(!s&&!a)return o&&tc(t,n,!1),wn(e,t,l);s=t.stateNode,km.current=t;var i=a&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&a?(t.child=Rr(t,e.child,null,l),t.child=Rr(t,null,i,l)):Nt(e,t,i,l),t.memoizedState=s.state,o&&tc(t,n,!0),t.child}function Nu(e){var t=e.stateNode;t.pendingContext?ec(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ec(e,t.context,!1),Ja(e,t.containerInfo)}function xc(e,t,n,s,o){return Tr(),qa(o),t.flags|=256,Nt(e,t,n,s),t.child}var fa={dehydrated:null,treeContext:null,retryLane:0};function pa(e){return{baseLanes:e,cachePool:null,transitions:null}}function ju(e,t,n){var s=t.pendingProps,o=Je.current,l=!1,a=(t.flags&128)!==0,i;if((i=a)||(i=e!==null&&e.memoizedState===null?!1:(o&2)!==0),i?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Ve(Je,o&1),e===null)return oa(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=s.children,e=s.fallback,l?(s=t.mode,l=t.child,a={mode:"hidden",children:a},!(s&1)&&l!==null?(l.childLanes=0,l.pendingProps=a):l=Qo(a,s,0,null),e=Zn(e,s,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=pa(n),t.memoizedState=fa,e):li(t,a));if(o=e.memoizedState,o!==null&&(i=o.dehydrated,i!==null))return Dm(e,t,a,s,i,o,n);if(l){l=s.fallback,a=t.mode,o=e.child,i=o.sibling;var c={mode:"hidden",children:s.children};return!(a&1)&&t.child!==o?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=Ln(o,c),s.subtreeFlags=o.subtreeFlags&14680064),i!==null?l=Ln(i,l):(l=Zn(l,a,n,null),l.flags|=2),l.return=t,s.return=t,s.sibling=l,t.child=s,s=l,l=t.child,a=e.child.memoizedState,a=a===null?pa(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},l.memoizedState=a,l.childLanes=e.childLanes&~n,t.memoizedState=fa,s}return l=e.child,e=l.sibling,s=Ln(l,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function li(e,t){return t=Qo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Qs(e,t,n,s){return s!==null&&qa(s),Rr(t,e.child,null,n),e=li(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Dm(e,t,n,s,o,l,a){if(n)return t.flags&256?(t.flags&=-257,s=Dl(Error(ce(422))),Qs(e,t,a,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=s.fallback,o=t.mode,s=Qo({mode:"visible",children:s.children},o,0,null),l=Zn(l,o,a,null),l.flags|=2,s.return=t,l.return=t,s.sibling=l,t.child=s,t.mode&1&&Rr(t,e.child,null,a),t.child.memoizedState=pa(a),t.memoizedState=fa,l);if(!(t.mode&1))return Qs(e,t,a,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var i=s.dgst;return s=i,l=Error(ce(419)),s=Dl(l,s,void 0),Qs(e,t,a,s)}if(i=(a&e.childLanes)!==0,_t||i){if(s=ft,s!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|a)?0:o,o!==0&&o!==l.retryLane&&(l.retryLane=o,vn(e,o),nn(s,e,o,-1))}return fi(),s=Dl(Error(ce(421))),Qs(e,t,a,s)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Bm.bind(null,e),o._reactRetry=t,null):(e=l.treeContext,Ot=$n(o.nextSibling),Ut=t,Qe=!0,en=null,e!==null&&(Ft[Ht++]=mn,Ft[Ht++]=hn,Ft[Ht++]=tr,mn=e.id,hn=e.overflow,tr=t),t=li(t,s.children),t.flags|=4096,t)}function yc(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),la(e.return,t,n)}function _l(e,t,n,s,o){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:o}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=s,l.tail=n,l.tailMode=o)}function Su(e,t,n){var s=t.pendingProps,o=s.revealOrder,l=s.tail;if(Nt(e,t,s.children,n),s=Je.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&yc(e,n,t);else if(e.tag===19)yc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Ve(Je,s),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&Io(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),_l(t,!1,o,n,l);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&Io(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}_l(t,!0,n,null,l);break;case"together":_l(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function co(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function wn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),rr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ce(153));if(t.child!==null){for(e=t.child,n=Ln(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ln(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function _m(e,t,n){switch(t.tag){case 3:Nu(t),Tr();break;case 5:Qd(t);break;case 1:Pt(t.type)&&Co(t);break;case 4:Ja(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,o=t.memoizedProps.value;Ve(_o,s._currentValue),s._currentValue=o;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(Ve(Je,Je.current&1),t.flags|=128,null):n&t.child.childLanes?ju(e,t,n):(Ve(Je,Je.current&1),e=wn(e,t,n),e!==null?e.sibling:null);Ve(Je,Je.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return Su(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ve(Je,Je.current),s)break;return null;case 22:case 23:return t.lanes=0,wu(e,t,n)}return wn(e,t,n)}var Cu,ma,ku,Du;Cu=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ma=function(){};ku=function(e,t,n,s){var o=e.memoizedProps;if(o!==s){e=t.stateNode,Kn(dn.current);var l=null;switch(n){case"input":o=Al(e,o),s=Al(e,s),l=[];break;case"select":o=et({},o,{value:void 0}),s=et({},s,{value:void 0}),l=[];break;case"textarea":o=Ll(e,o),s=Ll(e,s),l=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=jo)}zl(n,s);var a;n=null;for(g in o)if(!s.hasOwnProperty(g)&&o.hasOwnProperty(g)&&o[g]!=null)if(g==="style"){var i=o[g];for(a in i)i.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(ms.hasOwnProperty(g)?l||(l=[]):(l=l||[]).push(g,null));for(g in s){var c=s[g];if(i=o!=null?o[g]:void 0,s.hasOwnProperty(g)&&c!==i&&(c!=null||i!=null))if(g==="style")if(i){for(a in i)!i.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&i[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(l||(l=[]),l.push(g,n)),n=c;else g==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,i=i?i.__html:void 0,c!=null&&i!==c&&(l=l||[]).push(g,c)):g==="children"?typeof c!="string"&&typeof c!="number"||(l=l||[]).push(g,""+c):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(ms.hasOwnProperty(g)?(c!=null&&g==="onScroll"&&qe("scroll",e),l||i===c||(l=[])):(l=l||[]).push(g,c))}n&&(l=l||[]).push("style",n);var g=l;(t.updateQueue=g)&&(t.flags|=4)}};Du=function(e,t,n,s){n!==s&&(t.flags|=4)};function Kr(e,t){if(!Qe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function vt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function Mm(e,t,n){var s=t.pendingProps;switch(Va(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vt(t),null;case 1:return Pt(t.type)&&So(),vt(t),null;case 3:return s=t.stateNode,$r(),We(It),We(bt),ei(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Ys(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,en!==null&&(Na(en),en=null))),ma(e,t),vt(t),null;case 5:Za(t);var o=Kn(ks.current);if(n=t.type,e!==null&&t.stateNode!=null)ku(e,t,n,s,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(ce(166));return vt(t),null}if(e=Kn(dn.current),Ys(t)){s=t.stateNode,n=t.type;var l=t.memoizedProps;switch(s[an]=t,s[Ss]=l,e=(t.mode&1)!==0,n){case"dialog":qe("cancel",s),qe("close",s);break;case"iframe":case"object":case"embed":qe("load",s);break;case"video":case"audio":for(o=0;o<rs.length;o++)qe(rs[o],s);break;case"source":qe("error",s);break;case"img":case"image":case"link":qe("error",s),qe("load",s);break;case"details":qe("toggle",s);break;case"input":Di(s,l),qe("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!l.multiple},qe("invalid",s);break;case"textarea":Mi(s,l),qe("invalid",s)}zl(n,l),o=null;for(var a in l)if(l.hasOwnProperty(a)){var i=l[a];a==="children"?typeof i=="string"?s.textContent!==i&&(l.suppressHydrationWarning!==!0&&Ws(s.textContent,i,e),o=["children",i]):typeof i=="number"&&s.textContent!==""+i&&(l.suppressHydrationWarning!==!0&&Ws(s.textContent,i,e),o=["children",""+i]):ms.hasOwnProperty(a)&&i!=null&&a==="onScroll"&&qe("scroll",s)}switch(n){case"input":Ls(s),_i(s,l,!0);break;case"textarea":Ls(s),Ei(s);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(s.onclick=jo)}s=o,t.updateQueue=s,s!==null&&(t.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=td(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=a.createElement(n,{is:s.is}):(e=a.createElement(n),n==="select"&&(a=e,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):e=a.createElementNS(e,n),e[an]=t,e[Ss]=s,Cu(e,t,!1,!1),t.stateNode=e;e:{switch(a=Gl(n,s),n){case"dialog":qe("cancel",e),qe("close",e),o=s;break;case"iframe":case"object":case"embed":qe("load",e),o=s;break;case"video":case"audio":for(o=0;o<rs.length;o++)qe(rs[o],e);o=s;break;case"source":qe("error",e),o=s;break;case"img":case"image":case"link":qe("error",e),qe("load",e),o=s;break;case"details":qe("toggle",e),o=s;break;case"input":Di(e,s),o=Al(e,s),qe("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=et({},s,{value:void 0}),qe("invalid",e);break;case"textarea":Mi(e,s),o=Ll(e,s),qe("invalid",e);break;default:o=s}zl(n,o),i=o;for(l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="style"?sd(e,c):l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&nd(e,c)):l==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&hs(e,c):typeof c=="number"&&hs(e,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(ms.hasOwnProperty(l)?c!=null&&l==="onScroll"&&qe("scroll",e):c!=null&&Ea(e,l,c,a))}switch(n){case"input":Ls(e),_i(e,s,!1);break;case"textarea":Ls(e),Ei(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Bn(s.value));break;case"select":e.multiple=!!s.multiple,l=s.value,l!=null?Cr(e,!!s.multiple,l,!1):s.defaultValue!=null&&Cr(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=jo)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return vt(t),null;case 6:if(e&&t.stateNode!=null)Du(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(ce(166));if(n=Kn(ks.current),Kn(dn.current),Ys(t)){if(s=t.stateNode,n=t.memoizedProps,s[an]=t,(l=s.nodeValue!==n)&&(e=Ut,e!==null))switch(e.tag){case 3:Ws(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ws(s.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[an]=t,t.stateNode=s}return vt(t),null;case 13:if(We(Je),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Qe&&Ot!==null&&t.mode&1&&!(t.flags&128))Vd(),Tr(),t.flags|=98560,l=!1;else if(l=Ys(t),s!==null&&s.dehydrated!==null){if(e===null){if(!l)throw Error(ce(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(ce(317));l[an]=t}else Tr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;vt(t),l=!1}else en!==null&&(Na(en),en=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||Je.current&1?ct===0&&(ct=3):fi())),t.updateQueue!==null&&(t.flags|=4),vt(t),null);case 4:return $r(),ma(e,t),e===null&&Ns(t.stateNode.containerInfo),vt(t),null;case 10:return Xa(t.type._context),vt(t),null;case 17:return Pt(t.type)&&So(),vt(t),null;case 19:if(We(Je),l=t.memoizedState,l===null)return vt(t),null;if(s=(t.flags&128)!==0,a=l.rendering,a===null)if(s)Kr(l,!1);else{if(ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Io(e),a!==null){for(t.flags|=128,Kr(l,!1),s=a.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)l=n,e=s,l.flags&=14680066,a=l.alternate,a===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,l.type=a.type,e=a.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ve(Je,Je.current&1|2),t.child}e=e.sibling}l.tail!==null&&ot()>Or&&(t.flags|=128,s=!0,Kr(l,!1),t.lanes=4194304)}else{if(!s)if(e=Io(a),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Kr(l,!0),l.tail===null&&l.tailMode==="hidden"&&!a.alternate&&!Qe)return vt(t),null}else 2*ot()-l.renderingStartTime>Or&&n!==1073741824&&(t.flags|=128,s=!0,Kr(l,!1),t.lanes=4194304);l.isBackwards?(a.sibling=t.child,t.child=a):(n=l.last,n!==null?n.sibling=a:t.child=a,l.last=a)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=ot(),t.sibling=null,n=Je.current,Ve(Je,s?n&1|2:n&1),t):(vt(t),null);case 22:case 23:return ui(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?At&1073741824&&(vt(t),t.subtreeFlags&6&&(t.flags|=8192)):vt(t),null;case 24:return null;case 25:return null}throw Error(ce(156,t.tag))}function Em(e,t){switch(Va(t),t.tag){case 1:return Pt(t.type)&&So(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return $r(),We(It),We(bt),ei(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Za(t),null;case 13:if(We(Je),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ce(340));Tr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return We(Je),null;case 4:return $r(),null;case 10:return Xa(t.type._context),null;case 22:case 23:return ui(),null;case 24:return null;default:return null}}var Ks=!1,wt=!1,Im=typeof WeakSet=="function"?WeakSet:Set,je=null;function br(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){nt(e,t,s)}else n.current=null}function ha(e,t,n){try{n()}catch(s){nt(e,t,s)}}var vc=!1;function Pm(e,t){if(Jl=wo,e=Pd(),Fa(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var o=s.anchorOffset,l=s.focusNode;s=s.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var a=0,i=-1,c=-1,g=0,y=0,h=e,p=null;t:for(;;){for(var b;h!==n||o!==0&&h.nodeType!==3||(i=a+o),h!==l||s!==0&&h.nodeType!==3||(c=a+s),h.nodeType===3&&(a+=h.nodeValue.length),(b=h.firstChild)!==null;)p=h,h=b;for(;;){if(h===e)break t;if(p===n&&++g===o&&(i=a),p===l&&++y===s&&(c=a),(b=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=b}n=i===-1||c===-1?null:{start:i,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zl={focusedElem:e,selectionRange:n},wo=!1,je=t;je!==null;)if(t=je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,je=e;else for(;je!==null;){t=je;try{var N=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var S=N.memoizedProps,A=N.memoizedState,d=t.stateNode,u=d.getSnapshotBeforeUpdate(t.elementType===t.type?S:Jt(t.type,S),A);d.__reactInternalSnapshotBeforeUpdate=u}break;case 3:var m=t.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(C){nt(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,je=e;break}je=t.return}return N=vc,vc=!1,N}function ds(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var l=o.destroy;o.destroy=void 0,l!==void 0&&ha(t,n,l)}o=o.next}while(o!==s)}}function Yo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function ga(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function _u(e){var t=e.alternate;t!==null&&(e.alternate=null,_u(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[an],delete t[Ss],delete t[na],delete t[mm],delete t[hm])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Mu(e){return e.tag===5||e.tag===3||e.tag===4}function wc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Mu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function xa(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=jo));else if(s!==4&&(e=e.child,e!==null))for(xa(e,t,n),e=e.sibling;e!==null;)xa(e,t,n),e=e.sibling}function ya(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(ya(e,t,n),e=e.sibling;e!==null;)ya(e,t,n),e=e.sibling}var mt=null,Zt=!1;function Sn(e,t,n){for(n=n.child;n!==null;)Eu(e,t,n),n=n.sibling}function Eu(e,t,n){if(cn&&typeof cn.onCommitFiberUnmount=="function")try{cn.onCommitFiberUnmount(Bo,n)}catch{}switch(n.tag){case 5:wt||br(n,t);case 6:var s=mt,o=Zt;mt=null,Sn(e,t,n),mt=s,Zt=o,mt!==null&&(Zt?(e=mt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):mt.removeChild(n.stateNode));break;case 18:mt!==null&&(Zt?(e=mt,n=n.stateNode,e.nodeType===8?bl(e.parentNode,n):e.nodeType===1&&bl(e,n),vs(e)):bl(mt,n.stateNode));break;case 4:s=mt,o=Zt,mt=n.stateNode.containerInfo,Zt=!0,Sn(e,t,n),mt=s,Zt=o;break;case 0:case 11:case 14:case 15:if(!wt&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var l=o,a=l.destroy;l=l.tag,a!==void 0&&(l&2||l&4)&&ha(n,t,a),o=o.next}while(o!==s)}Sn(e,t,n);break;case 1:if(!wt&&(br(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(i){nt(n,t,i)}Sn(e,t,n);break;case 21:Sn(e,t,n);break;case 22:n.mode&1?(wt=(s=wt)||n.memoizedState!==null,Sn(e,t,n),wt=s):Sn(e,t,n);break;default:Sn(e,t,n)}}function bc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Im),t.forEach(function(s){var o=zm.bind(null,e,s);n.has(s)||(n.add(s),s.then(o,o))})}}function Kt(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var o=n[s];try{var l=e,a=t,i=a;e:for(;i!==null;){switch(i.tag){case 5:mt=i.stateNode,Zt=!1;break e;case 3:mt=i.stateNode.containerInfo,Zt=!0;break e;case 4:mt=i.stateNode.containerInfo,Zt=!0;break e}i=i.return}if(mt===null)throw Error(ce(160));Eu(l,a,o),mt=null,Zt=!1;var c=o.alternate;c!==null&&(c.return=null),o.return=null}catch(g){nt(o,t,g)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Iu(t,e),t=t.sibling}function Iu(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Kt(t,e),sn(e),s&4){try{ds(3,e,e.return),Yo(3,e)}catch(S){nt(e,e.return,S)}try{ds(5,e,e.return)}catch(S){nt(e,e.return,S)}}break;case 1:Kt(t,e),sn(e),s&512&&n!==null&&br(n,n.return);break;case 5:if(Kt(t,e),sn(e),s&512&&n!==null&&br(n,n.return),e.flags&32){var o=e.stateNode;try{hs(o,"")}catch(S){nt(e,e.return,S)}}if(s&4&&(o=e.stateNode,o!=null)){var l=e.memoizedProps,a=n!==null?n.memoizedProps:l,i=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{i==="input"&&l.type==="radio"&&l.name!=null&&Zc(o,l),Gl(i,a);var g=Gl(i,l);for(a=0;a<c.length;a+=2){var y=c[a],h=c[a+1];y==="style"?sd(o,h):y==="dangerouslySetInnerHTML"?nd(o,h):y==="children"?hs(o,h):Ea(o,y,h,g)}switch(i){case"input":Ol(o,l);break;case"textarea":ed(o,l);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!l.multiple;var b=l.value;b!=null?Cr(o,!!l.multiple,b,!1):p!==!!l.multiple&&(l.defaultValue!=null?Cr(o,!!l.multiple,l.defaultValue,!0):Cr(o,!!l.multiple,l.multiple?[]:"",!1))}o[Ss]=l}catch(S){nt(e,e.return,S)}}break;case 6:if(Kt(t,e),sn(e),s&4){if(e.stateNode===null)throw Error(ce(162));o=e.stateNode,l=e.memoizedProps;try{o.nodeValue=l}catch(S){nt(e,e.return,S)}}break;case 3:if(Kt(t,e),sn(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{vs(t.containerInfo)}catch(S){nt(e,e.return,S)}break;case 4:Kt(t,e),sn(e);break;case 13:Kt(t,e),sn(e),o=e.child,o.flags&8192&&(l=o.memoizedState!==null,o.stateNode.isHidden=l,!l||o.alternate!==null&&o.alternate.memoizedState!==null||(ci=ot())),s&4&&bc(e);break;case 22:if(y=n!==null&&n.memoizedState!==null,e.mode&1?(wt=(g=wt)||y,Kt(t,e),wt=g):Kt(t,e),sn(e),s&8192){if(g=e.memoizedState!==null,(e.stateNode.isHidden=g)&&!y&&e.mode&1)for(je=e,y=e.child;y!==null;){for(h=je=y;je!==null;){switch(p=je,b=p.child,p.tag){case 0:case 11:case 14:case 15:ds(4,p,p.return);break;case 1:br(p,p.return);var N=p.stateNode;if(typeof N.componentWillUnmount=="function"){s=p,n=p.return;try{t=s,N.props=t.memoizedProps,N.state=t.memoizedState,N.componentWillUnmount()}catch(S){nt(s,n,S)}}break;case 5:br(p,p.return);break;case 22:if(p.memoizedState!==null){jc(h);continue}}b!==null?(b.return=p,je=b):jc(h)}y=y.sibling}e:for(y=null,h=e;;){if(h.tag===5){if(y===null){y=h;try{o=h.stateNode,g?(l=o.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(i=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,i.style.display=rd("display",a))}catch(S){nt(e,e.return,S)}}}else if(h.tag===6){if(y===null)try{h.stateNode.nodeValue=g?"":h.memoizedProps}catch(S){nt(e,e.return,S)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;y===h&&(y=null),h=h.return}y===h&&(y=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Kt(t,e),sn(e),s&4&&bc(e);break;case 21:break;default:Kt(t,e),sn(e)}}function sn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Mu(n)){var s=n;break e}n=n.return}throw Error(ce(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(hs(o,""),s.flags&=-33);var l=wc(e);ya(e,l,o);break;case 3:case 4:var a=s.stateNode.containerInfo,i=wc(e);xa(e,i,a);break;default:throw Error(ce(161))}}catch(c){nt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Tm(e,t,n){je=e,Pu(e)}function Pu(e,t,n){for(var s=(e.mode&1)!==0;je!==null;){var o=je,l=o.child;if(o.tag===22&&s){var a=o.memoizedState!==null||Ks;if(!a){var i=o.alternate,c=i!==null&&i.memoizedState!==null||wt;i=Ks;var g=wt;if(Ks=a,(wt=c)&&!g)for(je=o;je!==null;)a=je,c=a.child,a.tag===22&&a.memoizedState!==null?Sc(o):c!==null?(c.return=a,je=c):Sc(o);for(;l!==null;)je=l,Pu(l),l=l.sibling;je=o,Ks=i,wt=g}Nc(e)}else o.subtreeFlags&8772&&l!==null?(l.return=o,je=l):Nc(e)}}function Nc(e){for(;je!==null;){var t=je;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:wt||Yo(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!wt)if(n===null)s.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Jt(t.type,n.memoizedProps);s.componentDidUpdate(o,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&lc(t,l,s);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}lc(t,a,n)}break;case 5:var i=t.stateNode;if(n===null&&t.flags&4){n=i;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var g=t.alternate;if(g!==null){var y=g.memoizedState;if(y!==null){var h=y.dehydrated;h!==null&&vs(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}wt||t.flags&512&&ga(t)}catch(p){nt(t,t.return,p)}}if(t===e){je=null;break}if(n=t.sibling,n!==null){n.return=t.return,je=n;break}je=t.return}}function jc(e){for(;je!==null;){var t=je;if(t===e){je=null;break}var n=t.sibling;if(n!==null){n.return=t.return,je=n;break}je=t.return}}function Sc(e){for(;je!==null;){var t=je;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Yo(4,t)}catch(c){nt(t,n,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var o=t.return;try{s.componentDidMount()}catch(c){nt(t,o,c)}}var l=t.return;try{ga(t)}catch(c){nt(t,l,c)}break;case 5:var a=t.return;try{ga(t)}catch(c){nt(t,a,c)}}}catch(c){nt(t,t.return,c)}if(t===e){je=null;break}var i=t.sibling;if(i!==null){i.return=t.return,je=i;break}je=t.return}}var Rm=Math.ceil,Ro=bn.ReactCurrentDispatcher,ai=bn.ReactCurrentOwner,qt=bn.ReactCurrentBatchConfig,Be=0,ft=null,at=null,ht=0,At=0,Nr=Fn(0),ct=0,Es=null,rr=0,Xo=0,ii=0,us=null,Dt=null,ci=0,Or=1/0,fn=null,$o=!1,va=null,On=null,Js=!1,En=null,Ao=0,fs=0,wa=null,uo=-1,fo=0;function jt(){return Be&6?ot():uo!==-1?uo:uo=ot()}function Un(e){return e.mode&1?Be&2&&ht!==0?ht&-ht:xm.transition!==null?(fo===0&&(fo=gd()),fo):(e=Fe,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function nn(e,t,n,s){if(50<fs)throw fs=0,wa=null,Error(ce(185));Ps(e,n,s),(!(Be&2)||e!==ft)&&(e===ft&&(!(Be&2)&&(Xo|=n),ct===4&&_n(e,ht)),Tt(e,s),n===1&&Be===0&&!(t.mode&1)&&(Or=ot()+500,Vo&&Hn()))}function Tt(e,t){var n=e.callbackNode;xp(e,t);var s=vo(e,e===ft?ht:0);if(s===0)n!==null&&Ti(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&Ti(n),t===1)e.tag===0?gm(Cc.bind(null,e)):Gd(Cc.bind(null,e)),fm(function(){!(Be&6)&&Hn()}),n=null;else{switch(xd(s)){case 1:n=$a;break;case 4:n=md;break;case 16:n=yo;break;case 536870912:n=hd;break;default:n=yo}n=Bu(n,Tu.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Tu(e,t){if(uo=-1,fo=0,Be&6)throw Error(ce(327));var n=e.callbackNode;if(Er()&&e.callbackNode!==n)return null;var s=vo(e,e===ft?ht:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Oo(e,s);else{t=s;var o=Be;Be|=2;var l=$u();(ft!==e||ht!==t)&&(fn=null,Or=ot()+500,Jn(e,t));do try{Om();break}catch(i){Ru(e,i)}while(!0);Ya(),Ro.current=l,Be=o,at!==null?t=0:(ft=null,ht=0,t=ct)}if(t!==0){if(t===2&&(o=Wl(e),o!==0&&(s=o,t=ba(e,o))),t===1)throw n=Es,Jn(e,0),_n(e,s),Tt(e,ot()),n;if(t===6)_n(e,s);else{if(o=e.current.alternate,!(s&30)&&!$m(o)&&(t=Oo(e,s),t===2&&(l=Wl(e),l!==0&&(s=l,t=ba(e,l))),t===1))throw n=Es,Jn(e,0),_n(e,s),Tt(e,ot()),n;switch(e.finishedWork=o,e.finishedLanes=s,t){case 0:case 1:throw Error(ce(345));case 2:Yn(e,Dt,fn);break;case 3:if(_n(e,s),(s&130023424)===s&&(t=ci+500-ot(),10<t)){if(vo(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){jt(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ta(Yn.bind(null,e,Dt,fn),t);break}Yn(e,Dt,fn);break;case 4:if(_n(e,s),(s&4194240)===s)break;for(t=e.eventTimes,o=-1;0<s;){var a=31-tn(s);l=1<<a,a=t[a],a>o&&(o=a),s&=~l}if(s=o,s=ot()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Rm(s/1960))-s,10<s){e.timeoutHandle=ta(Yn.bind(null,e,Dt,fn),s);break}Yn(e,Dt,fn);break;case 5:Yn(e,Dt,fn);break;default:throw Error(ce(329))}}}return Tt(e,ot()),e.callbackNode===n?Tu.bind(null,e):null}function ba(e,t){var n=us;return e.current.memoizedState.isDehydrated&&(Jn(e,t).flags|=256),e=Oo(e,t),e!==2&&(t=Dt,Dt=n,t!==null&&Na(t)),e}function Na(e){Dt===null?Dt=e:Dt.push.apply(Dt,e)}function $m(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var o=n[s],l=o.getSnapshot;o=o.value;try{if(!rn(l(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function _n(e,t){for(t&=~ii,t&=~Xo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-tn(t),s=1<<n;e[n]=-1,t&=~s}}function Cc(e){if(Be&6)throw Error(ce(327));Er();var t=vo(e,0);if(!(t&1))return Tt(e,ot()),null;var n=Oo(e,t);if(e.tag!==0&&n===2){var s=Wl(e);s!==0&&(t=s,n=ba(e,s))}if(n===1)throw n=Es,Jn(e,0),_n(e,t),Tt(e,ot()),n;if(n===6)throw Error(ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Yn(e,Dt,fn),Tt(e,ot()),null}function di(e,t){var n=Be;Be|=1;try{return e(t)}finally{Be=n,Be===0&&(Or=ot()+500,Vo&&Hn())}}function sr(e){En!==null&&En.tag===0&&!(Be&6)&&Er();var t=Be;Be|=1;var n=qt.transition,s=Fe;try{if(qt.transition=null,Fe=1,e)return e()}finally{Fe=s,qt.transition=n,Be=t,!(Be&6)&&Hn()}}function ui(){At=Nr.current,We(Nr)}function Jn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,um(n)),at!==null)for(n=at.return;n!==null;){var s=n;switch(Va(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&So();break;case 3:$r(),We(It),We(bt),ei();break;case 5:Za(s);break;case 4:$r();break;case 13:We(Je);break;case 19:We(Je);break;case 10:Xa(s.type._context);break;case 22:case 23:ui()}n=n.return}if(ft=e,at=e=Ln(e.current,null),ht=At=t,ct=0,Es=null,ii=Xo=rr=0,Dt=us=null,Qn!==null){for(t=0;t<Qn.length;t++)if(n=Qn[t],s=n.interleaved,s!==null){n.interleaved=null;var o=s.next,l=n.pending;if(l!==null){var a=l.next;l.next=o,s.next=a}n.pending=s}Qn=null}return e}function Ru(e,t){do{var n=at;try{if(Ya(),ao.current=To,Po){for(var s=Ze.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Po=!1}if(nr=0,ut=it=Ze=null,cs=!1,Ds=0,ai.current=null,n===null||n.return===null){ct=1,Es=t,at=null;break}e:{var l=e,a=n.return,i=n,c=t;if(t=ht,i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var g=c,y=i,h=y.tag;if(!(y.mode&1)&&(h===0||h===11||h===15)){var p=y.alternate;p?(y.updateQueue=p.updateQueue,y.memoizedState=p.memoizedState,y.lanes=p.lanes):(y.updateQueue=null,y.memoizedState=null)}var b=fc(a);if(b!==null){b.flags&=-257,pc(b,a,i,l,t),b.mode&1&&uc(l,g,t),t=b,c=g;var N=t.updateQueue;if(N===null){var S=new Set;S.add(c),t.updateQueue=S}else N.add(c);break e}else{if(!(t&1)){uc(l,g,t),fi();break e}c=Error(ce(426))}}else if(Qe&&i.mode&1){var A=fc(a);if(A!==null){!(A.flags&65536)&&(A.flags|=256),pc(A,a,i,l,t),qa(Ar(c,i));break e}}l=c=Ar(c,i),ct!==4&&(ct=2),us===null?us=[l]:us.push(l),l=a;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var d=xu(l,c,t);oc(l,d);break e;case 1:i=c;var u=l.type,m=l.stateNode;if(!(l.flags&128)&&(typeof u.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(On===null||!On.has(m)))){l.flags|=65536,t&=-t,l.lanes|=t;var C=yu(l,i,t);oc(l,C);break e}}l=l.return}while(l!==null)}Ou(n)}catch(P){t=P,at===n&&n!==null&&(at=n=n.return);continue}break}while(!0)}function $u(){var e=Ro.current;return Ro.current=To,e===null?To:e}function fi(){(ct===0||ct===3||ct===2)&&(ct=4),ft===null||!(rr&268435455)&&!(Xo&268435455)||_n(ft,ht)}function Oo(e,t){var n=Be;Be|=2;var s=$u();(ft!==e||ht!==t)&&(fn=null,Jn(e,t));do try{Am();break}catch(o){Ru(e,o)}while(!0);if(Ya(),Be=n,Ro.current=s,at!==null)throw Error(ce(261));return ft=null,ht=0,ct}function Am(){for(;at!==null;)Au(at)}function Om(){for(;at!==null&&!ip();)Au(at)}function Au(e){var t=Lu(e.alternate,e,At);e.memoizedProps=e.pendingProps,t===null?Ou(e):at=t,ai.current=null}function Ou(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Em(n,t),n!==null){n.flags&=32767,at=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ct=6,at=null;return}}else if(n=Mm(n,t,At),n!==null){at=n;return}if(t=t.sibling,t!==null){at=t;return}at=t=e}while(t!==null);ct===0&&(ct=5)}function Yn(e,t,n){var s=Fe,o=qt.transition;try{qt.transition=null,Fe=1,Um(e,t,n,s)}finally{qt.transition=o,Fe=s}return null}function Um(e,t,n,s){do Er();while(En!==null);if(Be&6)throw Error(ce(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ce(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(yp(e,l),e===ft&&(at=ft=null,ht=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Js||(Js=!0,Bu(yo,function(){return Er(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=qt.transition,qt.transition=null;var a=Fe;Fe=1;var i=Be;Be|=4,ai.current=null,Pm(e,n),Iu(n,e),sm(Zl),wo=!!Jl,Zl=Jl=null,e.current=n,Tm(n),cp(),Be=i,Fe=a,qt.transition=l}else e.current=n;if(Js&&(Js=!1,En=e,Ao=o),l=e.pendingLanes,l===0&&(On=null),fp(n.stateNode),Tt(e,ot()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],s(o.value,{componentStack:o.stack,digest:o.digest});if($o)throw $o=!1,e=va,va=null,e;return Ao&1&&e.tag!==0&&Er(),l=e.pendingLanes,l&1?e===wa?fs++:(fs=0,wa=e):fs=0,Hn(),null}function Er(){if(En!==null){var e=xd(Ao),t=qt.transition,n=Fe;try{if(qt.transition=null,Fe=16>e?16:e,En===null)var s=!1;else{if(e=En,En=null,Ao=0,Be&6)throw Error(ce(331));var o=Be;for(Be|=4,je=e.current;je!==null;){var l=je,a=l.child;if(je.flags&16){var i=l.deletions;if(i!==null){for(var c=0;c<i.length;c++){var g=i[c];for(je=g;je!==null;){var y=je;switch(y.tag){case 0:case 11:case 15:ds(8,y,l)}var h=y.child;if(h!==null)h.return=y,je=h;else for(;je!==null;){y=je;var p=y.sibling,b=y.return;if(_u(y),y===g){je=null;break}if(p!==null){p.return=b,je=p;break}je=b}}}var N=l.alternate;if(N!==null){var S=N.child;if(S!==null){N.child=null;do{var A=S.sibling;S.sibling=null,S=A}while(S!==null)}}je=l}}if(l.subtreeFlags&2064&&a!==null)a.return=l,je=a;else e:for(;je!==null;){if(l=je,l.flags&2048)switch(l.tag){case 0:case 11:case 15:ds(9,l,l.return)}var d=l.sibling;if(d!==null){d.return=l.return,je=d;break e}je=l.return}}var u=e.current;for(je=u;je!==null;){a=je;var m=a.child;if(a.subtreeFlags&2064&&m!==null)m.return=a,je=m;else e:for(a=u;je!==null;){if(i=je,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:Yo(9,i)}}catch(P){nt(i,i.return,P)}if(i===a){je=null;break e}var C=i.sibling;if(C!==null){C.return=i.return,je=C;break e}je=i.return}}if(Be=o,Hn(),cn&&typeof cn.onPostCommitFiberRoot=="function")try{cn.onPostCommitFiberRoot(Bo,e)}catch{}s=!0}return s}finally{Fe=n,qt.transition=t}}return!1}function kc(e,t,n){t=Ar(n,t),t=xu(e,t,1),e=An(e,t,1),t=jt(),e!==null&&(Ps(e,1,t),Tt(e,t))}function nt(e,t,n){if(e.tag===3)kc(e,e,n);else for(;t!==null;){if(t.tag===3){kc(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(On===null||!On.has(s))){e=Ar(n,e),e=yu(t,e,1),t=An(t,e,1),e=jt(),t!==null&&(Ps(t,1,e),Tt(t,e));break}}t=t.return}}function Lm(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=jt(),e.pingedLanes|=e.suspendedLanes&n,ft===e&&(ht&n)===n&&(ct===4||ct===3&&(ht&130023424)===ht&&500>ot()-ci?Jn(e,0):ii|=n),Tt(e,t)}function Uu(e,t){t===0&&(e.mode&1?(t=Gs,Gs<<=1,!(Gs&130023424)&&(Gs=4194304)):t=1);var n=jt();e=vn(e,t),e!==null&&(Ps(e,t,n),Tt(e,n))}function Bm(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Uu(e,n)}function zm(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(ce(314))}s!==null&&s.delete(t),Uu(e,n)}var Lu;Lu=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||It.current)_t=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return _t=!1,_m(e,t,n);_t=!!(e.flags&131072)}else _t=!1,Qe&&t.flags&1048576&&Fd(t,Do,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;co(e,t),e=t.pendingProps;var o=Pr(t,bt.current);Mr(t,n),o=ni(null,t,s,e,o,n);var l=ri();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pt(s)?(l=!0,Co(t)):l=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Ka(t),o.updater=Wo,t.stateNode=o,o._reactInternals=t,ia(t,s,e,n),t=ua(null,t,s,!0,l,n)):(t.tag=0,Qe&&l&&Ha(t),Nt(null,t,o,n),t=t.child),t;case 16:s=t.elementType;e:{switch(co(e,t),e=t.pendingProps,o=s._init,s=o(s._payload),t.type=s,o=t.tag=Fm(s),e=Jt(s,e),o){case 0:t=da(null,t,s,e,n);break e;case 1:t=gc(null,t,s,e,n);break e;case 11:t=mc(null,t,s,e,n);break e;case 14:t=hc(null,t,s,Jt(s.type,e),n);break e}throw Error(ce(306,s,""))}return t;case 0:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Jt(s,o),da(e,t,s,o,n);case 1:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Jt(s,o),gc(e,t,s,o,n);case 3:e:{if(Nu(t),e===null)throw Error(ce(387));s=t.pendingProps,l=t.memoizedState,o=l.element,Xd(e,t),Eo(t,s,null,n);var a=t.memoizedState;if(s=a.element,l.isDehydrated)if(l={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){o=Ar(Error(ce(423)),t),t=xc(e,t,s,n,o);break e}else if(s!==o){o=Ar(Error(ce(424)),t),t=xc(e,t,s,n,o);break e}else for(Ot=$n(t.stateNode.containerInfo.firstChild),Ut=t,Qe=!0,en=null,n=Wd(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Tr(),s===o){t=wn(e,t,n);break e}Nt(e,t,s,n)}t=t.child}return t;case 5:return Qd(t),e===null&&oa(t),s=t.type,o=t.pendingProps,l=e!==null?e.memoizedProps:null,a=o.children,ea(s,o)?a=null:l!==null&&ea(s,l)&&(t.flags|=32),bu(e,t),Nt(e,t,a,n),t.child;case 6:return e===null&&oa(t),null;case 13:return ju(e,t,n);case 4:return Ja(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Rr(t,null,s,n):Nt(e,t,s,n),t.child;case 11:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Jt(s,o),mc(e,t,s,o,n);case 7:return Nt(e,t,t.pendingProps,n),t.child;case 8:return Nt(e,t,t.pendingProps.children,n),t.child;case 12:return Nt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,o=t.pendingProps,l=t.memoizedProps,a=o.value,Ve(_o,s._currentValue),s._currentValue=a,l!==null)if(rn(l.value,a)){if(l.children===o.children&&!It.current){t=wn(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var i=l.dependencies;if(i!==null){a=l.child;for(var c=i.firstContext;c!==null;){if(c.context===s){if(l.tag===1){c=gn(-1,n&-n),c.tag=2;var g=l.updateQueue;if(g!==null){g=g.shared;var y=g.pending;y===null?c.next=c:(c.next=y.next,y.next=c),g.pending=c}}l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),la(l.return,n,t),i.lanes|=n;break}c=c.next}}else if(l.tag===10)a=l.type===t.type?null:l.child;else if(l.tag===18){if(a=l.return,a===null)throw Error(ce(341));a.lanes|=n,i=a.alternate,i!==null&&(i.lanes|=n),la(a,n,t),a=l.sibling}else a=l.child;if(a!==null)a.return=l;else for(a=l;a!==null;){if(a===t){a=null;break}if(l=a.sibling,l!==null){l.return=a.return,a=l;break}a=a.return}l=a}Nt(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,s=t.pendingProps.children,Mr(t,n),o=Wt(o),s=s(o),t.flags|=1,Nt(e,t,s,n),t.child;case 14:return s=t.type,o=Jt(s,t.pendingProps),o=Jt(s.type,o),hc(e,t,s,o,n);case 15:return vu(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Jt(s,o),co(e,t),t.tag=1,Pt(s)?(e=!0,Co(t)):e=!1,Mr(t,n),gu(t,s,o),ia(t,s,o,n),ua(null,t,s,!0,e,n);case 19:return Su(e,t,n);case 22:return wu(e,t,n)}throw Error(ce(156,t.tag))};function Bu(e,t){return pd(e,t)}function Gm(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vt(e,t,n,s){return new Gm(e,t,n,s)}function pi(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Fm(e){if(typeof e=="function")return pi(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Pa)return 11;if(e===Ta)return 14}return 2}function Ln(e,t){var n=e.alternate;return n===null?(n=Vt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function po(e,t,n,s,o,l){var a=2;if(s=e,typeof e=="function")pi(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case fr:return Zn(n.children,o,l,t);case Ia:a=8,o|=8;break;case Pl:return e=Vt(12,n,t,o|2),e.elementType=Pl,e.lanes=l,e;case Tl:return e=Vt(13,n,t,o),e.elementType=Tl,e.lanes=l,e;case Rl:return e=Vt(19,n,t,o),e.elementType=Rl,e.lanes=l,e;case Qc:return Qo(n,o,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Yc:a=10;break e;case Xc:a=9;break e;case Pa:a=11;break e;case Ta:a=14;break e;case Cn:a=16,s=null;break e}throw Error(ce(130,e==null?e:typeof e,""))}return t=Vt(a,n,t,o),t.elementType=e,t.type=s,t.lanes=l,t}function Zn(e,t,n,s){return e=Vt(7,e,s,t),e.lanes=n,e}function Qo(e,t,n,s){return e=Vt(22,e,s,t),e.elementType=Qc,e.lanes=n,e.stateNode={isHidden:!1},e}function Ml(e,t,n){return e=Vt(6,e,null,t),e.lanes=n,e}function El(e,t,n){return t=Vt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Hm(e,t,n,s,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dl(0),this.expirationTimes=dl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dl(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function mi(e,t,n,s,o,l,a,i,c){return e=new Hm(e,t,n,i,c),t===1?(t=1,l===!0&&(t|=8)):t=0,l=Vt(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ka(l),e}function Vm(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ur,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function zu(e){if(!e)return zn;e=e._reactInternals;e:{if(lr(e)!==e||e.tag!==1)throw Error(ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ce(171))}if(e.tag===1){var n=e.type;if(Pt(n))return zd(e,n,t)}return t}function Gu(e,t,n,s,o,l,a,i,c){return e=mi(n,s,!0,e,o,l,a,i,c),e.context=zu(null),n=e.current,s=jt(),o=Un(n),l=gn(s,o),l.callback=t??null,An(n,l,o),e.current.lanes=o,Ps(e,o,s),Tt(e,s),e}function Ko(e,t,n,s){var o=t.current,l=jt(),a=Un(o);return n=zu(n),t.context===null?t.context=n:t.pendingContext=n,t=gn(l,a),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=An(o,t,a),e!==null&&(nn(e,o,a,l),lo(e,o,a)),a}function Uo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Dc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function hi(e,t){Dc(e,t),(e=e.alternate)&&Dc(e,t)}function qm(){return null}var Fu=typeof reportError=="function"?reportError:function(e){console.error(e)};function gi(e){this._internalRoot=e}Jo.prototype.render=gi.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ce(409));Ko(e,t,null,null)};Jo.prototype.unmount=gi.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;sr(function(){Ko(null,e,null,null)}),t[yn]=null}};function Jo(e){this._internalRoot=e}Jo.prototype.unstable_scheduleHydration=function(e){if(e){var t=wd();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dn.length&&t!==0&&t<Dn[n].priority;n++);Dn.splice(n,0,e),n===0&&Nd(e)}};function xi(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Zo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function _c(){}function Wm(e,t,n,s,o){if(o){if(typeof s=="function"){var l=s;s=function(){var g=Uo(a);l.call(g)}}var a=Gu(t,s,e,0,null,!1,!1,"",_c);return e._reactRootContainer=a,e[yn]=a.current,Ns(e.nodeType===8?e.parentNode:e),sr(),a}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var i=s;s=function(){var g=Uo(c);i.call(g)}}var c=mi(e,0,!1,null,null,!1,!1,"",_c);return e._reactRootContainer=c,e[yn]=c.current,Ns(e.nodeType===8?e.parentNode:e),sr(function(){Ko(t,c,n,s)}),c}function el(e,t,n,s,o){var l=n._reactRootContainer;if(l){var a=l;if(typeof o=="function"){var i=o;o=function(){var c=Uo(a);i.call(c)}}Ko(t,a,e,o)}else a=Wm(n,t,e,o,s);return Uo(a)}yd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ns(t.pendingLanes);n!==0&&(Aa(t,n|1),Tt(t,ot()),!(Be&6)&&(Or=ot()+500,Hn()))}break;case 13:sr(function(){var s=vn(e,1);if(s!==null){var o=jt();nn(s,e,1,o)}}),hi(e,1)}};Oa=function(e){if(e.tag===13){var t=vn(e,134217728);if(t!==null){var n=jt();nn(t,e,134217728,n)}hi(e,134217728)}};vd=function(e){if(e.tag===13){var t=Un(e),n=vn(e,t);if(n!==null){var s=jt();nn(n,e,t,s)}hi(e,t)}};wd=function(){return Fe};bd=function(e,t){var n=Fe;try{return Fe=e,t()}finally{Fe=n}};Hl=function(e,t,n){switch(t){case"input":if(Ol(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var o=Ho(s);if(!o)throw Error(ce(90));Jc(s),Ol(s,o)}}}break;case"textarea":ed(e,n);break;case"select":t=n.value,t!=null&&Cr(e,!!n.multiple,t,!1)}};ad=di;id=sr;var Ym={usingClientEntryPoint:!1,Events:[Rs,gr,Ho,od,ld,di]},Jr={findFiberByHostInstance:Xn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Xm={bundleType:Jr.bundleType,version:Jr.version,rendererPackageName:Jr.rendererPackageName,rendererConfig:Jr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ud(e),e===null?null:e.stateNode},findFiberByHostInstance:Jr.findFiberByHostInstance||qm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zs.isDisabled&&Zs.supportsFiber)try{Bo=Zs.inject(Xm),cn=Zs}catch{}}Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ym;Bt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xi(t))throw Error(ce(200));return Vm(e,t,null,n)};Bt.createRoot=function(e,t){if(!xi(e))throw Error(ce(299));var n=!1,s="",o=Fu;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=mi(e,1,!1,null,null,n,!1,s,o),e[yn]=t.current,Ns(e.nodeType===8?e.parentNode:e),new gi(t)};Bt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ce(188)):(e=Object.keys(e).join(","),Error(ce(268,e)));return e=ud(t),e=e===null?null:e.stateNode,e};Bt.flushSync=function(e){return sr(e)};Bt.hydrate=function(e,t,n){if(!Zo(t))throw Error(ce(200));return el(null,e,t,!0,n)};Bt.hydrateRoot=function(e,t,n){if(!xi(e))throw Error(ce(405));var s=n!=null&&n.hydratedSources||null,o=!1,l="",a=Fu;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Gu(t,null,e,1,n??null,o,!1,l,a),e[yn]=t.current,Ns(e),s)for(e=0;e<s.length;e++)n=s[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Jo(t)};Bt.render=function(e,t,n){if(!Zo(t))throw Error(ce(200));return el(null,e,t,!1,n)};Bt.unmountComponentAtNode=function(e){if(!Zo(e))throw Error(ce(40));return e._reactRootContainer?(sr(function(){el(null,null,e,!1,function(){e._reactRootContainer=null,e[yn]=null})}),!0):!1};Bt.unstable_batchedUpdates=di;Bt.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!Zo(n))throw Error(ce(200));if(e==null||e._reactInternals===void 0)throw Error(ce(38));return el(e,t,n,!1,s)};Bt.version="18.3.1-next-f1338f8080-20240426";function Hu(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Hu)}catch(e){console.error(e)}}Hu(),Hc.exports=Bt;var Qm=Hc.exports,Vu,Mc=Qm;Vu=Mc.createRoot,Mc.hydrateRoot;class Km{constructor(){this.config=null,this.isConfigLoaded=!1}async loadConfig(){var t;if(this.config&&this.isConfigLoaded)return this.config;try{const n=await fetch("../config.txt");if(!n.ok)throw new Error(`Failed to load config: ${n.status}`);const s=await n.text();if(this.config=JSON.parse(s),this.isConfigLoaded=!0,!((t=this.config)!=null&&t.domain))throw new Error("Invalid config: missing domain");return this.config}catch(n){throw console.error("Failed to load API config:",n),new Error("API configuration not available")}}async request(t,n={}){const o=`${(await this.loadConfig()).domain}${t}`,l={method:"POST",headers:{"Content-Type":"application/json",...n.headers},...n},a=new Date().toISOString();if(console.log(""),console.log(` API Request [${a}]`),console.log(" Endpoint:",t),console.log(" Full URL:",o),console.log(" Method:",l.method),console.log(" Headers:",l.headers),l.body){console.log(" Request Body:",l.body);try{const i=JSON.parse(l.body);console.log(" Parsed Body:",i)}catch{console.log(" Body (raw):",l.body)}}console.log("");try{const i=await fetch(o,l);if(console.log(""),console.log(` API Response [${new Date().toISOString()}]`),console.log(" Endpoint:",t),console.log(" Status:",i.status,i.statusText),console.log(" Response Headers:",Object.fromEntries(i.headers.entries())),!i.ok)throw console.log(" HTTP Error:",i.status),console.log(""),new Error(`HTTP error! status: ${i.status}`);const c=await i.json();return console.log(" Response Data:",c),console.log(""),c}catch(i){throw console.log(""),console.log(" API Request Failed"),console.log(" Endpoint:",t),console.log(" Error:",i),console.log(""),i}}async login(t){const n={Data:{ID:t.ID.trim(),Password:t.Password}};return this.request("/api/session/login",{method:"POST",body:JSON.stringify(n)})}async getDepartments(t={}){return this.request("/api/ServerSetting/get_name",{method:"POST",body:JSON.stringify(t)})}async getMedicineCloud(t={}){return this.request("/api/MED_page/get_med_cloud",{method:"POST",body:JSON.stringify({})})}async searchMedicine(t="",n="N"){try{const s=await this.getMedicineCloud();if(s.Code!==200||!s.Data)return console.error("API returned error:",s),[];let o=s.Data;if(o=o.filter(l=>l.DRUGKIND===n),o=o.filter(l=>l.FILE_STATUS!==""),t.trim()){const l=t.toLowerCase();o=o.filter(a=>a.CODE&&a.CODE.toLowerCase().includes(l)||a.CHT_NAME&&a.CHT_NAME.toLowerCase().includes(l)||a.NAME&&a.NAME.toLowerCase().includes(l))}return o}catch(s){return console.error("Medicine search failed:",s),[]}}async getMedMapByDepartment(t){const n={Data:{},ValueAry:[t]};return this.request("/api/medMap/get_medMap_by_department",{method:"POST",body:JSON.stringify(n)})}async updateContainerPosition(t){const n={Data:[t]};return this.request("/api/medMap/update_medMap_section",{method:"POST",body:JSON.stringify(n)})}async addMedMapBox(t){const n={Data:t};return this.request("/api/medMap/add_medMap_box",{method:"POST",body:JSON.stringify(n)})}async updateMedMapBox(t){const n={Data:t};return this.request("/api/medMap/update_medMap_box",{method:"POST",body:JSON.stringify(n)})}async updateEpd266Storages(t,n,s){const o={ServerName:t,ServerType:n,Data:s};return this.request("/api/device/update_epd266_storages",{method:"POST",body:JSON.stringify(o)})}async updateMedMapDrawer(t){const n={Data:t};return this.request("/api/medMap/update_medMap_drawer",{method:"POST",body:JSON.stringify(n)})}async updateMedMapShelf(t){const n={Data:t};return this.request("/api/medMap/update_medMap_shelf",{method:"POST",body:JSON.stringify(n)})}async addMedMapSection(t,n,s,o){const l={ValueAry:[t,n],ServerName:s,ServerType:o};return this.request("/api/medMap/add_medMap_section",{method:"POST",body:JSON.stringify(l)})}async addMedMapShelf(t){const n={Data:t};return this.request("/api/medMap/add_medMap_shelf",{method:"POST",body:JSON.stringify(n)})}async addMedMapDrawer(t){const n={Data:t};return this.request("/api/medMap/add_medMap_drawer",{method:"POST",body:JSON.stringify(n)})}async addSubSection(t,n){const s={ValueAry:[t,n]};return this.request("/api/medMap/add_sub_section",{method:"POST",body:JSON.stringify(s)})}async updateSubSection(t){const n={Data:t};return this.request("/api/medMap/update_sub_section",{method:"POST",body:JSON.stringify(n)})}async updateMedMapSection(t){const n={Data:t};return this.request("/api/medMap/update_medMap_section",{method:"POST",body:JSON.stringify(n)})}async updateEpd266Medcode(t,n,s,o){const l={ServerName:t,ServerType:n,ValueAry:[`code=${s}`],Data:o};return this.request("/api/device/update_epd266_medcode",{method:"POST",body:JSON.stringify(l)})}async getConfig(){return this.loadConfig()}async checkConnection(){try{return await this.loadConfig(),!0}catch(t){return console.error("API connection check failed:",t),!1}}async addStock(t){const n={Data:t};return console.log(n),this.request("/api/medMap/add_stock",{method:"POST",body:JSON.stringify(n)})}async updateStock(t){const n={Data:t};return this.request("/api/medMap/update_stock",{method:"POST",body:JSON.stringify(n)})}async deleteStockByGUID(t){const n={ValueAry:t};return this.request("/api/medMap/delete_stock_by_GUID",{method:"POST",body:JSON.stringify(n)})}async addMedMap(t,n,s){const o={ValueAry:[t,n,s,"0,0"]};return this.request("/api/medMap/add_medMap",{method:"POST",body:JSON.stringify(o)})}async scanBarcode(t){const o=`${(await this.loadConfig()).ai||"https://www.kutech.tw:3000"}/barcode`,l=new FormData;l.append("file",t),console.log(""),console.log(` AI Barcode Scan Request [${new Date().toISOString()}]`),console.log(" URL:",o),console.log(" Image File:",t.name,t.size,"bytes"),console.log("");try{const a=await fetch(o,{method:"POST",body:l}),i=await a.json();return console.log(""),console.log(` AI Barcode Scan Response [${new Date().toISOString()}]`),console.log(" Status:",a.status),console.log(" Response Data:",i),console.log(""),i}catch(a){return console.error(" AI Barcode Scan Error:",a),{results:[]}}}async searchByBarCode(t){const n={Value:t};return this.request("/api/MED_page/serch_by_BarCode",{method:"POST",body:JSON.stringify(n)})}async lightByCodeNameType(t,n,s,o,l){const a={Method:"light_by_code_name_type",ValueAry:[`ServerName=${t}`,`ServerType=${n}`,`code=${s}`,`color=${o}`,`lightness=${l}`],Data:{}};return this.request("/api/medMap/light_by_code_name_type",{method:"POST",body:JSON.stringify(a)})}async addMedClouds(t,n,s,o){let l=o;l.push(t);const a={Data:[{BARCODE:l,CODE:n,BARCODE2:s||JSON.stringify([t])}]};return this.request("/api/MED_page/add_med_clouds",{method:"POST",body:JSON.stringify(a)})}async stockDeleteValidityPeriod(t,n){const s={ValueAry:[t,n]};return this.request("/api/medMap/stock_delete_Validity_period",{method:"POST",body:JSON.stringify(s)})}resetConfig(){this.config=null,this.isConfigLoaded=!1}async getRequisitionByTime(t,n){const s={ValueAry:[t,n]};return this.request("/api/materialRequisition/get_by_requestTime",{method:"POST",body:JSON.stringify(s)})}async getDistributionByTime(t,n){const s={ValueAry:[t,n]};return this.request("/api/drugStotreDistribution/get_by_addedTime",{method:"POST",body:JSON.stringify(s)})}async updateRequisitionNotice(t,n){const s={Data:{GUID:t,notice:n}};return this.request("/api/materialRequisition/update_notice",{method:"POST",body:JSON.stringify(s)})}async updateDistributionNotice(t,n){const s={ValueAry:[t,n]};return console.log(s),this.request("/api/drugStotreDistribution/update_notice",{method:"POST",body:JSON.stringify(s)})}async updateRequisitionActualQuantity(t,n){const s={Data:{GUID:t,actualQuantity:n}};return this.request("/api/materialRequisition/update_actual_quantity",{method:"POST",body:JSON.stringify(s)})}async updateRequisitionByGuid(t){const n={Data:[t]};return this.request("/api/materialRequisition/update_by_guid",{method:"POST",body:JSON.stringify(n)})}async updateDistributionActualQuantity(t,n){const s={ValueAry:[t,n]};return this.request("/api/drugStotreDistribution/update_actqty_by_guid",{method:"POST",body:JSON.stringify(s)})}async updateDistributionByGuid(t){const n={Data:[t]};return this.request("/api/drugStotreDistribution/update_by_guid",{method:"POST",body:JSON.stringify(n)})}async getAllStaffInfo(){return this.request("/api/person_page/get_all",{method:"POST",body:JSON.stringify({})})}async deleteParentContainer(t){const n={Data:[{GUID:t}]};return this.request("/api/medMap/delete_section",{method:"POST",body:JSON.stringify(n)})}async deleteSubContainer(t){const n={Data:[{GUID:t}]};return this.request("/api/medMap/delete_sub_section",{method:"POST",body:JSON.stringify(n)})}async deleteShelfContainer(t){const n={Data:[{GUID:t}]};return this.request("/api/medMap/delete_shelf",{method:"POST",body:JSON.stringify(n)})}}const ke=new Km;class Jm{convertMedMapApiToFakeData(t){console.log("  MedMap API "),console.log("  API :",t);try{Array.isArray(t)||(console.warn(" API "),t=[t]);const s=t.map((o,l)=>this.convertSingleDepartment(o,l)).filter(o=>{if(Object.keys(o).length!==0)return o});return console.log(" MedMap :",s),s}catch(n){return console.error(" MedMap :",n),[]}}convertSingleDepartment(t,n){if(Object.keys(t).length!==0){let s;t.absolute_position?s=t.absolute_position.split(","):s=[0,0];const o={GUID:t.GUID||t.guid||`dept_${n}_${Date.now()}`,Master_GUID:t.Master_GUID,type:t.sys_ServerSetting.type||"",name:t.sys_ServerSetting.name||"",gird_position:t.position,position:{x:s[0],y:s[1]},contents:t.medMap_Section,department_type:t.sys_ServerSetting["department_type "],class:0};return Array.isArray(t.medMap_Section)&&t.medMap_Section.forEach((l,a)=>{let i;l.absolute_position?i=l.absolute_position.split(","):i=[0,0],o.contents[a]={GUID:l.GUID,Master_GUID:l.Master_GUID,name:l.name,type:"parent_container",class:1,gird_position:l.position,position:{x:i[0],y:i[1]},serverName:t.sys_ServerSetting.name,serverType:t.sys_ServerSetting.type,device_type:t.sys_ServerSetting.device_type,ip_light:l.ip_light,reverse:l.reverse,contents:[],med_list:[]},Array.isArray(l.sub_section)&&l.sub_section.forEach((c,g)=>{let y={GUID:c.GUID,Master_GUID:c.Master_GUID,name:c.name,type:"sub_container",class:2,gird_position:c.position,contents:[],serverName:t.sys_ServerSetting.name,serverType:t.sys_ServerSetting.type,oriMaxCol:0};o.contents[a].contents[g]=y;let h=0;Array.isArray(c.shelf)&&c.shelf.forEach((p,b)=>{let N={GUID:p.GUID,Master_GUID:p.Master_GUID,name:p.name,class:3,gird_position:p.position,serverName:p.serverName||"",serverType:p.serverType||"",device_type:p.device_type||"",type:p.type,contents:[],ip:p.ip_light,width:p.width,height:p.height};if(N.serverName&&(N.serverName=t.sys_ServerSetting.name),N.serverType&&(N.serverType=t.sys_ServerSetting.type),p.type=="dispensing_shelves"||p.type=="shelf")p.type=="shelf"&&(N.type="dispensing_shelves"),Array.isArray(p.medMapBox)&&p.medMapBox.forEach((A,d)=>{let u={GUID:A.GUID,Master_GUID:A.Master_GUID,name:"",class:4,gird_position:A.position,ip:A.ip_box,box_type:"",width:A.width,height:A.height,serverType:A.serverType,serverName:A.serverName,med_info:[],type:"med_box"},m={},C=p.position.split(","),P=A.position.split(",");if(A.storage){switch(u.device_type=A.storage.DeviceType,u.storage=A.storage,+u.device_type){case 10:u.box_type="2.9";break;case 118:u.box_type="2.13";break;case 13:u.box_type="4.2";break}m.name=A.storage.Name,m.code=A.storage.Code,m.cht_name=A.storage.ChineseName,m.SKDIACODE=A.storage.SKDIACODE,m.device_type=A.storage.device_type,m.qty=A.storage.StorageName,m.stockCol=`${+C[0]+1}`,m.stockRow="",m.stock=`${+P[1]+1}`}else u.device_type=10,u.box_type="2.9",m.name="",m.code="",m.cht_name="",m.stockCol=`${+C[0]+1}`,m.stockRow="",m.stock=`${+P[1]+1}`;o.contents[a].med_list.push(m),u.med_info[0]=m,N.contents.push(u)});else{N.type="store_shelves";const A=p.medMapStock.sort((P,k)=>{const[T]=P.location.split(",").map(Number),[G]=k.location.split(",").map(Number);return T-G});N.medMapStock=A,N.name=p.name;let d=Math.max(...A.map(P=>P.location.split(",")[0])),u=Math.max(...l.sub_section.map(P=>P.position.split(",")[1]));+d<=0&&(d=0);let m=p.position.split(","),C=c.position.split(",");A.forEach((P,k)=>{if(P.code){let T={};T.name=P.name,T.code=P.code,T.cht_name="",T.SKDIACODE=P.material_no,T.qty=P.qty,T.stockCol=`${+m[0]+1}`,T.stockRow=`${+C[1]+1}`,l.reverse=="True"&&(T.stockRow=u+1-`${+C[1]}`),T.stock=`${+P.location.split(",")[0]+1}`,l.reverse=="True"&&(T.stock=d+1-+P.location.split(",")[0]),o.contents[a].med_list.push(T)}})}let S=p.position.split(",")[1];h<+S&&(h=+S,o.contents[a].contents[g].oriMaxCol=+h),o.contents[a].contents[g].contents.push(N)}),Array.isArray(c.drawer)&&c.drawer.forEach((p,b)=>{let N={GUID:p.GUID,Master_GUID:p.Master_GUID,name:` ${b}`,class:3,gird_position:p.position,ip:p.ip_drawer,serverName:p.serverName,serverType:p.serverType};N.serverName&&(N.serverName=t.sys_ServerSetting.name),N.serverType&&(N.serverType=t.sys_ServerSetting.type),p.drawer?(N.drawer=p.drawer,p.drawer.Boxes&&(N.type="grid_draw",N.name=p.drawer.Name,N.Boxes=[],Array.isArray(p.drawer.Boxes)?p.drawer.Boxes.forEach((d,u)=>{let m=[];Array.isArray(d)&&d.forEach((C,P)=>{let k={Row:C.Row,Column:C.Column,Width:1,Height:1,Slave:C.Slave,SlaveBox_Row:C.SlaveBox_Row,SlaveBox_Column:C.SlaveBox_Column,MasterBox_Column:C.MasterBox_Column,MasterBox_Row:C.MasterBox_Row,Name:C.Name,Code:C.Code,ChineseName:C.ChineseName,GUID:C.GUID};m.push(k),C.Code&&o.contents[a].med_list.push(C.Code)}),N.Boxes.push(m)}):N.Boxes=p.drawer.Boxes)):(N.type="list_draw",N.name=` ${b}`);let S=p.position.split(",")[1];h<+S&&(h=+S,o.contents[a].contents[g].oriMaxCol=+h),o.contents[a].contents[g].contents.push(N)})})}),o}else return{}}convertSingleComponent(t,n,s){var l,a,i,c,g;const o={GUID:t.GUID||t.guid||`comp_${n}_${Date.now()}`,type:this.mapComponentType(t.type||t.component_type||"unknown"),name:t.name||t.component_name||`_${n}`,position:{x:((l=t.position)==null?void 0:l.x)||t.x||50+n*200,y:((a=t.position)==null?void 0:a.y)||t.y||50+n*150},dimensions:{width:((i=t.dimensions)==null?void 0:i.width)||t.width||180,height:((c=t.dimensions)==null?void 0:c.height)||t.height||120,depth:((g=t.dimensions)==null?void 0:g.depth)||t.depth||30},med_box:t.med_box||t.medBox||t.medicine_boxes||[],Master_GUID:s};return t.components&&Array.isArray(t.components)&&(o.components=t.components.map((y,h)=>this.convertSingleComponent(y,h,o.GUID))),Object.keys(t).forEach(y=>{["GUID","type","name","position","dimensions","med_box","components"].includes(y)||(o[y]=t[y])}),o}mapDepartmentType(t){return{dispensing_station:"",warehouse:"",pharmacy:"",storage:""}[t]||t}mapComponentType(t){return{medicine_box_shelf:"med_box_shelf",medicine_shelf:"normal_shelf",grid_drawer:"grid_draw",list_drawer:"list_draw",medicine_box:"med_box",parent_container:"parent_container",sub_container:"sub_container",dispensing_shelves:"dispensing_shelves",store_shelves:"store_shelves"}[t]||t}validateConvertedData(t){try{if(!Array.isArray(t))return console.error(" "),!1;for(const n of t){if(!n.GUID||!n.type||!n.name)return console.error(" :",n),!1;if(!n.gird_position||typeof n.gird_position!="string")return console.error(" :",n.gird_position),!1;if(n.components&&Array.isArray(n.components)){for(const s of n.components)if(!s.GUID||!s.type)return console.error(" :",s),!1}}return console.log(" "),!0}catch(n){return console.error(" :",n),!1}}generateConversionReport(t,n){const s={timestamp:new Date().toISOString(),originalDataCount:Array.isArray(t)?t.length:0,convertedDataCount:n.length,conversionSuccess:n.length>0,totalComponents:n.reduce((o,l)=>{var a;return o+(((a=l.components)==null?void 0:a.length)||0)},0),departmentTypes:[...new Set(n.map(o=>o.type))],componentTypes:[...new Set(n.flatMap(o=>{var l;return((l=o.components)==null?void 0:l.map(a=>a.type))||[]}))]};return console.log(" :",s),s}}const Mt=new Jm,Zm=Object.freeze(Object.defineProperty({__proto__:null,default:Mt},Symbol.toStringTag,{value:"Module"})),qu=f.createContext(void 0),eh=({children:e})=>{const[t,n]=f.useState(!1),[s,o]=f.useState(null),[l,a]=f.useState(!1),[i,c]=f.useState(null),[g,y]=f.useState(null),[h,p]=f.useState("medicine"),[b,N]=f.useState(!1),[S,A]=f.useState(0),[d,u]=f.useState({message:"",type:"success",isVisible:!1}),[m,C]=f.useState(!1),[P,k]=f.useState(null),[T,G]=f.useState("edit"),[M,U]=f.useState(!1),[le,ue]=f.useState(null),[_,v]=f.useState(!1),[H,w]=f.useState(null),[j,D]=f.useState(!1),[I,Z]=f.useState(!1),[z,oe]=f.useState(null),[be,fe]=f.useState(!1),[W,he]=f.useState(null),[Y,Ce]=f.useState(!1),[ve,ye]=f.useState(null),[Ae,te]=f.useState(!1),[R,E]=f.useState(null),[X,B]=f.useState(null),[re,ie]=f.useState("add"),[$,V]=f.useState(!1),[F,J]=f.useState([]),[ae,ge]=f.useState([]),[de,we]=f.useState(!1),[Se,Ie]=f.useState(!1),[tt,Pe]=f.useState(""),[lt,He]=f.useState(!1),[$t,Gt]=f.useState(""),[Vn,Xt]=f.useState(!1),[qn,Gr]=f.useState(null),[As,Fr]=f.useState(null),[nl,x]=f.useState(!1),[se,Q]=f.useState(null),[O,q]=f.useState(!1),[L,K]=f.useState(null),[ee,pe]=f.useState(null),ne=()=>{sessionStorage.removeItem("user_session"),n(!1),o(null)},xe=f.useCallback(()=>{A(_e=>_e+1)},[]),me=f.useCallback((_e,Ye)=>{u({message:_e,type:Ye,isVisible:!0})},[]),Ne=f.useCallback(()=>{u(_e=>({..._e,isVisible:!1}))},[]),Te=_e=>{k(_e),G("edit"),C(!0)},De=()=>{const _e={GUID:`new_medbox_${Date.now()}`,name:"",box_type:"",width:[],width_index:0,med_info:[],parentShelf:null};k(_e),G("add"),C(!0)},$e=()=>{C(!1),k(null),G("edit")},Me=_e=>{ue(_e),U(!0)},Re=()=>{U(!1),ue(null)},Oe=_e=>{w(_e),v(!0)},Ee=()=>{v(!1),w(null)},Le=_e=>{oe(_e),Z(!0)},xt=()=>{Z(!1),oe(null)},ze=_e=>{he(_e),fe(!0)},un=()=>{fe(!1),he(null)},Hr=_e=>{ye(_e),Ce(!0)},rl=()=>{Ce(!1),ye(null)},tf=_e=>{E(_e),B(null),ie("add"),te(!0)},nf=(_e,Ye)=>{E(_e),B(Ye),ie("edit"),te(!0)},rf=()=>{te(!1),E(null),B(null),ie("add")},sf=()=>{V(!0)},of=()=>{V(!1)},lf=(_e="")=>{Pe(_e),Ie(!0)},af=()=>{Ie(!1)},cf=_e=>{Gt(_e),He(!0)},df=()=>{He(!1),Gt("")},uf=(_e,Ye)=>{Gr(_e),Fr(Ye||null),Xt(!0)},ff=()=>{Xt(!1),Gr(null),Fr(null)},pf=_e=>{Q(_e),x(!0)},mf=()=>{x(!1),Q(null)},hf=_e=>{K(_e),q(!0)},gf=()=>{q(!1),K(null)},xf=f.useCallback(async()=>{if(!i){console.warn("");return}console.log(" :",i),D(!0);try{const _e=await ke.getMedMapByDepartment(i);if(_e.Code===200&&_e.Data){console.log(" :",_e.Data);const Ye=Mt.convertMedMapApiToFakeData(_e.Data);if(!Mt.validateConvertedData(Ye)){console.error(" "),y(null);return}y(Ye),console.log(" ")}else console.error(" API :",_e),y(null)}catch(_e){console.error(" :",_e),y(null)}finally{D(!1)}},[i,D,y]),yf=f.useCallback((_e,Ye)=>{y(st=>st&&st.map(pt=>{const Xe={...pt};return Xe.contents&&(Xe.contents=Xe.contents.map(Nn=>{const ar={...Nn};return ar.contents&&(ar.contents=ar.contents.map(ir=>{const cr={...ir};return cr.contents&&(cr.contents=cr.contents.map(jn=>{if(jn.GUID===_e){const Qt={...jn};return Qt.medMapStock||(Qt.medMapStock=[]),Qt.medMapStock=[...Qt.medMapStock,Ye],Qt}return jn})),cr})),ar})),Xe}))},[]),vf=f.useCallback((_e,Ye,st)=>{y(dt=>dt&&dt.map(Xe=>{const Nn={...Xe};return Nn.contents&&(Nn.contents=Nn.contents.map(ar=>{const ir={...ar};return ir.contents&&(ir.contents=ir.contents.map(cr=>{const jn={...cr};return jn.contents&&(jn.contents=jn.contents.map(Qt=>{if(Qt.GUID===_e&&Qt.medMapStock){const wi={...Qt};return wi.medMapStock=Qt.medMapStock.map(sl=>sl.GUID===Ye?{...sl,...st}:sl),wi}return Qt})),jn})),ir})),Nn}))},[]),wf=f.useCallback((_e,Ye)=>{y(st=>{if(!st)return st;const dt=pt=>pt.map(Xe=>Xe.GUID===_e?{...Xe,...Ye}:Xe.contents&&Array.isArray(Xe.contents)?{...Xe,contents:dt(Xe.contents)}:Xe);return dt(st)})},[]),bf=f.useCallback(_e=>{y(Ye=>{if(!Ye)return Ye;const st=dt=>dt.filter(pt=>pt.GUID!==_e).map(pt=>pt.contents&&Array.isArray(pt.contents)?{...pt,contents:st(pt.contents)}:pt);return st(Ye)})},[]),Nf=f.useCallback((_e,Ye)=>{y(st=>st&&st.map(dt=>{if(dt.GUID===_e){const pt=dt.contents?[...dt.contents,Ye]:[Ye];return{...dt,contents:pt,medMap_Section:pt}}return dt}))},[]),jf=f.useCallback((_e,Ye)=>{y(st=>{if(!st)return st;const dt=pt=>pt.map(Xe=>{if(Xe.GUID===_e){const Nn=Xe.contents?[...Xe.contents,Ye]:[Ye];return{...Xe,contents:Nn}}return Xe.contents&&Array.isArray(Xe.contents)?{...Xe,contents:dt(Xe.contents)}:Xe});return dt(st)})},[]);return r.jsx(qu.Provider,{value:{isAuthenticated:t,setIsAuthenticated:n,currentUser:s,setCurrentUser:o,logout:ne,sidebarOpen:l,setSidebarOpen:a,selectedDepartmentType:i,setSelectedDepartmentType:c,isAdminMode:b,setIsAdminMode:N,apiDepartmentData:g,setApiDepartmentData:y,viewMode:h,setViewMode:p,refreshTrigger:S,triggerRefresh:xe,addStockToShelf:yf,notification:d,showNotification:me,hideNotification:Ne,medBoxModalOpen:m,setMedBoxModalOpen:C,selectedMedBox:P,setSelectedMedBox:k,openMedBoxModal:Te,closeMedBoxModal:$e,modalMode:T,setModalMode:G,openAddMedBoxModal:De,listDrawModalOpen:M,setListDrawModalOpen:U,selectedListDraw:le,setSelectedListDraw:ue,openListDrawModal:Me,closeListDrawModal:Re,gridDrawModalOpen:_,setGridDrawModalOpen:v,selectedGridDraw:H,setSelectedGridDraw:w,openGridDrawModal:Oe,closeGridDrawModal:Ee,isLoadingMedMap:j,setIsLoadingMedMap:D,addParentContainerModalOpen:I,setAddParentContainerModalOpen:Z,selectedDepartmentForAdd:z,setSelectedDepartmentForAdd:oe,openAddParentContainerModal:Le,closeAddParentContainerModal:xt,addShelfDrawContainerModalOpen:be,setAddShelfDrawContainerModalOpen:fe,selectedSubContainerForAdd:W,setSelectedSubContainerForAdd:he,openAddShelfDrawContainerModal:ze,closeAddShelfDrawContainerModal:un,addSubContainerModalOpen:Y,setAddSubContainerModalOpen:Ce,selectedParentContainerForAdd:ve,setSelectedParentContainerForAdd:ye,openAddSubContainerModal:Hr,closeAddSubContainerModal:rl,addStoreItemModalOpen:Ae,setAddStoreItemModalOpen:te,selectedStoreShelfForAdd:R,setSelectedStoreShelfForAdd:E,selectedStockItemForEdit:X,setSelectedStockItemForEdit:B,storeItemModalMode:re,setStoreItemModalMode:ie,openAddStoreItemModal:tf,openEditStoreItemModal:nf,closeAddStoreItemModal:rf,updateStockInShelf:vf,updateContainerInLocalData:wf,removeContainerFromLocalData:bf,addParentContainerToLocalData:Nf,addSubContainerToLocalData:jf,addDepartmentModalOpen:$,setAddDepartmentModalOpen:V,allDepartmentsList:F,setAllDepartmentsList:J,openAddDepartmentModal:sf,closeAddDepartmentModal:of,reloadMedMapData:xf,qrCodeScannerModalOpen:Se,qrCodeScannerMode:tt,setQRCodeScannerModalOpen:Ie,openQRCodeScannerModal:lf,closeQRCodeScannerModal:af,addBarcodeModalOpen:lt,setAddBarcodeModalOpen:He,openAddBarcodeModal:cf,closeAddBarcodeModal:df,initialBarcodeValue:$t,containerDetailModalOpen:Vn,setContainerDetailModalOpen:Xt,selectedContainerForDetail:qn,setSelectedContainerForDetail:Gr,highlightedMedicineCode:As,setHighlightedMedicineCode:Fr,openContainerDetailModal:uf,closeContainerDetailModal:ff,editStoreShelfModalOpen:nl,setEditStoreShelfModalOpen:x,selectedStoreShelfForEdit:se,setSelectedStoreShelfForEdit:Q,openEditStoreShelfModal:pf,closeEditStoreShelfModal:mf,activeCanvas:ee,setActiveCanvas:pe,editParentContainerModalOpen:O,setEditParentContainerModalOpen:q,selectedParentContainerForEdit:L,setSelectedParentContainerForEdit:K,openEditParentContainerModal:hf,closeEditParentContainerModal:gf,medicineList:ae,setMedicineList:ge,isLoadingMedicines:de,setIsLoadingMedicines:we},children:e})},rt=()=>{const e=f.useContext(qu);if(e===void 0)throw new Error("useDrugMap must be used within a DrugMapProvider");return e},th={"zh-TW":{"nav.title":"","nav.home":"","nav.expandSidebar":"","nav.collapseSidebar":"","topbar.medicine":"","topbar.department":"","topbar.language":"","topbar.logout":"","sidebar.drugMap":"","sidebar.closeSidebar":"","sidebar.departmentCategories":"","sidebar.departments":"","canvas.lockCanvas":"","canvas.unlockCanvas":"","type.dispensingStation":"","type.warehouse":"","type.medBoxShelf":"","type.storeShelf":"","type.parentContainer":"","type.subContainer":"","type.gridDraw":"","type.listDraw":"","type.medBox":"","type.containers":"","modal.medBoxSettings":"","modal.addMedBox":"","modal.listDrawSettings":"","modal.gridDrawSettings":"","modal.settings":"","modal.add":"","form.medBoxName":"","form.medBoxType":"","form.widthSelection":"","form.ipAddress":"IP ","form.drugInfo":"","form.drawerName":"","form.drugList":"","form.drugCode":"","form.drugName":"","form.chineseName":"","form.drugSearch":"","placeholder.medBoxName":"  ","placeholder.ipAddress":" IP ","placeholder.drawerName":"","placeholder.gridDrawName":"","placeholder.drugSearch":" //","button.cancel":"","button.save":"","button.add":"","button.edit":"","button.change":"","button.remove":"","button.search":"","button.merge":"","button.unmerge":"","status.noDrugData":"","status.newMedBoxNoDrug":"","status.drawerNoDrug":"","status.gridDrawNotConfigured":"","status.noDrugInfo":"","status.drugListEmpty":"","status.noContent":"No content available","status.notSet":"","status.notAdded":"","status.searchResults":"","status.selectCellsForDrug":"","status.selectedCellsNoDrug":"","status.loadingMedMapData":"...","status.loadingMedMapHint":"","footer.copyright":"Copyright 2025 ","login.title":"","login.subtitle":"","login.userId":"","login.userIdPlaceholder":"","login.password":"","login.passwordPlaceholder":"","login.loginButton":"","login.loggingIn":"..."},en:{"nav.title":"Drug Map","nav.home":"Back to Home","nav.expandSidebar":"Expand Sidebar","nav.collapseSidebar":"Collapse Sidebar","topbar.medicine":"Medicine","topbar.department":"Department","topbar.language":"English","topbar.logout":"Logout","sidebar.drugMap":"Drug Map","sidebar.closeSidebar":"Close Sidebar","sidebar.departmentCategories":"Department Categories","sidebar.departments":"Departments","canvas.lockCanvas":"Lock Canvas","canvas.unlockCanvas":"Unlock Canvas","type.dispensingStation":"Dispensing Station","type.warehouse":"Warehouse","type.medBoxShelf":"Medicine Box Shelf","type.parentContainer":"Cabinet","type.subContainer":"sub container","type.gridDraw":"Grid Drawer","type.listDraw":"List Drawer","type.medBox":"Medicine Box","type.containers":"Containers","modal.medBoxSettings":"Medicine Box Settings","modal.addMedBox":"Add Medicine Box","modal.listDrawSettings":"Drawer Settings","modal.gridDrawSettings":"Grid Drawer Settings","modal.settings":"Edit Settings","modal.add":"Add Medicine Box","form.medBoxName":"Medicine Box Name","form.medBoxType":"Medicine Box Type","form.widthSelection":"Width Selection","form.ipAddress":"IP Address","form.drugInfo":"Drug Information","form.drawerName":"Drawer Name","form.drugList":"Drug List","form.drugCode":"Drug Code","form.drugName":"Drug Name","form.chineseName":"Chinese Name","form.drugSearch":"Drug Search","placeholder.medBoxName":"Enter medicine box name","placeholder.ipAddress":"Enter IP address","placeholder.drawerName":"Enter drawer name","placeholder.gridDrawName":"Enter grid drawer name","placeholder.drugSearch":"Enter drug code/name/Chinese name","button.cancel":"Cancel","button.save":"Save","button.add":"Add","button.edit":"Edit","button.change":"Change","button.remove":"Remove Drug","button.search":"Search","button.merge":"Merge","button.unmerge":"Unmerge","status.noDrugData":"This medicine box has no drug data configured","status.newMedBoxNoDrug":"New medicine box has no drug data configured","status.drawerNoDrug":"This drawer has no drugs configured","status.gridDrawNotConfigured":"This grid drawer is not configured","status.noDrugInfo":"No drug information","status.drugListEmpty":"Drug list is empty","status.noContent":"No content available","status.notSet":"Not set","status.notAdded":"No drugs added","status.searchResults":"Search results will be displayed here","status.selectCellsForDrug":"Select merged cells to display drug information","status.selectedCellsNoDrug":"Selected cells have no drug data","status.searching":"Searching...","status.noSearchResults":"No search results found","status.loadingMedMapData":"Loading medicine map data...","status.loadingMedMapHint":"Please wait while we process department data","footer.copyright":"Copyright 2025 Hongsen Intelligent Technology","login.title":"Drug Map System","login.subtitle":"Please login to continue","login.userId":"ID","login.userIdPlaceholder":"Enter your user ID","login.password":"Password","login.passwordPlaceholder":"Enter your password","login.loginButton":"Login","login.loggingIn":"Logging in..."}},Wu=f.createContext(void 0),nh=({children:e})=>{const[t,n]=f.useState("zh-TW"),s=o=>th[t][o]||o;return r.jsx(Wu.Provider,{value:{language:t,setLanguage:n,t:s},children:e})},kt=()=>{const e=f.useContext(Wu);if(e===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return e};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sh=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ge=(e,t)=>{const n=f.forwardRef(({color:s="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:a,className:i="",children:c,...g},y)=>f.createElement("svg",{ref:y,...rh,width:o,height:o,stroke:s,strokeWidth:a?Number(l)*24/Number(o):l,className:["lucide",`lucide-${sh(e)}`,i].join(" "),...g},[...t.map(([h,p])=>f.createElement(h,p)),...Array.isArray(c)?c:[c]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oh=Ge("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ec=Ge("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=Ge("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=Ge("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lh=Ge("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=Ge("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=Ge("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ah=Ge("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ih=Ge("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=Ge("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=Ge("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ch=Ge("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ju=Ge("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=Ge("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dh=Ge("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uh=Ge("ListX",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"m19 10-4 4",key:"1tz659"}],["path",{d:"m15 10 4 4",key:"1n7nei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=Ge("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=Ge("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vi=Ge("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=Ge("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ph=Ge("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=Ge("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mh=Ge("Pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=Ge("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=Ge("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=Ge("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zu=Ge("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=Ge("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gh=Ge("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=Ge("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),xh=()=>{const{sidebarOpen:e,setSidebarOpen:t}=rt(),{t:n}=kt();return r.jsx("div",{className:"fixed top-4 left-4 z-30",children:r.jsx("nav",{className:"bg-white/95 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg px-2 py-1",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("a",{href:"../frontpage",className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors",title:n("nav.home"),children:r.jsx(yi,{className:"w-5 h-5"})}),r.jsx("div",{className:"ml-2 text-lg font-semibold text-gray-900",children:n("nav.title")}),r.jsx("button",{onClick:()=>t(!e),className:"ml-8 p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors",title:n(e?"nav.collapseSidebar":"nav.expandSidebar"),children:e?r.jsx(ja,{className:"w-6 h-6"}):r.jsx(ja,{className:"w-6 h-6"})})]})})})},yh=()=>{const{viewMode:e,setViewMode:t,logout:n,currentUser:s,selectedDepartmentType:o,openAddDepartmentModal:l,apiDepartmentData:a,allDepartmentsList:i}=rt(),{language:c,setLanguage:g,t:y}=kt(),[h,p]=mo.useState(!1),b=()=>{g(c==="zh-TW"?"en":"zh-TW")},N=mo.useMemo(()=>{if(!o||!i||!a)return!1;const S=a.map(u=>u.name);return i.filter(u=>u["department_type "]===o).filter(u=>!S.includes(u.name)).length>0},[o,i,a]);return r.jsx("div",{className:"fixed top-20 left-4 right-auto sm:top-4 sm:left-auto sm:right-4 z-30",children:r.jsx("div",{className:"bg-white/95 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg px-2 py-1 sm:px-3 sm:py-2",children:r.jsxs("div",{className:"flex items-center gap-2 lg:gap-0 lg:space-x-2 flex-col lg:flex-row relative",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[r.jsxs("button",{onClick:()=>t("medicine"),className:`flex items-center space-x-2 px-3 py-1.5 rounded-md transition-all duration-300 ease-in-out transform ${e==="medicine"?"bg-white text-green-600 shadow-sm scale-105":"text-gray-600 hover:text-gray-900 hover:bg-gray-50 hover:scale-102"}`,children:[r.jsx(mh,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:y("topbar.medicine")})]}),r.jsxs("button",{onClick:()=>t("department"),className:`flex items-center space-x-2 px-3 py-1.5 rounded-md transition-all duration-300 ease-in-out transform ${e==="department"?"bg-white text-blue-600 shadow-sm scale-105":"text-gray-600 hover:text-gray-900 hover:bg-gray-50 hover:scale-102"}`,children:[r.jsx(Yu,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:y("topbar.department")})]})]}),r.jsx("button",{onClick:()=>p(!h),className:"lg:hidden flex items-center justify-center p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors",children:h?r.jsx(ih,{className:"w-4 h-4"}):r.jsx(Xu,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:`
            flex items-center gap-2 lg:gap-0 lg:space-x-2 flex-col lg:flex-row
            lg:flex lg:opacity-100 lg:max-h-none
            transition-all duration-300 ease-in-out overflow-hidden
            ${h?"flex opacity-100 max-h-96":"hidden opacity-0 max-h-0 lg:flex lg:opacity-100 lg:max-h-none"}
          `,children:[r.jsx("div",{className:"mx-1 w-full lg:w-px lg:h-6 h-px bg-gray-300"}),o&&N&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>l(),className:"w-full lg:w-auto flex justify-center items-center space-x-2 px-3 py-1.5 text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors border border-green-700",children:[r.jsx(Et,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:""})]}),r.jsx("div",{className:"w-full lg:w-px lg:h-6 h-px bg-gray-300"})]}),r.jsxs("button",{onClick:b,className:"w-full lg:w-auto flex justify-center items-center space-x-2 px-3 py-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors border",children:[r.jsx(ch,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:y("topbar.language")})]}),r.jsx("div",{className:"w-full lg:w-px lg:h-6 h-px bg-gray-300"}),s&&r.jsx("div",{className:"w-full lg:w-auto flex justify-center items-center space-x-2 px-3 py-1.5 bg-gray-50 border border-gray-200 rounded-lg",children:r.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.Name})}),r.jsxs("button",{onClick:n,className:"w-full lg:w-auto flex items-center space-x-2 px-3 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 hover:text-red-700 border border-red-200 rounded-lg transition-colors justify-center",children:[r.jsx(fh,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:y("topbar.logout")})]})]})]})})})},vh=[{name:"",value:"blue",bgr:"255,0,0",bgColor:"white",textColor:"text-black"},{name:"",value:"green",bgr:"0,255,0",bgColor:"white",textColor:"text-black"},{name:"",value:"red",bgr:"0,0,255",bgColor:"white",textColor:"text-black"},{name:"",value:"yellow",bgr:"0,255,255",bgColor:"white",textColor:"text-black"},{name:"",value:"purple",bgr:"255,0,255",bgColor:"white",textColor:"text-black"},{name:"",value:"cyan",bgr:"255,255,0",bgColor:"white",textColor:"text-black"}],wh=({isOpen:e,onClose:t})=>{const[n,s]=f.useState("blue"),[o,l]=f.useState(1),[a,i]=f.useState(60),[c,g]=f.useState(""),[y,h]=f.useState(""),[p,b]=f.useState([]),[N,S]=f.useState([]),[A,d]=f.useState([]),[u,m]=f.useState(!1),[C,P]=f.useState(!1),k=f.useRef(null),T=f.useRef(null),G=f.useRef(null),M=f.useRef(null);f.useEffect(()=>{if(e){const w=localStorage.getItem("medMap_setting");if(w)try{const j=JSON.parse(w);s(j.light_color||"blue"),l(j.brightness!==void 0?j.brightness:1),i(j.light_sec!==void 0?j.light_sec:60),g(j.default_person||""),h(j.default_person_id||"")}catch(j){console.error(":",j),s("blue"),l(1),i(60),g(""),h("")}else s("blue"),l(1),i(60),g(""),h("");U()}},[e]),f.useEffect(()=>{const w=j=>{G.current&&!G.current.contains(j.target)&&k.current&&!k.current.contains(j.target)&&m(!1),M.current&&!M.current.contains(j.target)&&T.current&&!T.current.contains(j.target)&&P(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);const U=async()=>{try{const w=await ke.getAllStaffInfo();w.Code===200&&w.Data&&b(w.Data)}catch(w){console.error(":",w)}},le=w=>{if(g(w),w.trim()===""){S([]),m(!1);return}const j=p.filter(D=>D.name&&D.name.toLowerCase().includes(w.toLowerCase()));S(j),m(j.length>0)},ue=w=>{if(h(w),w.trim()===""){d([]),P(!1);return}const j=p.filter(D=>D.ID&&D.ID.toLowerCase().includes(w.toLowerCase()));d(j),P(j.length>0)},_=w=>{g(w.name),h(w.ID),m(!1)},v=w=>{g(w.name),h(w.ID),P(!1)},H=()=>{const w={light_color:n,brightness:o,light_sec:a,default_person:c,default_person_id:y};localStorage.setItem("medMap_setting",JSON.stringify(w)),console.log(":",w),t()};return e?r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),r.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 sticky top-0 bg-white z-10",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""}),r.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"/"}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:""}),r.jsx("input",{ref:k,type:"text",value:c,onChange:w=>le(w.target.value),onFocus:()=>{c.trim()&&le(c)},placeholder:"",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),u&&r.jsx("div",{ref:G,className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:N.map((w,j)=>r.jsxs("div",{onClick:()=>_(w),className:"px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[r.jsx("div",{className:"font-medium text-gray-900",children:w.name}),r.jsx("div",{className:"text-xs text-gray-500",children:w.ID})]},j))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:" ID"}),r.jsx("input",{ref:T,type:"text",value:y,onChange:w=>ue(w.target.value),onFocus:()=>{y.trim()&&ue(y)},placeholder:" ID",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),C&&r.jsx("div",{ref:M,className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:A.map((w,j)=>r.jsxs("div",{onClick:()=>v(w),className:"px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[r.jsx("div",{className:"font-medium text-gray-900",children:w.ID}),r.jsx("div",{className:"text-xs text-gray-500",children:w.name})]},j))})]})]}),r.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"/"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" (BGR)"}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:vh.map(w=>r.jsxs("button",{onClick:()=>s(w.value),className:`
                    relative p-3 rounded-lg border-2 transition-all
                    ${w.bgColor} ${w.textColor}
                    ${n===w.value?"border-gray-900 shadow-lg scale-105":"border-gray-300 hover:border-gray-400 hover:shadow-md"}
                  `,children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"font-semibold text-sm mb-1",children:w.name}),r.jsx("div",{className:"text-xs opacity-90",children:w.bgr})]}),n===w.value&&r.jsx("div",{className:"absolute top-1 right-1 w-3 h-3 bg-white rounded-full border-2 border-gray-900"})]},w.value))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[": ",o.toFixed(1)]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:o,onChange:w=>l(parseFloat(w.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600",style:{background:`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${o*100}%, #e5e7eb ${o*100}%, #e5e7eb 100%)`}}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[r.jsx("span",{children:"0"}),r.jsx("span",{children:"0.5"}),r.jsx("span",{children:"1"})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[" (): ",a]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"range",min:"1",max:"120",step:"1",value:a,onChange:w=>i(parseInt(w.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600",style:{background:`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${(a-1)/119*100}%, #e5e7eb ${(a-1)/119*100}%, #e5e7eb 100%)`}}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[r.jsx("span",{children:"5"}),r.jsx("span",{children:"60"}),r.jsx("span",{children:"120"})]})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 bg-gray-50 rounded-b-xl sticky bottom-0",children:[r.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:""}),r.jsx("button",{onClick:H,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:""})]})]})]}):null},bh=({isOpen:e,onClose:t,onConfirm:n})=>{const[s,o]=f.useState(""),[l,a]=f.useState(!1);f.useEffect(()=>{e&&(o(""),a(!1))},[e]);const i=g=>{g.preventDefault(),s.trim()&&n(s)},c=g=>{g.key==="Escape"&&t()};return e?r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200 w-[400px]",onClick:g=>g.stopPropagation(),onKeyDown:c,children:[r.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(vi,{className:"w-5 h-5 text-blue-600"})}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""})]}),r.jsx("button",{type:"button",onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6"})})]}),r.jsx("form",{onSubmit:i,className:"flex-1 px-6 py-6",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600",children:""}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"text",value:s,onChange:g=>o(g.target.value),className:"w-full px-4 py-3 pr-12 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"",autoFocus:!0}),r.jsx("button",{type:"button",onClick:()=>a(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 transition-colors",children:l?r.jsx(Qu,{className:"w-5 h-5"}):r.jsx(Ku,{className:"w-5 h-5"})})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 py-4 px-6 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:""}),r.jsx("button",{type:"button",onClick:i,disabled:!s.trim(),className:"px-6 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:""})]})]})]}):null},Nh=()=>{const{sidebarOpen:e,setSidebarOpen:t,selectedDepartmentType:n,setSelectedDepartmentType:s,setApiDepartmentData:o,isLoadingMedMap:l,setIsLoadingMedMap:a,setAllDepartmentsList:i,isAdminMode:c,setIsAdminMode:g}=rt(),{t:y}=kt(),[h,p]=f.useState(new Set),[b,N]=f.useState([]),[S,A]=f.useState(!0),[d,u]=f.useState([]),[m,C]=f.useState(!1),[P,k]=f.useState(!1),T=()=>{c?g(!1):k(!0)},G=_=>{_==="66437068"?(g(!0),k(!1)):alert("")};f.useEffect(()=>{(async()=>{A(!0);try{const v=await ke.getDepartments();v.Code===200&&v.Data?(console.log(v.Data),N(v.Data),i(v.Data)):(console.error("API returned error:",v),N([]),i([]))}catch(v){console.error("Failed to fetch department data:",v),N([]),i([])}finally{A(!1)}})()},[]);const M=b.reduce((_,v)=>{const H=v["department_type "];return _[H]||(_[H]=[]),_[H].push(v),_},{}),U=_=>{const v=new Set(h);v.has(_)?v.delete(_):v.add(_),p(v)},le=async _=>{console.log(" :",_),s(_),await ue(_),t(!1)},ue=async _=>{console.log(" :",_),a(!0);try{const v=await ke.getMedMapByDepartment(_);if(v.Code===200&&v.Data){console.log(" API :",v.Data);const H=Mt.convertMedMapApiToFakeData(v.Data);if(!Mt.validateConvertedData(H)){console.error(" "),u([]);return}const j=Mt.generateConversionReport(v.Data,H);u(H),o(H),console.log(" "),console.log(" :",H),console.log(" :",j)}else console.error(" API :",v),u([]),o(null)}catch(v){console.error(" :",v),u([]),o(null)}finally{a(!1)}};return r.jsxs(r.Fragment,{children:[e&&r.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-40 lg:hidden",onClick:()=>t(!1)}),r.jsx("div",{className:`fixed w-80 bg-white/95 backdrop-blur-sm shadow-xl border border-gray-200/50 z-50 transform transition-all duration-300 ease-in-out h-screen h-svh ${e?"translate-x-0 opacity-100":"-translate-x-full opacity-0"}`,children:r.jsxs("div",{className:"flex flex-col h-screen h-svh",children:[r.jsx("div",{className:"flex-shrink-0 px-4 py-2 border-b border-gray-200/50",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("a",{href:"../frontpage",className:"text-gray-600 hover:text-gray-900 transition-colors p-2 rounded-lg hover:bg-gray-100/50",title:y("nav.home"),children:r.jsx(yi,{className:"w-5 h-5"})}),r.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:y("sidebar.drugMap")})]}),r.jsx("button",{type:"button",onClick:()=>t(!e),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors",title:y("sidebar.closeSidebar"),children:r.jsx(uh,{className:"w-6 h-6"})})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:S?r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsx("div",{className:"text-gray-500",children:"Loading departments..."})}):r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-base font-semibold text-gray-700 mb-4",children:y("sidebar.departmentCategories")}),Object.entries(M).map(([_,v])=>r.jsxs("div",{className:"space-y-1",children:[r.jsxs("button",{type:"button",onClick:()=>le(_),disabled:l,className:`w-full flex items-center justify-between p-3 rounded-lg transition-all duration-200 border ${n===_?"bg-blue-50 text-blue-700 border-blue-200 shadow-sm":"text-gray-700 hover:bg-gray-50 hover:shadow-sm border-transparent"} ${l?"opacity-50 cursor-not-allowed":""}`,children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[_==="B1F"?r.jsx(Yu,{className:"w-4 h-4"}):r.jsx(hh,{className:"w-4 h-4"}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"font-medium",children:_}),r.jsxs("div",{className:"text-xs text-gray-500",children:[v.length," ",y("sidebar.departments")]})]})]}),r.jsx("div",{onClick:H=>{H.stopPropagation(),U(_)},className:"p-1 hover:bg-gray-200/50 rounded transition-colors",children:h.has(_)?r.jsx(Xu,{className:"w-4 h-4"}):r.jsx(ah,{className:"w-4 h-4"})})]}),h.has(_)&&r.jsx("div",{className:"ml-6 space-y-2",children:v.map(H=>r.jsx("div",{className:"p-3 text-base text-gray-600 bg-gray-50 rounded-lg",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"font-medium text-gray-800",children:H.name}),r.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${H.type===""?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:H.type})]})},H.GUID))})]},_))]})}),r.jsx("div",{className:"flex-shrink-0 px-4 py-3 border-t border-gray-200/50",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("label",{htmlFor:"admin-mode-toggle",className:"text-sm font-medium text-gray-700 cursor-pointer select-none",children:""}),r.jsx("button",{type:"button",id:"admin-mode-toggle",role:"switch","aria-checked":c,onClick:T,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${c?"bg-blue-600":"bg-gray-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${c?"translate-x-6":"translate-x-1"}`})})]}),r.jsx("button",{type:"button",onClick:()=>C(!0),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100/50 rounded-lg transition-colors",title:"",children:r.jsx(In,{className:"w-5 h-5"})})]})})]})}),r.jsx(wh,{isOpen:m,onClose:()=>C(!1)}),r.jsx(bh,{isOpen:P,onClose:()=>k(!1),onConfirm:G})]})},jh=()=>{const{t:e}=kt();return r.jsx("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-30",children:r.jsx("div",{className:"bg-white/95 backdrop-blur-sm border border-gray-200/50 rounded-xl shadow-lg px-4 py-2",children:r.jsx("p",{className:"text-sm text-gray-600 font-medium whitespace-nowrap",children:e("footer.copyright")})})})},Sh=({component:e,scale:t,isLocked:n,isHighlighted:s=!1,onContainerClick:o})=>{const l=f.useRef(null),{t:a}=kt(),{apiDepartmentData:i,setApiDepartmentData:c,showNotification:g}=rt(),[y,h]=f.useState(!1),[p,b]=f.useState({x:0,y:0}),[N,S]=f.useState(e.position),[A,d]=f.useState(!1),[u,m]=f.useState(null),[C,P]=f.useState({x:0,y:0}),[k,T]=f.useState({x:0,y:0});f.useEffect(()=>{console.log(" CanvasComponent: position prop changed",{GUID:e.GUID,newPosition:e.position,currentPosition:N}),S(e.position)},[e.position]);const G=()=>{try{const Y=localStorage.getItem("medMap_setting");if(Y)return JSON.parse(Y).light_color||"red"}catch(Y){console.error(":",Y)}return"red"},M=f.useCallback(async(Y,Ce)=>{if(!i)return;console.log(" :",Y,Ce);const ve=JSON.parse(JSON.stringify(i)),ye=te=>{for(const R of te){if(R.GUID===Y)return R.position={x:Ce.x.toFixed(3),y:Ce.y.toFixed(3)},console.log(" :",R.name,Ce.x.toFixed(3),Ce.y.toFixed(3)),!0;if(R.components&&Array.isArray(R.components)&&ye(R.components)||R.contents&&Array.isArray(R.contents)&&ye(R.contents))return!0}return!1};if(ye(ve)){c(ve),console.log(" ");try{console.log(" ...");const te=await ke.updateContainerPosition({GUID:Y,absolute_position:`${Ce.x.toFixed(3)},${Ce.y.toFixed(3)}`});te.Code===200?(console.log(" ",te),g("","success")):(console.error(" :",te),g(`: ${te.Result||""}`,"error"))}catch(te){console.error(" :",te),g(": ","error")}}else console.warn(" :",Y)},[i,c,g]),{position:U,dimensions:le,name:ue,type:_}=e,v=f.useCallback(Y=>{const Ce=l.current;if(Ce)if(T({x:Y.clientX,y:Y.clientY}),n){Y.preventDefault(),Y.stopPropagation(),Ce.setPointerCapture(Y.pointerId);const ve=Ce.getBoundingClientRect(),ye=Y.clientX-ve.left,Ae=Y.clientY-ve.top;b({x:ye,y:Ae}),h(!0),d(!1)}else d(!1)},[n]),H=f.useCallback(()=>{if(!i)return[];const Y=[],Ce=ve=>{for(const ye of ve)ye.GUID!==e.GUID&&ye.position&&Y.push({GUID:ye.GUID,position:ye.position,dimensions:ye.dimensions}),ye.components&&Array.isArray(ye.components)&&Ce(ye.components),ye.contents&&Array.isArray(ye.contents)&&Ce(ye.contents)};return Ce(i),Y},[i,e.GUID]),w=f.useCallback((Y,Ce)=>{const ye=H();let Ae=Y,te=Ce;for(const R of ye){const E=parseFloat(R.position.x),X=parseFloat(R.position.y);if(Math.abs(Y-E)<20&&(Ae=E),Math.abs(Ce-X)<20&&(te=X),R.dimensions&&e.dimensions){const B=E+parseFloat(R.dimensions.width),re=Y+parseFloat(e.dimensions.width);Math.abs(re-B)<20&&(Ae=B-parseFloat(e.dimensions.width));const ie=X+parseFloat(R.dimensions.depth),$=Ce+parseFloat(e.dimensions.depth);Math.abs($-ie)<20&&(te=ie-parseFloat(e.dimensions.depth))}}return{x:Ae,y:te}},[H,e.dimensions]),j=f.useCallback(Y=>{const Ce=Math.abs(Y.clientX-k.x),ve=Math.abs(Y.clientY-k.y);if((Ce>5||ve>5)&&d(!0),!y||!n)return;Y.preventDefault(),Y.stopPropagation();const ye=l.current;if(!ye)return;const Ae=ye.closest("[data-canvas-content]");if(!Ae)return;const te=Ae.getBoundingClientRect(),R=(Y.clientX-te.left-p.x)/t,E=(Y.clientY-te.top-p.y)/t,X=w(R,E);S(X)},[y,p,t,n,w,k]),D=f.useCallback(Y=>{const Ce=Math.abs(Y.clientX-k.x),ve=Math.abs(Y.clientY-k.y),ye=Ce>5||ve>5;if(n){if(!y)return;Y.preventDefault(),Y.stopPropagation();const Ae=l.current;Ae&&Ae.releasePointerCapture(Y.pointerId),h(!1),ye?M(e.GUID,N):o&&o(e),d(!1)}else!ye&&o&&(Y.preventDefault(),Y.stopPropagation(),o(e)),d(!1)},[y,n,o,e,M,N,k]),I=f.useCallback(Y=>{const Ce=l.current;if(!Ce)return;const ve=Y.touches[0];if(ve&&(P({x:ve.clientX,y:ve.clientY}),n)){Y.preventDefault(),Y.stopPropagation(),m(ve.identifier);const ye=Ce.getBoundingClientRect(),Ae=ve.clientX-ye.left,te=ve.clientY-ye.top;b({x:Ae,y:te}),h(!0)}},[n]),Z=f.useCallback(Y=>{if(!y||!n||u===null)return;Y.preventDefault(),Y.stopPropagation();const Ce=l.current;if(!Ce)return;const ve=Array.from(Y.touches).find(X=>X.identifier===u);if(!ve)return;const ye=Ce.closest("[data-canvas-content]");if(!ye)return;const Ae=ye.getBoundingClientRect(),te=(ve.clientX-Ae.left-p.x)/t,R=(ve.clientY-Ae.top-p.y)/t,E=w(te,R);S(E)},[y,p,t,n,u,w]),z=f.useCallback(Y=>{const Ce=Array.from(Y.changedTouches)[0];if(!Ce)return;const ve=Math.abs(Ce.clientX-C.x),ye=Math.abs(Ce.clientY-C.y),Ae=ve>10||ye>10;if(n){if(!y||u===null||!Array.from(Y.changedTouches).some(R=>R.identifier===u))return;Y.preventDefault(),Y.stopPropagation(),h(!1),m(null),P({x:0,y:0}),Ae?M(e.GUID,N):o&&o(e)}else!Ae&&o&&(Y.preventDefault(),Y.stopPropagation(),o(e)),P({x:0,y:0})},[y,n,u,M,e,N,C,o]),oe=f.useCallback(Y=>{!y||!n||u===null||!Array.from(Y.changedTouches).some(ve=>ve.identifier===u)||(Y.preventDefault(),Y.stopPropagation(),S(e.position),h(!1),m(null),P({x:0,y:0}))},[y,n,u,e.position]),be=Y=>{if(s)return`highlight-breathe-${G()}`;switch(Y){case"":return"bg-gray-100 border-gray-400";case"":return"bg-gray-100 border-gray-400";case"parent_container":return"bg-gray-100 border-gray-400";default:return"bg-gray-50 border-gray-400"}},fe=Y=>{if(s)return`highlight-breathe-${G()}`;switch(Y){case"":return"bg-gray-200 text-gray-900";case"":return"bg-gray-200 text-gray-900";case"parent_container":return"bg-gray-200 text-gray-900";default:return"bg-gray-200 text-gray-800"}},W=Y=>{if(s)return`highlight-tag-${G()}`;switch(Y){case"":return"bg-gray-700 text-gray-900";case"":return"bg-gray-700 text-gray-900";case"parent_container":return"bg-gray-700 text-gray-900";default:return"bg-gray-700 text-gray-900"}},he=Y=>{const Ce=Y===""?"type.dispensingStation":Y===""?"type.warehouse":Y==="parent_container"?"":"type."+Y;return a(Ce)||Y};return r.jsx("div",{ref:l,className:`flex flex-col absolute border-2 rounded-lg shadow-lg hover:shadow-xl ${be(_)} overflow-hidden ${n?"cursor-move":"cursor-default"} ${y?"shadow-2xl z-50":""}`,style:{left:`${N.x}px`,top:`${N.y}px`,minWidth:_===""||_===""?"120px":"180px",minHeight:_===""||_===""?"60px":"120px",userSelect:"none",touchAction:"none",transition:y?"none":"transform 0.2s ease-out, box-shadow 0.2s ease-out"},onPointerDown:v,onPointerMove:j,onPointerUp:D,onTouchStart:I,onTouchMove:Z,onTouchEnd:z,onTouchCancel:oe,children:r.jsx("div",{className:`w-full min-w-[400px] h-auto flex items-start flex-1 justify-between p-2 border-gray-600 ${fe(_)}`,children:r.jsx("div",{className:"flex space-x-2 flex-1 min-w-0",children:r.jsxs("div",{className:"min-w-0 flex gap-4",children:[r.jsx("div",{className:"font-semibold text-[48px] truncate",children:ue}),r.jsx("div",{className:`flex items-center text-[28px] truncate py-2 px-4 text-white rounded-2xl ${W(_)}`,children:he(_)})]})})})})},tl=({isOpen:e,onClose:t,onScanSuccess:n,mode:s})=>{const{showNotification:o,openAddBarcodeModal:l}=rt();console.log(" QRCodeScannerModal props:",{isOpen:e,mode:s,hasOnScanSuccess:!!n});const a=f.useRef(null),i=f.useRef(null),c=f.useRef(null),g=f.useRef(null),y=f.useRef(!1),[h,p]=f.useState(!1),[b,N]=f.useState(""),[S,A]=f.useState(null),[d,u]=f.useState(!1);f.useEffect(()=>{const M=()=>{const U=window.innerWidth<680;u(U)};return M(),window.addEventListener("resize",M),()=>window.removeEventListener("resize",M)},[]);const m=async()=>{try{N("");const M=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:9999},height:{ideal:9999}}});c.current=M,a.current&&(a.current.srcObject=M,await a.current.play(),console.log(" Camera started, setting isScanning to true"),p(!0))}catch(M){console.error(":",M),N("")}},C=()=>{console.log(" "),y.current=!1,p(!1),c.current&&(c.current.getTracks().forEach(M=>M.stop()),c.current=null),a.current&&(a.current.srcObject=null)},P=async()=>{if(console.log(" captureAndScan called"),!a.current||!i.current||!h){console.log(" Early return: missing refs or not scanning");return}if(y.current){console.log(" Scan already in progress, skipping");return}y.current=!0;const M=a.current,U=i.current,le=U.getContext("2d");if(!le||M.readyState!==M.HAVE_ENOUGH_DATA){console.log(" Video not ready or no context"),y.current=!1,setTimeout(()=>{h&&P()},100);return}U.width=M.videoWidth,U.height=M.videoHeight,le.drawImage(M,0,0,U.width,U.height),U.toBlob(async ue=>{if(!ue)return;const _=new File([ue],"scan.jpg",{type:"image/jpeg"}),v=performance.now();try{console.log(" [] ...");const H=performance.now(),w=await ke.scanBarcode(_),j=performance.now();if(console.log(` [] API: ${(j-H).toFixed(2)}ms`),!w.results||w.results.length===0){console.log(" "),y.current=!1,h&&P();return}const D=w.results[0];if(!D.code){console.log(" "),y.current=!1,h&&P();return}console.log(" :",D.code),console.log(" :",D.type),console.log(" :",D.conf),y.current=!1,C(),t();try{const I=performance.now(),Z=await ke.searchByBarCode(D.code);console.log("AI:",Z);const z=performance.now();if(console.log(` [] API: ${(z-I).toFixed(2)}ms`),console.log(" :",Z),Z.Code===200)if(console.log(" :",Z.Data),console.log("  onScanSuccess, mode:",s),o("","success"),n){console.log(" onScanSuccess ");const oe=performance.now();n(D.code,Z.Data);const be=performance.now();console.log(` [] : ${(be-oe).toFixed(2)}ms`);const fe=performance.now();console.log(` [] : ${(fe-v).toFixed(2)}ms`),console.log(" onScanSuccess ")}else console.warn(" onScanSuccess ");else Z.Code===-200&&Z.Result===""?(console.log(" "),o("","warning"),l(D.code)):(console.log(" :",Z.Result),o(Z.Result||"","error"))}catch(I){console.error(":",I),o("","error")}}catch(H){console.error(":",H),y.current=!1,setTimeout(()=>{h&&P()},500)}},"image/jpeg",1)},k=()=>{console.log(" "),y.current=!1,P()};f.useEffect(()=>(e?m():C(),()=>{C()}),[e]),f.useEffect(()=>{h?(console.log(" isScanning became true, starting continuous scan"),k()):(console.log(" isScanning became false"),y.current=!1)},[h]);const T=()=>{C(),t()},G=async M=>{if(!c.current||!g.current)return;const U=g.current.getBoundingClientRect(),le=(M.clientX-U.left)/U.width,ue=(M.clientY-U.top)/U.height;console.log(" :",{x:le,y:ue}),A({x:M.clientX-U.left,y:M.clientY-U.top}),setTimeout(()=>A(null),1e3);try{const _=c.current.getVideoTracks()[0],v=_.getCapabilities();if(console.log(" :",v),!v.focusMode||!v.focusMode.includes("manual")){console.log(" ");return}const H={advanced:[{focusMode:"manual",focusDistance:0,pointsOfInterest:[{x:le,y:ue}]}]};await _.applyConstraints(H),console.log(" ")}catch(_){console.log("  ():",_)}};return e?d?r.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 bg-opacity-90",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ur,{className:"w-6 h-6 text-white"}),r.jsx("h2",{className:"text-lg font-semibold text-white",children:""})]}),r.jsx("button",{onClick:T,className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6 text-white"})})]}),r.jsxs("div",{className:"flex-1 relative",children:[r.jsxs("div",{ref:g,className:"absolute inset-0 bg-black cursor-crosshair",onClick:G,children:[r.jsx("video",{ref:a,className:"w-full h-full object-cover",playsInline:!0,muted:!0}),S&&r.jsxs("div",{className:"absolute pointer-events-none",style:{left:S.x,top:S.y,transform:"translate(-50%, -50%)"},children:[r.jsx("div",{className:"w-16 h-16 border-2 border-yellow-400 rounded-full animate-ping"}),r.jsx("div",{className:"absolute inset-0 w-16 h-16 border-2 border-yellow-400 rounded-full"}),r.jsxs("div",{className:"absolute inset-0 w-16 h-16 flex items-center justify-center",children:[r.jsx("div",{className:"w-1 h-16 bg-yellow-400"}),r.jsx("div",{className:"absolute w-16 h-1 bg-yellow-400"})]})]})]}),r.jsx("canvas",{ref:i,className:"hidden"})]}),r.jsxs("div",{className:"p-4 bg-gray-900 bg-opacity-90",children:[b&&r.jsx("div",{className:"bg-red-500 bg-opacity-20 border border-red-500 rounded-lg px-3 py-2 mb-3",children:r.jsx("p",{className:"text-red-200 text-sm",children:b})}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-white text-base font-medium mb-1",children:""}),r.jsx("p",{className:"text-gray-300 text-sm mb-1",children:"QR Code"}),r.jsx("p",{className:"text-gray-400 text-xs",children:" "})]})]})]}):r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full overflow-hidden flex flex-col max-h-[90vh]",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",children:r.jsx(Ur,{className:"w-6 h-6 text-blue-500"})}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:T,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6 text-gray-600"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[b&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg px-3 py-2 mb-4",children:r.jsx("p",{className:"text-red-600 text-sm",children:b})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{ref:g,className:"relative bg-black rounded-xl overflow-hidden cursor-crosshair",style:{aspectRatio:"16/9"},onClick:G,children:r.jsx("video",{ref:a,className:"w-full h-full object-cover",playsInline:!0,muted:!0})}),r.jsx("canvas",{ref:i,className:"hidden"}),r.jsxs("div",{className:"text-center rounded-lg pb-4",children:[r.jsx("p",{className:"text-gray-800 text-base font-medium mb-2",children:""}),r.jsx("p",{className:"text-gray-600 text-sm",children:"QR Code"}),r.jsx("p",{className:"text-gray-500 text-xs mt-1",children:" "})]})]})]})]})}):null};class Ch{constructor(){this.currentTask=null,this.isProcessing=!1}async startLighting(t,n,s,o,l){if(this.isProcessing){console.log(" ...");return}this.isProcessing=!0;try{this.currentTask&&(console.log(" ..."),await this.clearCurrentTask(),await this.sleep(200)),console.log(" ");for(const i of t)try{const c=performance.now();await ke.lightByCodeNameType(i.serverName,i.serverType,i.medicineCode,n,s,i.deviceType);const g=performance.now();console.log(` API (${i.serverName}/${i.medicineCode}): ${(g-c).toFixed(2)}ms`)}catch(c){console.error(`  (${i.serverName}/${i.medicineCode}):`,c)}const a=setTimeout(async()=>{var i;console.log(" "),await this.turnOffLights(t),(i=this.currentTask)!=null&&i.onLightOff&&this.currentTask.onLightOff(),this.currentTask=null},o);this.currentTask={timerId:a,lightData:t,onLightOff:l},console.log(`  ${o/1e3} `)}finally{this.isProcessing=!1}}async clearCurrentTask(){this.currentTask&&(clearTimeout(this.currentTask.timerId),console.log(" "),await this.turnOffLights(this.currentTask.lightData),this.currentTask.onLightOff&&this.currentTask.onLightOff(),this.currentTask=null)}async turnOffLights(t){console.log(" ...");for(const n of t)try{const s=performance.now();await ke.lightByCodeNameType(n.serverName,n.serverType,n.medicineCode,"0,0,0","0",n.deviceType);const o=performance.now();console.log(` API (${n.serverName}/${n.medicineCode}): ${(o-s).toFixed(2)}ms`)}catch(s){console.error(`  (${n.serverName}/${n.medicineCode}):`,s)}console.log(" ")}async turnOffAllLights(){this.currentTask&&await this.clearCurrentTask()}sleep(t){return new Promise(n=>setTimeout(n,t))}hasActiveTask(){return this.currentTask!==null}getCurrentMedicineCode(){var t,n;return((n=(t=this.currentTask)==null?void 0:t.lightData[0])==null?void 0:n.medicineCode)||null}getCurrentMedicineCodes(){return this.currentTask?this.currentTask.lightData.map(t=>t.medicineCode):[]}cleanup(){this.currentTask&&(clearTimeout(this.currentTask.timerId),this.currentTask=null),this.isProcessing=!1}}const ps=new Ch,kh=({children:e})=>{const t=f.useRef(null),{selectedDepartmentType:n,apiDepartmentData:s,setApiDepartmentData:o,showNotification:l,openAddBarcodeModal:a,openContainerDetailModal:i,highlightedMedicineCode:c,setHighlightedMedicineCode:g,activeCanvas:y,setActiveCanvas:h}=rt(),{t:p}=kt(),[b,N]=f.useState({x:0,y:0,scale:1}),[S,A]=f.useState(!1),[d,u]=f.useState(!1),[m,C]=f.useState({x:0,y:0}),[P,k]=f.useState(!1),[T,G]=f.useState(!1),[M,U]=f.useState(""),[le,ue]=f.useState([]),[_,v]=f.useState(null),H={blue:"255,0,0",green:"0,255,0",red:"0,0,255",yellow:"0,255,255",purple:"255,0,255",cyan:"255,255,0"},w=()=>{try{const $=localStorage.getItem("med_map_anchor");return $?JSON.parse($):[]}catch($){return console.error("Error reading canvas states from localStorage:",$),[]}},j=($,V,F,J)=>{try{const ae=w(),ge=ae.findIndex(we=>we.department===$&&we.canvasType===V),de={department:$,canvasType:V,scale:F,position:J};ge>=0?ae[ge]=de:ae.push(de),localStorage.setItem("med_map_anchor",JSON.stringify(ae))}catch(ae){console.error("Error saving canvas state to localStorage:",ae)}},D=($,V)=>w().find(J=>J.department===$&&J.canvasType===V)||null;f.useEffect(()=>(h("infinite"),()=>{h(null)}),[h]),f.useEffect(()=>{if(y!=="infinite"||!n)return;const V=setInterval(async()=>{try{console.log(" Auto-refreshing data for InfiniteCanvas...");const F=await ke.getMedMapByDepartment(n);if(F.Code===200&&F.Data){console.log(" API ");const J=Mt.convertMedMapApiToFakeData(F.Data);if(!Mt.validateConvertedData(J)){console.error(" ");return}console.log(" Data refreshed and converted successfully, updating state..."),console.log(" Converted data to set:",J),o(J)}}catch(F){console.error(" Failed to auto-refresh data:",F)}},2*60*1e3);return()=>{clearInterval(V)}},[y,n,o]),f.useEffect(()=>{if(n){const $=D(n,"InfiniteCanvas");if($)N({x:$.position.x,y:$.position.y,scale:$.scale});else{const V={x:0,y:0,scale:1};N(V),j(n,"InfiniteCanvas",V.scale,V)}}},[n]),f.useEffect(()=>{if(!n)return;const $=setTimeout(()=>{j(n,"InfiniteCanvas",b.scale,{x:b.x,y:b.y})},500);return()=>clearTimeout($)},[b,n]),f.useEffect(()=>{console.log(" InfiniteCanvas: apiDepartmentData changed",{hasData:!!s,length:(s==null?void 0:s.length)||0,data:s})},[s]);const I=f.useMemo(()=>{if(console.log(" useMemo: Re-calculating components due to apiDepartmentData change"),!s||s.length===0)return console.log(" No apiDepartmentData available"),[];const $=s,V=[];console.log(" Processing departments for InfiniteCanvas:",$);for(const F of $)if(console.log(" Processing department:",F.name,"Type:",F.type),F.type===""||F.type===""){if(F.contents&&Array.isArray(F.contents)){console.log("   Found",F.contents.length,"parent containers");for(const J of F.contents)console.log("     Parent container:",{GUID:J.GUID,name:J.name,type:J.type,position:J.position,hasDimensions:!!J.dimensions,dimensions:J.dimensions}),V.push({GUID:J.GUID,type:J.type,name:`${J.name}`,position:J.position,dimensions:J.dimensions||{width:200,height:200,depth:200},med_list:J.med_list||[],serverName:J.serverName,serverType:J.serverType,Master_GUID:F.GUID,contents:J.contents||[]})}}else F.contents&&Array.isArray(F.contents)&&F.contents.length>0&&(console.log("   Found",F.contents.length,"contents"),V.push(...F.contents));return console.log(" Total components for InfiniteCanvas:",V.length),V},[s]);f.useEffect(()=>{console.log(" InfiniteCanvas: components changed",{count:I.length,components:I.map($=>({GUID:$.GUID,name:$.name,type:$.type,position:$.position}))})},[I]),f.useEffect(()=>{const $=F=>{F.code==="Space"&&!F.repeat&&(F.preventDefault(),k(!0))},V=F=>{F.code==="Space"&&(F.preventDefault(),k(!1),A(!1))};return window.addEventListener("keydown",$),window.addEventListener("keyup",V),()=>{window.removeEventListener("keydown",$),window.removeEventListener("keyup",V)}},[]);const Z=f.useCallback($=>{var F;if(d)return;if($.ctrlKey&&!navigator.userAgent.includes("Mac")||$.metaKey&&navigator.userAgent.includes("Mac")){$.preventDefault(),$.stopPropagation();const J=(F=t.current)==null?void 0:F.getBoundingClientRect();if(!J)return;const ae=$.clientX-J.left,ge=$.clientY-J.top,de=$.deltaY>0?.9:1.1,we=Math.max(.1,Math.min(5,b.scale*de)),Se=we/b.scale,Ie=ae-(ae-b.x)*Se,tt=ge-(ge-b.y)*Se;N({x:Ie,y:tt,scale:we})}},[b,d]),z=f.useCallback($=>{d||!P||(A(!0),C({x:$.clientX,y:$.clientY}),$.preventDefault())},[d,P]),oe=f.useCallback($=>{if(!S||d)return;const V=$.clientX-m.x,F=$.clientY-m.y;N(J=>({...J,x:J.x+V,y:J.y+F})),C({x:$.clientX,y:$.clientY})},[S,m,d]),be=f.useCallback(()=>{A(!1)},[]),fe=f.useCallback($=>{if(!s)return[];const V=[],F=J=>{for(const ae of J)ae.med_list&&Array.isArray(ae.med_list)&&ae.med_list.some(de=>de.code==$)&&(console.log(" :",ae.name,ae.GUID),V.push(ae)),ae.components&&Array.isArray(ae.components)&&F(ae.components),ae.contents&&Array.isArray(ae.contents)&&F(ae.contents)};return F(s),V},[s]),W=f.useCallback(()=>{try{const V=localStorage.getItem("medMap_setting");if(V){const J=JSON.parse(V).light_sec;if(J!=null&&J!==""){const ae=Number(J);if(!isNaN(ae)&&ae>0)return ae*1e3}}}catch(V){console.error(":",V)}return 6e4},[]),he=f.useCallback(()=>{const $={rgb_color:"255,0,0",brightness:"100"};try{const V=localStorage.getItem("medMap_setting");if(V){const F=JSON.parse(V),J=F.light_color||"red";return{rgb_color:H[J]||H.red,brightness:String(F.brightness!==void 0?F.brightness:100)}}}catch(V){console.error(":",V)}return $},[]),Y=f.useCallback(async $=>{if(!$.trim())return;console.log(" :",$);const V=fe($);if(V.length>0){const F=W(),J=he();console.log(`  ${V.length} :`,V),console.log(` : ${F}ms (${F/1e3})`),console.log(" :",J);const ae=V.map(de=>de.GUID);ue(ae),v($),g($);const ge=V.filter(de=>de.serverName&&de.serverType).map(de=>({serverName:de.serverName,serverType:de.serverType,medicineCode:$,deviceType:de.device_type}));ge.length>0&&(await ps.startLighting(ge,J.rgb_color,J.brightness,F),setTimeout(()=>{ue([]),v(null),g(null)},F))}else console.log(" "),ue([]),v(null),g(null)},[fe,W,he,g]),Ce=($,V)=>{var ge,de;console.log(" [-]  - :",{barcode:$,medicineData:V});const F=((ge=V[0])==null?void 0:ge.CODE)||((de=V[0])==null?void 0:de.code);G(!1);const J=performance.now();Y(F);const ae=performance.now();console.log(` [-] : ${(ae-J).toFixed(2)}ms`)},ve=async $=>{var V,F;if($.key==="Enter"){if($.preventDefault(),!M.trim()){l("","warning");return}const J=performance.now();try{console.log(" [-] :",M);const ae=performance.now(),ge=await ke.searchByBarCode(M),de=performance.now();if(console.log(` [-] API: ${(de-ae).toFixed(2)}ms`),console.log(" :",ge),ge.Code===200&&ge.Data&&ge.Data.length>0){const we=((V=ge.Data[0])==null?void 0:V.CODE)||((F=ge.Data[0])==null?void 0:F.code);console.log(" :",ge.Data),l("","success");const Se=performance.now();Y(we);const Ie=performance.now();console.log(` [-] : ${(Ie-Se).toFixed(2)}ms`),U("");const tt=performance.now();console.log(` [-] : ${(tt-J).toFixed(2)}ms`)}else ge.Code===-200&&ge.Result===""?(console.log(" "),l("","warning"),a(M),U("")):(console.log(" :",ge.Result),l(ge.Result||"","error"))}catch(ae){console.error(":",ae),l("","error")}}};f.useEffect(()=>()=>{ps.cleanup()},[]),f.useEffect(()=>{if(c){console.log(" Context highlightedMedicineCode :",c);const $=fe(c);if($.length>0){const V=$.map(F=>F.GUID);ue(V),v(c),console.log(" UI :",V)}}else ue([]),v(null)},[c,fe]);const[ye,Ae]=f.useState(null),[te,R]=f.useState({x:0,y:0}),E=$=>{if($.length<2)return null;const V=$[0],F=$[1];return Math.sqrt(Math.pow(F.clientX-V.clientX,2)+Math.pow(F.clientY-V.clientY,2))},X=$=>{if($.length===1)return{x:$[0].clientX,y:$[0].clientY};const V=$[0],F=$[1];return{x:(V.clientX+F.clientX)/2,y:(V.clientY+F.clientY)/2}},B=f.useCallback($=>{if(!d){if($.touches.length===2){const V=E($.touches),F=X($.touches);Ae(V),R(F)}else if($.touches.length===1){const V=$.touches[0];C({x:V.clientX,y:V.clientY}),A(!0)}}},[d]),re=f.useCallback($=>{var V;if(!d){if($.preventDefault(),$.touches.length===2&&ye!==null){const F=E($.touches),J=X($.touches);if(F&&ye){const ae=(V=t.current)==null?void 0:V.getBoundingClientRect();if(!ae)return;const ge=F/ye,de=Math.max(.1,Math.min(5,b.scale*ge)),we=J.x-ae.left,Se=J.y-ae.top,Ie=de/b.scale,tt=we-(we-b.x)*Ie,Pe=Se-(Se-b.y)*Ie;N({x:tt,y:Pe,scale:de}),Ae(F),R(J)}}else if($.touches.length===1&&S){const F=$.touches[0],J=F.clientX-m.x,ae=F.clientY-m.y;N(ge=>({...ge,x:ge.x+J,y:ge.y+ae})),C({x:F.clientX,y:F.clientY})}}},[b,ye,S,m,d]),ie=f.useCallback(()=>{Ae(null),A(!1)},[]);return f.useEffect(()=>{const $=t.current;if($)return $.addEventListener("wheel",Z,{passive:!1}),()=>$.removeEventListener("wheel",Z)},[Z]),f.useCallback(()=>{N({x:0,y:0,scale:1})},[]),r.jsxs("div",{className:"relative w-full h-full overflow-hidden bg-gray-50",children:[r.jsx("div",{className:"absolute md:bottom-4 md:left-4 bottom-16 left-[50%] md:translate-x-[0%] translate-x-[-50%] z-10",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg flex items-center overflow-hidden border border-gray-200",children:[r.jsx("input",{type:"text",value:M,onChange:$=>U($.target.value),onKeyPress:ve,placeholder:"...",className:"px-4 py-2 w-50 focus:outline-none text-gray-700 disabled:opacity-50"}),r.jsx("button",{onClick:()=>G(!0),className:"p-2",title:"",children:r.jsx(Ur,{className:"w-6 h-6 text-blue-600"})})]})}),r.jsx("div",{className:"absolute bottom-4 right-4 z-10 flex gap-2",children:r.jsx("button",{onClick:()=>u(!d),className:`p-3 rounded-lg shadow-lg transition-colors ${d?"bg-red-500 text-white hover:bg-red-600":"bg-white text-gray-700 hover:bg-gray-50"}`,title:p(d?"canvas.unlockCanvas":"canvas.lockCanvas"),children:d?r.jsx(vi,{className:"w-6 h-6"}):r.jsx(Zu,{className:"w-6 h-6"})})}),r.jsx("div",{ref:t,className:`w-full h-full relative ${P&&!d?"cursor-grab":"cursor-default"} ${S?"cursor-grabbing":""}`,onMouseDown:z,onMouseMove:oe,onMouseUp:be,onMouseLeave:be,onTouchStart:B,onTouchMove:re,onTouchEnd:ie,children:r.jsxs("div",{className:"absolute inset-0 origin-top-left",style:{transform:`translate(${b.x}px, ${b.y}px) scale(${b.scale})`,transformOrigin:"0 0"},children:[r.jsx("div",{className:"absolute",style:{left:-1e4,top:-1e4,width:2e4,height:2e4,backgroundImage:`
                linear-gradient(to right, #e5e7eb 1px, transparent 1px),
                linear-gradient(to bottom, #e5e7eb 1px, transparent 1px)
              `,backgroundSize:"50px 50px"}}),r.jsxs("div",{className:"relative","data-canvas-content":!0,children:[I.map($=>r.jsx(Sh,{component:$,scale:b.scale,isLocked:d,isHighlighted:le.includes($.GUID),onContainerClick:V=>{console.log(" :",_),i(V,_)}},$.GUID)),e]})]})}),r.jsx(tl,{isOpen:T,onClose:()=>G(!1),onScanSuccess:Ce,mode:"med_light_location_mode"})]})},Zr=({content:e,isAdminMode:t})=>{const{openMedBoxModal:n,openAddMedBoxModal:s,openListDrawModal:o,openGridDrawModal:l,openAddShelfDrawContainerModal:a,openAddSubContainerModal:i,openAddStoreItemModal:c,setSelectedMedBox:g,setModalMode:y,setMedBoxModalOpen:h,showNotification:p,triggerRefresh:b,openEditStoreShelfModal:N,openEditParentContainerModal:S,updateContainerInLocalData:A,removeContainerFromLocalData:d}=rt(),{t:u}=kt(),[m,C]=f.useState(!1),[P,k]=f.useState(""),[T,G]=f.useState(!1),[M,U]=f.useState(e.name),[le,ue]=f.useState(!1),[_,v]=f.useState(!1);f.useEffect(()=>{U(e.name)},[e.name]);const H=W=>{W.stopPropagation(),k(e.name||""),C(!0)},w=W=>{W.stopPropagation(),C(!1),k("")},j=W=>{W.stopPropagation(),v(!0)},D=W=>{W.stopPropagation(),v(!1)},I=async W=>{W.stopPropagation(),ue(!0);try{let he;if(e.type==="parent_container")he=await ke.deleteParentContainer(e.GUID);else if(e.type==="sub_container")he=await ke.deleteSubContainer(e.GUID);else if(e.type==="store_shelves"||e.type==="dispensing_shelves")he=await ke.deleteShelfContainer(e.GUID);else{p("","error"),ue(!1),v(!1);return}he.Code===200?(p("","success"),d(e.GUID),v(!1)):p(he.Result||"","error")}catch(he){console.error(":",he),p("","error")}finally{ue(!1),v(!1)}},Z=async W=>{if(W.stopPropagation(),!P.trim()){p("","error");return}if(P===e.name){C(!1);return}G(!0);try{const he=[{GUID:e.GUID,name:P.trim(),Master_GUID:e.Master_GUID,position:e.gird_position,serverName:e.serverName,serverType:e.serverType}];let Y;if(e.type==="store_shelves"||e.type==="dispensing_shelves")Y=await ke.updateMedMapShelf(he);else if(e.type==="sub_container")Y=await ke.updateSubSection(he);else if(e.type==="parent_container")Y=await ke.updateMedMapSection(he);else{p("","error"),G(!1);return}Y.Code===200?(p("","success"),C(!1),U(P.trim()),A(e.GUID,{name:P.trim()})):p(Y.Result||"","error")}catch(he){console.error(":",he),p("","error")}finally{G(!1)}},z=W=>{switch(W){case"parent_container":return"bg-pink-100";case"sub_container":return"bg-blue-100";case"dispensing_shelves":case"store_shelves":return"bg-green-100";case"med_box":return"bg-yellow-100";case"grid_draw":case"list_draw":return"bg-violet-100";default:return"bg-gray-100"}},oe=W=>{switch(W){case"parent_container":return"border-pink-200";case"sub_container":return"border-blue-200";case"dispensing_shelves":case"store_shelves":return"border-green-200";case"med_box":return"border-yellow-200";case"grid_draw":case"list_draw":return"border-violet-200";default:return"border-gray-200"}},be=W=>{switch(W){case"parent_container":return"bg-pink-400";case"sub_container":return"bg-blue-400";case"dispensing_shelves":case"store_shelves":return"bg-green-400";case"med_box":return"bg-yellow-400";case"grid_draw":case"list_draw":return"bg-violet-400";default:return"bg-gray-200"}},fe=W=>{switch(W){case"parent_container":return u("type.parentContainer");case"sub_container":return u("type.subContainer");case"dispensing_shelves":return u("type.medBoxShelf");case"store_shelves":return u("type.storeShelf");case"grid_draw":return u("type.gridDraw");case"list_draw":return u("type.listDraw");case"med_box":return u("type.medBox");default:return W}};switch(e.type){case"sub_container":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${z(e.type||0)} ${oe(e.type||0)}`,children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6 flex-1",children:[m?r.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[r.jsx("input",{type:"text",value:P,onChange:W=>k(W.target.value),onClick:W=>W.stopPropagation(),className:"text-base font-semibold text-gray-800 border-2 border-blue-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:T,autoFocus:!0}),r.jsx("button",{onClick:Z,disabled:T,className:"p-1 hover:bg-green-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(eo,{className:"w-5 h-5 text-green-600"})}),r.jsx("button",{onClick:w,disabled:T,className:"p-1 hover:bg-red-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(Ke,{className:"w-5 h-5 text-red-600"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:M}),r.jsx("button",{onClick:H,className:"p-1 hover:bg-black/10 rounded transition-colors",title:"",children:r.jsx(jr,{className:"w-4 h-4 text-gray-600"})})]}),e.type!="parent_container"&&!m&&r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${be(e.type)}`,children:fe(e.type)})]}),e.type!=="none"&&!m&&r.jsxs("div",{className:"flex items-center space-x-1",children:[t&&r.jsx("button",{className:"p-1 hover:bg-red-100 rounded transition-colors",onClick:j,title:"",children:r.jsx(Sr,{className:"w-5 h-5 text-red-600"})}),r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:W=>{W.stopPropagation(),a(e)},title:u("modal.add"),children:r.jsx(Et,{className:"w-6 h-6 text-green-700"})})]}),_&&r.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm mx-4",onClick:W=>W.stopPropagation(),children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:""}),r.jsxs("p",{className:"text-gray-600 mb-4",children:["",e.name,""]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:D,disabled:le,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:""}),r.jsx("button",{onClick:I,disabled:le,className:"px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:le?"...":""})]})]})})]});case"parent_container":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${z(e.type||0)} ${oe(e.type||0)} cursor-pointer hover:bg-black/5 transition-colors`,onClick:W=>{m||S(e)},children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6 flex-1",children:[m?r.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[r.jsx("input",{type:"text",value:P,onChange:W=>k(W.target.value),onClick:W=>W.stopPropagation(),className:"text-base font-semibold text-gray-800 border-2 border-blue-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:T,autoFocus:!0}),r.jsx("button",{onClick:W=>{W.stopPropagation(),Z(W)},disabled:T,className:"p-1 hover:bg-green-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(eo,{className:"w-5 h-5 text-green-600"})}),r.jsx("button",{onClick:W=>{W.stopPropagation(),w(W)},disabled:T,className:"p-1 hover:bg-red-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(Ke,{className:"w-5 h-5 text-red-600"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:M}),r.jsx("button",{onClick:W=>{W.stopPropagation(),H(W)},className:"p-1 hover:bg-black/10 rounded transition-colors",title:"",children:r.jsx(jr,{className:"w-4 h-4 text-gray-600"})})]}),e.type!="parent_container"&&!m?r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${be(e.type)}`,children:fe(e.type)}):null]}),e.type!=="none"&&!m&&r.jsxs("div",{className:"flex items-center space-x-1",children:[t&&r.jsx("button",{className:"p-1 hover:bg-red-100 rounded transition-colors",onClick:j,title:"",children:r.jsx(Sr,{className:"w-5 h-5 text-red-600"})}),r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:W=>{W.stopPropagation(),i(e)},title:u("modal.add"),children:r.jsx(Et,{className:"w-6 h-6 text-green-700"})})]}),_&&r.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm mx-4",onClick:W=>W.stopPropagation(),children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:""}),r.jsxs("p",{className:"text-gray-600 mb-4",children:["",e.name,""]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:D,disabled:le,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:""}),r.jsx("button",{onClick:I,disabled:le,className:"px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:le?"...":""})]})]})})]});case"med_box":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${z(e.type||0)} ${oe(e.type||0)}`,children:[r.jsx("div",{className:"flex items-center mr-4",children:e.type!="parent_container"?r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${be(e.type)}`,children:fe(e.type)}):null}),r.jsx("div",{className:"flex items-center space-x-1",children:r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:W=>{W.stopPropagation(),n(e)},title:u("modal.settings"),children:r.jsx(In,{className:"w-6 h-6 text-gray-600"})})})]});case"dispensing_shelves":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${z(e.type||0)} ${oe(e.type||0)}`,onClick:W=>{m||N(e)},children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6 flex-1",children:[m?r.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[r.jsx("input",{type:"text",value:P,onChange:W=>k(W.target.value),onClick:W=>W.stopPropagation(),className:"text-base font-semibold text-gray-800 border-2 border-blue-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:T,autoFocus:!0}),r.jsx("button",{onClick:Z,disabled:T,className:"p-1 hover:bg-green-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(eo,{className:"w-5 h-5 text-green-600"})}),r.jsx("button",{onClick:w,disabled:T,className:"p-1 hover:bg-red-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(Ke,{className:"w-5 h-5 text-red-600"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:M}),r.jsx("button",{onClick:W=>{W.stopPropagation(),H(W)},className:"p-1 hover:bg-black/10 rounded transition-colors",title:"",children:r.jsx(jr,{className:"w-4 h-4 text-gray-600"})})]}),e.type!="parent_container"&&!m&&r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${be(e.type)}`,children:fe(e.type)})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[t&&!m&&r.jsx("button",{className:"p-1 hover:bg-red-100 rounded transition-colors",onClick:j,title:"",children:r.jsx(Sr,{className:"w-5 h-5 text-red-600"})}),r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:W=>{W.stopPropagation();const he={GUID:`new_medbox_${Date.now()}`,name:"",box_type:"",width:[],width_index:0,med_info:[],parentShelf:e};g(he),y("add"),h(!0)},title:u("modal.add"),children:r.jsx(Et,{className:"w-6 h-6 text-green-700"})})]}),_&&r.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm mx-4",onClick:W=>W.stopPropagation(),children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:""}),r.jsxs("p",{className:"text-gray-600 mb-4",children:["",e.name,""]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:D,disabled:le,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:""}),r.jsx("button",{onClick:I,disabled:le,className:"px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:le?"...":""})]})]})})]});case"store_shelves":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${z(e.type||0)} ${oe(e.type||0)} cursor-pointer hover:bg-black/5 transition-colors`,onClick:W=>{m||N(e)},children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6 flex-1",children:[m?r.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[r.jsx("input",{type:"text",value:P,onChange:W=>k(W.target.value),onClick:W=>W.stopPropagation(),className:"text-base font-semibold text-gray-800 border-2 border-blue-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:T,autoFocus:!0}),r.jsx("button",{onClick:W=>{W.stopPropagation(),Z(W)},disabled:T,className:"p-1 hover:bg-green-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(eo,{className:"w-5 h-5 text-green-600"})}),r.jsx("button",{onClick:W=>{W.stopPropagation(),w(W)},disabled:T,className:"p-1 hover:bg-red-100 rounded transition-colors disabled:opacity-50",title:"",children:r.jsx(Ke,{className:"w-5 h-5 text-red-600"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:M}),r.jsx("button",{onClick:W=>{W.stopPropagation(),H(W)},className:"p-1 hover:bg-black/10 rounded transition-colors",title:"",children:r.jsx(jr,{className:"w-4 h-4 text-gray-600"})})]}),e.type!="parent_container"&&!m&&r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${be(e.type)}`,children:fe(e.type)})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[t&&!m&&r.jsx("button",{className:"p-1 hover:bg-red-100 rounded transition-colors",onClick:j,title:"",children:r.jsx(Sr,{className:"w-5 h-5 text-red-600"})}),r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:W=>{W.stopPropagation(),c(e)},title:u("modal.add"),children:r.jsx(Et,{className:"w-6 h-6 text-green-700"})})]}),_&&r.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm mx-4",onClick:W=>W.stopPropagation(),children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:""}),r.jsxs("p",{className:"text-gray-600 mb-4",children:["",e.name,""]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:D,disabled:le,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:""}),r.jsx("button",{onClick:I,disabled:le,className:"px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:le?"...":""})]})]})})]});case"list_draw":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${z(e.type||0)} ${oe(e.type||0)}`,children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6",children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:e.name}),e.type!="parent_container"?r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${be(e.type)}`,children:fe(e.type)}):null]}),r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:W=>{W.stopPropagation(),o(e)},title:u("modal.settings"),children:r.jsx(In,{className:"w-6 h-6 text-gray-600"})})]});case"grid_draw":return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${z(e.type||0)} ${oe(e.type||0)}`,children:[r.jsxs("div",{className:"flex items-center space-x-2 mr-6",children:[r.jsx("span",{className:"text-base font-semibold text-gray-800 whitespace-nowrap",children:e.name}),e.type!="parent_container"?r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${be(e.type)}`,children:fe(e.type)}):null]}),r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:W=>{W.stopPropagation(),l(e)},title:u("modal.settings"),children:r.jsx(In,{className:"w-6 h-6 text-gray-600"})})]});default:return r.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b-2 ${z(e.type||0)} ${oe(e.type||0)}`,children:[r.jsx("div",{className:"flex items-center space-x-2 mr-6",children:e.type!="parent_container"?r.jsx("span",{className:`text-sm px-3 py-1 rounded-full whitespace-nowrap ${be(e.type)}`,children:fe(e.type)}):null}),e.type!=="none"&&r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",title:u("modal.settings"),children:r.jsx(In,{className:"w-6 h-6 text-gray-600"})})]})}},ef=f.forwardRef(({children:e},t)=>{const n=f.useRef(null),{selectedDepartmentType:s,apiDepartmentData:o,setApiDepartmentData:l,setSidebarOpen:a,openAddParentContainerModal:i,openEditStoreItemModal:c,openQRCodeScannerModal:g,openAddBarcodeModal:y,showNotification:h,isAdminMode:p,activeCanvas:b,setActiveCanvas:N}=rt(),[S,A]=f.useState({x:0,y:0,scale:1}),[d,u]=f.useState(!1),[m,C]=f.useState(!1),[P,k]=f.useState({x:0,y:0}),[T,G]=f.useState(!1),[M,U]=f.useState(""),[le,ue]=f.useState(!1),[_,v]=f.useState(null),[H,w]=f.useState(!1),[j,D]=f.useState({isDragging:!1,draggedContainer:null,draggedElement:null,floatingElement:null,originalParent:null,originalPosition:"",originalIndex:-1,mouseOffset:{x:0,y:0},isMobileDrag:!1,originalData:null,draggedStockItem:null,draggedStockShelf:null}),[I,Z]=f.useState(null),z=f.useRef({}),oe=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window||navigator.maxTouchPoints>0,be=8,fe=()=>{try{const x=localStorage.getItem("med_map_anchor");return x?JSON.parse(x):[]}catch(x){return console.error("Error reading canvas states from localStorage:",x),[]}},W=(x,se,Q,O)=>{try{const q=fe(),L=q.findIndex(ee=>ee.department===x&&ee.canvasType===se),K={department:x,canvasType:se,scale:Q,position:O};L>=0?q[L]=K:q.push(K),localStorage.setItem("med_map_anchor",JSON.stringify(q))}catch(q){console.error("Error saving canvas state to localStorage:",q)}},he=(x,se)=>fe().find(O=>O.department===x&&O.canvasType===se)||null;f.useEffect(()=>(N("drug"),()=>{N(null)}),[N]),f.useEffect(()=>{if(b!=="drug"||!s)return;const se=setInterval(async()=>{try{console.log(" Auto-refreshing data for DrugCanvas...");const Q=await ke.getMedMapByDepartment(s);if(Q.Code===200&&Q.Data){console.log(" API ");const O=Mt.convertMedMapApiToFakeData(Q.Data);if(!Mt.validateConvertedData(O)){console.error(" ");return}console.log(" Data refreshed and converted successfully, updating state..."),l(O)}}catch(Q){console.error(" Failed to auto-refresh data:",Q)}},2*60*1e3);return()=>{clearInterval(se)}},[b,s,l]),f.useEffect(()=>{if(s){const x=he(s,"drugCanvas");if(x)A({x:x.position.x,y:x.position.y,scale:x.scale});else{const se={x:0,y:0,scale:1};A(se),W(s,"drugCanvas",se.scale,se)}}},[s]),f.useEffect(()=>{if(!s)return;const x=setTimeout(()=>{W(s,"drugCanvas",S.scale,{x:S.x,y:S.y})},500);return()=>clearTimeout(x)},[S,s]);const Y=x=>["parent_container","sub_container","dispensing_shelves","store_shelves","grid_draw","list_draw","med_box"].includes(x),Ce=x=>({parent_container:["parent_container","",""],sub_container:["parent_container","sub_container"],dispensing_shelves:["dispensing_shelves","store_shelves","sub_container","grid_draw","list_draw"],store_shelves:["dispensing_shelves","store_shelves","sub_container","grid_draw","list_draw"],grid_draw:["grid_draw","list_draw","sub_container","dispensing_shelves","store_shelves"],list_draw:["grid_draw","list_draw","sub_container","dispensing_shelves","store_shelves"],med_box:["med_box","dispensing_shelves"]})[x]||[],ve=x=>{const[se,Q]=x.split(",").map(Number);return{row:se||0,col:Q||0}},ye=(x,se)=>{const Q=(q,L=null)=>{if(q.GUID===x)return{container:q,parent:L};if(q.contents)for(const K of q.contents){const ee=Q(K,q);if(ee)return ee}return null},O=lt();for(const q of O){const L=Q(q);if(L)return L}return null},Ae=(x,se)=>{if(!x.contents)return[];const Q=se;if(!Q)return x.contents;const O=ve(Q.gird_position);console.log(" :",O);for(const q of x.contents){const L=ve(q.gird_position);if(L.row===O.row&&L.col>O.col){const K=L.col-1;q.gird_position=`${L.row},${K}`,console.log(`    ${q.GUID}: (${L.row},${L.col})  (${L.row},${K})`),z.current[q.GUID]={GUID:q.GUID,Master_GUID:x.GUID,position:`${L.row},${K}`,serverName:x.serverName,serverType:x.serverType,type:q.type,containerData:q}}}return console.log(" "),x.contents},te=(x,se,Q,O,q)=>{if(x.contents||(x.contents=[]),console.log(" :",`(${Q},${O})`),console.log("   :",q),console.log("   :",x.GUID),console.log("   :",x.contents.length),x.contents.length===0)Q=0,O=0,console.log("    (0,0)");else{const L=x.contents.filter(K=>{const ee=ve(K.gird_position||"0,0");return ee.row===Q&&ee.col>=O}).sort((K,ee)=>{const pe=ve(K.gird_position||"0,0");return ve(ee.gird_position||"0,0").col-pe.col});console.log(`    row ${Q} :`,L.length);for(const K of L){const ee=ve(K.gird_position||"0,0"),pe=ee.col+1;K.gird_position=`${ee.row},${pe}`,console.log(`    ${K.GUID}: (${ee.row},${ee.col})  (${ee.row},${pe})`),z.current[K.GUID]={GUID:K.GUID,Master_GUID:x.GUID,position:`${ee.row},${pe}`,serverName:x.serverName,serverType:x.serverType,type:K.type,containerData:K}}}se.gird_position=`${Q},${O}`,se.Master_GUID=x.GUID,console.log(`Inserted container ${se.GUID} at position ${Q},${O}`),x.contents.push(se),z.current[se.GUID]={GUID:se.GUID,Master_GUID:x.GUID,position:`${Q},${O}`,serverName:x.serverName,serverType:x.serverType,type:se.type,containerData:se},se.type==="dispensing_shelves"&&se.contents&&se.contents.forEach(L=>{L.type==="med_box"&&(z.current[L.GUID]={GUID:L.GUID,Master_GUID:L.Master_GUID,position:L.gird_position,serverName:x.serverName,serverType:x.serverType,type:L.type,containerData:L})})},R=(x,se,Q)=>{const O=x.getBoundingClientRect(),q=O.left+O.width/2,L=O.top+O.height/2,K=se-q,ee=Q-L;return Math.abs(K)>Math.abs(ee)?K>0?"right":"left":ee>0?"bottom":"top"},E=(x,se,Q,O)=>{if(!m)return;if(O.preventDefault(),O.stopPropagation(),j.floatingElement)try{j.floatingElement.parentNode&&j.floatingElement.parentNode.removeChild(j.floatingElement)}catch(xe){console.error(":",xe)}const q=oe(),L="touches"in O?O.touches[0].clientX:("pointerId"in O,O.clientX),K="touches"in O?O.touches[0].clientY:("pointerId"in O,O.clientY),ee=Q.getBoundingClientRect(),pe={x:L-ee.left,y:K-ee.top},ne=Q.cloneNode(!0);ne.style.position="fixed",ne.style.left=`${L-pe.x}px`,ne.style.top=`${K-pe.y}px`,ne.style.width=`${ee.width}px`,ne.style.height=`${ee.height}px`,ne.style.zIndex="9999",ne.style.opacity="0.8",ne.style.boxShadow="0 10px 25px rgba(0,0,0,0.3)",ne.style.pointerEvents="none",document.body.appendChild(ne),console.log(" stockItem:",x),console.log(" shelf:",se),D({isDragging:!0,draggedContainer:null,draggedElement:Q,floatingElement:ne,originalParent:null,originalPosition:"",originalIndex:-1,mouseOffset:pe,isMobileDrag:q,originalData:null,draggedStockItem:x,draggedStockShelf:se})},X=(x,se,Q)=>{if(!m||!Y(x.type))return;if(x.type==="sub_container"&&!p){h("","error");return}if(z.current={},Q.preventDefault(),Q.stopPropagation(),j.floatingElement)try{j.floatingElement.parentNode&&j.floatingElement.parentNode.removeChild(j.floatingElement)}catch(De){console.error(":",De)}const O=oe(),q="touches"in Q?Q.touches[0].clientX:("pointerId"in Q,Q.clientX),L="touches"in Q?Q.touches[0].clientY:("pointerId"in Q,Q.clientY),K=se.getBoundingClientRect(),ee={x:q-K.left,y:L-K.top},pe=ye(x.GUID);if(!pe)return;console.log("",x),console.log("",pe);const ne=se.cloneNode(!0);ne.style.position="fixed",ne.style.left=`${q-ee.x}px`,ne.style.top=`${L-ee.y}px`,ne.style.width=`${K.width}px`,ne.style.height=`${K.height}px`,ne.style.zIndex="9999",ne.style.opacity="0.8",ne.style.boxShadow="0 10px 25px rgba(0,0,0,0.3)",ne.style.pointerEvents="none",document.body.appendChild(ne);const xe=pe.parent.contents.findIndex(De=>De.GUID===x.GUID),me=JSON.parse(JSON.stringify(pe.parent.contents));pe.parent.contents.splice(xe,1),console.log(xe);const Ne=pe.parent,Te=Ae(pe.parent,x);pe.parent.contents=Te,console.log(pe.parent),D({isDragging:!0,draggedContainer:x,draggedElement:se,floatingElement:ne,originalParent:Ne,originalPosition:x.gird_position,originalIndex:xe,mouseOffset:ee,isMobileDrag:O,originalData:me})},B=x=>{if(!j.isDragging||!j.floatingElement)return;const se="touches"in x?x.touches[0].clientX:x.clientX,Q="touches"in x?x.touches[0].clientY:x.clientY;if(j.floatingElement.style.left=`${se-j.mouseOffset.x}px`,j.floatingElement.style.top=`${Q-j.mouseOffset.y}px`,j.draggedStockItem){const L=document.elementFromPoint(se,Q),K=L==null?void 0:L.closest("[data-stock-guid]");if(K){const pe=K.getAttribute("data-stock-guid"),ne=me=>{for(const Ne of me){if(Ne.type==="store_shelves"&&Ne.medMapStock){const Te=Ne.medMapStock.find(De=>De.GUID===pe);if(Te)return{stockItem:Te,shelf:Ne}}if(Ne.contents){const Te=ne(Ne.contents);if(Te)return Te}}return null},xe=ne(o);if(xe&&xe.stockItem.GUID!==j.draggedStockItem.GUID){const me=K.getBoundingClientRect(),Ne=me.left+me.width/2,Te=me.top+me.height/2,De=Math.abs(se-Ne),$e=Math.abs(Q-Te);let Me;De>$e?Me=se<Ne?"left":"right":Me=Q<Te?"top":"bottom",Z({container:xe.shelf,direction:null,element:K,stockItem:xe.stockItem,stockItemDirection:Me});return}}const ee=L==null?void 0:L.closest("[data-container-guid]");if(ee){const pe=ee.getAttribute("data-container-guid"),ne=ye(pe);if(ne&&ne.container.type==="store_shelves"){Z({container:ne.container,direction:null,element:ee});return}}Z(null);return}const O=document.elementFromPoint(se,Q),q=O==null?void 0:O.closest("[data-container-guid]");if(q){const L=q.getAttribute("data-container-guid"),K=ye(L);if(K){const ee=Ce(j.draggedContainer.type),pe=j.draggedContainer.type,ne=K.container.type;if(ee.includes(ne)){const xe=R(q,se,Q);if(pe==="med_box"&&!["left","right"].includes(xe)){Z(null);return}Z({container:K.container,direction:xe,element:q});return}if(pe==="parent_container"||pe==="sub_container"){let xe=q.parentElement;for(;xe;){if(xe.hasAttribute("data-container-guid")){const me=xe.getAttribute("data-container-guid"),Ne=ye(me);if(Ne&&ee.includes(Ne.container.type)){const Te=R(xe,se,Q);console.log(` : ${Ne.container.type} (${Ne.container.name})`),Z({container:Ne.container,direction:Te,element:xe});return}}xe=xe.parentElement}}}}Z(null)},re=async x=>{if(!j.isDragging)return;if(j.floatingElement)try{j.floatingElement.parentNode&&j.floatingElement.parentNode.removeChild(j.floatingElement)}catch(q){console.error(":",q)}if(j.draggedStockItem&&j.draggedStockShelf){if(console.log("StockItem "),console.log("Drop Target:",I),I){const q=[];if(I.stockItem&&I.stockItemDirection){console.log(` stockItem ${I.stockItem.GUID}  ${I.stockItemDirection} `);const L=I.container,K=j.draggedStockShelf,ee=j.draggedStockItem,pe=(I.stockItem.location||"0,0").split(","),ne=Number(pe[0]||"0"),xe=(ee.location||"0,0").split(","),me=Number(xe[0]||"0"),Ne=Number(xe[1]||"0");if(L.GUID===K.GUID){console.log("");const De=Number(pe[1]||"0");if(I.stockItemDirection==="top"||I.stockItemDirection==="bottom"){console.log("");let $e;if(I.stockItemDirection==="top"?$e=De:$e=De+1,me===ne){console.log(""),K.medMapStock.forEach(Re=>{const Oe=(Re.location||"0,0").split(","),Ee=Number(Oe[0]||"0"),Le=Number(Oe[1]||"0");if(Ee===me&&Re.GUID!==ee.GUID){if(Le>Ne){const xt=Le-1;xt>=$e?Re.location=`${Ee},${xt+1}`:Re.location=`${Ee},${xt}`,q.push({...Re})}else if(Le<Ne){const xt=$e>Ne?$e-1:$e;Le>=xt&&(Re.location=`${Ee},${Le+1}`,q.push({...Re}))}}});const Me=$e>Ne?$e-1:$e;ee.location=`${ne},${Me}`,q.push({...ee})}else console.log(""),K.medMapStock.forEach(Me=>{const Re=(Me.location||"0,0").split(","),Oe=Number(Re[0]||"0"),Ee=Number(Re[1]||"0");Oe===me&&Me.GUID!==ee.GUID&&Ee>Ne&&(Me.location=`${Oe},${Ee-1}`,q.push({...Me}))}),K.medMapStock.forEach(Me=>{const Re=(Me.location||"0,0").split(","),Oe=Number(Re[0]||"0"),Ee=Number(Re[1]||"0");Oe===ne&&Me.GUID!==ee.GUID&&Ee>=$e&&(Me.location=`${Oe},${Ee+1}`,q.push({...Me}))}),ee.location=`${ne},${$e}`,q.push({...ee})}else{console.log("");const $e=K.medMapStock.findIndex(Oe=>Oe.GUID===ee.GUID);$e!==-1&&K.medMapStock.splice($e,1),K.medMapStock.forEach(Oe=>{const Ee=(Oe.location||"0,0").split(","),Le=Number(Ee[0]||"0"),xt=Number(Ee[1]||"0");Le>me&&(Oe.location=`${Le-1},${xt}`,q.push({...Oe}))});let Me;const Re=ne>me?ne-1:ne;I.stockItemDirection==="left"?Me=Re:Me=Re+1,K.medMapStock.forEach(Oe=>{const Ee=(Oe.location||"0,0").split(","),Le=Number(Ee[0]||"0"),xt=Number(Ee[1]||"0");Le>=Me&&(Oe.location=`${Le+1},${xt}`,q.push({...Oe}))}),ee.location=`${Me},${Ne}`,K.medMapStock.push(ee),K.medMapStock.sort((Oe,Ee)=>{const Le=(Oe.location||"0,0").split(","),xt=(Ee.location||"0,0").split(",");return Number(Le[0]||"0")-Number(xt[0]||"0")}),q.push({...ee})}}else{console.log("");const De=Number(pe[1]||"0"),$e=K.medMapStock.findIndex(Me=>Me.GUID===ee.GUID);if($e!==-1&&K.medMapStock.splice($e,1),I.stockItemDirection==="top"||I.stockItemDirection==="bottom"){console.log(""),K.medMapStock.forEach(Re=>{const Oe=(Re.location||"0,0").split(","),Ee=Number(Oe[0]||"0"),Le=Number(Oe[1]||"0");Ee===me&&Le>Ne&&(Re.location=`${Ee},${Le-1}`,q.push({...Re}))});let Me;I.stockItemDirection==="top"?Me=De:Me=De+1,L.medMapStock.forEach(Re=>{const Oe=(Re.location||"0,0").split(","),Ee=Number(Oe[0]||"0"),Le=Number(Oe[1]||"0");Ee===ne&&Le>=Me&&(Re.location=`${Ee},${Le+1}`,q.push({...Re}))}),ee.location=`${ne},${Me}`,ee.shelf_guid=L.GUID,L.medMapStock.push(ee),L.medMapStock.sort((Re,Oe)=>{const Ee=(Re.location||"0,0").split(","),Le=(Oe.location||"0,0").split(",");return Number(Ee[0]||"0")-Number(Le[0]||"0")}),q.push({...ee})}else{console.log(""),K.medMapStock.forEach(Re=>{const Oe=(Re.location||"0,0").split(","),Ee=Number(Oe[0]||"0"),Le=Number(Oe[1]||"0");Ee>me&&(Re.location=`${Ee-1},${Le}`,q.push({...Re}))});let Me;I.stockItemDirection==="left"?Me=ne:Me=ne+1,L.medMapStock.forEach(Re=>{const Oe=(Re.location||"0,0").split(","),Ee=Number(Oe[0]||"0"),Le=Number(Oe[1]||"0");Ee>=Me&&(Re.location=`${Ee+1},${Le}`,q.push({...Re}))}),ee.location=`${Me},${Ne}`,ee.shelf_guid=L.GUID,L.medMapStock.push(ee),L.medMapStock.sort((Re,Oe)=>{const Ee=(Re.location||"0,0").split(","),Le=(Oe.location||"0,0").split(",");return Number(Ee[0]||"0")-Number(Le[0]||"0")}),q.push({...ee})}}}else if(I.container.type==="store_shelves"){console.log(" store_shelves ");const L=I.container,K=j.draggedStockShelf,ee=j.draggedStockItem,pe=(ee.location||"0,0").split(","),ne=Number(pe[0]||"0"),xe=K.medMapStock.findIndex(me=>me.GUID===ee.GUID);xe!==-1&&(K.medMapStock.splice(xe,1),K.medMapStock.forEach(me=>{const Ne=(me.location||"0,0").split(","),Te=Number(Ne[0]||"0"),De=Number(Ne[1]||"0");Te>ne&&(me.location=`${Te-1},${De}`,q.push({...me}))})),ee.location="0,0",ee.shelf_guid=L.GUID,L.medMapStock||(L.medMapStock=[]),L.medMapStock.forEach(me=>{const Ne=(me.location||"0,0").split(","),Te=Number(Ne[0]||"0"),De=Number(Ne[1]||"0");me.location=`${Te+1},${De}`,q.push({...me})}),L.medMapStock.push(ee),L.medMapStock.sort((me,Ne)=>{const Te=(me.location||"0,0").split(","),De=(Ne.location||"0,0").split(",");return Number(Te[0]||"0")-Number(De[0]||"0")}),q.push({...ee})}if(q.length>0){console.log(" stockItems:",q);try{const L=await ke.updateStock(q);if(L.Code===200){h("","success");try{const K=await ke.getMedMapByDepartment(s);if(K.Code===200&&K.Data){const ee=Mt.convertMedMapApiToFakeData(K.Data);Mt.validateConvertedData(ee)&&l(ee)}}catch(K){console.error(":",K)}}else h(L.Result||"","error")}catch(L){console.error(" stockItem :",L),h("","error")}}}D({isDragging:!1,draggedContainer:null,draggedElement:null,floatingElement:null,originalParent:null,originalPosition:"",originalIndex:-1,mouseOffset:{x:0,y:0},isMobileDrag:!1,originalData:null,draggedStockItem:null,draggedStockShelf:null}),Z(null);return}let se=null,Q=null,O=null;if(console.log("Drop Target:",I),console.log("Is Mobile Drag:",j.isMobileDrag),j.isMobileDrag)if(I){se=I.direction,O=I.container;const q=ye(j.draggedContainer.GUID);let L=null;if(q){L=q.parent.GUID;const Ne=q.parent.contents.findIndex(De=>De.GUID===j.draggedContainer.GUID);q.parent.contents.splice(Ne,1);const Te=Ae(q.parent,j.draggedContainer);q.parent.contents=Te}const K=ye(I.container.Master_GUID||I.container.GUID);let ee=I.container;if(L&&K&&K.container.GUID===L){const Ne=K.container.contents.find(Te=>Te.GUID===I.container.GUID);Ne&&(ee=Ne,console.log(":",Ne.gird_position))}const pe=ve(ee.gird_position||"0,0");let ne=pe.row,xe=pe.col;switch(I.direction){case"top":ne=Math.max(0,pe.row);break;case"bottom":ne=pe.row+1;break;case"left":xe=Math.max(0,pe.col);break;case"right":xe=pe.col+1;break}let me=(K==null?void 0:K.container)||I.container;if(j.draggedContainer.class!=I.class&&(me=I),j.draggedContainer.type==="med_box"&&I.container.type!=="med_box")if(console.log(""),me=I.container,me.contents.length>0){let Ne=0,Te=0;me.contents.forEach(De=>{const $e=ve(De.gird_position||"0,0").row,Me=ve(De.gird_position||"0,0").col;Ne>$e&&(Ne=$e),Te>Me&&(Te=Me)});for(let De=0;De<=Te;De++)for(let $e=0;$e<=Ne;$e++){const Me=`${De},${$e}`;me.contents.filter(Oe=>Oe.grid_position===Me).length===0&&(ne=De,xe=$e)}}else ne=0,xe=0;Q=me,te(me,j.draggedContainer,ne,xe,I.direction)}else console.log(""),j.originalData&&j.originalParent&&(j.originalParent.contents=JSON.parse(JSON.stringify(j.originalData))),se=null,O=null,Q=j.originalParent;else if(I){se=I.direction,O=I.container;const q=ye(j.draggedContainer.GUID);let L=null;if(console.log("===  ==="),console.log(" GUID:",j.draggedContainer.GUID),console.log(":",j.draggedContainer.gird_position),q){L=q.parent.GUID,console.log(" GUID:",L),console.log(" contents :",q.parent.contents.length);const Ne=q.parent.contents.findIndex(De=>De.GUID===j.draggedContainer.GUID);q.parent.contents.splice(Ne,1),console.log(" contents :",q.parent.contents.length);const Te=Ae(q.parent,j.draggedContainer);q.parent.contents=Te,console.log(":"),q.parent.contents.forEach(De=>{console.log(`  - ${De.GUID}: ${De.gird_position}`)})}const K=ye(I.container.Master_GUID||I.container.GUID);let ee=I.container;if(console.log(":",I.container.gird_position),L&&K&&K.container.GUID===L){console.log(" ");const Ne=K.container.contents.find(Te=>Te.GUID===I.container.GUID);Ne&&(ee=Ne,console.log(":",Ne.gird_position))}else console.log(" ");const pe=ve(ee.gird_position||"0,0");let ne=pe.row,xe=pe.col;switch(I.direction){case"top":ne=Math.max(0,pe.row);break;case"bottom":ne=pe.row+1;break;case"left":xe=Math.max(0,pe.col);break;case"right":xe=pe.col+1;break}console.log("------",I),console.log("------",j.draggedContainer);let me=(K==null?void 0:K.container)||I.container;if(console.log(j.draggedContainer.class),console.log(I.container.class),console.log(j.draggedContainer.class!=I.container.class),j.draggedContainer.class!=I.container.class&&(me=I.container,console.log("------"),console.log("------",I),console.log("------",j.draggedContainer),console.log("------",me)),j.draggedContainer.type==="med_box"&&I.container.type!=="med_box")if(console.log(""),me=I.container,me.contents.length>0){let Ne=0,Te=0;me.contents.forEach(De=>{const $e=ve(De.gird_position||"0,0").row,Me=ve(De.gird_position||"0,0").col;Ne>$e&&(Ne=$e),Te>Me&&(Te=Me)});for(let De=0;De<=Te;De++)for(let $e=0;$e<=Ne;$e++){const Me=`${De},${$e}`;me.contents.filter(Oe=>Oe.grid_position===Me).length===0&&(ne=De,xe=$e)}}else ne=0,xe=0;Q=me,te(me,j.draggedContainer,ne,xe,I.direction)}else console.log(""),j.originalData&&j.originalParent&&(j.originalParent.contents=JSON.parse(JSON.stringify(j.originalData))),se=null,O=null,Q=j.originalParent;D({isDragging:!1,draggedContainer:null,draggedElement:null,floatingElement:null,originalParent:null,originalPosition:"",originalIndex:-1,mouseOffset:{x:0,y:0},isMobileDrag:!1,originalData:null,draggedStockItem:null,draggedStockShelf:null}),Z(null),console.log("Drop Direction:",se),console.log("Parent Object:",Q),console.log("Target Object:",O),console.log("API",z),await Dh(z)};f.useEffect(()=>{if(j.isDragging)if(oe()){const se=q=>{q.preventDefault(),B(q)},Q=q=>re(),O=q=>re();return document.addEventListener("pointermove",se,{passive:!1}),document.addEventListener("pointerup",Q),document.addEventListener("pointercancel",O),()=>{document.removeEventListener("pointermove",se),document.removeEventListener("pointerup",Q),document.removeEventListener("pointercancel",O)}}else{const se=L=>B(L),Q=L=>re(),O=L=>{L.preventDefault(),B(L)},q=L=>re();return document.addEventListener("mousemove",se),document.addEventListener("mouseup",Q),document.addEventListener("touchmove",O,{passive:!1}),document.addEventListener("touchend",q),()=>{document.removeEventListener("mousemove",se),document.removeEventListener("mouseup",Q),document.removeEventListener("touchmove",O),document.removeEventListener("touchend",q)}}},[j.isDragging,I]),f.useEffect(()=>()=>{if(j.floatingElement)try{j.floatingElement.parentNode&&j.floatingElement.parentNode.removeChild(j.floatingElement)}catch(x){console.error(":",x)}},[j.floatingElement]),f.useEffect(()=>{const x=Q=>{Q.code==="Space"&&!Q.repeat&&(Q.preventDefault(),G(!0))},se=Q=>{Q.code==="Space"&&(Q.preventDefault(),G(!1),u(!1))};return window.addEventListener("keydown",x),window.addEventListener("keyup",se),()=>{window.removeEventListener("keydown",x),window.removeEventListener("keyup",se)}},[]);const ie=f.useCallback(x=>{var Q;if(m)return;if(x.ctrlKey||x.metaKey){x.preventDefault(),x.stopPropagation();const O=(Q=n.current)==null?void 0:Q.getBoundingClientRect();if(!O)return;const q=x.clientX-O.left,L=x.clientY-O.top,K=x.deltaY>0?.9:1.1,ee=Math.max(.1,Math.min(5,S.scale*K)),pe=ee/S.scale,ne=q-(q-S.x)*pe,xe=L-(L-S.y)*pe;A({x:ne,y:xe,scale:ee})}},[S,m]),$=f.useCallback(x=>{m||!T||(u(!0),k({x:x.clientX,y:x.clientY}),v({x:x.clientX,y:x.clientY}),w(!1),x.preventDefault())},[m,T]),V=f.useCallback(x=>{if(!d||m)return;const se=x.clientX-P.x,Q=x.clientY-P.y;if(_){const O=Math.abs(x.clientX-_.x),q=Math.abs(x.clientY-_.y);(O>5||q>5)&&w(!0)}A(O=>({...O,x:O.x+se,y:O.y+Q})),k({x:x.clientX,y:x.clientY})},[d,P,m,_]),F=f.useCallback(()=>{u(!1),v(null)},[]),[J,ae]=f.useState(null),[ge,de]=f.useState({x:0,y:0}),we=x=>{if(x.length<2)return null;const se=x[0],Q=x[1];return Math.sqrt(Math.pow(Q.clientX-se.clientX,2)+Math.pow(Q.clientY-se.clientY,2))},Se=x=>{if(x.length===1)return{x:x[0].clientX,y:x[0].clientY};const se=x[0],Q=x[1];return{x:(se.clientX+Q.clientX)/2,y:(se.clientY+Q.clientY)/2}},Ie=f.useCallback(x=>{if(!m){if(x.touches.length===2){const se=we(x.touches),Q=Se(x.touches);ae(se),de(Q)}else if(x.touches.length===1){const se=x.touches[0];k({x:se.clientX,y:se.clientY}),u(!0)}}},[m]),tt=f.useCallback(x=>{var se;if(!m){if(x.preventDefault(),x.touches.length===2&&J!==null){const Q=we(x.touches),O=Se(x.touches);if(Q&&J){const q=(se=n.current)==null?void 0:se.getBoundingClientRect();if(!q)return;const L=Q/J,K=Math.max(.1,Math.min(5,S.scale*L)),ee=O.x-q.left,pe=O.y-q.top,ne=K/S.scale,xe=ee-(ee-S.x)*ne,me=pe-(pe-S.y)*ne;A({x:xe,y:me,scale:K}),ae(Q),de(O)}}else if(x.touches.length===1&&d){const Q=x.touches[0],O=Q.clientX-P.x,q=Q.clientY-P.y;A(L=>({...L,x:L.x+O,y:L.y+q})),k({x:Q.clientX,y:Q.clientY})}}},[S,J,d,P,m]),Pe=f.useCallback(()=>{ae(null),u(!1)},[]);f.useEffect(()=>{const x=n.current;if(x)return x.addEventListener("wheel",ie,{passive:!1}),()=>x.removeEventListener("wheel",ie)},[ie]);const lt=()=>!o||o.length===0?[]:o,He=x=>{if(!x||x.length===0)return{sortedContents:[],maxRow:0,maxCol:0};const se=x.map(L=>({...L,gridPos:ve(L.gird_position||"0,0")})),Q=Math.max(...se.map(L=>L.gridPos.row),0),O=Math.max(...se.map(L=>L.gridPos.col),0);return{sortedContents:se.sort((L,K)=>L.gridPos.row!==K.gridPos.row?L.gridPos.row-K.gridPos.row:L.gridPos.col-K.gridPos.col),maxRow:Q,maxCol:O}},$t=lt(),Gt=Math.max(...$t.map(x=>ve(x.gird_position||"0,0").row),0),Vn=Math.max(...$t.map(x=>ve(x.gird_position||"0,0").col),0),Xt=x=>{const se=O=>{if(O.width&&Array.isArray(O.width)&&typeof O.width_index=="number"&&O.width_index>=0&&O.width_index<O.width.length){const L=parseFloat(O.width[O.width_index]);if(!isNaN(L)){const K=L*20;return Math.max(200,K)}}return 200},Q=O=>{switch(O){case"parent_container":return"bg-pink-50 border-pink-300";case"sub_container":return"bg-blue-50 border-blue-300";case"dispensing_shelves":case"store_shelves":return"bg-green-50 border-green-300";case"med_box":return"bg-yellow-50 border-yellow-300";case"grid_draw":case"list_draw":return"bg-violet-50 border-violet-300";default:return"bg-gray-50 border-gray-300"}};switch(x.type){case"med_box":return se(x),r.jsxs("div",{"data-container-guid":x.GUID,className:`${x.type!=="sub_container"?"border-2 rounded-lg shadow-sm":""} ${Q(x.type||0)} min-h-[80px] flex flex-col flex-shrink-0 h-full overflow-hidden`,children:[r.jsx("div",{onMouseDown:m&&Y(x.type)&&!oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,onTouchStart:m&&Y(x.type)&&!oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,onPointerDown:m&&Y(x.type)&&oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,className:m&&Y(x.type)?"cursor-move":"",children:r.jsx(Zr,{content:x,isAdminMode:p})}),r.jsx("div",{className:"flex-1 p-1",children:qn(x)})]},x.GUID);case"sub_container":case"parent_container":return r.jsxs("div",{"data-container-guid":x.GUID,className:`${Q(x.type||0)} border-2 overflow-hidden rounded-lg shadow-sm min-h-[80px] flex flex-col h-full`,children:[r.jsx("div",{onMouseDown:m&&Y(x.type)&&!oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,onTouchStart:m&&Y(x.type)&&!oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,onPointerDown:m&&Y(x.type)&&oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,className:m&&Y(x.type)?"cursor-move":"",children:r.jsx(Zr,{content:x,isAdminMode:p})}),r.jsx("div",{className:"flex-1  p-1",children:qn(x)})]},x.GUID);case"grid_draw":return r.jsxs("div",{"data-container-guid":x.GUID,className:`${x.type!=="sub_container"?"border-2 rounded-lg shadow-sm":""} ${Q(x.type||0)} min-h-[80px] flex flex-col h-full overflow-hidden`,children:[r.jsx("div",{onMouseDown:m&&Y(x.type)&&!oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,onTouchStart:m&&Y(x.type)&&!oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,onPointerDown:m&&Y(x.type)&&oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,className:m&&Y(x.type)?"cursor-move":"",children:r.jsx(Zr,{content:x,isAdminMode:p})}),r.jsx("div",{className:"flex-1 p-1 flex items-center",children:qn(x)})]},x.GUID);case"dispensing_shelves":case"store_shelves":return r.jsxs("div",{"data-container-guid":x.GUID,className:`${x.type!=="sub_container"?"border-2 rounded-lg shadow-sm":""} ${Q(x.type||0)} min-h-[80px] flex flex-col h-full overflow-hidden`,children:[r.jsx("div",{onMouseDown:m&&Y(x.type)&&!oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,onTouchStart:m&&Y(x.type)&&!oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,onPointerDown:m&&Y(x.type)&&oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,className:m&&Y(x.type)?"cursor-move":"",children:r.jsx(Zr,{content:x,isAdminMode:p})}),r.jsx("div",{className:"flex-1 p-1 h-full overflow-hidden",children:qn(x)})]},x.GUID);default:return r.jsxs("div",{"data-container-guid":x.GUID,className:`${x.type!=="sub_container"?"border-2 rounded-lg shadow-sm":""} ${Q(x.type||0)} min-h-[80px] flex flex-col h-full overflow-hidden ${x.type=="none"?"opacity-0":""}`,children:[r.jsx("div",{onMouseDown:m&&Y(x.type)&&!oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,onTouchStart:m&&Y(x.type)&&!oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,onPointerDown:m&&Y(x.type)&&oe()?O=>X(x,O.currentTarget.closest("[data-container-guid]"),O):void 0,className:m&&Y(x.type)?"cursor-move":"",children:r.jsx(Zr,{content:x,isAdminMode:p})}),r.jsx("div",{className:"flex-1 p-1",children:qn(x)})]},x.GUID)}},qn=x=>{const se=(Q,O,q)=>{const L=Array(O+1).fill(null).map(()=>Array(q+1).fill(!1)),K={};return Q.forEach(ee=>{const pe=ve(ee.gird_position||"0,0");K[`${pe.row},${pe.col}`]=ee,L[pe.row][pe.col]=!0}),r.jsx("table",{className:"w-full h-full",style:{borderCollapse:"none",borderSpacing:"0px"},children:r.jsx("tbody",{children:Array.from({length:O+1},(ee,pe)=>r.jsx("tr",{className:"h-full",style:{height:`${100/(O+1)}%`,minHeight:"80px"},children:Array.from({length:q+1},(ne,xe)=>{const me=`${pe},${xe}`,Ne=K[me];return Ne?r.jsxs("td",{className:"align-top bg-transparent",style:{width:`${100/(q+1)}%`,height:`${100/(O+1)}%`,minHeight:"80px",border:"none",position:"relative"},children:[Xt(Ne),(I==null?void 0:I.container.GUID)===Ne.GUID&&r.jsx("div",{className:"absolute inset-0 pointer-events-none",children:r.jsx("div",{className:`absolute bg-blue-400 opacity-50 ${I.direction==="top"?"top-0 left-0 right-0 h-1":I.direction==="bottom"?"bottom-0 left-0 right-0 h-1":I.direction==="left"?"left-0 top-0 bottom-0 w-1":"right-0 top-0 bottom-0 w-1"}`})})]},xe):r.jsx("td",{className:"p-1 align-top bg-transparent",style:{width:`${100/(q+1)}%`,height:`${100/(O+1)}%`,minHeight:"80px",border:"none"},children:r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-sm",children:""})},xe)})},pe))})})};switch(x.type){case"parent_container":case"sub_container":if(x.contents&&x.contents.length>0){const{sortedContents:ne,maxRow:xe,maxCol:me}=He(x.contents);return se(ne,xe,me)}else return r.jsx("table",{className:"bg-transparent w-full h-full",style:{borderCollapse:"separate",borderSpacing:"1px"},children:r.jsx("tbody",{children:r.jsx("tr",{})})});case"dispensing_shelves":if(x.contents&&x.contents.length>0){const{sortedContents:ne,maxRow:xe,maxCol:me}=He(x.contents);return se(ne,xe,me)}else return r.jsx("table",{className:"bg-transparent w-full h-full",style:{borderCollapse:"separate",borderSpacing:"0px"},children:r.jsx("tbody",{children:r.jsx("tr",{children:r.jsx("td",{className:"p-4 text-center text-gray-500 bg-transparent",children:r.jsx("div",{className:"text-base",children:""})})})})});case"store_shelves":if(x.medMapStock&&x.medMapStock.length>0){const ne=x.medMapStock,xe={};ne.forEach(De=>{const $e=(De.location||"0,0").split(","),Me=Number($e[0]||"0"),Re=Number($e[1]||"0");xe[Me]||(xe[Me]=[]),xe[Me].push({...De,_position:Me,_depth:Re})});const me=Object.keys(xe).map(Number).sort((De,$e)=>De-$e),Ne=me.length;Math.max(...me.map(De=>xe[De].length));const Te=x.width?x.width*5:500;return r.jsx("div",{className:"flex h-full",style:{minWidth:`${Te}px`},children:me.map(De=>{const $e=xe[De].sort((Ee,Le)=>Le._depth-Ee._depth),Me=Ne>0?100/Ne:100,Re=$e.length,Oe=Re>0?100/Re:100;return r.jsx("div",{className:"flex flex-shrink-0 flex-col m-1",style:{width:`calc(${Me}% - 8px)`,minWidth:"160px"},children:$e.map((Ee,Le)=>{const xt=Le===Re-1;return r.jsx("div",{className:`relative ${xt?"":"mb-1"}`,style:{height:`calc(${Oe}% - ${xt?"0px":"0.25rem"})`},"data-stock-guid":Ee.GUID,children:r.jsxs("div",{className:`border-2 bg-yellow-50 border-yellow-400 rounded-lg p-2 h-full flex flex-col justify-center items-center cursor-pointer bg-white hover:bg-yellow-100 hover:border-yellow-500 hover:shadow-md transition-all ${m?"cursor-move":""}`,onMouseDown:ze=>{m?E(Ee,x,ze.currentTarget.closest("[data-stock-guid]"),ze):!d&&!T&&(v({x:ze.clientX,y:ze.clientY}),w(!1))},onMouseUp:ze=>{if(!d&&!T&&!H&&_&&!m){const un=Math.abs(ze.clientX-_.x),Hr=Math.abs(ze.clientY-_.y);un<=5&&Hr<=5&&(ze.stopPropagation(),c(x,Ee))}m||(v(null),w(!1))},onTouchStart:ze=>{if(m&&oe())E(Ee,x,ze.currentTarget.closest("[data-stock-guid]"),ze);else if(!d&&!m){const un=ze.touches[0];v({x:un.clientX,y:un.clientY}),w(!1)}},onTouchEnd:ze=>{if(!d&&!H&&_&&!m){const un=ze.changedTouches[0],Hr=Math.abs(un.clientX-_.x),rl=Math.abs(un.clientY-_.y);Hr<=5&&rl<=5&&(ze.stopPropagation(),c(x,Ee))}m||(v(null),w(!1))},onPointerDown:ze=>{m&&oe()&&E(Ee,x,ze.currentTarget.closest("[data-stock-guid]"),ze)},children:[r.jsx("div",{className:"py-1 text-base font-semibold text-gray-800 flex text-center text-ellipsis whitespace-normal items-center flex-1",children:Ee.name||Ee.material_no}),r.jsxs("div",{className:"w-full flex justify-between items-end",children:[r.jsx("div",{className:"",children:r.jsxs("div",{className:"mt-1",children:["[ ",+Ee.qty||0," ]"]})}),r.jsx("div",{className:"flex justify-end items-end mt-2",children:r.jsx("button",{onMouseDown:ze=>{ze.stopPropagation()},onMouseUp:ze=>{ze.stopPropagation()},onTouchStart:ze=>{ze.stopPropagation()},onTouchEnd:ze=>{ze.stopPropagation()},onClick:ze=>Fr(Ee,x,ze),className:"text-red-500 hover:text-red-600 rounded-full p-2 transition-all z-10",title:"",children:r.jsx(Sr,{className:"w-6 h-6"})})})]})]})},Ee.GUID||Le)})},De)})})}else if(x.contents&&x.contents.length>0){const{sortedContents:ne,maxRow:xe,maxCol:me}=He(x.contents);return se(ne,xe,me)}else return r.jsx("table",{className:"bg-transparent w-full h-full",style:{borderCollapse:"separate",borderSpacing:"0px"},children:r.jsx("tbody",{children:r.jsx("tr",{children:r.jsx("td",{className:"p-4 text-center text-gray-500 bg-transparent",children:r.jsx("div",{className:"text-base",children:""})})})})});case"none":if(x.contents&&x.contents.length>0){const{sortedContents:ne,maxRow:xe,maxCol:me}=He(x.contents);return se(ne,xe,me)}else return r.jsx("table",{className:"bg-transparent w-full h-full",style:{borderCollapse:"separate",borderSpacing:"0px"},children:r.jsx("tbody",{children:r.jsx("tr",{children:r.jsx("td",{className:"p-4 text-center text-gray-500 bg-transparent",children:r.jsx("div",{className:"text-base",children:""})})})})});case"grid_draw":const Q=Math.max(...x.Boxes.flat().map(ne=>+ne.Row+ +ne.Height-1)),O=Math.max(...x.Boxes.flat().map(ne=>+ne.Column+ +ne.Width-1)),q=Q+1,L=O+1,K=x.Boxes.flat(),ee=Array(q).fill(null).map(()=>Array(L).fill(!1)),pe={};return K.forEach(ne=>{ne.Slave||(pe[`${ne.Row},${ne.Column}`]=ne)}),K.forEach(ne=>{if(!ne.Slave&&(ne.Width>1||ne.Height>1))for(let xe=ne.Row;xe<ne.Row+ne.Height;xe++)for(let me=ne.Column;me<ne.Column+ne.Width;me++)(xe!==ne.Row||me!==ne.Column)&&(ee[xe][me]=!0)}),r.jsxs("div",{className:"bg-violet-100 h-20 flex ml-2 mt-2 mb-6 rounded-xl border-2 border-violet-400 w-[140px] items-center justify-center",children:[r.jsx("div",{className:"h-[60%] bg-violet-400 w-[3%] rounded-xl"}),r.jsx("div",{className:"h-[80%] border-2 border-violet-400 w-[82%] mx-1",children:r.jsx("div",{className:"flex items-center justify-center text-base text-violet-400 h-[100%]"})}),r.jsx("div",{className:"h-[60%] bg-violet-400 w-[3%]"})]});case"list_draw":return r.jsxs("div",{className:"bg-violet-100 h-20 flex ml-2 mt-2 mb-6 rounded-xl border-2 border-violet-400 w-[140px] items-center justify-center",children:[r.jsx("div",{className:"h-[60%] bg-violet-400 w-[3%] rounded-xl"}),r.jsx("div",{className:"h-[80%] border-2 border-violet-400 w-[82%] mx-1",children:r.jsx("div",{className:"flex items-center justify-center text-base text-violet-400 h-[100%]"})}),r.jsx("div",{className:"h-[60%] bg-violet-400 w-[3%]"})]});case"med_box":return x.med_info&&x.med_info.length>0?r.jsxs("div",{className:"text-base text-left h-full min-h-[40px] max-w-[200px] min-w-[200px] p-1 flex items-center justify-between flex-col",children:[r.jsx("div",{className:"text-gray-700 font-bold truncate w-full",children:x.med_info[0].name}),r.jsxs("div",{className:"text-gray-700 w-full flex justify-between px-1",children:[r.jsxs("div",{children:[x.box_type,""]}),r.jsxs("div",{children:[x.width[x.width_index],"cm"]})]})]}):r.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:r.jsx("div",{className:"text-base",children:""})});default:return x.contents&&x.contents.length>0?r.jsx("div",{className:"space-y-2",children:x.contents.map(ne=>Xt(ne))}):r.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:r.jsxs("div",{className:"text-base",children:[": ",x.type]})})}},Gr=x=>{if(ve(x.gird_position||"0,0"),x.type!==""&&x.type!=="")return null;const se=Q=>{if(!Q||Q.length===0)return r.jsx("table",{className:"w-full h-full border-none",children:r.jsx("tbody",{children:r.jsx("tr",{children:r.jsx("td",{className:"p-4 text-center text-gray-500",children:r.jsx("div",{className:"text-center",children:r.jsx("div",{className:"text-base",children:""})})})})})});const{sortedContents:O,maxRow:q,maxCol:L}=He(Q),K=Array(q+1).fill(null).map(()=>Array(L+1).fill(!1)),ee={};return O.forEach(pe=>{const ne=ve(pe.gird_position||"0,0");ee[`${ne.row},${ne.col}`]=pe,K[ne.row][ne.col]=!0}),r.jsx("table",{className:"w-full h-full",style:{borderCollapse:"none",borderSpacing:"0px"},children:r.jsx("tbody",{children:Array.from({length:q+1},(pe,ne)=>r.jsx("tr",{className:"h-full",children:Array.from({length:L+1},(xe,me)=>{const Ne=`${ne},${me}`,Te=ee[Ne];return Te?r.jsxs("td",{className:"p-1 align-top bg-transparent",style:{width:`${100/(L+1)}%`,height:`${100/(q+1)}%`,minHeight:"120px",border:"none",position:"relative"},children:[Xt(Te),(I==null?void 0:I.container.GUID)===Te.GUID&&r.jsx("div",{className:"absolute inset-0 pointer-events-none",children:r.jsx("div",{className:`absolute bg-blue-400 opacity-50 ${I.direction==="top"?"top-0 left-0 right-0 h-1":I.direction==="bottom"?"bottom-0 left-0 right-0 h-1":I.direction==="left"?"left-0 top-0 bottom-0 w-1":"right-0 top-0 bottom-0 w-1"}`})})]},me):r.jsx("td",{className:"p-1 align-top bg-transparent",style:{width:`${100/(L+1)}%`,height:`${100/(q+1)}%`,minHeight:"120px",border:"1px dashed #e5e7eb"},children:r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-sm",children:""})},me)})},ne))})})};return r.jsxs("div",{"data-container-guid":x.GUID,className:"border-2 rounded-lg shadow-lg bg-orange-50 border-orange-300 min-h-[120px] flex flex-col overflow-hidden w-full h-full",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b-2 bg-orange-100 border-b-orange-200",children:[r.jsx("div",{className:"flex items-center space-x-2",children:r.jsx("span",{className:"text-lg font-semibold text-gray-800",children:x.name})}),r.jsx("div",{className:"flex items-center space-x-1",children:r.jsx("button",{className:"p-1 hover:bg-black/10 rounded transition-colors",onClick:Q=>{Q.stopPropagation(),console.log(" "),console.log(" :",x),x?(console.log("  openAddParentContainerModal"),i(x)):console.warn(" ")},title:"",children:r.jsx(Et,{className:"w-6 h-6 text-green-700"})})})]}),r.jsx("div",{className:`flex-1 bg-orange-50 ${(I==null?void 0:I.container.GUID)===x.GUID?"ring-2 ring-blue-400 ring-inset":""}`,children:se(x.contents||[])})]},x.GUID)},As=f.useCallback(x=>{if(console.log(" locateDrugOnCanvas :",x),console.log(" apiDepartmentData:",!!o),console.log(" canvasRef.current:",!!n.current),!o||!n.current){console.warn(" ",{hasApiData:!!o,hasCanvasRef:!!n.current});return}const se=x[0].CODE||x[0].code;if(console.log(" :",se),!se){console.warn(" ");return}console.log(" :",se);const Q=q=>{for(const L of q){if(L.type==="grid_draw"&&L.Boxes){for(const K of L.Boxes)for(const ee of K)if(ee.Code===se){const pe=document.querySelector(`[data-container-guid="${L.GUID}"]`);if(pe)return console.log("  (grid_draw):",L),{element:pe,bounds:pe.getBoundingClientRect()}}}if(L.type==="list_draw"&&L.drugs&&L.drugs.some(ee=>ee.code===se)){const ee=document.querySelector(`[data-container-guid="${L.GUID}"]`);if(ee)return console.log("  (list_draw):",L),{element:ee,bounds:ee.getBoundingClientRect()}}if((L.type==="store_shelves"||L.type==="dispensing_shelves")&&L.medMapStock&&L.medMapStock.some(ee=>ee.code===se||ee.material_no===se)){const ee=document.querySelector(`[data-container-guid="${L.GUID}"]`);if(ee)return console.log("  (store_shelves):",L),{element:ee,bounds:ee.getBoundingClientRect()}}if(L.type==="med_box"&&L.med_info&&L.med_info.length>0&&L.med_info.some(ee=>ee.code===se)){const ee=document.querySelector(`[data-container-guid="${L.GUID}"]`);if(ee)return console.log("  (med_box):",L),{element:ee,bounds:ee.getBoundingClientRect()}}if(L.contents&&L.contents.length>0){const K=Q(L.contents);if(K)return K}}return null},O=Q(o);if(O){const q=n.current.getBoundingClientRect(),L=O.bounds,K=(L.left+L.right)/2,ee=(L.top+L.bottom)/2,pe=(K-q.left-S.x)/S.scale,ne=(ee-q.top-S.y)/S.scale,xe=q.width/2,me=q.height/2,Ne=xe-pe*S.scale,Te=me-ne*S.scale;A(De=>({...De,x:Ne,y:Te})),console.log(" ",{elementScreenCenter:{x:K,y:ee},elementCanvasPos:{x:pe,y:ne},screenCenter:{x:xe,y:me},newTransform:{x:Ne,y:Te}}),h(`${x.CHT_NAME||x.NAME||se}`,"success")}else console.warn(" "),h("","error")},[o,S,h]);f.useImperativeHandle(t,()=>(console.log(" useImperativeHandle  ref "),{locateDrug:As}));const Fr=async(x,se,Q)=>{if(Q.stopPropagation(),Q.preventDefault(),!!window.confirm(` ${x.name||x.material_no} `))try{const q=await ke.deleteStockByGUID([x.GUID]);if(q.Code===200){const L=se.medMapStock.findIndex(K=>K.GUID===x.GUID);L!==-1&&(se.medMapStock.splice(L,1),se.medMapStock.forEach((K,ee)=>{K.location=String(ee)})),h("","success")}else h(q.Result||"","error")}catch(q){console.error(" stock :",q),h("","error")}},nl=async x=>{if(x.key==="Enter"&&M.trim()&&!le){x.preventDefault(),ue(!0);const se=performance.now();try{console.log(" [] :",M);const Q=performance.now(),O=await ke.searchByBarCode(M.trim()),q=performance.now();if(console.log(` [] API: ${(q-Q).toFixed(2)}ms`),console.log(" :",O),O.Code===200){console.log(" :",O.Data),h("","success");const L=performance.now();As(O.Data);const K=performance.now();console.log(` [] : ${(K-L).toFixed(2)}ms`),U("");const ee=performance.now();console.log(` [] : ${(ee-se).toFixed(2)}ms`)}else O.Code===-200&&O.Result===""?(console.log(" "),h("","error"),y(M.trim()),U("")):(console.log(" :",O.Result),h(O.Result||"","error"))}catch(Q){console.error(":",Q),h("","error")}finally{ue(!1)}}};return r.jsxs("div",{className:"relative w-full h-full overflow-hidden bg-gray-50",children:[r.jsx("div",{className:"absolute md:bottom-4 md:left-4 bottom-16 left-[50%] md:translate-x-[0%] translate-x-[-50%] z-10",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg flex items-center overflow-hidden border border-gray-200",children:[r.jsx("input",{type:"text",value:M,onChange:x=>U(x.target.value),onKeyDown:nl,placeholder:"...",className:"px-4 py-2 w-50 focus:outline-none text-gray-700 disabled:opacity-50",disabled:le}),r.jsx("button",{onClick:()=>g("track_Drug_mode"),className:"p-2",title:"",disabled:le,children:r.jsx(Ur,{className:"w-6 h-6 text-blue-600"})})]})}),r.jsx("div",{className:"absolute bottom-4 right-4 z-10 flex gap-2",children:r.jsx("button",{onClick:()=>C(!m),className:`rounded-lg shadow-lg p-2 transition-colors ${m?"bg-red-500 text-white hover:bg-red-600":"bg-white text-gray-700 hover:bg-gray-50"}`,title:m?"Unlock Canvas":"Lock Canvas",children:m?r.jsx(vi,{className:"w-6 h-6"}):r.jsx(Zu,{className:"w-6 h-6"})})}),r.jsx("div",{ref:n,className:`w-full h-full relative ${T&&!m?"cursor-grab":"cursor-default"} ${d?"cursor-grabbing":""}`,onMouseDown:$,onMouseMove:V,onMouseUp:F,onMouseLeave:F,onTouchStart:Ie,onTouchMove:tt,onTouchEnd:Pe,children:r.jsxs("div",{className:"absolute inset-0 origin-top-left",style:{transform:`translate(${S.x}px, ${S.y}px) scale(${S.scale})`,transformOrigin:"0 0"},children:[r.jsx("div",{className:"relative","data-canvas-content":!0,children:r.jsx("table",{className:"h-full",style:{borderCollapse:"separate",borderSpacing:`${be}px`,minWidth:"fit-content",minHeight:"fit-content"},children:r.jsx("tbody",{children:Array.from({length:Gt+1},(x,se)=>r.jsx("tr",{children:Array.from({length:Vn+1},(Q,O)=>{const q=$t.find(L=>{const K=ve(L.gird_position||"0,0");return K.row===se&&K.col===O});return q?r.jsx("td",{className:"align-top",style:{minWidth:"150px",minHeight:"120px",border:"none"},children:Gr(q)},O):r.jsx("td",{className:"align-top",style:{minWidth:"150px",minHeight:"120px",border:"none"},children:r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-base"})},O)})},se))})})}),e]})})]})});ef.displayName="DrugCanvas";const Dh=async e=>{if(console.log(e),Object.keys(e.current).length===0){console.log("");return}console.log(" :",e.current);const t=[],n=[],s=[],o=[],l=[];Object.values(e.current).forEach(i=>{var g,y,h,p,b;console.log("API REQ",i);const c={GUID:i.GUID,position:i.position,Master_GUID:i.Master_GUID,serverName:i.serverName,serverType:i.serverType};switch(i.type){case"med_box":t.push(c);break;case"grid_draw":case"list_draw":n.push(c);break;case"dispensing_shelves":case"store_shelves":s.push(c);break;case"parent_container":const N={...c,absolute_position:`${(g=i.containerData)==null?void 0:g.position.x},${(y=i.containerData)==null?void 0:y.position.y}`,position:((h=i.containerData)==null?void 0:h.gird_position)||i.position,name:((p=i.containerData)==null?void 0:p.name)||"",ip:((b=i.containerData)==null?void 0:b.ip)||""};o.push(N);break;case"sub_container":l.push(c);break;default:console.warn(":",i.type)}});const a=[];if(t.length>0&&(console.log(" :",t),a.push(ke.updateMedMapBox(t).then(i=>({type:"med_box",response:i,count:t.length})).catch(i=>({type:"med_box",error:i,count:t.length})))),n.length>0&&(console.log(" :",n),a.push(ke.updateMedMapDrawer(n).then(i=>({type:"drawer",response:i,count:n.length})).catch(i=>({type:"drawer",error:i,count:n.length})))),s.length>0&&(console.log(" :",s),a.push(ke.updateMedMapShelf(s).then(i=>({type:"shelf",response:i,count:s.length})).catch(i=>({type:"shelf",error:i,count:s.length})))),o.length>0&&(console.log(" :",o),o.forEach(i=>{a.push(ke.updateContainerPosition(i).then(c=>({type:"parent_container",response:c,count:1})).catch(c=>({type:"parent_container",error:c,count:1})))})),l.length>0&&(console.log(" :",l),a.push(ke.updateSubSection(l).then(i=>({type:"sub_container",response:i,count:l.length})).catch(i=>({type:"sub_container",error:i,count:l.length})))),a.length===0){console.log(" API");return}try{const i=await Promise.all(a);let c=0,g=0;const y=[];i.forEach(h=>{var p,b;if(h.error)g+=h.count,y.push(`${h.type}: ${h.error.message||""}`),console.error(` ${h.type} API :`,h.error);else if(((p=h.response)==null?void 0:p.Code)===200)c+=h.count,console.log(` ${h.type} API :`,h.response);else{g+=h.count;const N=((b=h.response)==null?void 0:b.Result)||"";y.push(`${h.type}: ${N}`),console.error(` ${h.type} API :`,h.response)}})}catch(i){console.error(" :",i)}finally{console.log("")}},_h="modulepreload",Mh=function(e){return"/"+e},Ic={},Eh=function(t,n,s){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),i=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=Promise.allSettled(n.map(c=>{if(c=Mh(c),c in Ic)return;Ic[c]=!0;const g=c.endsWith(".css"),y=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${y}`))return;const h=document.createElement("link");if(h.rel=g?"stylesheet":_h,g||(h.as="script"),h.crossOrigin="",h.href=c,i&&h.setAttribute("nonce",i),document.head.appendChild(h),g)return new Promise((p,b)=>{h.addEventListener("load",p),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${c}`)))})}))}function l(a){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}return o.then(a=>{for(const i of a||[])i.status==="rejected"&&l(i.reason);return t().catch(l)})},on=[{name:"2.13",box_type:"2.13",width:["7.5"],unit:"cm"},{name:"2.9",type:"2.9",width:["10","15","20"],unit:"cm"},{name:"4.2",type:"4.2",width:["11","16"],unit:"cm"}],Ih=()=>{const{medBoxModalOpen:e,closeMedBoxModal:t,selectedMedBox:n,selectedDepartmentType:s,setApiDepartmentData:o,setIsLoadingMedMap:l,showNotification:a,triggerRefresh:i,modalMode:c,medicineList:g}=rt(),{t:y}=kt(),[h,p]=f.useState(0),[b,N]=f.useState({}),[S,A]=f.useState(""),[d,u]=f.useState(""),[m,C]=f.useState("N"),[P,k]=f.useState([]),[T,G]=f.useState(!1),[M,U]=f.useState(!1),[le,ue]=f.useState(null),[_,v]=f.useState(null),[H,w]=f.useState(!1),[j,D]=f.useState(!1);f.useEffect(()=>{if(n&&e)if(c==="add"){p(0);const te={};on.forEach((R,E)=>{te[E]=0}),N(te),A(""),U(!1),I()}else{const te=on.findIndex(R=>R.box_type===n.box_type||R.type===n.box_type);if(console.log(n),te>=0){p(te);const E=on[te].width.findIndex(B=>{var re;return B===((re=n.width)==null?void 0:re[n.width_index||0])}),X={};on.forEach((B,re)=>{re===te?X[re]=E>=0?E:0:X[re]=0}),N(X)}else{p(0);const R={};on.forEach((E,X)=>{R[X]=0}),N(R)}A(n.ip||""),v({box_type:n.box_type,width:n.width,width_index:n.width_index,ip:n.ip||"",storage:n.storage?JSON.parse(JSON.stringify(n.storage)):null})}},[n,e,c]);const I=()=>{n&&n.parentShelf&&ue(n.parentShelf)},Z=te=>{if(!te||!te.contents||te.contents.length===0)return"0,0";let R=-1,E=0;return te.contents.forEach(X=>{if(X.gird_position){const[B,re]=X.gird_position.split(",").map(Number);re>R&&(R=re,E=B)}}),`${E},${R+1}`},z=()=>{if(!_||c!=="edit")return!1;const te=on[h],R=b[h]||0,E=te.box_type||te.type||te.name;return _.box_type!==E||_.width_index!==R||_.ip!==S||JSON.stringify(_.storage)!==JSON.stringify(n==null?void 0:n.storage)},oe=te=>{p(te)},be=(te,R)=>{N(E=>({...E,[te]:R}))},fe=()=>{n&&(c==="add"?he():Y())},W=()=>{t()},he=async()=>{if(!n||!le){a("","error");return}U(!0);try{const te=on[h],R=b[h]||0,E=te.width[R],X=Z(le),B={Master_GUID:le.GUID,position:X,width:E.toString(),height:"60",ip_box:S,serverName:le.serverName||"",serverType:le.serverType||""};console.log("  API :",B);const re=await ke.addMedMapBox(B);re.Code===200?(a("","success"),t(),await Ce()):a(`${re.Result||""}`,"error")}catch(te){console.error("Add med box failed:",te),a("","error")}finally{U(!1)}},Y=async()=>{var te;if(!n||!z()){a("","error");return}w(!0);try{const R=on[h],E=b[h]||0,X=R.width[E],B=R.box_type||R.type||R.name,re=_.box_type!==B||_.width_index!==E||_.ip!==S,ie=JSON.stringify(_.storage)!==JSON.stringify(n==null?void 0:n.storage),$=[];if(re){const J={GUID:n.GUID,Master_GUID:n.Master_GUID,position:n.gird_position,ip_light:S,serverName:n.serverName,serverType:n.serverType};$.push(ke.updateMedMapBox([J]))}ie&&$.push(ke.updateEpd266Storages(n.serverName||"",n.serverType||"",[n.storage]));const V=await Promise.all($);if(V.every(J=>J.Code===200))a("","success"),t(),await Ce();else{const J=V.filter(ae=>ae.Code!==200);a(`${((te=J[0])==null?void 0:te.Result)||""}`,"error")}}catch(R){console.error("Update med box failed:",R),a("","error")}finally{w(!1)}},Ce=async()=>{if(!s){console.warn(" ");return}console.log(" :",s),l(!0);try{const te=await ke.getMedMapByDepartment(s);if(te.Code===200&&te.Data){console.log(" API ");const R=await Eh(()=>Promise.resolve().then(()=>Zm),void 0),E=R.default.convertMedMapApiToFakeData(te.Data);if(!R.default.validateConvertedData(E)){console.error(" "),a("","error");return}o(E),console.log(" ")}else console.error(" API :",te),a("API ","error")}catch(te){console.error(" :",te),a("","error")}finally{l(!1)}},ve=async()=>{G(!0);try{const te=d.toLowerCase().trim();let R=g;te&&(R=R.filter(E=>{var X,B,re;return((X=E.CODE)==null?void 0:X.toLowerCase().includes(te))||((B=E.NAME)==null?void 0:B.toLowerCase().includes(te))||((re=E.CHT_NAME)==null?void 0:re.toLowerCase().includes(te))})),m!=="N"&&(R=R.filter(E=>E.DRUGKIND===m)),k(R)}catch(te){console.error("Search failed:",te),k([])}finally{G(!1)}},ye=(te,R)=>{console.log(" :",R),D(!1),Ae(R)},Ae=async te=>{if(n)try{console.log(" :",te.CODE);const R=await ke.updateEpd266Medcode(n.serverName||"",n.serverType||"",te.CODE,n.storage||{});R.Code===200?(console.log(" :",R.Data),n.storage=R.Data,n.med_info=[{name:te.NAME,cht_name:te.CHT_NAME,code:te.CODE}],a("","success"),i()):(console.error(" :",R),a(`${R.Result||""}`,"error"))}catch(R){console.error(" :",R),a("","error")}};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:W}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh"},onClick:te=>te.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(In,{className:"w-6 h-6 text-gray-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:y(c==="add"?"modal.addMedBox":"modal.medBoxSettings")})]}),r.jsx("button",{onClick:W,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-4 py-2 overflow-y-auto",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"gap-16 flex",children:r.jsxs("div",{className:"space-y-1",children:[r.jsx("h3",{className:"text-base font-medium text-gray-900",children:y("form.ipAddress")}),r.jsx("div",{className:"flex items-center",children:r.jsx("input",{type:"text",onChange:te=>A(te.target.value),placeholder:(n==null?void 0:n.ip)||(n==null?void 0:n.name)||y("placeholder.ipAddress"),className:"px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors w-64"})})]})}),r.jsxs("div",{className:"flex gap-16",children:[r.jsxs("div",{className:"space-y-1 min-w-[260px]",children:[r.jsx("h3",{className:"text-base font-medium text-gray-900",children:y("form.medBoxType")}),r.jsx("div",{className:"flex gap-4 justify-between",children:on.map((te,R)=>r.jsxs("label",{className:`flex items-center px-4 py-2 border-2 rounded-lg cursor-pointer transition-all ${h===R?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[r.jsx("input",{type:"radio",name:"boxType",value:R,checked:h===R,onChange:()=>oe(R),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 hidden"}),r.jsx("div",{children:r.jsx("div",{className:"text-sm font-medium text-gray-900",children:te.name})})]},R))})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("h3",{className:"text-base font-medium text-gray-900",children:y("form.widthSelection")}),on.map((te,R)=>r.jsx("div",{className:`flex gap-4 ${h===R?"block":"hidden"}`,children:te.width.map((E,X)=>r.jsxs("label",{className:`flex items-center justify-center px-4 py-2 border-2 rounded-lg cursor-pointer transition-all ${h===R&&(b[R]||0)===X?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[r.jsx("input",{type:"radio",name:`width-${R}`,value:X,checked:h===R&&(b[R]||0)===X,onChange:()=>be(R,X),className:"w-4 h-4 text-green-600 border-gray-300 focus:ring-green-500 hidden"}),r.jsx("div",{className:"text-center",children:r.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:[E," ",te.unit]})})]},`${R}-${X}`))},R))]})]}),r.jsxs("div",{className:"flex gap-6",children:[c==="edit"&&r.jsxs("div",{className:"space-y-2 w-[50%]",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:y("form.drugInfo")}),r.jsx("div",{children:n!=null&&n.med_info&&n.med_info.length>0?r.jsx("div",{children:n.med_info.map((te,R)=>r.jsxs("div",{className:"space-y-2 p-4 border border-gray-200 rounded-lg min-h-[262px] max-h-[262px]",children:[r.jsxs("div",{children:[r.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[y("form.drugCode"),":"]}),r.jsx("div",{className:"text-base text-gray-900 mt-1",children:te.code||y("status.notSet")})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[y("form.drugName"),":"]}),r.jsx("div",{className:"text-base text-gray-900 mt-1",children:te.name||y("status.notSet")})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[y("form.chineseName"),":"]}),r.jsx("div",{className:"text-base text-gray-900 mt-1",children:te.cht_name||y("status.notSet")})]})]},R))}):r.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg py-8 px-4 text-center space-y-4",children:r.jsx("div",{className:"text-gray-500 text-base",children:y("status.noDrugData")})})})]}),c==="add"&&r.jsxs("div",{className:"space-y-2 w-[50%]",children:[r.jsx("h3",{className:"text-base font-medium text-gray-900",children:y("form.drugInfo")}),r.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg py-2 px-4 min-h-[262px] max-h-[262px]",children:r.jsx("div",{className:"text-center py-8 space-y-4",children:r.jsx("div",{className:"text-gray-500 text-base",children:y("status.newMedBoxNoDrug")})})})]}),r.jsxs("div",{className:"space-y-2 w-[50%]",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:y("form.drugSearch")}),r.jsx("button",{onClick:()=>D(!0),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",title:"",children:r.jsx(Ur,{className:"w-5 h-5 text-gray-600"})})]}),r.jsxs("div",{className:"flex gap-2 mb-2",children:[r.jsx("input",{type:"text",value:d,onChange:te=>u(te.target.value),placeholder:y("placeholder.drugSearch"),className:"border rounded px-3 py-1 flex-1 min-w-0 focus:border-blue-500 focus:outline-none transition-colors"}),r.jsxs("select",{value:m,onChange:te=>C(te.target.value),className:"border rounded px-2 py-1 focus:border-blue-500 focus:outline-none transition-colors",title:"",children:[r.jsx("option",{value:"N",children:"N"}),r.jsx("option",{value:"1",children:"1"}),r.jsx("option",{value:"2",children:"2"}),r.jsx("option",{value:"3",children:"3"}),r.jsx("option",{value:"4",children:"4"})]}),r.jsxs("button",{onClick:ve,disabled:T,className:"bg-blue-600 text-white px-4 py-1.5 rounded hover:bg-blue-700 transition-colors whitespace-nowrap disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:[T&&r.jsx(Rt,{className:"w-4 h-4 animate-spin"}),y("button.search")]})]}),r.jsx("div",{className:"bg-white border rounded p-3 min-h-[220px] max-h-[220px] overflow-y-auto",children:T?r.jsxs("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:[r.jsx(Rt,{className:"w-5 h-5 animate-spin mr-2"}),y("status.searching")]}):P.length>0?r.jsx("div",{className:"space-y-1",children:P.map((te,R)=>r.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded hover:bg-gray-50 transition-colors",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:te.NAME}),r.jsx("div",{className:"text-xs text-gray-500 truncate",children:te.CHT_NAME}),r.jsx("div",{className:"text-xs text-gray-400 font-mono",children:te.CODE})]}),r.jsx("button",{onClick:()=>Ae(te),className:"ml-2 p-1 text-green-600 hover:text-green-700 hover:bg-green-50 rounded transition-colors flex-shrink-0",title:y("button.add"),children:r.jsx(Et,{className:"w-4 h-4"})})]},te.GUID||R))}):r.jsx("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:y(d||m!=="N"?"status.noSearchResults":"status.searchResults")})})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 py-2 px-4 border-t border-gray-200",children:[r.jsx("button",{onClick:W,disabled:M||H,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:y("button.cancel")}),r.jsxs("button",{onClick:fe,disabled:M||H,className:"px-6 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[(M||H)&&r.jsx(Rt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:M?"...":H?"...":y(c==="add"?"button.add":"button.save")})]})]})]}),r.jsx(tl,{isOpen:j,onClose:()=>D(!1),onScanSuccess:ye,mode:"set_med_box_med_mode"})]})},Ph=()=>{const{listDrawModalOpen:e,closeListDrawModal:t,selectedListDraw:n,triggerRefresh:s}=rt(),{t:o}=kt(),[l,a]=f.useState(""),[i,c]=f.useState([]),[g,y]=f.useState(""),[h,p]=f.useState("N"),[b,N]=f.useState([]),[S,A]=f.useState(!1);f.useEffect(()=>{n&&e&&(a(n.name||""),c(n.med_info||[]))},[n,e]);const d=k=>{c(T=>T.filter(G=>G.code!==k))},u=async()=>{A(!0);try{const k=await ke.searchMedicine(g,h);N(k)}catch(k){console.error("Search failed:",k),N([])}finally{A(!1)}},m=k=>{const T={id:k.GUID||`${Date.now()}_${Math.random()}`,name:k.NAME,cht_name:k.CHT_NAME,code:k.CODE};c(G=>G.some(U=>U.code===T.code)?G:[...G,T])},C=()=>{n&&(n.name=l,n.med_info=i,s(),t())},P=()=>{t()};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:P}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh"},onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(In,{className:"w-6 h-6 text-gray-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o("modal.listDrawSettings")})]}),r.jsx("button",{onClick:P,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-4 py-1 overflow-y-auto",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:o("form.drawerName")}),r.jsx("input",{type:"text",value:l,onChange:k=>a(k.target.value),placeholder:(n==null?void 0:n.name)||o("placeholder.drawerName"),className:"w-full px-2 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors text-base"})]}),r.jsxs("div",{className:"flex gap-6",children:[r.jsxs("div",{className:"space-y-2 w-[50%]",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:o("form.drugList")}),i.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-2",children:i.map(k=>r.jsx("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-1 hover:border-gray-300 transition-colors",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsx("div",{className:"flex-1 min-w-0",children:r.jsxs("div",{children:[k.code&&r.jsx("div",{children:r.jsx("div",{className:"text-sm text-gray-900 font-mono",children:k.code})}),r.jsx("div",{children:r.jsx("div",{className:"text-sm text-gray-900 font-medium",children:k.name||o("status.notSet")})}),r.jsx("div",{children:r.jsx("div",{className:"text-sm text-gray-900",children:k.cht_name||o("status.notSet")})})]})}),r.jsx("button",{onClick:()=>d(k.code),className:"ml-3 p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors flex-shrink-0",title:o("button.remove"),children:r.jsx(Ke,{className:"w-5 h-5"})})]})},k.id))}):r.jsx("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg py-12",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-gray-500 text-lg mb-2",children:o("status.drawerNoDrug")}),r.jsx("div",{className:"text-gray-400 text-sm",children:o("status.drugListEmpty")})]})})]}),r.jsxs("div",{className:"space-y-2 w-[50%]",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:o("form.drugSearch")}),r.jsxs("div",{className:"flex gap-2 mb-2",children:[r.jsx("input",{type:"text",value:g,onChange:k=>y(k.target.value),placeholder:o("placeholder.drugSearch"),className:"border rounded px-3 py-1 flex-1 min-w-0 focus:border-blue-500 focus:outline-none transition-colors"}),r.jsxs("select",{value:h,onChange:k=>p(k.target.value),className:"border rounded px-2 py-1 focus:border-blue-500 focus:outline-none transition-colors",title:"",children:[r.jsx("option",{value:"N",children:"N"}),r.jsx("option",{value:"1",children:"1"}),r.jsx("option",{value:"2",children:"2"}),r.jsx("option",{value:"3",children:"3"}),r.jsx("option",{value:"4",children:"4"})]}),r.jsxs("button",{onClick:u,disabled:S,className:"bg-blue-600 text-white px-4 py-1.5 rounded hover:bg-blue-700 transition-colors whitespace-nowrap disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:[S&&r.jsx(Rt,{className:"w-4 h-4 animate-spin"}),o("button.search")]})]}),r.jsx("div",{className:"bg-white border rounded p-3 min-h-[300px] max-h-[300px] overflow-y-auto",children:S?r.jsxs("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:[r.jsx(Rt,{className:"w-5 h-5 animate-spin mr-2"}),o("status.searching")]}):b.length>0?r.jsx("div",{className:"space-y-1",children:b.map((k,T)=>r.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded hover:bg-gray-50 transition-colors",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:k.NAME}),r.jsx("div",{className:"text-xs text-gray-500 truncate",children:k.CHT_NAME}),r.jsx("div",{className:"text-xs text-gray-400 font-mono",children:k.CODE})]}),r.jsx("button",{onClick:()=>m(k),className:"ml-2 p-1 text-green-600 hover:text-green-700 hover:bg-green-50 rounded transition-colors flex-shrink-0",title:o("button.add"),children:r.jsx(Et,{className:"w-4 h-4"})})]},k.GUID||T))}):r.jsx("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:o(g||h!=="N"?"status.noSearchResults":"status.searchResults")})})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:P,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:o("button.cancel")}),r.jsx("button",{onClick:C,className:"px-6 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:o("button.save")})]})]})]})},Th=()=>{const{gridDrawModalOpen:e,closeGridDrawModal:t,selectedGridDraw:n,triggerRefresh:s,apiDepartmentData:o,setApiDepartmentData:l,showNotification:a,medicineList:i}=rt(),{t:c}=kt(),[g,y]=f.useState(""),[h,p]=f.useState(null),[b,N]=f.useState(!1),[S,A]=f.useState(!1),[d,u]=f.useState(null),[m,C]=f.useState(""),[P,k]=f.useState("N"),[T,G]=f.useState([]),[M,U]=f.useState(!1),[le,ue]=f.useState(0),[_,v]=f.useState({x:0,y:0});f.useEffect(()=>{if(n&&e)if(y(n.name||""),n.drawer){if(!b){console.log("  drawer :",n);const B=JSON.parse(JSON.stringify(n.drawer));p(B),N(!0),console.log(" :",B)}}else console.log("  drawer "),p(null),N(!1)},[n,e,b]),f.useEffect(()=>{e||(N(!1),p(null),u(null))},[e]);const H=()=>{n&&E()},w=()=>{if(console.log(" ..."),console.log(":",h),console.log(" selectedGridDraw:",n),n&&h&&b){console.log("  drawer ...");const B=JSON.parse(JSON.stringify(h));if(n.drawer=B,o){const re=$=>{$.forEach(V=>{V.GUID===n.GUID&&(console.log(" "),V.drawer=B),V.contents&&Array.isArray(V.contents)&&re(V.contents),V.components&&Array.isArray(V.components)&&re(V.components)})},ie=JSON.parse(JSON.stringify(o));re(ie),l(ie),console.log(" ")}console.log(" :",n.drawer)}else console.log("  - selectedGridDraworiginalDrawerData  hasBackup "),console.log("selectedGridDraw:",!!n),console.log("originalDrawerData:",!!h),console.log("hasBackup:",b);u(null),N(!1),p(null),s(),t()},j=(B,re)=>{if(!d)return!1;const ie=Math.min(d.startRow,d.endRow),$=Math.max(d.startRow,d.endRow),V=Math.min(d.startCol,d.endCol),F=Math.max(d.startCol,d.endCol);return B>=ie&&B<=$&&re>=V&&re<=F},D=B=>{var ge;if(!((ge=n==null?void 0:n.drawer)!=null&&ge.Boxes)||B.Slave)return{width:1,height:1};const ie=n.drawer.Boxes.flat().filter(de=>de.Slave&&de.MasterBox_Row===B.Row&&de.MasterBox_Column===B.Column);if(ie.length===0)return{width:1,height:1};const $=[B,...ie],V=Math.min(...$.map(de=>de.Row)),F=Math.max(...$.map(de=>de.Row)),J=Math.min(...$.map(de=>de.Column));return{width:Math.max(...$.map(de=>de.Column))-J+1,height:F-V+1}},I=()=>{var J;if(!d||!((J=n==null?void 0:n.drawer)!=null&&J.Boxes))return[];const B=n.drawer.Boxes.flat(),re=Math.min(d.startRow,d.endRow),ie=Math.max(d.startRow,d.endRow),$=Math.min(d.startCol,d.endCol),V=Math.max(d.startCol,d.endCol),F=[];return B.forEach(ae=>{if(!ae.Slave){const ge=D(ae),de=ae.Row+ge.height-1,we=ae.Column+ge.width-1;ae.Row>=re&&de<=ie&&ae.Column>=$&&we<=V&&F.push(ae)}}),F},Z=(B,re,ie,$)=>{var we;if(!d||!((we=n==null?void 0:n.drawer)!=null&&we.Boxes))return!1;const V=n.drawer.Boxes.flat();let F=!0,J=B,ae=re,ge=ie,de=$;for(;F;)F=!1,V.forEach(Se=>{if(!Se.Slave){const Ie=D(Se),tt=Se.Row+Ie.height-1,Pe=Se.Column+Ie.width-1;!(Se.Row>ae||tt<J||Se.Column>de||Pe<ge)&&(Se.Row<J&&(J=Se.Row,F=!0),tt>ae&&(ae=tt,F=!0),Se.Column<ge&&(ge=Se.Column,F=!0),Pe>de&&(de=Pe,F=!0))}});return{minRow:J,maxRow:ae,minCol:ge,maxCol:de}},z=()=>{var F;if(!d||!((F=n==null?void 0:n.drawer)!=null&&F.Boxes))return!1;const B=Math.min(d.startRow,d.endRow),re=Math.max(d.startRow,d.endRow),ie=Math.min(d.startCol,d.endCol),$=Math.max(d.startCol,d.endCol),V=n.drawer.Boxes.flat();for(let J=B;J<=re;J++)for(let ae=ie;ae<=$;ae++){let ge=!1;for(const de of V)if(!de.Slave){const we=D(de),Se=de.Row+we.height-1,Ie=de.Column+we.width-1;if(J>=de.Row&&J<=Se&&ae>=de.Column&&ae<=Ie){ge=!0;break}}if(!ge)return!1}return!0},oe=()=>{var we,Se;const B=I();if(!d)return{canMerge:!1,canUnmerge:!1};if(B.length===0)return{canMerge:!1,canUnmerge:!1};const re=((Se=(we=n==null?void 0:n.drawer)==null?void 0:we.Boxes)==null?void 0:Se.flat())||[],ie=B.some(Ie=>re.filter(Pe=>Pe.Slave&&Pe.MasterBox_Row===Ie.Row&&Pe.MasterBox_Column===Ie.Column).length>0),$=Math.min(d.startRow,d.endRow),V=Math.max(d.startRow,d.endRow),F=Math.min(d.startCol,d.endCol),J=Math.max(d.startCol,d.endCol),ae=re.some(Ie=>Ie.Slave&&Ie.Row>=$&&Ie.Row<=V&&Ie.Column>=F&&Ie.Column<=J);return{canMerge:B.length>1&&z(),canUnmerge:ie||ae}},{canMerge:be,canUnmerge:fe}=oe(),W=async()=>{U(!0);try{const B=m.toLowerCase().trim();let re=i;B&&(re=re.filter(ie=>{var $,V,F;return(($=ie.CODE)==null?void 0:$.toLowerCase().includes(B))||((V=ie.NAME)==null?void 0:V.toLowerCase().includes(B))||((F=ie.CHT_NAME)==null?void 0:F.toLowerCase().includes(B))})),P!=="N"&&(re=re.filter(ie=>ie.DRUGKIND===P)),G(re)}catch(B){console.error("Search failed:",B),G([])}finally{U(!1)}},he=async B=>{var ie;if(!d||!((ie=n==null?void 0:n.drawer)!=null&&ie.Boxes))return;const re=I();if(re.length!==0)try{const $={ServerName:n.serverName,ServerType:n.serverType,ValueAry:[`guid=${re[0].GUID}`,`code=${B.CODE}`],Data:n.drawer};console.log("  API :",$);const V=await ke.request("/api/device/update_drawer_medcode",{method:"POST",body:JSON.stringify($)});if(console.log("  API :",V),V.Code===200&&V.Data){if(n.drawer=V.Data,V.Data.Boxes&&(n.Boxes=V.Data.Boxes),console.log(" "),o){const F=ae=>{ae.forEach(ge=>{ge.GUID===n.GUID&&(console.log(" "),ge.drawer=n.drawer,n.Boxes&&(ge.Boxes=n.Boxes)),ge.contents&&Array.isArray(ge.contents)&&F(ge.contents),ge.components&&Array.isArray(ge.components)&&F(ge.components)})},J=JSON.parse(JSON.stringify(o));F(J),l(J)}u(null),s()}else console.error(" :",V),a(`${V.Result||""}`,"error")}catch($){console.error("  API :",$),a("","error")}},Y=(B,re,ie)=>{ie.preventDefault(),ie.stopPropagation(),"touches"in ie&&(ue(Date.now()),v({x:ie.touches[0].clientX,y:ie.touches[0].clientY})),A(!0),u({startRow:B,startCol:re,endRow:B,endCol:re})},Ce=(B,re)=>{if(!S||!d)return;const ie=Math.min(d.startRow,B),$=Math.max(d.startRow,B),V=Math.min(d.startCol,re),F=Math.max(d.startCol,re),J=Z(ie,$,V,F);J&&u(ae=>ae?{startRow:ae.startRow,startCol:ae.startCol,endRow:B>=ae.startRow?J.maxRow:J.minRow,endCol:re>=ae.startCol?J.maxCol:J.minCol}:null)},ve=()=>{if(S&&(A(!1),d&&(n!=null&&n.Boxes))){const B=Math.min(d.startRow,d.endRow),re=Math.max(d.startRow,d.endRow),ie=Math.min(d.startCol,d.endCol),$=Math.max(d.startCol,d.endCol),V=Z(B,re,ie,$);V&&u({startRow:V.minRow,startCol:V.minCol,endRow:V.maxRow,endCol:V.maxCol})}},ye=()=>{var B;!be||!((B=n==null?void 0:n.drawer)!=null&&B.Boxes)||!d||R()},Ae=()=>{var B;!fe||!((B=n==null?void 0:n.drawer)!=null&&B.Boxes)||!d||(console.log(d),te())},te=async()=>{var B;if(!(!d||!((B=n==null?void 0:n.drawer)!=null&&B.Boxes)))try{const re=Math.min(d.startRow,d.endRow),ie=Math.max(d.startRow,d.endRow),$=Math.min(d.startCol,d.endCol),V=Math.max(d.startCol,d.endCol),J=n.drawer.Boxes.flat().filter(Se=>Se.Row>=re&&Se.Row<=ie&&Se.Column>=$&&Se.Column<=V),ae=[],ge=[];J.forEach(Se=>{ae.push(Se.Column.toString()),ge.push(Se.Row.toString())});const de={ServerName:n.serverName,ServerType:n.serverType,ValueAry:[`SelectColumns=${ae.join(",")}`,`SelectRows=${ge.join(",")}`],Data:{IP:n.ip,Boxes:n.Boxes}};console.log("  API :",de);const we=await ke.request("/api/device/separate_drawer_boxes",{method:"POST",body:JSON.stringify(de)});if(console.log(" API :",we),we.Code===200&&we.Data){if(we.Data.Boxes&&Array.isArray(we.Data.Boxes)&&(n.Boxes=we.Data.Boxes,n.drawer=we.Data,console.log(" "),o)){const Se=tt=>{tt.forEach(Pe=>{Pe.GUID===n.GUID&&(console.log(" "),Pe.drawer=n.drawer),Pe.contents&&Array.isArray(Pe.contents)&&Se(Pe.contents),Pe.components&&Array.isArray(Pe.components)&&Se(Pe.components)})},Ie=JSON.parse(JSON.stringify(o));Se(Ie),l(Ie)}}else console.error(" API :",we),a(`${we.Result||""}`,"error")}catch(re){console.error(" API :",re),a("","error")}finally{console.log("",n),console.log("",o),u(null),s()}},R=async()=>{var B;if(!(!d||!((B=n==null?void 0:n.drawer)!=null&&B.Boxes)))try{const re=Math.min(d.startRow,d.endRow),ie=Math.max(d.startRow,d.endRow),$=Math.min(d.startCol,d.endCol),V=Math.max(d.startCol,d.endCol),J=n.drawer.Boxes.flat().filter(Se=>Se.Row>=re&&Se.Row<=ie&&Se.Column>=$&&Se.Column<=V),ae=[],ge=[];J.forEach(Se=>{ae.push(Se.Column.toString()),ge.push(Se.Row.toString())});const de={ServerName:n.serverName,ServerType:n.serverType,ValueAry:[`SelectColumns=${ae.join(",")}`,`SelectRows=${ge.join(",")}`],Data:{IP:n.ip,Boxes:n.Boxes}};console.log("  API :",de);const we=await ke.request("/api/device/combine_drawer_boxes",{method:"POST",body:JSON.stringify(de)});if(console.log(" API :",we),we.Code===200&&we.Data){if(we.Data.Boxes&&Array.isArray(we.Data.Boxes)&&(n.Boxes=we.Data.Boxes,n.drawer=we.Data,console.log(" "),o)){const Se=tt=>{tt.forEach(Pe=>{Pe.GUID===n.GUID&&(console.log(" "),Pe.drawer=n.drawer),Pe.contents&&Array.isArray(Pe.contents)&&Se(Pe.contents),Pe.components&&Array.isArray(Pe.components)&&Se(Pe.components)})},Ie=JSON.parse(JSON.stringify(o));Se(Ie),l(Ie)}}else console.error(" API :",we),a(`${we.Result||""}`,"error")}catch(re){console.error(" API :",re),a("","error")}finally{console.log("",n),console.log("",o),u(null),s()}},E=async()=>{if(n)try{n.name=g;const B={ServerName:n.serverName,ServerType:n.serverType,Data:[n.drawer]};console.log("  API :",B);const re=await ke.request("/api/device/update_epd583_drawers",{method:"POST",body:JSON.stringify(B)});if(console.log("  API :",re),re.Code===200){if(console.log(" "),a("","success"),o){const ie=V=>{V.forEach(F=>{F.GUID===n.GUID&&(console.log(" "),F.name=n.name),F.contents&&Array.isArray(F.contents)&&ie(F.contents),F.components&&Array.isArray(F.components)&&ie(F.components)})},$=JSON.parse(JSON.stringify(o));ie($),l($)}N(!1),p(null),s(),t()}else console.error(" :",re),a(`${re.Result||""}`,"error")}catch(B){console.error("  API :",B),a("","error")}},X=()=>{var ge;if(!((ge=n==null?void 0:n.drawer)!=null&&ge.Boxes)||n.drawer.Boxes.length===0)return r.jsx("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg py-12",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Ju,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("div",{className:"text-gray-500 text-lg mb-2",children:c("status.gridDrawNotConfigured")}),r.jsx("div",{className:"text-gray-400 text-sm",children:c("status.noDrugInfo")})]})});const B=n.drawer.Boxes.flat(),re=de=>{if(de.Slave)return{width:1,height:1};const we=B.filter(He=>He.Slave&&He.MasterBox_Row===de.Row&&He.MasterBox_Column===de.Column);if(we.length===0)return{width:1,height:1};const Se=[de,...we],Ie=Math.min(...Se.map(He=>He.Row)),tt=Math.max(...Se.map(He=>He.Row)),Pe=Math.min(...Se.map(He=>He.Column));return{width:Math.max(...Se.map(He=>He.Column))-Pe+1,height:tt-Ie+1}},ie=Math.max(...B.map(de=>de.Row+1-1)),$=Math.max(...B.map(de=>de.Column+1-1)),V=ie+1,F=$+1,J=Array(V).fill(null).map(()=>Array(F).fill(!1)),ae={};return B.forEach(de=>{if(!de.Slave){const we=re(de);ae[`${de.Row},${de.Column}`]=de,de.calculatedWidth=we.width,de.calculatedHeight=we.height}}),B.forEach(de=>{if(!de.Slave&&(de.calculatedWidth>1||de.calculatedHeight>1))for(let we=de.Row;we<de.Row+de.calculatedHeight;we++)for(let Se=de.Column;Se<de.Column+de.calculatedWidth;Se++)(we!==de.Row||Se!==de.Column)&&(J[we][Se]=!0)}),r.jsx("div",{className:"rounded-lg",children:r.jsx("table",{className:"w-full",children:r.jsx("tbody",{children:Array.from({length:V},(de,we)=>r.jsx("tr",{children:Array.from({length:F},(Se,Ie)=>{if(J[we][Ie])return null;const tt=`${we},${Ie}`,Pe=ae[tt];return Pe?r.jsx("td",{className:`border border-gray-400 pt-1 pl-1 align-top cursor-pointer select-none ${j(we,Ie)?"bg-blue-200":"bg-white hover:bg-gray-100"}`,style:{width:`${100/F}%`,minHeight:"40px",height:`${50*Pe.calculatedHeight}px`,maxHeight:`${50*Pe.calculatedHeight}px`},colSpan:Pe.calculatedWidth,rowSpan:Pe.calculatedHeight,onMouseDown:lt=>Y(we,Ie,lt),onMouseEnter:()=>Ce(we,Ie),onMouseUp:ve,onTouchStart:lt=>Y(we,Ie,lt),onTouchMove:lt=>{if(lt.preventDefault(),!S)return;const He=lt.touches[0],$t=document.elementFromPoint(He.clientX,He.clientY),Gt=$t==null?void 0:$t.closest("td");if(Gt){const Vn=parseInt(Gt.getAttribute("data-row")||"0"),Xt=parseInt(Gt.getAttribute("data-col")||"0");Ce(Vn,Xt)}},onTouchEnd:ve,"data-row":we,"data-col":Ie,children:r.jsx("div",{className:"h-full flex flex-col",children:Pe.Code||Pe.Name||Pe.ChineseName?r.jsxs(r.Fragment,{children:[Pe.Code&&r.jsx("div",{className:"text-xs font-mono text-gray-600",children:Pe.Code}),Pe.Name&&r.jsx("div",{className:"text-xs font-medium text-gray-900",children:Pe.Name}),Pe.ChineseName&&r.jsx("div",{className:"text-xs text-gray-700",children:Pe.ChineseName})]}):r.jsx("div",{className:"h-full flex justify-center items-center text-xs text-gray-400 italic text-center",children:c("status.notAdded")})})},Ie):r.jsx("td",{className:`border border-gray-300 p-2 align-top cursor-pointer select-none ${j(we,Ie)?"border-1 border-blue-500 bg-blue-100":"bg-gray-50 hover:bg-gray-100"}`,style:{width:`${100/F}%`,minWidth:"80px",minHeight:"80px"},onMouseDown:lt=>Y(we,Ie,lt),onMouseEnter:()=>Ce(we,Ie),onMouseUp:ve,onTouchStart:lt=>Y(we,Ie,lt),onTouchMove:lt=>{if(lt.preventDefault(),!S)return;const He=lt.touches[0],$t=document.elementFromPoint(He.clientX,He.clientY),Gt=$t==null?void 0:$t.closest("td");if(Gt){const Vn=parseInt(Gt.getAttribute("data-row")||"0"),Xt=parseInt(Gt.getAttribute("data-col")||"0");Ce(Vn,Xt)}},onTouchEnd:ve,"data-row":we,"data-col":Ie,children:r.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-xs",children:c("status.notAdded")})},Ie)})},we))})})})};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:w}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh"},onClick:B=>B.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(In,{className:"w-6 h-6 text-gray-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:c("modal.gridDrawSettings")})]}),r.jsx("button",{onClick:w,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"flex-1 px-4 py-2 overflow-y-auto",children:[r.jsxs("div",{className:"space-y-4 pt-2",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("h3",{className:"text-lg whitespace-nowrap font-medium text-gray-900",children:c("form.drawerName")}),r.jsx("input",{type:"text",value:g,onChange:B=>y(B.target.value),disabled:!0,placeholder:(n==null?void 0:n.name)||c("placeholder.gridDrawName"),className:"px-2 py-1 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors text-base"})]}),r.jsx("div",{className:"space-y-1",children:X()})]}),r.jsxs("div",{className:"py-2 flex space-x-4",children:[r.jsx("div",{className:"grid grid-cols-1 gap-2 w-[10%]",children:r.jsxs("div",{className:"grid grid-cols-1 gap-2 items-strat",children:[r.jsx("button",{onClick:ye,disabled:!be,className:`px-4 py-2 rounded transition-colors ${be?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:c("button.merge")}),r.jsx("button",{onClick:Ae,disabled:!fe,className:`px-4 py-2 rounded transition-colors ${fe?"bg-red-600 text-white hover:bg-red-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:c("button.unmerge")})]})}),r.jsx("div",{className:"space-y-2 w-[30%]",children:(()=>{const B=I(),re=B.find(ie=>!ie.Slave);return re&&(re.Code||re.Name||re.ChineseName)?r.jsxs("div",{className:"border border-blue-200 rounded-lg p-2 space-y-1 h-full",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-900 mb-1",children:c("form.drugCode")}),r.jsx("div",{className:"text-base text-gray-900",children:re.Code||"-"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-900  mb-1",children:c("form.drugName")}),r.jsx("div",{className:"text-base text-gray-900",children:re.Name||"-"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-900 mb-1",children:c("form.chineseName")}),r.jsx("div",{className:"text-base text-gray-900",children:re.ChineseName||"-"})]})]}):r.jsx("div",{className:"bg-gray-50 border h-full border-gray-200 rounded-lg p-3 text-center",children:r.jsx("div",{className:"text-gray-500 h-full w-full flex justify-center items-center",children:d&&B.length>0?c("status.selectedCellsNoDrug"):c("status.selectCellsForDrug")})})})()}),r.jsxs("div",{className:"w-[60%]",children:[r.jsxs("div",{className:"flex gap-2 mb-2",children:[r.jsx("input",{type:"text",value:m,onChange:B=>C(B.target.value),placeholder:c("placeholder.drugSearch"),className:"border rounded px-3 py-1 flex-1 min-w-0 focus:border-blue-500 focus:outline-none transition-colors"}),r.jsxs("select",{value:P,onChange:B=>k(B.target.value),className:"border rounded px-2 py-1 focus:border-blue-500 focus:outline-none transition-colors",title:"",children:[r.jsx("option",{value:"N",children:"N"}),r.jsx("option",{value:"1",children:"1"}),r.jsx("option",{value:"2",children:"2"}),r.jsx("option",{value:"3",children:"3"}),r.jsx("option",{value:"4",children:"4"})]}),r.jsxs("button",{onClick:W,disabled:M,className:"bg-blue-600 text-white px-4 py-1.5 rounded hover:bg-blue-700 transition-colors whitespace-nowrap disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:[M&&r.jsx(Rt,{className:"w-4 h-4 animate-spin"}),c("button.search")]})]}),r.jsx("div",{className:"bg-white border rounded p-3 min-h-[150px] max-h-[150px] overflow-y-auto",children:M?r.jsxs("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:[r.jsx(Rt,{className:"w-5 h-5 animate-spin mr-2"}),c("status.searching")]}):T.length>0?r.jsx("div",{className:"space-y-1",children:T.map((B,re)=>r.jsxs("div",{className:"flex items-center justify-between p-1 border border-gray-200 rounded hover:bg-gray-50 transition-colors",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:B.NAME}),r.jsx("div",{className:"text-xs text-gray-500 truncate",children:B.CHT_NAME}),r.jsx("div",{className:"text-xs text-gray-400 font-mono",children:B.CODE})]}),r.jsx("button",{onClick:()=>he(B),className:"ml-2 p-1 text-green-600 hover:text-green-700 hover:bg-green-50 rounded transition-colors flex-shrink-0",title:c("button.add"),children:r.jsx(Et,{className:"w-4 h-4"})})]},B.GUID||re))}):r.jsx("div",{className:"text-gray-500 text-center flex items-center justify-center h-full",children:c(m||P!=="N"?"status.noSearchResults":"status.searchResults")})})]})]}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:w,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:c("button.cancel")}),r.jsx("button",{onClick:H,className:"px-6 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:c("button.save")})]})]}),r.jsx("div",{className:"fixed inset-0 pointer-events-none",onMouseUp:ve,onMouseLeave:ve,onTouchEnd:ve,onTouchCancel:ve})]})]})},Rh=()=>{var G;const{addParentContainerModalOpen:e,closeAddParentContainerModal:t,selectedDepartmentForAdd:n,showNotification:s,setSidebarOpen:o,addParentContainerToLocalData:l}=rt(),{t:a}=kt(),[i,c]=f.useState(null),[g,y]=f.useState(0),[h,p]=f.useState(0),[b,N]=f.useState(!1);f.useEffect(()=>{e&&(c(null),y(0),p(0),N(!1))},[e]),f.useEffect(()=>{i&&(y(i.row),p(i.col))},[i]);const S=()=>{const M=new Set;return n!=null&&n.contents&&n.contents.forEach(U=>{U.type==="parent_container"&&U.gird_position&&M.add(U.gird_position)}),M},A=()=>{const M=S(),U=[];if(M.size===0)return U.push({row:0,col:0}),U;const le=[];M.forEach(_=>{const[v,H]=_.split(",").map(Number);le.push({row:v,col:H})});const ue=new Set;return le.forEach(({row:_,col:v})=>{ue.add(`${_},${v+1}`),ue.add(`${_+1},${v}`),v>0&&ue.add(`${_},${v-1}`),_>0&&ue.add(`${_-1},${v}`)}),ue.forEach(_=>{if(!M.has(_)){const[v,H]=_.split(",").map(Number);v>=0&&H>=0&&U.push({row:v,col:H})}}),M.has("0,1")||U.some(v=>v.row===0&&v.col===1)||U.push({row:0,col:1}),M.has("1,0")||U.some(v=>v.row===1&&v.col===0)||U.push({row:1,col:0}),U.sort((_,v)=>_.row===v.row?_.col-v.col:_.row-v.row)},d=M=>{c(M)},u=M=>{y(M),c({row:M,col:h})},m=M=>{p(M),c({row:g,col:M})},C=i&&!S().has(`${i.row},${i.col}`)&&i.row>=0&&i.col>=0,P=async()=>{if(!(!i||!n||!C)){N(!0);try{const M=`${i.row},${i.col}`;console.log(n);const U=await ke.addMedMapSection(n.GUID,M,n.name,n.type);if(U.Code===200){const le={GUID:U.Data.GUID,Master_GUID:U.Data.Master_GUID,gird_position:U.Data.position,name:"",type:"parent_container",class:1,position:{x:0,y:0},serverName:n.name,serverType:n.type,ip_light:"",reverse:"False",contents:[],med_list:[]};l(n.GUID,le),s("","success"),t(),o(!1)}else s(`${U.Result||""}`,"error")}catch(M){console.error("Add parent container failed:",M),s("","error")}finally{N(!1)}}},k=()=>{t()},T=()=>{const M=S(),U=A(),le=[...M].map(D=>{const[I,Z]=D.split(",").map(Number);return{row:I,col:Z}}).concat(U);le.length===0&&le.push({row:0,col:0});const ue=Math.max(...le.map(D=>D.row)),_=Math.max(...le.map(D=>D.col)),v=Math.min(...le.map(D=>D.row)),H=Math.min(...le.map(D=>D.col)),w=ue-v+1,j=_-H+1;return r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:r.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${j}, 1fr)`},children:Array.from({length:w*j},(D,I)=>{const Z=Math.floor(I/j)+v,z=I%j+H,oe=`${Z},${z}`,be=M.has(oe),fe=U.some(he=>he.row===Z&&he.col===z),W=(i==null?void 0:i.row)===Z&&(i==null?void 0:i.col)===z;return r.jsx("button",{onClick:()=>fe&&d({row:Z,col:z}),disabled:be||!fe,className:`
                    w-16 h-16 border-2 rounded-lg transition-all duration-200 flex items-center justify-center text-sm font-medium
                    ${be?"bg-red-100 border-red-300 text-red-600 cursor-not-allowed":W?"bg-blue-500 border-blue-600 text-white shadow-lg":fe?"bg-green-100 border-green-300 text-green-700 hover:bg-green-200 hover:border-green-400 cursor-pointer":"bg-gray-100 border-gray-300 text-gray-400 cursor-not-allowed"}
                  `,title:be?"":fe?"":"",children:be?"":`${Z},${z}`},oe)})})})]})};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:k}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh",maxWidth:"800px"},onClick:M=>M.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Et,{className:"w-6 h-6 text-green-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:k,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-6 py-4 overflow-y-auto",children:r.jsxs("div",{className:"space-y-6",children:[T(),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Row):"}),r.jsx("input",{type:"number",min:"0",value:g,onChange:M=>u(parseInt(M.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Column):"}),r.jsx("input",{type:"number",min:"0",value:h,onChange:M=>m(parseInt(M.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]})]}),i&&r.jsx("div",{className:`text-sm p-2 rounded ${C?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:C?`${i.row},${i.col}`:` ${i.row},${i.col} `})]}),r.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsxs("div",{children:["",(n==null?void 0:n.name)||""]}),r.jsxs("div",{children:["",(n==null?void 0:n.type)||""]}),r.jsxs("div",{children:["",((G=n==null?void 0:n.contents)==null?void 0:G.filter(M=>M.type==="parent_container").length)||0]})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:k,disabled:b,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a("button.cancel")}),r.jsxs("button",{onClick:P,disabled:!C||b,className:"px-6 py-2 text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[b&&r.jsx(Rt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:b?"...":""})]})]})]})]})},Pc=[{value:"dispensing_shelves",label:"",icon:r.jsx(ph,{className:"w-5 h-5"}),isShelf:!0},{value:"store_shelves",label:"",icon:r.jsx(oh,{className:"w-5 h-5"}),isShelf:!0},{value:"list_draw",label:"",icon:r.jsx(ja,{className:"w-5 h-5"}),isShelf:!1},{value:"grid_draw",label:"",icon:r.jsx(Ju,{className:"w-5 h-5"}),isShelf:!1}],$h=()=>{var Z;const{addShelfDrawContainerModalOpen:e,closeAddShelfDrawContainerModal:t,selectedSubContainerForAdd:n,selectedDepartmentType:s,setApiDepartmentData:o,setIsLoadingMedMap:l,showNotification:a,triggerRefresh:i,setSidebarOpen:c}=rt(),{t:g}=kt(),[y,h]=f.useState("dispensing_shelves"),[p,b]=f.useState("1"),[N,S]=f.useState("1"),[A,d]=f.useState(""),[u,m]=f.useState(null),[C,P]=f.useState(0),[k,T]=f.useState(0),[G,M]=f.useState(!1);f.useEffect(()=>{e&&(h("dispensing_shelves"),b("1"),S("1"),d(""),m(null),P(0),T(0),M(!1))},[e]),f.useEffect(()=>{u&&(P(u.row),T(u.col))},[u]);const U=()=>{const z=new Set;return n!=null&&n.contents&&n.contents.forEach(oe=>{oe.gird_position&&z.add(oe.gird_position)}),z},le=()=>{const z=U(),oe=[];if(z.size===0)return oe.push({row:0,col:0}),oe;const be=[];z.forEach(W=>{const[he,Y]=W.split(",").map(Number);be.push({row:he,col:Y})});const fe=new Set;return be.forEach(({row:W,col:he})=>{fe.add(`${W},${he+1}`),fe.add(`${W+1},${he}`),he>0&&fe.add(`${W},${he-1}`),W>0&&fe.add(`${W-1},${he}`)}),fe.forEach(W=>{if(!z.has(W)){const[he,Y]=W.split(",").map(Number);he>=0&&Y>=0&&oe.push({row:he,col:Y})}}),z.has("0,1")||oe.some(he=>he.row===0&&he.col===1)||oe.push({row:0,col:1}),z.has("1,0")||oe.some(he=>he.row===1&&he.col===0)||oe.push({row:1,col:0}),oe.sort((W,he)=>W.row===he.row?W.col-he.col:W.row-he.row)},ue=z=>{m(z)},_=z=>{P(z),m({row:z,col:k})},v=z=>{T(z),m({row:C,col:z})},H=u&&!U().has(`${u.row},${u.col}`)&&u.row>=0&&u.col>=0,w=async()=>{if(!(!u||!n||!H)){M(!0);try{const z=`${u.row},${u.col}`,oe=Pc.find(fe=>fe.value===y);let be;oe!=null&&oe.isShelf?be=await ke.addMedMapShelf({Master_GUID:n.GUID,position:z,width:p,height:N,ip_light:A,type:y,serverName:n.name,serverType:n.type}):be=await ke.addMedMapDrawer({Master_GUID:n.GUID,position:z,width:p,height:N,ip_drawer:A,type:y,serverName:n.name,serverType:n.type}),be.Code===200?(a("","success"),t(),c(!1),await j()):a(`${be.Result||""}`,"error")}catch(z){console.error("Add container failed:",z),a("","error")}finally{M(!1)}}},j=async()=>{if(!s){console.warn(" ");return}console.log(" :",s),l(!0);try{const z=await ke.getMedMapByDepartment(s);if(z.Code===200&&z.Data){console.log(" API ");const oe=Mt.convertMedMapApiToFakeData(z.Data);if(!Mt.validateConvertedData(oe)){console.error(" "),a("","error");return}o(oe),console.log(" ")}else console.error(" API :",z),a("API ","error")}catch(z){console.error(" :",z),a("","error")}finally{l(!1)}},D=()=>{t()},I=()=>{const z=U(),oe=le(),be=[...z].map(ye=>{const[Ae,te]=ye.split(",").map(Number);return{row:Ae,col:te}}).concat(oe);be.length===0&&be.push({row:0,col:0});const fe=Math.max(...be.map(ye=>ye.row)),W=Math.max(...be.map(ye=>ye.col)),he=Math.min(...be.map(ye=>ye.row)),Y=Math.min(...be.map(ye=>ye.col)),Ce=fe-he+1,ve=W-Y+1;return r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:r.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${ve}, 1fr)`},children:Array.from({length:Ce*ve},(ye,Ae)=>{const te=Math.floor(Ae/ve)+he,R=Ae%ve+Y,E=`${te},${R}`,X=z.has(E),B=oe.some(ie=>ie.row===te&&ie.col===R),re=(u==null?void 0:u.row)===te&&(u==null?void 0:u.col)===R;return r.jsx("button",{onClick:()=>B&&ue({row:te,col:R}),disabled:X||!B,className:`
                    w-16 h-16 border-2 rounded-lg transition-all duration-200 flex items-center justify-center text-sm font-medium
                    ${X?"bg-red-100 border-red-300 text-red-600 cursor-not-allowed":re?"bg-blue-500 border-blue-600 text-white shadow-lg":B?"bg-green-100 border-green-300 text-green-700 hover:bg-green-200 hover:border-green-400 cursor-pointer":"bg-gray-100 border-gray-300 text-gray-400 cursor-not-allowed"}
                  `,title:X?"":B?"":"",children:X?"":`${te},${R}`},E)})})})]})};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:D}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh",maxWidth:"1000px"},onClick:z=>z.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Et,{className:"w-6 h-6 text-green-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"/"})]}),r.jsx("button",{onClick:D,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-6 py-4 overflow-y-auto",children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:Pc.map(z=>r.jsxs("label",{className:`flex items-center space-x-3 p-4 border-2 rounded-lg cursor-pointer transition-all ${y===z.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[r.jsx("input",{type:"radio",name:"containerType",value:z.value,checked:y===z.value,onChange:oe=>h(oe.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 hidden"}),r.jsxs("div",{className:"flex items-center space-x-3",children:[z.icon,r.jsx("span",{className:"font-medium text-gray-900",children:z.label})]})]},z.value))})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:""}),r.jsx("input",{type:"number",min:"1",value:p,onChange:z=>b(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:""}),r.jsx("input",{type:"number",min:"1",value:N,onChange:z=>S(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"IP "}),r.jsx("input",{type:"text",value:A,onChange:z=>d(z.target.value),placeholder:" IP ",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),I(),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Row):"}),r.jsx("input",{type:"number",min:"0",value:C,onChange:z=>_(parseInt(z.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Column):"}),r.jsx("input",{type:"number",min:"0",value:k,onChange:z=>v(parseInt(z.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]})]}),u&&r.jsx("div",{className:`text-sm p-2 rounded ${H?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:H?`${u.row},${u.col}`:` ${u.row},${u.col} `})]}),r.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsxs("div",{children:["",(n==null?void 0:n.name)||""]}),r.jsxs("div",{children:["",(n==null?void 0:n.type)||""]}),r.jsxs("div",{children:["",((Z=n==null?void 0:n.contents)==null?void 0:Z.length)||0]})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:D,disabled:G,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g("button.cancel")}),r.jsxs("button",{onClick:w,disabled:!H||G,className:"px-6 py-2 text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[G&&r.jsx(Rt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:G?"...":""})]})]})]})]})},Ah=()=>{var G;const{addSubContainerModalOpen:e,closeAddSubContainerModal:t,selectedParentContainerForAdd:n,showNotification:s,setSidebarOpen:o,addSubContainerToLocalData:l}=rt(),{t:a}=kt(),[i,c]=f.useState(null),[g,y]=f.useState(0),[h,p]=f.useState(0),[b,N]=f.useState(!1);f.useEffect(()=>{e&&(c(null),y(0),p(0),N(!1))},[e]),f.useEffect(()=>{i&&(y(i.row),p(i.col))},[i]);const S=()=>{const M=new Set;return n!=null&&n.contents&&n.contents.forEach(U=>{U.type==="sub_container"&&U.gird_position&&M.add(U.gird_position)}),M},A=()=>{const M=S(),U=[];if(M.size===0)return U.push({row:0,col:0}),U;const le=[];M.forEach(_=>{const[v,H]=_.split(",").map(Number);le.push({row:v,col:H})});const ue=new Set;return le.forEach(({row:_,col:v})=>{ue.add(`${_},${v+1}`),ue.add(`${_+1},${v}`),v>0&&ue.add(`${_},${v-1}`),_>0&&ue.add(`${_-1},${v}`)}),ue.forEach(_=>{if(!M.has(_)){const[v,H]=_.split(",").map(Number);v>=0&&H>=0&&U.push({row:v,col:H})}}),M.has("0,1")||U.some(v=>v.row===0&&v.col===1)||U.push({row:0,col:1}),M.has("1,0")||U.some(v=>v.row===1&&v.col===0)||U.push({row:1,col:0}),U.sort((_,v)=>_.row===v.row?_.col-v.col:_.row-v.row)},d=M=>{c(M)},u=M=>{y(M),c({row:M,col:h})},m=M=>{p(M),c({row:g,col:M})},C=i&&!S().has(`${i.row},${i.col}`)&&i.row>=0&&i.col>=0,P=async()=>{if(!(!i||!n||!C)){N(!0);try{const M=`${i.row},${i.col}`,U=await ke.addSubSection(n.GUID,M);if(U.Code===200){const le={GUID:U.Data.GUID,Master_GUID:U.Data.Master_GUID,name:"",type:"sub_container",class:2,gird_position:U.Data.position,contents:[],serverName:n.serverName,serverType:n.serverType,oriMaxCol:0};l(n.GUID,le),s("","success"),t(),o(!1)}else s(`${U.Result||""}`,"error")}catch(M){console.error("Add sub container failed:",M),s("","error")}finally{N(!1)}}},k=()=>{t()},T=()=>{const M=S(),U=A(),le=[...M].map(D=>{const[I,Z]=D.split(",").map(Number);return{row:I,col:Z}}).concat(U);le.length===0&&le.push({row:0,col:0});const ue=Math.max(...le.map(D=>D.row)),_=Math.max(...le.map(D=>D.col)),v=Math.min(...le.map(D=>D.row)),H=Math.min(...le.map(D=>D.col)),w=ue-v+1,j=_-H+1;return r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:r.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${j}, 1fr)`},children:Array.from({length:w*j},(D,I)=>{const Z=Math.floor(I/j)+v,z=I%j+H,oe=`${Z},${z}`,be=M.has(oe),fe=U.some(he=>he.row===Z&&he.col===z),W=(i==null?void 0:i.row)===Z&&(i==null?void 0:i.col)===z;return r.jsx("button",{onClick:()=>fe&&d({row:Z,col:z}),disabled:be||!fe,className:`
                    w-16 h-16 border-2 rounded-lg transition-all duration-200 flex items-center justify-center text-sm font-medium
                    ${be?"bg-red-100 border-red-300 text-red-600 cursor-not-allowed":W?"bg-blue-500 border-blue-600 text-white shadow-lg":fe?"bg-green-100 border-green-300 text-green-700 hover:bg-green-200 hover:border-green-400 cursor-pointer":"bg-gray-100 border-gray-300 text-gray-400 cursor-not-allowed"}
                  `,title:be?"":fe?"":"",children:be?"":`${Z},${z}`},oe)})})})]})};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:k}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200",style:{width:"90vw",height:"90vh",maxWidth:"800px"},onClick:M=>M.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Et,{className:"w-6 h-6 text-green-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:k,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-6 py-4 overflow-y-auto",children:r.jsxs("div",{className:"space-y-6",children:[T(),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Row):"}),r.jsx("input",{type:"number",min:"0",value:g,onChange:M=>u(parseInt(M.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:" (Column):"}),r.jsx("input",{type:"number",min:"0",value:h,onChange:M=>m(parseInt(M.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition-colors"})]})]}),i&&r.jsx("div",{className:`text-sm p-2 rounded ${C?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:C?`${i.row},${i.col}`:` ${i.row},${i.col} `})]}),r.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsxs("div",{children:["",(n==null?void 0:n.name)||""]}),r.jsxs("div",{children:["",(n==null?void 0:n.type)||""]}),r.jsxs("div",{children:["",((G=n==null?void 0:n.contents)==null?void 0:G.filter(M=>M.type==="sub_container").length)||0]})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:k,disabled:b,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a("button.cancel")}),r.jsxs("button",{onClick:P,disabled:!C||b,className:"px-6 py-2 text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[b&&r.jsx(Rt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:b?"...":""})]})]})]})]})},Oh=({isOpen:e,onClose:t,storeShelf:n})=>{const{showNotification:s,medicineList:o,isLoadingMedicines:l,addStockToShelf:a,selectedStockItemForEdit:i,storeItemModalMode:c,updateStockInShelf:g}=rt(),[y,h]=f.useState(""),[p,b]=f.useState(""),[N,S]=f.useState(""),[A,d]=f.useState(""),[u,m]=f.useState([]),[C,P]=f.useState([]),[k,T]=f.useState(""),[G,M]=f.useState(""),[U,le]=f.useState(""),[ue,_]=f.useState(""),[v,H]=f.useState("EPD290"),[w,j]=f.useState(null),[D,I]=f.useState([]),[Z,z]=f.useState(""),[oe,be]=f.useState(!1),fe=f.useRef(null);f.useEffect(()=>{if(e&&c==="edit"&&i){h(i.code||""),b(i.name||""),S(""),d(i.material_no||"");const E=i.lot||[],X=i.expiry_date||[],B=i.qty||[],re=[];if(E.length>0||X.length>0||B.length>0){const V=Math.max(E.length,X.length,B.length),F=[];for(let J=0;J<V;J++){const ae=X[J]||"";let ge="";ae&&(ge=ae.split("T")[0]),ge=ge.replace(/\//g,"-"),F.push({id:`batch_${Date.now()}_${J}`,lot:E[J]||"",expiryDate:ge,qty:String(B[J]||"")}),ge&&re.push(ge)}m(F),P(re),m([])}else P([]);const $=(i.location||"0,0").split(",");T($[0]||"0"),M($[1]||"0"),le(i.led_index||""),_(i.ip||""),H(i.device_type||"EPD290")}else if(e&&c==="add"){if(h(""),b(""),S(""),d(""),m([]),P([]),le(""),_(""),H("EPD290"),n&&n.medMapStock&&n.medMapStock.length>0){const E=n.medMapStock.map(B=>{const ie=(B.location||"0,0").split(",");return Number(ie[0]||"0")});let X=0;for(;E.includes(X);)X++;T(String(X))}else T("0");M("0")}},[e,c,i,n]),f.useEffect(()=>{const E=X=>{fe.current&&!fe.current.contains(X.target)&&j(null)};return document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[]);const W=(E,X)=>{if(!X.trim()){I([]);return}const B=X.toLowerCase(),re=o.filter(ie=>{var $,V,F,J;switch(E){case"code":return($=ie.CODE)==null?void 0:$.toLowerCase().includes(B);case"name":return(V=ie.NAME)==null?void 0:V.toLowerCase().includes(B);case"chineseName":return(F=ie.CHT_NAME)==null?void 0:F.toLowerCase().includes(B);case"skdiacode":return(J=ie.SKDIACODE)==null?void 0:J.toLowerCase().includes(B);default:return!1}});I(re.slice(0,50))},he=(E,X)=>{switch(j(E),E){case"code":h(X);break;case"name":b(X);break;case"chineseName":S(X);break;case"skdiacode":d(X);break}W(E,X)},Y=(E,X)=>{switch(X){case"code":h(E.CODE||""),b(E.NAME||""),S(E.CHT_NAME||""),d(E.SKDIACODE||"");break;case"name":h(E.CODE||""),b(E.NAME||""),S(E.CHT_NAME||""),d(E.SKDIACODE||"");break;case"chineseName":h(E.CODE||""),b(E.NAME||""),S(E.CHT_NAME||""),d(E.SKDIACODE||"");break;case"skdiacode":h(E.CODE||""),b(E.NAME||""),S(E.CHT_NAME||""),d(E.SKDIACODE||"");break}z(E.GUID),j(null),I([])},Ce=()=>{const E={id:`batch_${Date.now()}`,lot:"",expiryDate:"",qty:""};m([...u,E])},ve=E=>{m(u.filter(X=>X.id!==E))},ye=(E,X,B)=>{m(u.map(re=>re.id===E?{...re,[X]:B}:re))},Ae=async()=>{var re;if(!y||!p){s("","error");return}if(!n||!n.GUID){s("","error");return}const E=[],X=[],B=[];u.forEach(ie=>{E.push(ie.lot||"");let $="";ie.expiryDate&&($=`${ie.expiryDate}`),X.push($),B.push(ie.qty?`${Number(ie.qty)}`:"0")});try{if(c==="edit"&&i){const ie={GUID:i.GUID,code:y,device_type:v,expiry_date:X,ip_light:ue||"",ip:ue||"",led_index:U||"",location:`${k||"0"},${G||"0"}`,lot:E,material_no:A||"",name:p,qty:B,shelf_guid:n.GUID},$=await ke.updateStock([ie]);if($.Code===200){g(n.GUID,i.GUID,ie),console.log("");const V=C.filter(F=>!X.includes(F));if(console.log(V),V.length>0){console.log(" :",V);let F="";try{i.Value&&(F=JSON.parse(i.Value).GUID||"",console.log("  Value  GUID:",F))}catch(J){console.error("  Value :",J)}if(F){for(const J of V)try{console.log(` GUID: ${F}, : ${J}`);const ae=await ke.stockDeleteValidityPeriod(F,J);ae.Code===200?console.log(` : ${J}`):console.warn(`  (: ${J}):`,ae.Result)}catch(ae){console.error(`  (: ${J}):`,ae)}s(` ${V.length} `,"success")}else console.warn("  Value GUID"),s("","success")}else s("","success");R()}else s($.Result||"","error")}else{const ie={code:y,device_type:v,expiry_date:X,ip_light:ue||"",ip:ue||"",led_index:U||"",location:`${k||"0"},${G||"0"}`,lot:E,material_no:A||"",name:p,qty:B,shelf_guid:n.GUID},$=await ke.addStock([ie]);$.Code===200?(a(n.GUID,{GUID:((re=$.Data)==null?void 0:re.GUID)||`stock_${Date.now()}`,...ie}),s("","success"),R()):s($.Result||"","error")}}catch(ie){console.error(":",ie),s(c==="edit"?"":"","error")}},te=(E,X)=>{console.log(" :",X),h(X[0].CODE||X[0].code||""),b(X[0].NAME||X[0].name||""),S(X[0].CHT_NAME||X[0].cht_name||""),d(X[0].SKDIACODE||X[0].skdiacode||X[0].material_no||""),z(X[0].GUID||""),be(!1),s("","success")},R=()=>{h(""),b(""),S(""),d(""),m([]),P([]),T(""),M(""),le(""),_(""),H("EPD290"),z(""),I([]),j(null),t()};return e?r.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between z-10",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800",children:c==="edit"?"":""}),r.jsx("button",{onClick:R,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:r.jsx(Ke,{className:"w-5 h-5"})})]}),r.jsx("div",{className:"p-4 space-y-2",children:l?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"..."})]}):o.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-gray-600",children:""}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:""})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex w-full border-b items-center pb-1",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700 mr-6",children:""}),r.jsx("button",{onClick:()=>be(!0),className:"hover:bg-gray-100 rounded-lg transition-colors p-2",title:"",children:r.jsx(Ur,{className:"w-7 h-7 text-blue-600"})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"relative",ref:w==="code"?fe:null,children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:y,onChange:E=>he("code",E.target.value),onFocus:()=>j("code"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""}),w==="code"&&D.length>0&&r.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:D.map(E=>r.jsxs("div",{onClick:()=>Y(E,"code"),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer border-b last:border-b-0",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx("span",{className:"font-medium text-gray-900",children:E.CODE}),r.jsx("span",{className:"text-gray-600",children:"|"}),r.jsx("span",{className:"text-gray-700",children:E.NAME})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1",children:[r.jsx("span",{className:"text-gray-600",children:E.CHT_NAME}),r.jsx("span",{className:"text-gray-400",children:"|"}),r.jsxs("span",{className:"text-gray-500",children:[": ",E.SKDIACODE]})]})]},E.GUID))})]}),r.jsxs("div",{className:"relative",ref:w==="name"?fe:null,children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:p,onChange:E=>he("name",E.target.value),onFocus:()=>j("name"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""}),w==="name"&&D.length>0&&r.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:D.map(E=>r.jsxs("div",{onClick:()=>Y(E,"name"),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer border-b last:border-b-0",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx("span",{className:"font-medium text-gray-900",children:E.CODE}),r.jsx("span",{className:"text-gray-600",children:"|"}),r.jsx("span",{className:"text-gray-700",children:E.NAME})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1",children:[r.jsx("span",{className:"text-gray-600",children:E.CHT_NAME}),r.jsx("span",{className:"text-gray-400",children:"|"}),r.jsxs("span",{className:"text-gray-500",children:[": ",E.SKDIACODE]})]})]},E.GUID))})]}),r.jsxs("div",{className:"relative",ref:w==="chineseName"?fe:null,children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:N,onChange:E=>he("chineseName",E.target.value),onFocus:()=>j("chineseName"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""}),w==="chineseName"&&D.length>0&&r.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:D.map(E=>r.jsxs("div",{onClick:()=>Y(E,"chineseName"),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer border-b last:border-b-0",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx("span",{className:"font-medium text-gray-900",children:E.CODE}),r.jsx("span",{className:"text-gray-600",children:"|"}),r.jsx("span",{className:"text-gray-700",children:E.NAME})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1",children:[r.jsx("span",{className:"text-gray-600",children:E.CHT_NAME}),r.jsx("span",{className:"text-gray-400",children:"|"}),r.jsxs("span",{className:"text-gray-500",children:[": ",E.SKDIACODE]})]})]},E.GUID))})]}),r.jsxs("div",{className:"relative",ref:w==="skdiacode"?fe:null,children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:A,onChange:E=>he("skdiacode",E.target.value),onFocus:()=>j("skdiacode"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""}),w==="skdiacode"&&D.length>0&&r.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:D.map(E=>r.jsxs("div",{onClick:()=>Y(E,"skdiacode"),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer border-b last:border-b-0",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx("span",{className:"font-medium text-gray-900",children:E.CODE}),r.jsx("span",{className:"text-gray-600",children:"|"}),r.jsx("span",{className:"text-gray-700",children:E.NAME})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1",children:[r.jsx("span",{className:"text-gray-600",children:E.CHT_NAME}),r.jsx("span",{className:"text-gray-400",children:"|"}),r.jsxs("span",{className:"text-gray-500",children:[": ",E.SKDIACODE]})]})]},E.GUID))})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:""}),r.jsxs("button",{onClick:Ce,className:"flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"",children:[r.jsx(Et,{className:"w-4 h-4"}),""]})]}),u.length===0?r.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[r.jsx("p",{className:"text-gray-500",children:""}),r.jsx("p",{className:"text-sm text-gray-400 mt-1",children:""})]}):r.jsx("div",{className:"space-y-3",children:u.map((E,X)=>r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[" ",X+1]}),r.jsx("button",{onClick:()=>ve(E.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"",children:r.jsx(Sr,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),r.jsx("input",{type:"text",value:E.lot,onChange:B=>ye(E.id,"lot",B.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),r.jsx("input",{type:"date",value:E.expiryDate,onChange:B=>ye(E.id,"expiryDate",B.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),r.jsx("input",{type:"number",value:E.qty,onChange:B=>ye(E.id,"qty",B.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"",min:"0"})]})]})]},E.id))})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:""}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:k,onChange:E=>T(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsx("input",{type:"text",value:G,onChange:E=>M(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LED "}),r.jsx("input",{type:"text",value:U,onChange:E=>le(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:" LED "})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" IP"}),r.jsx("input",{type:"text",value:ue,onChange:E=>_(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:" IP"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),r.jsxs("select",{value:v,onChange:E=>H(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:[r.jsx("option",{value:"EPD290",children:"EPD290"}),r.jsx("option",{value:"RowsLED",children:"RowsLED"}),r.jsx("option",{value:"EPD730E",children:"EPD730E"}),r.jsx("option",{value:"EPD730F",children:"EPD730F"})]})]})]})]})]})}),r.jsxs("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 border-t flex justify-end space-x-3",children:[r.jsx("button",{onClick:R,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition-colors",children:""}),r.jsx("button",{onClick:Ae,disabled:l||o.length===0,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400",children:c==="edit"?"":""})]})]}),r.jsx(tl,{isOpen:oe,onClose:()=>be(!1),onScanSuccess:te,mode:"set_store_med_mode"})]}):null},Uh=({isOpen:e,onClose:t})=>{const{selectedDepartmentType:n,apiDepartmentData:s,allDepartmentsList:o,showNotification:l,triggerRefresh:a,reloadMedMapData:i}=rt(),[c,g]=f.useState(null),[y,h]=f.useState(""),[p,b]=f.useState(!1),N=()=>s?s.map(T=>T.name):[],S=()=>!n||!o?[]:o.filter(T=>T["department_type "]===n),A=()=>{const T=N();return S().filter(M=>!T.includes(M.name))},d=()=>s?s.map(T=>T.gird_position):[],u=()=>{const T=d(),G=[];for(let M=0;M<10;M++)for(let U=0;U<10;U++){const le=`${M},${U}`;T.includes(le)||G.push(le)}return G.slice(0,20)};f.useEffect(()=>{e&&(g(null),h(""))},[e]);const m=async()=>{if(!c){l("","error");return}if(!y){l("","error");return}if(!n){l("","error");return}b(!0);try{const T=await ke.addMedMap(c.name,c.type,y);T.Code===200?(l("","success"),await i(),C()):l(T.Result||"","error")}catch(T){console.error(":",T),l("","error")}finally{b(!1)}},C=()=>{g(null),h(""),t()};if(!e)return null;const P=A(),k=u();return r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800",children:""}),r.jsx("button",{onClick:C,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:r.jsx(Ke,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-6 space-y-6",children:[n&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["",r.jsx("span",{className:"font-bold",children:n})]})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:""}),P.length===0?r.jsx("div",{className:"text-center py-8",children:r.jsx("p",{className:"text-gray-600",children:""})}):r.jsx("div",{className:"space-y-2",children:P.map(T=>r.jsxs("label",{className:`flex items-center p-4 border-2 rounded-lg cursor-pointer transition-all ${(c==null?void 0:c.name)===T.name?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300 hover:bg-gray-50"}`,children:[r.jsx("input",{type:"radio",name:"department",value:T.name,checked:(c==null?void 0:c.name)===T.name,onChange:()=>g(T),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),r.jsxs("div",{className:"ml-3",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.name}),r.jsx("div",{className:"text-xs text-gray-500",children:T.type})]})]},T.name))})]}),c&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:""}),k.length===0?r.jsx("div",{className:"text-center py-8",children:r.jsx("p",{className:"text-gray-600",children:""})}):r.jsx("div",{className:"grid grid-cols-5 gap-2",children:k.map(T=>{const[G,M]=T.split(",");return r.jsxs("button",{onClick:()=>h(T),className:`p-3 border-2 rounded-lg text-sm font-medium transition-all ${y===T?"border-blue-500 bg-blue-500 text-white":"border-gray-200 hover:border-blue-300 hover:bg-blue-50 text-gray-700"}`,children:["(",G,",",M,")"]},T)})})]})]}),r.jsxs("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 border-t flex justify-end space-x-3",children:[r.jsx("button",{onClick:C,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition-colors",disabled:p,children:""}),r.jsx("button",{onClick:m,disabled:!c||!y||p,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:p?"...":""})]})]})})},Lh=({isOpen:e,onClose:t,initialBarcode:n=""})=>{const{showNotification:s,medicineList:o,isLoadingMedicines:l}=rt(),[a,i]=f.useState(""),[c,g]=f.useState(""),[y,h]=f.useState(""),[p,b]=f.useState(""),[N,S]=f.useState(""),[A,d]=f.useState(null),[u,m]=f.useState([]),[C,P]=f.useState(""),[k,T]=f.useState(null),[G,M]=f.useState(!1),U=f.useRef(null);f.useEffect(()=>{e&&(i(n),g(""),h(""),b(""),S(""),P(""),T(null),d(null))},[e,n]),f.useEffect(()=>{const w=j=>{U.current&&!U.current.contains(j.target)&&d(null)};return document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[]);const le=(w,j)=>{if(!j.trim()||l){m([]);return}const D=j.toLowerCase(),I=o.filter(Z=>{var z,oe,be,fe;switch(w){case"code":return(z=Z.CODE)==null?void 0:z.toLowerCase().includes(D);case"name":return(oe=Z.NAME)==null?void 0:oe.toLowerCase().includes(D);case"chineseName":return(be=Z.CHT_NAME)==null?void 0:be.toLowerCase().includes(D);case"skdiacode":return(fe=Z.SKDIACODE)==null?void 0:fe.toLowerCase().includes(D);default:return!1}});m(I.slice(0,10))},ue=(w,j)=>{switch(d(w),w){case"code":g(j);break;case"name":h(j);break;case"chineseName":b(j);break;case"skdiacode":S(j);break}le(w,j)},_=w=>{P(w.GUID),T(w),g(w.CODE||""),h(w.NAME||""),b(w.CHT_NAME||""),S(w.SKDIACODE||""),d(null),m([])},v=()=>{i(""),g(""),h(""),b(""),S(""),P(""),T(null),d(null),m([]),t()},H=async()=>{if(!c.trim()){s("","error");return}if(!a.trim()){s("","error");return}M(!0);try{let w=[];if(k&&k.BARCODE2)try{const D=JSON.parse(k.BARCODE2);Array.isArray(D)?w=[...D]:typeof D=="string"&&(w=[D])}catch{console.warn(" BARCODE2 :",k.BARCODE2),k.BARCODE2&&(w=[k.BARCODE2])}w.includes(a.trim())||w.push(a.trim()),console.log("  BARCODE2 :",w);const j=await ke.addMedClouds(a.trim(),c.trim(),JSON.stringify(w),k.BARCODE);j.Code===200?(s("","success"),v()):s(j.Result||"","error")}catch(w){console.error(":",w),s("","error")}finally{M(!1)}};return e?r.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between p-2 border-b",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:r.jsx(Et,{className:"w-6 h-6 text-blue-500"})}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:v,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",disabled:G,children:r.jsx(Ke,{className:"w-6 h-6 text-gray-600"})})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:r.jsxs("div",{className:"space-y-4",ref:U,children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:a,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-600 cursor-not-allowed"})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[" ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:c,onChange:w=>ue("code",w.target.value),onFocus:()=>d("code"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"...",disabled:G}),A==="code"&&u.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:u.map(w=>r.jsxs("div",{onClick:()=>_(w),className:"px-4 py-2 hover:bg-green-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[r.jsx("div",{className:"font-medium text-gray-800",children:w.CODE}),r.jsx("div",{className:"text-sm text-gray-600",children:w.NAME})]},w.GUID))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:y,onChange:w=>ue("name",w.target.value),onFocus:()=>d("name"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"...",disabled:G}),A==="name"&&u.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:u.map(w=>r.jsxs("div",{onClick:()=>_(w),className:"px-4 py-2 hover:bg-green-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[r.jsx("div",{className:"font-medium text-gray-800",children:w.NAME}),r.jsx("div",{className:"text-sm text-gray-600",children:w.CODE})]},w.GUID))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:p,onChange:w=>ue("chineseName",w.target.value),onFocus:()=>d("chineseName"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"...",disabled:G}),A==="chineseName"&&u.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:u.map(w=>r.jsxs("div",{onClick:()=>_(w),className:"px-4 py-2 hover:bg-green-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[r.jsx("div",{className:"font-medium text-gray-800",children:w.CHT_NAME}),r.jsx("div",{className:"text-sm text-gray-600",children:w.CODE})]},w.GUID))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:N,onChange:w=>ue("skdiacode",w.target.value),onFocus:()=>d("skdiacode"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"...",disabled:G}),A==="skdiacode"&&u.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:u.map(w=>r.jsxs("div",{onClick:()=>_(w),className:"px-4 py-2 hover:bg-green-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[r.jsx("div",{className:"font-medium text-gray-800",children:w.SKDIACODE}),r.jsx("div",{className:"text-sm text-gray-600",children:w.NAME})]},w.GUID))})]}),l&&r.jsx("div",{className:"text-center py-2 text-gray-500 text-sm",children:"..."})]})}),r.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:v,disabled:G,className:"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:""}),r.jsx("button",{onClick:H,disabled:G||!c.trim(),className:"px-6 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:G?"...":""})]})})]})}):null},Bh=({container:e,highlightedMedicineCode:t,pendingRequisitionCodes:n=[],onMedicineClick:s})=>{const o=()=>{try{const h=localStorage.getItem("medMap_setting");if(h)return JSON.parse(h).light_color||"red"}catch(h){console.error(":",h)}return"red"},l=h=>{const[p,b]=h.split(",").map(Number);return{row:p||0,col:b||0}},a=h=>{if(!h||h.length===0)return{sortedContents:[],maxRow:0,maxCol:0};const p=h.map(A=>({...A,gridPos:l(A.gird_position||"0,0")})),b=Math.max(...p.map(A=>A.gridPos.row),0),N=Math.max(...p.map(A=>A.gridPos.col),0);return{sortedContents:p.sort((A,d)=>A.gridPos.row!==d.gridPos.row?A.gridPos.row-d.gridPos.row:A.gridPos.col-d.gridPos.col),maxRow:b,maxCol:N}},i=h=>{switch(h){case"parent_container":return"border-gray-300";case"sub_container":return"border-gray-300";case"dispensing_shelves":case"store_shelves":return"border-gray-300";case"med_box":return"border-gray-300";case"grid_draw":case"list_draw":return"border-gray-300";default:return"border-gray-300"}},c=h=>{const p=["med_box","dispensing_shelves","store_shelves","grid_draw","list_draw"].includes(h.type);return r.jsx("div",{className:`${p?"shadow-sm border-2 p-1 rounded-lg":""} ${i(h.type)} flex flex-col max-w-full min-w-0 h-full overflow-hidden`,children:r.jsx("div",{className:"flex-1 min-w-0 overflow-hidden",children:y(h)})},h.GUID)},g=(h,p,b)=>{const N={};return h.forEach(S=>{const A=l(S.gird_position||"0,0");N[`${A.row},${A.col}`]=S}),r.jsx("table",{className:"w-full h-full max-w-full table-fixed",style:{borderCollapse:"separate",borderSpacing:"0px"},children:r.jsx("tbody",{children:Array.from({length:p+1},(S,A)=>r.jsx("tr",{children:Array.from({length:b+1},(d,u)=>{const m=`${A},${u}`,C=N[m];return C?r.jsx("td",{className:"align-top bg-transparent overflow-hidden",style:{width:`${100/(b+1)}%`,maxWidth:`${100/(b+1)}%`},children:c(C)},u):r.jsx("td",{className:"align-top bg-transparent overflow-hidden",style:{width:`${100/(b+1)}%`,maxWidth:`${100/(b+1)}%`},children:r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300 text-xs border border-dashed border-gray-200 rounded overflow-hidden",children:""})},u)})},A))})})},y=h=>{switch(h.type){case"parent_container":if(h.contents&&h.contents.length>0){const{sortedContents:p,maxRow:b,maxCol:N}=a(h.contents);return g(p,b,N)}else return r.jsx("div",{className:""});case"sub_container":if(h.contents&&h.contents.length>0){const{sortedContents:p,maxRow:b,maxCol:N}=a(h.contents);return g(p,b,N)}else return r.jsx("div",{className:""});case"dispensing_shelves":if(h.contents&&h.contents.length>0){const{sortedContents:p,maxRow:b,maxCol:N}=a(h.contents);return g(p,b,N)}else return r.jsx("div",{className:"border-2 rounded-lg flex py-3 items-center justify-center h-full text-gray-400 text-sm",children:""});case"store_shelves":if(h.medMapStock&&h.medMapStock.length>0){const p=h.medMapStock,b={};p.forEach(A=>{const d=A.location||A.gird_position||"0,0",[u,m]=d.split(",").map(Number);b[u]||(b[u]=[]),b[u].push({...A,_position:u,_depth:m})});const N=Object.keys(b).map(Number).sort((A,d)=>A-d),S=N.length;return Math.max(...N.map(A=>b[A].length)),r.jsx("div",{className:"flex h-full w-full overflow-hidden gap-1",children:N.map(A=>{const d=b[A].sort((P,k)=>k._depth-P._depth),u=S>0?100/S:100,m=d.length,C=m>0?100/m:100;return r.jsx("div",{className:"flex flex-col h-full",style:{width:`${u}%`},children:d.map((P,k)=>{let T=0;P.qty&&P.qty.forEach(ue=>{T+=+ue});const G=t&&(P.code==t||P.material_no==t),M=n.includes(P.code)||n.includes(P.material_no),U=o(),le=k===m-1;return r.jsxs("div",{className:`border-2 rounded-lg border-gray-300 p-2 flex flex-col text-gray-800 justify-center items-center transition-colors cursor-pointer min-w-0 overflow-hidden ${le?"":"mb-1"} ${M?"highlight-breathe-red":G?`highlight-breathe-${U}`:""}`,style:{height:`calc(${C}% - ${le?"0px":"0.25rem"})`},onClick:()=>s&&s({code:P.code||P.material_no,name:P.name}),children:[r.jsx("div",{className:"text-sm font-semibold truncate w-full text-center whitespace-normal overflow-hidden",children:P.name||P.material_no}),r.jsxs("div",{className:"text-xs mt-1",children:[": ",T||0]})]},P.GUID||k)})},A)})})}else if(h.contents&&h.contents.length>0){const{sortedContents:p,maxRow:b,maxCol:N}=a(h.contents);return g(p,b,N)}else return r.jsx("div",{className:"border-2 flex py-3 items-center justify-center h-full text-gray-400 text-sm",children:""});case"grid_draw":return r.jsxs("div",{className:"border-2 bg-violet-100 h-16 flex rounded-lg border-2 border-violet-400 max-w-[120px] w-full items-center justify-center mx-auto overflow-hidden",children:[r.jsx("div",{className:"h-[50%] bg-violet-400 w-[3%] rounded flex-shrink-0"}),r.jsx("div",{className:"h-[70%] border-2 border-violet-400 w-[82%] mx-1 flex items-center justify-center overflow-hidden",children:r.jsx("span",{className:"text-xs text-violet-600 truncate",children:""})}),r.jsx("div",{className:"h-[50%] bg-violet-400 w-[3%] flex-shrink-0"})]});case"list_draw":return r.jsxs("div",{className:"border-2 bg-violet-100 h-16 flex rounded-lg border-2 border-violet-400 max-w-[120px] w-full items-center justify-center mx-auto overflow-hidden",children:[r.jsx("div",{className:"h-[50%] bg-violet-400 w-[3%] rounded flex-shrink-0"}),r.jsx("div",{className:"h-[70%] border-2 border-violet-400 w-[82%] mx-1 flex items-center justify-center overflow-hidden",children:r.jsx("span",{className:"text-xs text-violet-600 truncate",children:""})}),r.jsx("div",{className:"h-[50%] bg-violet-400 w-[3%] flex-shrink-0"})]});case"med_box":if(h.med_info&&h.med_info.length>0){const p=t&&h.med_info.some(S=>S.code==t),b=h.med_info.some(S=>n.includes(S.code)),N=o();return r.jsx("div",{className:`text-sm text-center h-full p-2 flex flex-col text-gray-800 justify-center transition-colors cursor-pointer overflow-hidden ${b?"highlight-breathe-red":p?`highlight-breathe-${N}`:""}`,onClick:()=>s&&s(h.med_info[0]),children:r.jsx("div",{className:"font-semibold truncate w-full overflow-hidden",children:h.med_info[0].name||"-"})})}else return r.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-xs",children:""});default:if(h.contents&&h.contents.length>0){const{sortedContents:p,maxRow:b,maxCol:N}=a(h.contents);return g(p,b,N)}else return r.jsxs("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:[": ",h.type]})}};return e?r.jsx("div",{className:"w-full h-full overflow-auto",children:r.jsx("div",{className:"max-w-full h-full",children:y(e)})}):r.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:r.jsx("p",{children:""})})},zh=({isOpen:e,onClose:t,type:n,data:s,onApprove:o})=>{const[l,a]=f.useState("0"),[i,c]=f.useState("0"),[g,y]=f.useState(null),[h,p]=f.useState(null),[b,N]=f.useState(!1),[S,A]=f.useState(!1),[d,u]=f.useState(""),[m,C]=f.useState(""),[P,k]=f.useState([]),[T,G]=f.useState([]),[M,U]=f.useState([]),[le,ue]=f.useState(!1),[_,v]=f.useState(!1),H=f.useRef(null),w=f.useRef(null),j=f.useRef(null),D=f.useRef(null);f.useEffect(()=>{if(e&&s){const R=s.issuedQuantity||s.requestedQuantity||"0";a(R),c(R),y(null),p(null),N(!1);const E=localStorage.getItem("medMap_setting");if(E)try{const X=JSON.parse(E);u(X.default_person||""),C(X.default_person_id||"")}catch(X){console.error(":",X),u(""),C("")}else u(""),C("");I()}},[e,s]),f.useEffect(()=>{const R=E=>{j.current&&!j.current.contains(E.target)&&H.current&&!H.current.contains(E.target)&&ue(!1),D.current&&!D.current.contains(E.target)&&w.current&&!w.current.contains(E.target)&&v(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]);const I=async()=>{try{const R=await ke.getAllStaffInfo();R.Code===200&&R.Data&&k(R.Data)}catch(R){console.error(":",R)}},Z=R=>{if(u(R),R.trim()===""){G([]),ue(!1);return}const E=P.filter(X=>X.name&&X.name.toLowerCase().includes(R.toLowerCase()));G(E),ue(E.length>0)},z=R=>{if(C(R),R.trim()===""){U([]),v(!1);return}const E=P.filter(X=>X.ID&&X.ID.toLowerCase().includes(R.toLowerCase()));U(E),v(E.length>0)},oe=R=>{u(R.name),C(R.ID),ue(!1)},be=R=>{u(R.name),C(R.ID),v(!1)};if(!e||!s)return null;const fe=R=>{if(b)a(R),c(R),N(!1);else{const E=l==="0"?R:l+R;a(E),c(E)}},W=R=>{g&&h!==null&&!b&&he(),p(i),y(R),N(!0)},he=()=>{if(g===null||h===null)return;const R=parseFloat(h),E=parseFloat(i);let X=0;switch(g){case"+":X=R+E;break;case"-":X=R-E;break;case"":X=R*E;break;case"":X=E!==0?R/E:0;break;default:return}const B=X.toString();a(B),c(B),y(null),p(null),N(!0)},Y=()=>{he()},Ce=()=>{if(b)a("0."),c("0."),N(!1);else if(!l.includes(".")){const R=l+".";a(R),c(R)}},ve=()=>{a("0"),c("0"),y(null),p(null),N(!1)},ye=()=>{const R=new Date,E=R.getFullYear(),X=String(R.getMonth()+1).padStart(2,"0"),B=String(R.getDate()).padStart(2,"0"),re=String(R.getHours()).padStart(2,"0"),ie=String(R.getMinutes()).padStart(2,"0"),$=String(R.getSeconds()).padStart(2,"0");return`${E}-${X}-${B}T${re}:${ie}:${$}`},Ae=async()=>{if(!s)return;if(!d.trim()){alert("");return}const R=n==="requisition"?"":"";if(window.confirm(`

${s.name}
${l}
${d}${m?` (${m})`:""}

${R}`)){A(!0);try{const X=ye();if(n==="requisition"){const B=await ke.updateRequisitionActualQuantity(s.GUID,l);if(B.Code!==200){alert(`${B.Message||""}`),A(!1);return}const re={...s,actualQuantity:l,notice:"False",state:"",issuingPerson:d,issueTime:X};console.log("request",re);const ie=await ke.updateRequisitionByGuid(re);if(ie.Code!==200){alert(`${ie.Message||""}`),A(!1);return}console.log(" :",{GUID:s.GUID,name:s.name,actualQuantity:l,issuingPerson:d,issueTime:X})}else{const B=await ke.updateDistributionActualQuantity(s.GUID,l);if(B.Code!==200){alert(`${B.Message||""}`),A(!1);return}const re={...s,actualQuantity:l,notice:"False",state:"",issuer:d,issuanceTime:X};console.log("request",re);const ie=await ke.updateDistributionByGuid(re);if(ie.Code!==200){alert(`${ie.Message||""}`),A(!1);return}console.log(" :",{GUID:s.GUID,name:s.name,actualQuantity:l,issuer:d,issuanceTime:X})}o&&await o(),alert(`${R}`),t()}catch(X){console.error(`${R}:`,X),alert(`${R}`)}finally{A(!1)}}},te=n==="requisition"?s.requestedQuantity:s.issuedQuantity;return r.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),r.jsxs("div",{className:"relative w-full max-w-md bg-white shadow-2xl rounded-xl overflow-hidden flex flex-col m-4 max-h-[90vh]",children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200",children:[r.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:[n==="requisition"?"":"",""]}),r.jsx("button",{onClick:t,className:"p-2 hover:bg-white/50 rounded-full transition-colors",title:"",children:r.jsx(Ke,{className:"w-5 h-5 text-gray-700"})})]}),r.jsx("div",{className:"overflow-y-auto flex-1",children:r.jsxs("div",{className:"p-4 space-y-2",children:[r.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 space-y-2",children:[r.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:""}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{ref:H,type:"text",value:d,onChange:R=>Z(R.target.value),onFocus:()=>{d.trim()&&Z(d)},placeholder:"",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),le&&r.jsx("div",{ref:j,className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:T.map((R,E)=>r.jsxs("div",{onClick:()=>oe(R),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[r.jsx("div",{className:"text-xs text-gray-500",children:R.ID}),r.jsx("div",{className:"font-medium text-gray-900 text-sm",children:R.name})]},E))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{ref:w,type:"text",value:m,onChange:R=>z(R.target.value),onFocus:()=>{m.trim()&&z(m)},placeholder:" ID",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),_&&r.jsx("div",{ref:D,className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:M.map((R,E)=>r.jsxs("div",{onClick:()=>be(R),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[r.jsx("div",{className:"font-medium text-gray-900 text-sm",children:R.ID}),r.jsx("div",{className:"text-xs text-gray-500",children:R.name})]},E))})]})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-gray-600",children:""}),r.jsx("div",{className:"text-base text-gray-800 mt-1",children:s.name||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-gray-600",children:""}),r.jsx("div",{className:"text-base text-gray-800 mt-1",children:s.code||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-gray-600",children:n==="requisition"?"":""}),r.jsx("div",{className:"text-base text-gray-800 mt-1",children:te||"-"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-base font-semibold text-gray-600 block mb-2",children:""}),r.jsx("input",{type:"text",value:l,disabled:!0,className:"w-full px-4 py-3 text-lg font-semibold text-gray-800 bg-gray-100 border border-gray-300 rounded-lg"})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[r.jsx("button",{onClick:()=>fe("7"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"7"}),r.jsx("button",{onClick:()=>fe("8"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"8"}),r.jsx("button",{onClick:()=>fe("9"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"9"}),r.jsx("button",{onClick:()=>W(""),className:"py-4 text-lg font-semibold bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-lg transition-colors",children:""}),r.jsx("button",{onClick:()=>fe("4"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"4"}),r.jsx("button",{onClick:()=>fe("5"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"5"}),r.jsx("button",{onClick:()=>fe("6"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"6"}),r.jsx("button",{onClick:()=>W(""),className:"py-4 text-lg font-semibold bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-lg transition-colors",children:""}),r.jsx("button",{onClick:()=>fe("1"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"1"}),r.jsx("button",{onClick:()=>fe("2"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"2"}),r.jsx("button",{onClick:()=>fe("3"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"3"}),r.jsx("button",{onClick:()=>W("-"),className:"py-4 text-lg font-semibold bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-lg transition-colors",children:"-"}),r.jsx("button",{onClick:()=>fe("0"),className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"0"}),r.jsx("button",{onClick:Ce,className:"py-4 text-lg font-semibold bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"."}),r.jsx("button",{onClick:Y,className:"py-4 text-lg font-semibold bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors",children:"="}),r.jsx("button",{onClick:()=>W("+"),className:"py-4 text-lg font-semibold bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-lg transition-colors",children:"+"})]})]})}),r.jsxs("div",{className:"flex items-center justify-end gap-2 p-3 border-t border-gray-200 bg-gray-50",children:[r.jsx("button",{onClick:ve,className:"px-6 py-2.5 font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors",children:""}),r.jsx("button",{onClick:t,className:"px-6 py-2.5 font-semibold text-gray-700 bg-white border border-gray-300 hover:bg-gray-100 rounded-lg transition-colors",children:""}),r.jsx("button",{onClick:Ae,disabled:S,className:"px-6 py-2.5 font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:S?"...":""})]})]})]})},Gh=({isOpen:e,onClose:t,medicineInfo:n,requisitions:s,distributions:o,onNoticeUpdated:l})=>{const{setHighlightedMedicineCode:a}=rt(),[i,c]=f.useState(s),[g,y]=f.useState(o),[h,p]=f.useState(null),[b,N]=f.useState(!1),[S,A]=f.useState(null),[d,u]=f.useState("requisition"),[m,C]=f.useState(!1),[P,k]=f.useState(!1);mo.useEffect(()=>{c(s),y(o)},[s,o]),f.useEffect(()=>()=>{ps.cleanup()},[]);const T=async()=>{var v;if(n&&!P){if(!n.serverName||!n.serverType){alert("");return}k(!0);try{const H=localStorage.getItem("medMap_setting");let w="255,0,0",j="1",D=60;if(H)try{const I=JSON.parse(H);w={blue:"255,0,0",green:"0,255,0",red:"0,0,255",yellow:"0,255,255",purple:"255,0,255",cyan:"255,255,0"}[I.light_color]||"255,0,0",j=((v=I.brightness)==null?void 0:v.toString())||"1",D=I.light_sec||60}catch(I){console.error(":",I)}if(m)await ps.turnOffAllLights(),C(!1),a(null);else{const I=[{serverName:n.serverName,serverType:n.serverType,medicineCode:n.code}];await ps.startLighting(I,w,j,D*1e3,()=>{C(!1),a(null)}),C(!0),a(n.code)}}catch(H){console.error(":",H)}finally{k(!1)}}},G=async v=>{const H=v.notice==="True"?"False":"True";p(v.GUID);const w=[...i],j=w.findIndex(D=>D.GUID===v.GUID);if(j===-1){p(null);return}w[j]={...v,notice:H},c(w);try{const D=await ke.updateRequisitionNotice(v.GUID,H);D.Code!==200?(w[j]={...v,notice:v.notice},c(w),console.error(":",D)):l&&l()}catch(D){w[j]={...v,notice:v.notice},c(w),console.error(":",D)}finally{p(null)}},M=async v=>{const H=v.notice==="True"?"False":"True";p(v.GUID);const w=[...g],j=w.findIndex(D=>D.GUID===v.GUID);if(j===-1){p(null);return}w[j]={...v,notice:H},y(w);try{const D=await ke.updateDistributionNotice(v.GUID,H);D.Code!==200?(w[j]={...v,notice:v.notice},y(w),console.error(":",D)):l&&l()}catch(D){w[j]={...v,notice:v.notice},y(w),console.error(":",D)}finally{p(null)}};if(!e||!n)return null;const U=i.filter(v=>v.state===""),le=g.filter(v=>v.state===""),ue=U.length===0&&le.length===0,_=v=>{if(!v||v==="1/01/01 00:00:00"||v==="0001-01-01T00:00:00")return"-";try{const H=new Date(v);if(isNaN(H.getTime()))return v;const w=H.getFullYear(),j=String(H.getMonth()+1).padStart(2,"0"),D=String(H.getDate()).padStart(2,"0"),I=String(H.getHours()).padStart(2,"0"),Z=String(H.getMinutes()).padStart(2,"0");return`${w}/${j}/${D} ${I}:${Z}`}catch{return v}};return r.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),r.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] bg-white shadow-2xl rounded-lg overflow-hidden flex flex-col m-4",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200",children:[r.jsxs("div",{className:"flex gap-4 items-center",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800",children:""}),r.jsx("button",{onClick:T,disabled:P,className:`p-2 rounded-full transition-all disabled:opacity-50 disabled:cursor-not-allowed ${m?"bg-green-500 text-white hover:bg-green-600 shadow-lg":"bg-gray-200 text-gray-600 hover:bg-gray-300"}`,title:m?"":"",children:r.jsx(dh,{className:"w-6 h-6",fill:m?"currentColor":"none"})})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("button",{onClick:t,className:"p-2 hover:bg-white/50 rounded-full transition-colors",title:"",children:r.jsx(Ke,{className:"w-6 h-6 text-gray-700"})})})]}),r.jsx("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:n.name||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:n.skdiacode||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:n.code||"-"})]}),n.cht_name&&r.jsxs("div",{className:"col-span-2",children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:n.cht_name})]})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:ue?r.jsx("div",{className:"flex items-center justify-center h-40 text-gray-400 text-lg",children:""}):r.jsxs("div",{className:"space-y-2",children:[U.map((v,H)=>r.jsxs("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50 hover:shadow-md transition-shadow",onClick:()=>{u("requisition"),A(v),N(!0)},children:[r.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[r.jsxs("div",{className:"flex items-center gap-6",children:[r.jsx("span",{className:"underline font-medium text-xl font-semibold text-gray-700",children:""}),r.jsx("button",{onClick:w=>{w.stopPropagation(),G(v)},disabled:h===v.GUID,className:`p-2 rounded-full transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:scale-110 ${v.notice==="True"?"bg-green-500 text-white hover:bg-green-600":"bg-gray-300 text-gray-600 hover:bg-gray-400"}`,title:v.notice==="True"?"":"",children:r.jsx(Ec,{className:"w-5 h-5"})})]}),r.jsx("span",{className:`px-3 text-sm py-2 text-white font-semibold rounded-full ${v.actionType.includes("")?"bg-green-600":"bg-blue-600"}`,children:v.actionType})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:v.requestingUnit||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:v.requestingPerson||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:v.requestedQuantity||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:_(v.requestTime)})]})]})]},v.GUID)),le.map((v,H)=>r.jsxs("div",{className:"border border-yellow-200 rounded-lg p-3 bg-yellow-50 hover:shadow-md transition-shadow",onClick:()=>{u("distribution"),A(v),N(!0)},children:[r.jsxs("div",{className:"flex items-center gap-6 mb-2",children:[r.jsx("span",{className:"underline font-medium text-xl rounded-full text-gray-700",children:""}),r.jsx("button",{onClick:w=>{w.stopPropagation(),M(v)},disabled:h===v.GUID,className:`p-2 rounded-full transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:scale-110 ${v.notice==="True"?"bg-green-500 text-white hover:bg-green-600":"bg-gray-300 text-gray-600 hover:bg-gray-400"}`,title:v.notice==="True"?"":"",children:r.jsx(Ec,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:v.sourceStoreType||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:v.destinationStoreType||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:v.LOT||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:v.VAL||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:v.issuedQuantity||"-"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:v.reportName||"-"})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("span",{className:"font-semibold text-gray-600",children:""}),r.jsx("span",{className:"text-gray-800",children:_(v.addedTime)})]})]})]},v.GUID))]})})]}),r.jsx(zh,{isOpen:b,onClose:()=>N(!1),type:d,data:S,onApprove:l})]})},Fh=({isOpen:e,onClose:t,container:n})=>{const[s,o]=f.useState("list_mode"),{highlightedMedicineCode:l,apiDepartmentData:a}=rt(),[i,c]=f.useState(!1),[g,y]=f.useState([]),[h,p]=f.useState([]),[b,N]=f.useState([]),[S,A]=f.useState(!1),[d,u]=f.useState(null),m=f.useRef(null),C=f.useRef(null),P=f.useCallback(_=>{if(!a||!_)return null;const v=H=>{for(const w of H){if(w.GUID===_)return w;if(w.contents&&Array.isArray(w.contents)){const j=v(w.contents);if(j)return j}}return null};for(const H of a){if(H.GUID===_)return H;if(H.contents&&Array.isArray(H.contents)){const w=v(H.contents);if(w)return w}}return null},[a]),k=n?P(n.GUID)||n:null,T=()=>{try{const v=localStorage.getItem("medMap_setting");if(v){const w=JSON.parse(v).light_sec;if(w!=null&&w!==""){const j=Number(w);if(!isNaN(j)&&j>0)return j*1e3}}}catch(v){console.error(":",v)}return 6e4},G=()=>{try{const _=localStorage.getItem("medMap_setting");if(_)return JSON.parse(_).light_color||"red"}catch(_){console.error(":",_)}return"red"},M=f.useCallback(async()=>{try{const _=new Date,v=`${_.getFullYear()}-${String(_.getMonth()+1).padStart(2,"0")}-${String(_.getDate()).padStart(2,"0")} 00:00:00`,H=`${_.getFullYear()}-${String(_.getMonth()+1).padStart(2,"0")}-${String(_.getDate()).padStart(2,"0")} 23:59:59`,[w,j]=await Promise.all([ke.getRequisitionByTime(v,H),ke.getDistributionByTime(v,H)]),D=[];if(w.Code===200&&w.Data){const I=w.Data.filter(z=>{var oe;return(oe=k==null?void 0:k.med_list)==null?void 0:oe.some(be=>be.code===z.code)});p(I),I.filter(z=>z.state===""&&z.notice==="True").forEach(z=>{z.code&&D.push(z.code)})}if(j.Code===200&&j.Data){const I=j.Data.filter(z=>{var oe;return(oe=k==null?void 0:k.med_list)==null?void 0:oe.some(be=>be.code===z.code)});N(I),I.filter(z=>z.state===""&&z.notice==="True").forEach(z=>{z.code&&(D.includes(z.code)||D.push(z.code))})}y(D)}catch(_){console.error(":",_)}},[k]);f.useEffect(()=>(e?(M(),C.current&&clearInterval(C.current),C.current=setInterval(()=>{M()},1e4)):C.current&&(clearInterval(C.current),C.current=null),()=>{C.current&&(clearInterval(C.current),C.current=null)}),[e,M]),f.useEffect(()=>{var _;k&&console.log(" ContainerDetailModal: currentContainer updated",{GUID:k.GUID,name:k.name,medListCount:((_=k.med_list)==null?void 0:_.length)||0})},[k]),f.useEffect(()=>{if(console.log("",k),console.log(" ContainerDetailModal - :",{isOpen:e,highlightedMedicineCode:l,containerName:k==null?void 0:k.name}),e&&l){c(!0);const _=T();console.log(" ContainerDetailModal - :",{medicineCode:l,duration:_/1e3+""}),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{console.log(" ContainerDetailModal - "),c(!1),m.current=null},_)}else c(!1);return()=>{m.current&&clearTimeout(m.current)}},[e,l]);const U=_=>{var w,j;h.filter(D=>D.code===_.code),b.filter(D=>D.code===_.code);const v=D=>{for(const I of D){if(I.type==="store_shelves"&&I.medMapStock){const Z=I.medMapStock.find(z=>z.code===_.code);if(Z)return{stock:Z,shelf:I}}if(I.contents&&I.contents.length>0){const Z=v(I.contents);if(Z)return Z}}return null},H=n?v([n]):null;u({code:_.code,name:_.name,cht_name:_.cht_name,skdiacode:_.SKDIACODE||_.skdiacode,serverName:(w=H==null?void 0:H.shelf)==null?void 0:w.serverName,serverType:(j=H==null?void 0:H.shelf)==null?void 0:j.serverType}),A(!0)};if(!e)return null;const le=()=>{if(!(k!=null&&k.med_list)||k.med_list.length===0)return r.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:r.jsx("p",{children:""})});const _=[...k.med_list].sort((v,H)=>v.code.localeCompare(H.code));return r.jsx("div",{className:"overflow-y-auto h-full",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{className:"sticky top-0",children:r.jsxs("tr",{children:[r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700 text-right",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700 text-center",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700 text-center",children:""}),r.jsx("th",{className:"border border-gray-300 px-1 py-2 text-left text-sm font-semibold text-gray-700 text-center",children:""})]})}),r.jsx("tbody",{children:_.map((v,H)=>{const w=i&&l&&v.code==l,j=g.includes(v.code);let D=0;v.qty.forEach(Z=>{D+=+Z}),H===0&&console.log(" ContainerDetailModal - :",{medCode:v.code,highlightedCode:l,isHighlightActive:i,isHighlighted:w,isPendingRequisition:j,comparison:`${v.code} == ${l} = ${v.code==l}`});const I=G();return r.jsxs("tr",{className:`transition-colors cursor-pointer ${j?"highlight-breathe-red":w?`highlight-breathe-${I}`:"hover:bg-gray-50"}`,onClick:()=>U(v),children:[r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm",children:v.code||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm",children:v.SKDIACODE||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm",children:v.name||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm text-right",children:D||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm text-center",children:v.stockCol||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm text-center",children:v.stockRow||"-"}),r.jsx("td",{className:"border border-gray-300 px-1 py-2 text-sm text-center",children:v.stock||"-"})]},H)})})]})})},ue=()=>n?r.jsx(Bh,{container:k,highlightedMedicineCode:i?l:null,pendingRequisitionCodes:g,onMedicineClick:U}):r.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:r.jsx("p",{children:""})});return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),r.jsxs("div",{className:"relative w-full h-full bg-white shadow-2xl overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-200 bg-white",children:[r.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[r.jsx("button",{onClick:()=>o("list_mode"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="list_mode"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:""}),r.jsx("button",{onClick:()=>o("view_mode"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="view_mode"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:""})]}),r.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",title:"",children:r.jsx(Ke,{className:"w-6 h-6 text-gray-700"})})]}),r.jsx("div",{className:"flex-1 overflow-hidden p-3",children:s==="list_mode"?le():ue()})]})]}),r.jsx(Gh,{isOpen:S,onClose:()=>A(!1),medicineInfo:d,requisitions:d?h.filter(_=>_.code===d.code):[],distributions:d?b.filter(_=>_.code===d.code):[],onNoticeUpdated:M})]})},Hh=()=>{const{editStoreShelfModalOpen:e,closeEditStoreShelfModal:t,selectedStoreShelfForEdit:n,showNotification:s,updateContainerInLocalData:o}=rt(),[l,a]=f.useState({name:"",position:"",width:"85",height:"29",ip:"",serverName:"",serverType:"",deviceType:""}),[i,c]=f.useState(!1);f.useEffect(()=>{n&&e&&a({name:n.name||"",position:n.gird_position||"",width:n.width||"85",height:n.height||"29",ip:n.ip||"",serverName:n.serverName||"",serverType:n.serverType||"",deviceType:n.device_type||""})},[n,e]);const g=(p,b)=>{a(N=>({...N,[p]:b}))},y=async()=>{if(n){if(!l.name.trim()){s("","error");return}if(!l.position.trim()){s("","error");return}c(!0);try{const p={Data:[{Master_GUID:n.Master_GUID,name:l.name.trim(),position:l.position.trim(),type:n.type,width:l.width,height:l.height,ip_light:l.ip.trim(),ip:l.ip.trim(),device_type:l.deviceType,serverName:l.serverName.trim(),serverType:l.serverType.trim(),GUID:n.GUID}]},N=`${(await ke.getConfig()).domain}/api/medmap/update_shelf`,A=await(await fetch(N,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).json();console.log(p),console.log(A),A.Code===200?(s("","success"),o(n.GUID,{name:l.name.trim(),gird_position:l.position.trim(),width:l.width,height:l.height,ip:l.ip.trim(),device_type:l.deviceType,serverName:l.serverName.trim(),serverType:l.serverType.trim()}),t()):s(A.Result||"","error")}catch(p){console.error(":",p),s("","error")}finally{c(!1)}}},h=()=>{t()};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:h}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200 w-[600px]",onClick:p=>p.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(jr,{className:"w-6 h-6 text-gray-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:h,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-6 py-4 overflow-y-auto",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.name,onChange:p=>g("name",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (grid_position)"}),r.jsx("input",{type:"text",value:l.position,onChange:p=>g("position",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"0,0"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.width,onChange:p=>g("width",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"85"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.height,onChange:p=>g("height",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"29"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IP"}),r.jsx("input",{type:"text",value:l.ip,onChange:p=>g("ip",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"IP"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.serverName,onChange:p=>g("serverName",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.serverType,onChange:p=>g("serverType",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsxs("select",{value:l.deviceType,onChange:p=>g("deviceType",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors bg-white",children:[r.jsx("option",{value:"",children:""}),r.jsx("option",{value:"RowsLED",children:"RowsLED"})]})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 py-4 px-6 border-t border-gray-200",children:[r.jsx("button",{onClick:h,disabled:i,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:""}),r.jsxs("button",{onClick:y,disabled:i,className:"px-6 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[i&&r.jsx(Rt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:i?"...":""})]})]})]})]})},Vh=()=>{const{editParentContainerModalOpen:e,closeEditParentContainerModal:t,selectedParentContainerForEdit:n,showNotification:s,updateContainerInLocalData:o}=rt(),[l,a]=f.useState({name:"",position:"",ip_light:"",serverName:"",serverType:"",deviceType:"",reverse:"False"}),[i,c]=f.useState(!1);f.useEffect(()=>{n&&e&&a({name:n.name||"",position:n.gird_position||"",ip_light:n.ip_light||"",serverName:n.serverName||"",serverType:n.serverType||"",deviceType:n.device_type||"",reverse:n.reverse||"False"})},[n,e]);const g=(p,b)=>{a(N=>({...N,[p]:b}))},y=async()=>{if(n){if(!l.name.trim()){s("","error");return}if(!l.position.trim()){s("","error");return}c(!0);try{let p=`${n.position.x},${n.position.y}`;const b=[{GUID:n.GUID,name:l.name.trim(),position:l.position.trim(),absolute_position:p||"0,0",ip_light:l.ip_light.trim(),serverName:l.serverName.trim(),serverType:l.serverType.trim(),device_type:l.deviceType,reverse:l.reverse}];console.log("=========",b,"=========");const N=await ke.updateMedMapSection(b);N.Code===200?(s("","success"),o(n.GUID,{name:l.name.trim(),gird_position:l.position.trim(),ip_light:l.ip_light.trim(),serverName:l.serverName.trim(),serverType:l.serverType.trim(),device_type:l.deviceType,reverse:l.reverse}),t()):s(N.Result||"","error")}catch(p){console.error(":",p),s("","error")}finally{c(!1)}}},h=()=>{t()};return!e||!n?null:r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:h}),r.jsxs("div",{className:"relative flex flex-col bg-white rounded-xl shadow-2xl border border-gray-200 w-[600px]",onClick:p=>p.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(jr,{className:"w-6 h-6 text-gray-600"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""})]}),r.jsx("button",{onClick:h,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(Ke,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 px-6 py-4 overflow-y-auto",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.name,onChange:p=>g("name",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (grid_position)"}),r.jsx("input",{type:"text",value:l.position,onChange:p=>g("position",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"0,0"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IP"}),r.jsx("input",{type:"text",value:l.ip_light,onChange:p=>g("ip_light",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:"IP"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.serverName,onChange:p=>g("serverName",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("input",{type:"text",value:l.serverType,onChange:p=>g("serverType",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors",placeholder:""})]}),r.jsxs("div",{className:"hidden",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsxs("select",{value:l.deviceType,onChange:p=>g("deviceType",p.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-colors bg-white",children:[r.jsx("option",{value:"",children:""}),r.jsx("option",{value:"RowsLED",children:"RowsLED"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),r.jsx("button",{type:"button",onClick:()=>g("reverse",l.reverse==="True"?"False":"True"),className:`relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${l.reverse==="True"?"bg-blue-600":"bg-gray-300"}`,children:r.jsx("span",{className:`inline-block h-6 w-6 transform rounded-full bg-white transition-transform ${l.reverse==="True"?"translate-x-7":"translate-x-1"}`})}),r.jsx("span",{className:"ml-3 text-sm text-gray-600",children:l.reverse==="True"?"":""})]})]})}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 py-4 px-6 border-t border-gray-200",children:[r.jsx("button",{onClick:h,disabled:i,className:"px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:""}),r.jsxs("button",{onClick:y,disabled:i,className:"px-6 py-2 text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[i&&r.jsx(Rt,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:i?"...":""})]})]})]})]})},qh=({isOpen:e,onLoginSuccess:t})=>{const{t:n}=kt(),[s,o]=f.useState(""),[l,a]=f.useState(""),[i,c]=f.useState(!1),[g,y]=f.useState(!1),[h,p]=f.useState(""),b=async S=>{if(S.preventDefault(),!s.trim()||!l.trim()){p("Please enter both ID and password");return}y(!0),p("");try{const A=await ke.login({ID:s.trim(),Password:l});if(A.Code===200&&A.Data){const d={...A.Data,loginTime:new Date().toISOString()};sessionStorage.setItem("user_session",JSON.stringify(d)),t(d)}else p(A.Result||"Login failed")}catch(A){console.error("Login failed:",A),p("Network error. Please try again.")}finally{y(!1)}},N=S=>{S.key==="Enter"&&!g&&b(S)};return e?r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900",children:[r.jsx("div",{className:"absolute inset-0 bg-white"}),r.jsxs("div",{className:"relative z-10 w-full max-w-md mx-4",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8 text-center",children:n("login.title")}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-4 md:p-6",children:[h&&r.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-red-600 text-sm",children:h})}),r.jsxs("form",{onSubmit:b,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"userId",className:"block text-sm font-medium text-gray-700 mb-2",children:n("login.userId")}),r.jsx("input",{id:"userId",type:"text",value:s,onChange:S=>o(S.target.value),onKeyPress:N,placeholder:n("login.userIdPlaceholder"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",disabled:g,autoComplete:"username"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:n("login.password")}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{id:"password",type:i?"text":"password",value:l,onChange:S=>a(S.target.value),onKeyPress:N,placeholder:n("login.passwordPlaceholder"),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",disabled:g,autoComplete:"current-password"}),r.jsx("button",{type:"button",onClick:()=>c(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",disabled:g,children:i?r.jsx(Qu,{className:"w-5 h-5"}):r.jsx(Ku,{className:"w-5 h-5"})})]})]}),r.jsx("button",{type:"submit",disabled:g||!s.trim()||!l.trim(),className:"w-full flex items-center justify-center px-4 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:g?r.jsxs(r.Fragment,{children:[r.jsx(Rt,{className:"w-5 h-5 animate-spin mr-2"}),n("login.loggingIn")]}):r.jsx(r.Fragment,{children:n("login.loginButton")})})]})]})]})]}):null},Wh=({isVisible:e,message:t})=>{const{t:n}=kt();return e?r.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),r.jsx("div",{className:"relative z-10 flex flex-col items-center justify-center p-8",children:r.jsxs("div",{className:"bg-white/95 backdrop-blur-sm border border-gray-200/50 rounded-2xl shadow-2xl px-8 py-6 flex flex-col items-center space-y-4 min-w-[280px]",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[r.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:r.jsx(yi,{className:"w-8 h-8 text-blue-600"})}),r.jsx("div",{className:"text-xl font-semibold text-gray-900",children:n("nav.title")})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Rt,{className:"w-8 h-8 text-blue-600 animate-spin"}),r.jsx("div",{className:"text-lg font-medium text-gray-700",children:t||n("status.loadingMedMapData")})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-blue-600 rounded-full animate-pulse",style:{width:"100%"}})}),r.jsx("div",{className:"text-sm text-gray-500 text-center max-w-xs",children:n("status.loadingMedMapHint")})]})})]}):null},Yh=({message:e,type:t,isVisible:n,onClose:s,duration:o=3e3})=>{const[l,a]=f.useState(!1);return f.useEffect(()=>{if(n){a(!0);const i=setTimeout(()=>{s()},o);return()=>clearTimeout(i)}else{const i=setTimeout(()=>{a(!1)},300);return()=>clearTimeout(i)}},[n,o,s]),l?r.jsx("div",{className:`fixed top-4 left-1/2 transform -translate-x-1/2 z-[9999] transition-all duration-300 ease-in-out ${n?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:r.jsxs("div",{className:`flex items-center space-x-3 px-4 py-3 rounded-lg shadow-lg border ${t==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:[t==="success"?r.jsx(lh,{className:"w-5 h-5 text-green-600"}):r.jsx(gh,{className:"w-5 h-5 text-red-600"}),r.jsx("span",{className:"text-sm font-medium",children:e}),r.jsx("button",{onClick:s,className:`p-1 rounded-full hover:bg-black/10 transition-colors ${t==="success"?"text-green-600":"text-red-600"}`,children:r.jsx(Ke,{className:"w-4 h-4"})})]})}):null};function Xh(){const{selectedDepartmentType:e,viewMode:t,isAuthenticated:n,setIsAuthenticated:s,setCurrentUser:o,isLoadingMedMap:l,notification:a,hideNotification:i,addParentContainerModalOpen:c,closeAddParentContainerModal:g,selectedDepartmentForAdd:y,addStoreItemModalOpen:h,closeAddStoreItemModal:p,selectedStoreShelfForAdd:b,addDepartmentModalOpen:N,closeAddDepartmentModal:S,qrCodeScannerModalOpen:A,qrCodeScannerMode:d,closeQRCodeScannerModal:u,addBarcodeModalOpen:m,closeAddBarcodeModal:C,initialBarcodeValue:P,containerDetailModalOpen:k,closeContainerDetailModal:T,selectedContainerForDetail:G,setMedicineList:M,setIsLoadingMedicines:U,showNotification:le}=rt();f.useEffect(()=>{(()=>{try{const w=sessionStorage.getItem("user_session");if(w){const j=JSON.parse(w);j.GUID&&j.ID&&j.Name?(o(j),s(!0)):sessionStorage.removeItem("user_session")}}catch(w){console.error("Error checking session:",w),sessionStorage.removeItem("user_session")}})()},[s,o]),f.useEffect(()=>{let H=!0;return(async()=>{if(n){U(!0);try{console.log("...");const j=await ke.getMedicineCloud();if(console.log(" API :",j),!H)return;j.Code===200&&j.Data?(M(j.Data),console.log(`  ${j.Data.length} `),le(` ${j.Data.length} `,"success")):(console.warn("API :",j),M([]),le("","error"))}catch(j){if(!H)return;console.error(":",j),M([]),le("","error")}finally{H&&U(!1)}}})(),()=>{H=!1}},[n]);const ue=H=>{o(H),s(!0)},_=mo.useRef(null),v=(H,w)=>{if(console.log(" QR - handleQRScanSuccess :",{barcode:H,medicineData:w,mode:d}),console.log("  mode:",d),console.log("  viewMode:",t),console.log(" drugCanvasRef.current:",_.current),d==="track_Drug_mode"){if(console.log("  track_Drug_mode "),t!=="medicine"){console.warn(" "),le("","error");return}_.current?(console.log(" drugCanvasRef.current "),console.log(" drugCanvasRef.current.locateDrug :",typeof _.current.locateDrug),typeof _.current.locateDrug=="function"?(console.log("  locateDrug "),_.current.locateDrug(w)):console.warn(" locateDrug ")):console.warn(" drugCanvasRef.current ")}else console.log(" mode  track_Drug_mode mode:",d)};return n?r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(xh,{}),r.jsx(yh,{}),r.jsx(Nh,{}),r.jsx("div",{className:"fixed inset-0",children:r.jsx("div",{className:"w-full h-full",children:t==="department"?r.jsx(kh,{}):r.jsx(ef,{ref:_})})}),r.jsx(jh,{}),r.jsx(Ih,{}),r.jsx(Ph,{}),r.jsx(Th,{}),r.jsx(Rh,{}),r.jsx($h,{}),r.jsx(Ah,{}),r.jsx(Oh,{isOpen:h,onClose:p,storeShelf:b}),r.jsx(Uh,{isOpen:N,onClose:S}),r.jsx(tl,{isOpen:A,onClose:u,mode:d,onScanSuccess:v}),r.jsx(Lh,{isOpen:m,onClose:C,initialBarcode:P}),r.jsx(Fh,{isOpen:k,onClose:T,container:G}),r.jsx(Hh,{}),r.jsx(Vh,{}),r.jsx(Wh,{isVisible:l}),r.jsx(Yh,{message:a.message,type:a.type,isVisible:a.isVisible,onClose:i})]}):r.jsx(qh,{isOpen:!0,onLoginSuccess:ue})}function Qh(){return r.jsx(nh,{children:r.jsx(eh,{children:r.jsx(Xh,{})})})}Vu(document.getElementById("root")).render(r.jsx(f.StrictMode,{children:r.jsx(Qh,{})}));
